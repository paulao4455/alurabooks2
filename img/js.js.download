/*! For license information please see js.js.LICENSE.txt */
(()=>{var e={9824:(e,t,n)=>{e.exports=n(2240)},4080:(e,t,n)=>{"use strict";var i=n(9732),s=n(9392),o=n(3908),r=n(1016),a=n(8208),c=n(3768),l=n(872),d=n(2964);e.exports=function(e){return new Promise((function(t,n){var u=e.data,h=e.headers,p=e.responseType;i.isFormData(u)&&delete h["Content-Type"];var m=new XMLHttpRequest;if(e.auth){var w=e.auth.username||"",g=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";h.Authorization="Basic "+btoa(w+":"+g)}var f=a(e.baseURL,e.url);function v(){if(m){var i="getAllResponseHeaders"in m?c(m.getAllResponseHeaders()):null,o={data:p&&"text"!==p&&"json"!==p?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:i,config:e,request:m};s(t,n,o),m=null}}if(m.open(e.method.toUpperCase(),r(f,e.params,e.paramsSerializer),!0),m.timeout=e.timeout,"onloadend"in m?m.onloadend=v:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(v)},m.onabort=function(){m&&(n(d("Request aborted",e,"ECONNABORTED",m)),m=null)},m.onerror=function(){n(d("Network Error",e,null,m)),m=null},m.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(d(t,e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",m)),m=null},i.isStandardBrowserEnv()){var b=(e.withCredentials||l(f))&&e.xsrfCookieName?o.read(e.xsrfCookieName):void 0;b&&(h[e.xsrfHeaderName]=b)}"setRequestHeader"in m&&i.forEach(h,(function(e,t){void 0===u&&"content-type"===t.toLowerCase()?delete h[t]:m.setRequestHeader(t,e)})),i.isUndefined(e.withCredentials)||(m.withCredentials=!!e.withCredentials),p&&"json"!==p&&(m.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&m.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&m.upload&&m.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){m&&(m.abort(),n(e),m=null)})),u||(u=null),m.send(u)}))}},2240:(e,t,n)=>{"use strict";var i=n(9732),s=n(528),o=n(3188),r=n(808);function a(e){var t=new o(e),n=s(o.prototype.request,t);return i.extend(n,o.prototype,t),i.extend(n,t),n}var c=a(n(6816));c.Axios=o,c.create=function(e){return a(r(c.defaults,e))},c.Cancel=n(6588),c.CancelToken=n(5291),c.isCancel=n(9500),c.all=function(e){return Promise.all(e)},c.spread=n(7284),c.isAxiosError=n(7560),e.exports=c,e.exports.default=c},6588:e=>{"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},5291:(e,t,n)=>{"use strict";var i=n(6588);function s(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new i(e),t(n.reason))}))}s.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},s.source=function(){var e;return{token:new s((function(t){e=t})),cancel:e}},e.exports=s},9500:e=>{"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},3188:(e,t,n)=>{"use strict";var i=n(9732),s=n(1016),o=n(8776),r=n(7108),a=n(808),c=n(8832),l=c.validators;function d(e){this.defaults=e,this.interceptors={request:new o,response:new o}}d.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&c.assertOptions(t,{silentJSONParsing:l.transitional(l.boolean,"1.0.0"),forcedJSONParsing:l.transitional(l.boolean,"1.0.0"),clarifyTimeoutError:l.transitional(l.boolean,"1.0.0")},!1);var n=[],i=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(i=i&&t.synchronous,n.unshift(t.fulfilled,t.rejected))}));var s,o=[];if(this.interceptors.response.forEach((function(e){o.push(e.fulfilled,e.rejected)})),!i){var d=[r,void 0];for(Array.prototype.unshift.apply(d,n),d=d.concat(o),s=Promise.resolve(e);d.length;)s=s.then(d.shift(),d.shift());return s}for(var u=e;n.length;){var h=n.shift(),p=n.shift();try{u=h(u)}catch(e){p(e);break}}try{s=r(u)}catch(e){return Promise.reject(e)}for(;o.length;)s=s.then(o.shift(),o.shift());return s},d.prototype.getUri=function(e){return e=a(this.defaults,e),s(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},i.forEach(["delete","get","head","options"],(function(e){d.prototype[e]=function(t,n){return this.request(a(n||{},{method:e,url:t,data:(n||{}).data}))}})),i.forEach(["post","put","patch"],(function(e){d.prototype[e]=function(t,n,i){return this.request(a(i||{},{method:e,url:t,data:n}))}})),e.exports=d},8776:(e,t,n)=>{"use strict";var i=n(9732);function s(){this.handlers=[]}s.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},s.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},s.prototype.forEach=function(e){i.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=s},8208:(e,t,n)=>{"use strict";var i=n(9688),s=n(5584);e.exports=function(e,t){return e&&!i(t)?s(e,t):t}},2964:(e,t,n)=>{"use strict";var i=n(3356);e.exports=function(e,t,n,s,o){var r=new Error(e);return i(r,t,n,s,o)}},7108:(e,t,n)=>{"use strict";var i=n(9732),s=n(4948),o=n(9500),r=n(6816);function a(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return a(e),e.headers=e.headers||{},e.data=s.call(e,e.data,e.headers,e.transformRequest),e.headers=i.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),i.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||r.adapter)(e).then((function(t){return a(e),t.data=s.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(a(e),t&&t.response&&(t.response.data=s.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},3356:e=>{"use strict";e.exports=function(e,t,n,i,s){return e.config=t,n&&(e.code=n),e.request=i,e.response=s,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},808:(e,t,n)=>{"use strict";var i=n(9732);e.exports=function(e,t){t=t||{};var n={},s=["url","method","data"],o=["headers","auth","proxy","params"],r=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],a=["validateStatus"];function c(e,t){return i.isPlainObject(e)&&i.isPlainObject(t)?i.merge(e,t):i.isPlainObject(t)?i.merge({},t):i.isArray(t)?t.slice():t}function l(s){i.isUndefined(t[s])?i.isUndefined(e[s])||(n[s]=c(void 0,e[s])):n[s]=c(e[s],t[s])}i.forEach(s,(function(e){i.isUndefined(t[e])||(n[e]=c(void 0,t[e]))})),i.forEach(o,l),i.forEach(r,(function(s){i.isUndefined(t[s])?i.isUndefined(e[s])||(n[s]=c(void 0,e[s])):n[s]=c(void 0,t[s])})),i.forEach(a,(function(i){i in t?n[i]=c(e[i],t[i]):i in e&&(n[i]=c(void 0,e[i]))}));var d=s.concat(o).concat(r).concat(a),u=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===d.indexOf(e)}));return i.forEach(u,l),n}},9392:(e,t,n)=>{"use strict";var i=n(2964);e.exports=function(e,t,n){var s=n.config.validateStatus;n.status&&s&&!s(n.status)?t(i("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},4948:(e,t,n)=>{"use strict";var i=n(9732),s=n(6816);e.exports=function(e,t,n){var o=this||s;return i.forEach(n,(function(n){e=n.call(o,e,t)})),e}},6816:(e,t,n)=>{"use strict";var i=n(9732),s=n(8060),o=n(3356),r={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var c,l={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(c=n(4080)),c),transformRequest:[function(e,t){return s(t,"Accept"),s(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)||t&&"application/json"===t["Content-Type"]?(a(t,"application/json"),function(e,t,n){if(i.isString(e))try{return(0,JSON.parse)(e),i.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional,n=t&&t.silentJSONParsing,s=t&&t.forcedJSONParsing,r=!n&&"json"===this.responseType;if(r||s&&i.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(r){if("SyntaxError"===e.name)throw o(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};i.forEach(["delete","get","head"],(function(e){l.headers[e]={}})),i.forEach(["post","put","patch"],(function(e){l.headers[e]=i.merge(r)})),e.exports=l},528:e=>{"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];return e.apply(t,n)}}},1016:(e,t,n)=>{"use strict";var i=n(9732);function s(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var o;if(n)o=n(t);else if(i.isURLSearchParams(t))o=t.toString();else{var r=[];i.forEach(t,(function(e,t){null!=e&&(i.isArray(e)?t+="[]":e=[e],i.forEach(e,(function(e){i.isDate(e)?e=e.toISOString():i.isObject(e)&&(e=JSON.stringify(e)),r.push(s(t)+"="+s(e))})))})),o=r.join("&")}if(o){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}},5584:e=>{"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},3908:(e,t,n)=>{"use strict";var i=n(9732);e.exports=i.isStandardBrowserEnv()?{write:function(e,t,n,s,o,r){var a=[];a.push(e+"="+encodeURIComponent(t)),i.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),i.isString(s)&&a.push("path="+s),i.isString(o)&&a.push("domain="+o),!0===r&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},9688:e=>{"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},7560:e=>{"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},872:(e,t,n)=>{"use strict";var i=n(9732);e.exports=i.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function s(e){var i=e;return t&&(n.setAttribute("href",i),i=n.href),n.setAttribute("href",i),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=s(window.location.href),function(t){var n=i.isString(t)?s(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},8060:(e,t,n)=>{"use strict";var i=n(9732);e.exports=function(e,t){i.forEach(e,(function(n,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[i])}))}},3768:(e,t,n)=>{"use strict";var i=n(9732),s=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,o,r={};return e?(i.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=i.trim(e.substr(0,o)).toLowerCase(),n=i.trim(e.substr(o+1)),t){if(r[t]&&s.indexOf(t)>=0)return;r[t]="set-cookie"===t?(r[t]?r[t]:[]).concat([n]):r[t]?r[t]+", "+n:n}})),r):r}},7284:e=>{"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},8832:(e,t,n)=>{"use strict";var i=n(3706),s={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){s[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var o={},r=i.version.split(".");function a(e,t){for(var n=t?t.split("."):r,i=e.split("."),s=0;s<3;s++){if(n[s]>i[s])return!0;if(n[s]<i[s])return!1}return!1}s.transitional=function(e,t,n){var s=t&&a(t);function r(e,t){return"[Axios v"+i.version+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,i,a){if(!1===e)throw new Error(r(i," has been removed in "+t));return s&&!o[i]&&(o[i]=!0,console.warn(r(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,i,a)}},e.exports={isOlderVersion:a,assertOptions:function(e,t,n){if("object"!=typeof e)throw new TypeError("options must be an object");for(var i=Object.keys(e),s=i.length;s-- >0;){var o=i[s],r=t[o];if(r){var a=e[o],c=void 0===a||r(a,o,e);if(!0!==c)throw new TypeError("option "+o+" must be "+c)}else if(!0!==n)throw Error("Unknown option "+o)}},validators:s}},9732:(e,t,n)=>{"use strict";var i=n(528),s=Object.prototype.toString;function o(e){return"[object Array]"===s.call(e)}function r(e){return void 0===e}function a(e){return null!==e&&"object"==typeof e}function c(e){if("[object Object]"!==s.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function l(e){return"[object Function]"===s.call(e)}function d(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),o(e))for(var n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(null,e[s],s,e)}e.exports={isArray:o,isArrayBuffer:function(e){return"[object ArrayBuffer]"===s.call(e)},isBuffer:function(e){return null!==e&&!r(e)&&null!==e.constructor&&!r(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isPlainObject:c,isUndefined:r,isDate:function(e){return"[object Date]"===s.call(e)},isFile:function(e){return"[object File]"===s.call(e)},isBlob:function(e){return"[object Blob]"===s.call(e)},isFunction:l,isStream:function(e){return a(e)&&l(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:d,merge:function e(){var t={};function n(n,i){c(t[i])&&c(n)?t[i]=e(t[i],n):c(n)?t[i]=e({},n):o(n)?t[i]=n.slice():t[i]=n}for(var i=0,s=arguments.length;i<s;i++)d(arguments[i],n);return t},extend:function(e,t,n){return d(t,(function(t,s){e[s]=n&&"function"==typeof t?i(t,n):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},2416:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",i=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),i&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),i&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,i,s,o){"string"==typeof e&&(e=[[null,e,void 0]]);var r={};if(i)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(r[c]=!0)}for(var l=0;l<e.length;l++){var d=[].concat(e[l]);i&&r[d[0]]||(void 0!==o&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=o),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),s&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=s):d[4]="".concat(s)),t.push(d))}},t}},5664:e=>{"use strict";e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},1503:e=>{"use strict";e.exports=function(e){return e[1]}},436:function(e,t){var n;!function(t,n){"use strict";"object"==typeof e.exports?e.exports=t.document?n(t,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return n(e)}:n(t)}("undefined"!=typeof window?window:this,(function(i,s){"use strict";var o=[],r=Object.getPrototypeOf,a=o.slice,c=o.flat?function(e){return o.flat.call(e)}:function(e){return o.concat.apply([],e)},l=o.push,d=o.indexOf,u={},h=u.toString,p=u.hasOwnProperty,m=p.toString,w=m.call(Object),g={},f=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},v=function(e){return null!=e&&e===e.window},b=i.document,_={type:!0,src:!0,nonce:!0,noModule:!0};function y(e,t,n){var i,s,o=(n=n||b).createElement("script");if(o.text=e,t)for(i in _)(s=t[i]||t.getAttribute&&t.getAttribute(i))&&o.setAttribute(i,s);n.head.appendChild(o).parentNode.removeChild(o)}function C(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?u[h.call(e)]||"object":typeof e}var S="3.5.1",E=function(e,t){return new E.fn.init(e,t)};function x(e){var t=!!e&&"length"in e&&e.length,n=C(e);return!f(e)&&!v(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}E.fn=E.prototype={jquery:S,constructor:E,length:0,toArray:function(){return a.call(this)},get:function(e){return null==e?a.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=E.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return E.each(this,e)},map:function(e){return this.pushStack(E.map(this,(function(t,n){return e.call(t,n,t)})))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(E.grep(this,(function(e,t){return(t+1)%2})))},odd:function(){return this.pushStack(E.grep(this,(function(e,t){return t%2})))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:l,sort:o.sort,splice:o.splice},E.extend=E.fn.extend=function(){var e,t,n,i,s,o,r=arguments[0]||{},a=1,c=arguments.length,l=!1;for("boolean"==typeof r&&(l=r,r=arguments[a]||{},a++),"object"==typeof r||f(r)||(r={}),a===c&&(r=this,a--);a<c;a++)if(null!=(e=arguments[a]))for(t in e)i=e[t],"__proto__"!==t&&r!==i&&(l&&i&&(E.isPlainObject(i)||(s=Array.isArray(i)))?(n=r[t],o=s&&!Array.isArray(n)?[]:s||E.isPlainObject(n)?n:{},s=!1,r[t]=E.extend(l,o,i)):void 0!==i&&(r[t]=i));return r},E.extend({expando:"jQuery"+(S+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==h.call(e)||(t=r(e))&&("function"!=typeof(n=p.call(t,"constructor")&&t.constructor)||m.call(n)!==w))},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){y(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,i=0;if(x(e))for(n=e.length;i<n&&!1!==t.call(e[i],i,e[i]);i++);else for(i in e)if(!1===t.call(e[i],i,e[i]))break;return e},makeArray:function(e,t){var n=t||[];return null!=e&&(x(Object(e))?E.merge(n,"string"==typeof e?[e]:e):l.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:d.call(t,e,n)},merge:function(e,t){for(var n=+t.length,i=0,s=e.length;i<n;i++)e[s++]=t[i];return e.length=s,e},grep:function(e,t,n){for(var i=[],s=0,o=e.length,r=!n;s<o;s++)!t(e[s],s)!==r&&i.push(e[s]);return i},map:function(e,t,n){var i,s,o=0,r=[];if(x(e))for(i=e.length;o<i;o++)null!=(s=t(e[o],o,n))&&r.push(s);else for(o in e)null!=(s=t(e[o],o,n))&&r.push(s);return c(r)},guid:1,support:g}),"function"==typeof Symbol&&(E.fn[Symbol.iterator]=o[Symbol.iterator]),E.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,t){u["[object "+t+"]"]=t.toLowerCase()}));var k=function(e){var t,n,i,s,o,r,a,c,l,d,u,h,p,m,w,g,f,v,b,_="sizzle"+1*new Date,y=e.document,C=0,S=0,E=ce(),x=ce(),k=ce(),M=ce(),T=function(e,t){return e===t&&(u=!0),0},I={}.hasOwnProperty,R=[],A=R.pop,$=R.push,L=R.push,P=R.slice,D=function(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1},N="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",O="[\\x20\\t\\r\\n\\f]",B="(?:\\\\[\\da-fA-F]{1,6}"+O+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",F="\\["+O+"*("+B+")(?:"+O+"*([*^$|!~]?=)"+O+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+B+"))|)"+O+"*\\]",U=":("+B+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+F+")*)|.*)\\)|)",j=new RegExp(O+"+","g"),V=new RegExp("^"+O+"+|((?:^|[^\\\\])(?:\\\\.)*)"+O+"+$","g"),G=new RegExp("^"+O+"*,"+O+"*"),q=new RegExp("^"+O+"*([>+~]|"+O+")"+O+"*"),H=new RegExp(O+"|>"),z=new RegExp(U),W=new RegExp("^"+B+"$"),J={ID:new RegExp("^#("+B+")"),CLASS:new RegExp("^\\.("+B+")"),TAG:new RegExp("^("+B+"|[*])"),ATTR:new RegExp("^"+F),PSEUDO:new RegExp("^"+U),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+O+"*(even|odd|(([+-]|)(\\d*)n|)"+O+"*(?:([+-]|)"+O+"*(\\d+)|))"+O+"*\\)|)","i"),bool:new RegExp("^(?:"+N+")$","i"),needsContext:new RegExp("^"+O+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+O+"*((?:-\\d)?\\d*)"+O+"*\\)|)(?=[^-]|$)","i")},Y=/HTML$/i,K=/^(?:input|select|textarea|button)$/i,X=/^h\d$/i,Z=/^[^{]+\{\s*\[native \w/,Q=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\[\\da-fA-F]{1,6}"+O+"?|\\\\([^\\r\\n\\f])","g"),ne=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},ie=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,se=function(e,t){return t?"\0"===e?"ï¿½":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},oe=function(){h()},re=_e((function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{L.apply(R=P.call(y.childNodes),y.childNodes),R[y.childNodes.length].nodeType}catch(e){L={apply:R.length?function(e,t){$.apply(e,P.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}function ae(e,t,i,s){var o,a,l,d,u,m,f,v=t&&t.ownerDocument,y=t?t.nodeType:9;if(i=i||[],"string"!=typeof e||!e||1!==y&&9!==y&&11!==y)return i;if(!s&&(h(t),t=t||p,w)){if(11!==y&&(u=Q.exec(e)))if(o=u[1]){if(9===y){if(!(l=t.getElementById(o)))return i;if(l.id===o)return i.push(l),i}else if(v&&(l=v.getElementById(o))&&b(t,l)&&l.id===o)return i.push(l),i}else{if(u[2])return L.apply(i,t.getElementsByTagName(e)),i;if((o=u[3])&&n.getElementsByClassName&&t.getElementsByClassName)return L.apply(i,t.getElementsByClassName(o)),i}if(n.qsa&&!M[e+" "]&&(!g||!g.test(e))&&(1!==y||"object"!==t.nodeName.toLowerCase())){if(f=e,v=t,1===y&&(H.test(e)||q.test(e))){for((v=ee.test(e)&&fe(t.parentNode)||t)===t&&n.scope||((d=t.getAttribute("id"))?d=d.replace(ie,se):t.setAttribute("id",d=_)),a=(m=r(e)).length;a--;)m[a]=(d?"#"+d:":scope")+" "+be(m[a]);f=m.join(",")}try{return L.apply(i,v.querySelectorAll(f)),i}catch(t){M(e,!0)}finally{d===_&&t.removeAttribute("id")}}}return c(e.replace(V,"$1"),t,i,s)}function ce(){var e=[];return function t(n,s){return e.push(n+" ")>i.cacheLength&&delete t[e.shift()],t[n+" "]=s}}function le(e){return e[_]=!0,e}function de(e){var t=p.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ue(e,t){for(var n=e.split("|"),s=n.length;s--;)i.attrHandle[n[s]]=t}function he(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function pe(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function me(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function we(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&re(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function ge(e){return le((function(t){return t=+t,le((function(n,i){for(var s,o=e([],n.length,t),r=o.length;r--;)n[s=o[r]]&&(n[s]=!(i[s]=n[s]))}))}))}function fe(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in n=ae.support={},o=ae.isXML=function(e){var t=e.namespaceURI,n=(e.ownerDocument||e).documentElement;return!Y.test(t||n&&n.nodeName||"HTML")},h=ae.setDocument=function(e){var t,s,r=e?e.ownerDocument||e:y;return r!=p&&9===r.nodeType&&r.documentElement?(m=(p=r).documentElement,w=!o(p),y!=p&&(s=p.defaultView)&&s.top!==s&&(s.addEventListener?s.addEventListener("unload",oe,!1):s.attachEvent&&s.attachEvent("onunload",oe)),n.scope=de((function(e){return m.appendChild(e).appendChild(p.createElement("div")),void 0!==e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length})),n.attributes=de((function(e){return e.className="i",!e.getAttribute("className")})),n.getElementsByTagName=de((function(e){return e.appendChild(p.createComment("")),!e.getElementsByTagName("*").length})),n.getElementsByClassName=Z.test(p.getElementsByClassName),n.getById=de((function(e){return m.appendChild(e).id=_,!p.getElementsByName||!p.getElementsByName(_).length})),n.getById?(i.filter.ID=function(e){var t=e.replace(te,ne);return function(e){return e.getAttribute("id")===t}},i.find.ID=function(e,t){if(void 0!==t.getElementById&&w){var n=t.getElementById(e);return n?[n]:[]}}):(i.filter.ID=function(e){var t=e.replace(te,ne);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},i.find.ID=function(e,t){if(void 0!==t.getElementById&&w){var n,i,s,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];for(s=t.getElementsByName(e),i=0;o=s[i++];)if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),i.find.TAG=n.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):n.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,i=[],s=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[s++];)1===n.nodeType&&i.push(n);return i}return o},i.find.CLASS=n.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&w)return t.getElementsByClassName(e)},f=[],g=[],(n.qsa=Z.test(p.querySelectorAll))&&(de((function(e){var t;m.appendChild(e).innerHTML="<a id='"+_+"'></a><select id='"+_+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&g.push("[*^$]="+O+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||g.push("\\["+O+"*(?:value|"+N+")"),e.querySelectorAll("[id~="+_+"-]").length||g.push("~="),(t=p.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||g.push("\\["+O+"*name"+O+"*="+O+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||g.push(":checked"),e.querySelectorAll("a#"+_+"+*").length||g.push(".#.+[+~]"),e.querySelectorAll("\\\f"),g.push("[\\r\\n\\f]")})),de((function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=p.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&g.push("name"+O+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&g.push(":enabled",":disabled"),m.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&g.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),g.push(",.*:")}))),(n.matchesSelector=Z.test(v=m.matches||m.webkitMatchesSelector||m.mozMatchesSelector||m.oMatchesSelector||m.msMatchesSelector))&&de((function(e){n.disconnectedMatch=v.call(e,"*"),v.call(e,"[s!='']:x"),f.push("!=",U)})),g=g.length&&new RegExp(g.join("|")),f=f.length&&new RegExp(f.join("|")),t=Z.test(m.compareDocumentPosition),b=t||Z.test(m.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},T=t?function(e,t){if(e===t)return u=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i||(1&(i=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!n.sortDetached&&t.compareDocumentPosition(e)===i?e==p||e.ownerDocument==y&&b(y,e)?-1:t==p||t.ownerDocument==y&&b(y,t)?1:d?D(d,e)-D(d,t):0:4&i?-1:1)}:function(e,t){if(e===t)return u=!0,0;var n,i=0,s=e.parentNode,o=t.parentNode,r=[e],a=[t];if(!s||!o)return e==p?-1:t==p?1:s?-1:o?1:d?D(d,e)-D(d,t):0;if(s===o)return he(e,t);for(n=e;n=n.parentNode;)r.unshift(n);for(n=t;n=n.parentNode;)a.unshift(n);for(;r[i]===a[i];)i++;return i?he(r[i],a[i]):r[i]==y?-1:a[i]==y?1:0},p):p},ae.matches=function(e,t){return ae(e,null,null,t)},ae.matchesSelector=function(e,t){if(h(e),n.matchesSelector&&w&&!M[t+" "]&&(!f||!f.test(t))&&(!g||!g.test(t)))try{var i=v.call(e,t);if(i||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(e){M(t,!0)}return ae(t,p,null,[e]).length>0},ae.contains=function(e,t){return(e.ownerDocument||e)!=p&&h(e),b(e,t)},ae.attr=function(e,t){(e.ownerDocument||e)!=p&&h(e);var s=i.attrHandle[t.toLowerCase()],o=s&&I.call(i.attrHandle,t.toLowerCase())?s(e,t,!w):void 0;return void 0!==o?o:n.attributes||!w?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null},ae.escape=function(e){return(e+"").replace(ie,se)},ae.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ae.uniqueSort=function(e){var t,i=[],s=0,o=0;if(u=!n.detectDuplicates,d=!n.sortStable&&e.slice(0),e.sort(T),u){for(;t=e[o++];)t===e[o]&&(s=i.push(o));for(;s--;)e.splice(i[s],1)}return d=null,e},s=ae.getText=function(e){var t,n="",i=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=s(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[i++];)n+=s(t);return n},i=ae.selectors={cacheLength:50,createPseudo:le,match:J,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ae.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ae.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return J.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&z.test(n)&&(t=r(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=E[e+" "];return t||(t=new RegExp("(^|"+O+")"+e+"("+O+"|$)"))&&E(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,n){return function(i){var s=ae.attr(i,e);return null==s?"!="===t:!t||(s+="","="===t?s===n:"!="===t?s!==n:"^="===t?n&&0===s.indexOf(n):"*="===t?n&&s.indexOf(n)>-1:"$="===t?n&&s.slice(-n.length)===n:"~="===t?(" "+s.replace(j," ")+" ").indexOf(n)>-1:"|="===t&&(s===n||s.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,i,s){var o="nth"!==e.slice(0,3),r="last"!==e.slice(-4),a="of-type"===t;return 1===i&&0===s?function(e){return!!e.parentNode}:function(t,n,c){var l,d,u,h,p,m,w=o!==r?"nextSibling":"previousSibling",g=t.parentNode,f=a&&t.nodeName.toLowerCase(),v=!c&&!a,b=!1;if(g){if(o){for(;w;){for(h=t;h=h[w];)if(a?h.nodeName.toLowerCase()===f:1===h.nodeType)return!1;m=w="only"===e&&!m&&"nextSibling"}return!0}if(m=[r?g.firstChild:g.lastChild],r&&v){for(b=(p=(l=(d=(u=(h=g)[_]||(h[_]={}))[h.uniqueID]||(u[h.uniqueID]={}))[e]||[])[0]===C&&l[1])&&l[2],h=p&&g.childNodes[p];h=++p&&h&&h[w]||(b=p=0)||m.pop();)if(1===h.nodeType&&++b&&h===t){d[e]=[C,p,b];break}}else if(v&&(b=p=(l=(d=(u=(h=t)[_]||(h[_]={}))[h.uniqueID]||(u[h.uniqueID]={}))[e]||[])[0]===C&&l[1]),!1===b)for(;(h=++p&&h&&h[w]||(b=p=0)||m.pop())&&((a?h.nodeName.toLowerCase()!==f:1!==h.nodeType)||!++b||(v&&((d=(u=h[_]||(h[_]={}))[h.uniqueID]||(u[h.uniqueID]={}))[e]=[C,b]),h!==t)););return(b-=s)===i||b%i==0&&b/i>=0}}},PSEUDO:function(e,t){var n,s=i.pseudos[e]||i.setFilters[e.toLowerCase()]||ae.error("unsupported pseudo: "+e);return s[_]?s(t):s.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?le((function(e,n){for(var i,o=s(e,t),r=o.length;r--;)e[i=D(e,o[r])]=!(n[i]=o[r])})):function(e){return s(e,0,n)}):s}},pseudos:{not:le((function(e){var t=[],n=[],i=a(e.replace(V,"$1"));return i[_]?le((function(e,t,n,s){for(var o,r=i(e,null,s,[]),a=e.length;a--;)(o=r[a])&&(e[a]=!(t[a]=o))})):function(e,s,o){return t[0]=e,i(t,null,o,n),t[0]=null,!n.pop()}})),has:le((function(e){return function(t){return ae(e,t).length>0}})),contains:le((function(e){return e=e.replace(te,ne),function(t){return(t.textContent||s(t)).indexOf(e)>-1}})),lang:le((function(e){return W.test(e||"")||ae.error("unsupported lang: "+e),e=e.replace(te,ne).toLowerCase(),function(t){var n;do{if(n=w?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===m},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:we(!1),disabled:we(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return X.test(e.nodeName)},input:function(e){return K.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ge((function(){return[0]})),last:ge((function(e,t){return[t-1]})),eq:ge((function(e,t,n){return[n<0?n+t:n]})),even:ge((function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e})),odd:ge((function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e})),lt:ge((function(e,t,n){for(var i=n<0?n+t:n>t?t:n;--i>=0;)e.push(i);return e})),gt:ge((function(e,t,n){for(var i=n<0?n+t:n;++i<t;)e.push(i);return e}))}},i.pseudos.nth=i.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[t]=pe(t);for(t in{submit:!0,reset:!0})i.pseudos[t]=me(t);function ve(){}function be(e){for(var t=0,n=e.length,i="";t<n;t++)i+=e[t].value;return i}function _e(e,t,n){var i=t.dir,s=t.next,o=s||i,r=n&&"parentNode"===o,a=S++;return t.first?function(t,n,s){for(;t=t[i];)if(1===t.nodeType||r)return e(t,n,s);return!1}:function(t,n,c){var l,d,u,h=[C,a];if(c){for(;t=t[i];)if((1===t.nodeType||r)&&e(t,n,c))return!0}else for(;t=t[i];)if(1===t.nodeType||r)if(d=(u=t[_]||(t[_]={}))[t.uniqueID]||(u[t.uniqueID]={}),s&&s===t.nodeName.toLowerCase())t=t[i]||t;else{if((l=d[o])&&l[0]===C&&l[1]===a)return h[2]=l[2];if(d[o]=h,h[2]=e(t,n,c))return!0}return!1}}function ye(e){return e.length>1?function(t,n,i){for(var s=e.length;s--;)if(!e[s](t,n,i))return!1;return!0}:e[0]}function Ce(e,t,n,i,s){for(var o,r=[],a=0,c=e.length,l=null!=t;a<c;a++)(o=e[a])&&(n&&!n(o,i,s)||(r.push(o),l&&t.push(a)));return r}function Se(e,t,n,i,s,o){return i&&!i[_]&&(i=Se(i)),s&&!s[_]&&(s=Se(s,o)),le((function(o,r,a,c){var l,d,u,h=[],p=[],m=r.length,w=o||function(e,t,n){for(var i=0,s=t.length;i<s;i++)ae(e,t[i],n);return n}(t||"*",a.nodeType?[a]:a,[]),g=!e||!o&&t?w:Ce(w,h,e,a,c),f=n?s||(o?e:m||i)?[]:r:g;if(n&&n(g,f,a,c),i)for(l=Ce(f,p),i(l,[],a,c),d=l.length;d--;)(u=l[d])&&(f[p[d]]=!(g[p[d]]=u));if(o){if(s||e){if(s){for(l=[],d=f.length;d--;)(u=f[d])&&l.push(g[d]=u);s(null,f=[],l,c)}for(d=f.length;d--;)(u=f[d])&&(l=s?D(o,u):h[d])>-1&&(o[l]=!(r[l]=u))}}else f=Ce(f===r?f.splice(m,f.length):f),s?s(null,r,f,c):L.apply(r,f)}))}function Ee(e){for(var t,n,s,o=e.length,r=i.relative[e[0].type],a=r||i.relative[" "],c=r?1:0,d=_e((function(e){return e===t}),a,!0),u=_e((function(e){return D(t,e)>-1}),a,!0),h=[function(e,n,i){var s=!r&&(i||n!==l)||((t=n).nodeType?d(e,n,i):u(e,n,i));return t=null,s}];c<o;c++)if(n=i.relative[e[c].type])h=[_e(ye(h),n)];else{if((n=i.filter[e[c].type].apply(null,e[c].matches))[_]){for(s=++c;s<o&&!i.relative[e[s].type];s++);return Se(c>1&&ye(h),c>1&&be(e.slice(0,c-1).concat({value:" "===e[c-2].type?"*":""})).replace(V,"$1"),n,c<s&&Ee(e.slice(c,s)),s<o&&Ee(e=e.slice(s)),s<o&&be(e))}h.push(n)}return ye(h)}return ve.prototype=i.filters=i.pseudos,i.setFilters=new ve,r=ae.tokenize=function(e,t){var n,s,o,r,a,c,l,d=x[e+" "];if(d)return t?0:d.slice(0);for(a=e,c=[],l=i.preFilter;a;){for(r in n&&!(s=G.exec(a))||(s&&(a=a.slice(s[0].length)||a),c.push(o=[])),n=!1,(s=q.exec(a))&&(n=s.shift(),o.push({value:n,type:s[0].replace(V," ")}),a=a.slice(n.length)),i.filter)!(s=J[r].exec(a))||l[r]&&!(s=l[r](s))||(n=s.shift(),o.push({value:n,type:r,matches:s}),a=a.slice(n.length));if(!n)break}return t?a.length:a?ae.error(e):x(e,c).slice(0)},a=ae.compile=function(e,t){var n,s=[],o=[],a=k[e+" "];if(!a){for(t||(t=r(e)),n=t.length;n--;)(a=Ee(t[n]))[_]?s.push(a):o.push(a);a=k(e,function(e,t){var n=t.length>0,s=e.length>0,o=function(o,r,a,c,d){var u,m,g,f=0,v="0",b=o&&[],_=[],y=l,S=o||s&&i.find.TAG("*",d),E=C+=null==y?1:Math.random()||.1,x=S.length;for(d&&(l=r==p||r||d);v!==x&&null!=(u=S[v]);v++){if(s&&u){for(m=0,r||u.ownerDocument==p||(h(u),a=!w);g=e[m++];)if(g(u,r||p,a)){c.push(u);break}d&&(C=E)}n&&((u=!g&&u)&&f--,o&&b.push(u))}if(f+=v,n&&v!==f){for(m=0;g=t[m++];)g(b,_,r,a);if(o){if(f>0)for(;v--;)b[v]||_[v]||(_[v]=A.call(c));_=Ce(_)}L.apply(c,_),d&&!o&&_.length>0&&f+t.length>1&&ae.uniqueSort(c)}return d&&(C=E,l=y),b};return n?le(o):o}(o,s)),a.selector=e}return a},c=ae.select=function(e,t,n,s){var o,c,l,d,u,h="function"==typeof e&&e,p=!s&&r(e=h.selector||e);if(n=n||[],1===p.length){if((c=p[0]=p[0].slice(0)).length>2&&"ID"===(l=c[0]).type&&9===t.nodeType&&w&&i.relative[c[1].type]){if(!(t=(i.find.ID(l.matches[0].replace(te,ne),t)||[])[0]))return n;h&&(t=t.parentNode),e=e.slice(c.shift().value.length)}for(o=J.needsContext.test(e)?0:c.length;o--&&(l=c[o],!i.relative[d=l.type]);)if((u=i.find[d])&&(s=u(l.matches[0].replace(te,ne),ee.test(c[0].type)&&fe(t.parentNode)||t))){if(c.splice(o,1),!(e=s.length&&be(c)))return L.apply(n,s),n;break}}return(h||a(e,p))(s,t,!w,n,!t||ee.test(e)&&fe(t.parentNode)||t),n},n.sortStable=_.split("").sort(T).join("")===_,n.detectDuplicates=!!u,h(),n.sortDetached=de((function(e){return 1&e.compareDocumentPosition(p.createElement("fieldset"))})),de((function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")}))||ue("type|href|height|width",(function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)})),n.attributes&&de((function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")}))||ue("value",(function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue})),de((function(e){return null==e.getAttribute("disabled")}))||ue(N,(function(e,t,n){var i;if(!n)return!0===e[t]?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null})),ae}(i);E.find=k,E.expr=k.selectors,E.expr[":"]=E.expr.pseudos,E.uniqueSort=E.unique=k.uniqueSort,E.text=k.getText,E.isXMLDoc=k.isXML,E.contains=k.contains,E.escapeSelector=k.escape;var M=function(e,t,n){for(var i=[],s=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(s&&E(e).is(n))break;i.push(e)}return i},T=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},I=E.expr.match.needsContext;function R(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var A=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function $(e,t,n){return f(t)?E.grep(e,(function(e,i){return!!t.call(e,i,e)!==n})):t.nodeType?E.grep(e,(function(e){return e===t!==n})):"string"!=typeof t?E.grep(e,(function(e){return d.call(t,e)>-1!==n})):E.filter(t,e,n)}E.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?E.find.matchesSelector(i,e)?[i]:[]:E.find.matches(e,E.grep(t,(function(e){return 1===e.nodeType})))},E.fn.extend({find:function(e){var t,n,i=this.length,s=this;if("string"!=typeof e)return this.pushStack(E(e).filter((function(){for(t=0;t<i;t++)if(E.contains(s[t],this))return!0})));for(n=this.pushStack([]),t=0;t<i;t++)E.find(e,s[t],n);return i>1?E.uniqueSort(n):n},filter:function(e){return this.pushStack($(this,e||[],!1))},not:function(e){return this.pushStack($(this,e||[],!0))},is:function(e){return!!$(this,"string"==typeof e&&I.test(e)?E(e):e||[],!1).length}});var L,P=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(E.fn.init=function(e,t,n){var i,s;if(!e)return this;if(n=n||L,"string"==typeof e){if(!(i="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:P.exec(e))||!i[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof E?t[0]:t,E.merge(this,E.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:b,!0)),A.test(i[1])&&E.isPlainObject(t))for(i in t)f(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}return(s=b.getElementById(i[2]))&&(this[0]=s,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):f(e)?void 0!==n.ready?n.ready(e):e(E):E.makeArray(e,this)}).prototype=E.fn,L=E(b);var D=/^(?:parents|prev(?:Until|All))/,N={children:!0,contents:!0,next:!0,prev:!0};function O(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}E.fn.extend({has:function(e){var t=E(e,this),n=t.length;return this.filter((function(){for(var e=0;e<n;e++)if(E.contains(this,t[e]))return!0}))},closest:function(e,t){var n,i=0,s=this.length,o=[],r="string"!=typeof e&&E(e);if(!I.test(e))for(;i<s;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(r?r.index(n)>-1:1===n.nodeType&&E.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?E.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?d.call(E(e),this[0]):d.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(E.uniqueSort(E.merge(this.get(),E(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),E.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return M(e,"parentNode")},parentsUntil:function(e,t,n){return M(e,"parentNode",n)},next:function(e){return O(e,"nextSibling")},prev:function(e){return O(e,"previousSibling")},nextAll:function(e){return M(e,"nextSibling")},prevAll:function(e){return M(e,"previousSibling")},nextUntil:function(e,t,n){return M(e,"nextSibling",n)},prevUntil:function(e,t,n){return M(e,"previousSibling",n)},siblings:function(e){return T((e.parentNode||{}).firstChild,e)},children:function(e){return T(e.firstChild)},contents:function(e){return null!=e.contentDocument&&r(e.contentDocument)?e.contentDocument:(R(e,"template")&&(e=e.content||e),E.merge([],e.childNodes))}},(function(e,t){E.fn[e]=function(n,i){var s=E.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(s=E.filter(i,s)),this.length>1&&(N[e]||E.uniqueSort(s),D.test(e)&&s.reverse()),this.pushStack(s)}}));var B=/[^\x20\t\r\n\f]+/g;function F(e){return e}function U(e){throw e}function j(e,t,n,i){var s;try{e&&f(s=e.promise)?s.call(e).done(t).fail(n):e&&f(s=e.then)?s.call(e,t,n):t.apply(void 0,[e].slice(i))}catch(e){n.apply(void 0,[e])}}E.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return E.each(e.match(B)||[],(function(e,n){t[n]=!0})),t}(e):E.extend({},e);var t,n,i,s,o=[],r=[],a=-1,c=function(){for(s=s||e.once,i=t=!0;r.length;a=-1)for(n=r.shift();++a<o.length;)!1===o[a].apply(n[0],n[1])&&e.stopOnFalse&&(a=o.length,n=!1);e.memory||(n=!1),t=!1,s&&(o=n?[]:"")},l={add:function(){return o&&(n&&!t&&(a=o.length-1,r.push(n)),function t(n){E.each(n,(function(n,i){f(i)?e.unique&&l.has(i)||o.push(i):i&&i.length&&"string"!==C(i)&&t(i)}))}(arguments),n&&!t&&c()),this},remove:function(){return E.each(arguments,(function(e,t){for(var n;(n=E.inArray(t,o,n))>-1;)o.splice(n,1),n<=a&&a--})),this},has:function(e){return e?E.inArray(e,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return s=r=[],o=n="",this},disabled:function(){return!o},lock:function(){return s=r=[],n||t||(o=n=""),this},locked:function(){return!!s},fireWith:function(e,n){return s||(n=[e,(n=n||[]).slice?n.slice():n],r.push(n),t||c()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!i}};return l},E.extend({Deferred:function(e){var t=[["notify","progress",E.Callbacks("memory"),E.Callbacks("memory"),2],["resolve","done",E.Callbacks("once memory"),E.Callbacks("once memory"),0,"resolved"],["reject","fail",E.Callbacks("once memory"),E.Callbacks("once memory"),1,"rejected"]],n="pending",s={state:function(){return n},always:function(){return o.done(arguments).fail(arguments),this},catch:function(e){return s.then(null,e)},pipe:function(){var e=arguments;return E.Deferred((function(n){E.each(t,(function(t,i){var s=f(e[i[4]])&&e[i[4]];o[i[1]]((function(){var e=s&&s.apply(this,arguments);e&&f(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[i[0]+"With"](this,s?[e]:arguments)}))})),e=null})).promise()},then:function(e,n,s){var o=0;function r(e,t,n,s){return function(){var a=this,c=arguments,l=function(){var i,l;if(!(e<o)){if((i=n.apply(a,c))===t.promise())throw new TypeError("Thenable self-resolution");l=i&&("object"==typeof i||"function"==typeof i)&&i.then,f(l)?s?l.call(i,r(o,t,F,s),r(o,t,U,s)):(o++,l.call(i,r(o,t,F,s),r(o,t,U,s),r(o,t,F,t.notifyWith))):(n!==F&&(a=void 0,c=[i]),(s||t.resolveWith)(a,c))}},d=s?l:function(){try{l()}catch(i){E.Deferred.exceptionHook&&E.Deferred.exceptionHook(i,d.stackTrace),e+1>=o&&(n!==U&&(a=void 0,c=[i]),t.rejectWith(a,c))}};e?d():(E.Deferred.getStackHook&&(d.stackTrace=E.Deferred.getStackHook()),i.setTimeout(d))}}return E.Deferred((function(i){t[0][3].add(r(0,i,f(s)?s:F,i.notifyWith)),t[1][3].add(r(0,i,f(e)?e:F)),t[2][3].add(r(0,i,f(n)?n:U))})).promise()},promise:function(e){return null!=e?E.extend(e,s):s}},o={};return E.each(t,(function(e,i){var r=i[2],a=i[5];s[i[1]]=r.add,a&&r.add((function(){n=a}),t[3-e][2].disable,t[3-e][3].disable,t[0][2].lock,t[0][3].lock),r.add(i[3].fire),o[i[0]]=function(){return o[i[0]+"With"](this===o?void 0:this,arguments),this},o[i[0]+"With"]=r.fireWith})),s.promise(o),e&&e.call(o,o),o},when:function(e){var t=arguments.length,n=t,i=Array(n),s=a.call(arguments),o=E.Deferred(),r=function(e){return function(n){i[e]=this,s[e]=arguments.length>1?a.call(arguments):n,--t||o.resolveWith(i,s)}};if(t<=1&&(j(e,o.done(r(n)).resolve,o.reject,!t),"pending"===o.state()||f(s[n]&&s[n].then)))return o.then();for(;n--;)j(s[n],r(n),o.reject);return o.promise()}});var V=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;E.Deferred.exceptionHook=function(e,t){i.console&&i.console.warn&&e&&V.test(e.name)&&i.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},E.readyException=function(e){i.setTimeout((function(){throw e}))};var G=E.Deferred();function q(){b.removeEventListener("DOMContentLoaded",q),i.removeEventListener("load",q),E.ready()}E.fn.ready=function(e){return G.then(e).catch((function(e){E.readyException(e)})),this},E.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--E.readyWait:E.isReady)||(E.isReady=!0,!0!==e&&--E.readyWait>0||G.resolveWith(b,[E]))}}),E.ready.then=G.then,"complete"===b.readyState||"loading"!==b.readyState&&!b.documentElement.doScroll?i.setTimeout(E.ready):(b.addEventListener("DOMContentLoaded",q),i.addEventListener("load",q));var H=function(e,t,n,i,s,o,r){var a=0,c=e.length,l=null==n;if("object"===C(n))for(a in s=!0,n)H(e,t,a,n[a],!0,o,r);else if(void 0!==i&&(s=!0,f(i)||(r=!0),l&&(r?(t.call(e,i),t=null):(l=t,t=function(e,t,n){return l.call(E(e),n)})),t))for(;a<c;a++)t(e[a],n,r?i:i.call(e[a],a,t(e[a],n)));return s?e:l?t.call(e):c?t(e[0],n):o},z=/^-ms-/,W=/-([a-z])/g;function J(e,t){return t.toUpperCase()}function Y(e){return e.replace(z,"ms-").replace(W,J)}var K=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function X(){this.expando=E.expando+X.uid++}X.uid=1,X.prototype={cache:function(e){var t=e[this.expando];return t||(t={},K(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var i,s=this.cache(e);if("string"==typeof t)s[Y(t)]=n;else for(i in t)s[Y(i)]=t[i];return s},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][Y(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,i=e[this.expando];if(void 0!==i){if(void 0!==t){n=(t=Array.isArray(t)?t.map(Y):(t=Y(t))in i?[t]:t.match(B)||[]).length;for(;n--;)delete i[t[n]]}(void 0===t||E.isEmptyObject(i))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!E.isEmptyObject(t)}};var Z=new X,Q=new X,ee=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,te=/[A-Z]/g;function ne(e,t,n){var i;if(void 0===n&&1===e.nodeType)if(i="data-"+t.replace(te,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(i))){try{n=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:ee.test(e)?JSON.parse(e):e)}(n)}catch(e){}Q.set(e,t,n)}else n=void 0;return n}E.extend({hasData:function(e){return Q.hasData(e)||Z.hasData(e)},data:function(e,t,n){return Q.access(e,t,n)},removeData:function(e,t){Q.remove(e,t)},_data:function(e,t,n){return Z.access(e,t,n)},_removeData:function(e,t){Z.remove(e,t)}}),E.fn.extend({data:function(e,t){var n,i,s,o=this[0],r=o&&o.attributes;if(void 0===e){if(this.length&&(s=Q.get(o),1===o.nodeType&&!Z.get(o,"hasDataAttrs"))){for(n=r.length;n--;)r[n]&&0===(i=r[n].name).indexOf("data-")&&(i=Y(i.slice(5)),ne(o,i,s[i]));Z.set(o,"hasDataAttrs",!0)}return s}return"object"==typeof e?this.each((function(){Q.set(this,e)})):H(this,(function(t){var n;if(o&&void 0===t)return void 0!==(n=Q.get(o,e))||void 0!==(n=ne(o,e))?n:void 0;this.each((function(){Q.set(this,e,t)}))}),null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each((function(){Q.remove(this,e)}))}}),E.extend({queue:function(e,t,n){var i;if(e)return t=(t||"fx")+"queue",i=Z.get(e,t),n&&(!i||Array.isArray(n)?i=Z.access(e,t,E.makeArray(n)):i.push(n)),i||[]},dequeue:function(e,t){t=t||"fx";var n=E.queue(e,t),i=n.length,s=n.shift(),o=E._queueHooks(e,t);"inprogress"===s&&(s=n.shift(),i--),s&&("fx"===t&&n.unshift("inprogress"),delete o.stop,s.call(e,(function(){E.dequeue(e,t)}),o)),!i&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Z.get(e,n)||Z.access(e,n,{empty:E.Callbacks("once memory").add((function(){Z.remove(e,[t+"queue",n])}))})}}),E.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?E.queue(this[0],e):void 0===t?this:this.each((function(){var n=E.queue(this,e,t);E._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&E.dequeue(this,e)}))},dequeue:function(e){return this.each((function(){E.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,i=1,s=E.Deferred(),o=this,r=this.length,a=function(){--i||s.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";r--;)(n=Z.get(o[r],e+"queueHooks"))&&n.empty&&(i++,n.empty.add(a));return a(),s.promise(t)}});var ie=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,se=new RegExp("^(?:([+-])=|)("+ie+")([a-z%]*)$","i"),oe=["Top","Right","Bottom","Left"],re=b.documentElement,ae=function(e){return E.contains(e.ownerDocument,e)},ce={composed:!0};re.getRootNode&&(ae=function(e){return E.contains(e.ownerDocument,e)||e.getRootNode(ce)===e.ownerDocument});var le=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&ae(e)&&"none"===E.css(e,"display")};function de(e,t,n,i){var s,o,r=20,a=i?function(){return i.cur()}:function(){return E.css(e,t,"")},c=a(),l=n&&n[3]||(E.cssNumber[t]?"":"px"),d=e.nodeType&&(E.cssNumber[t]||"px"!==l&&+c)&&se.exec(E.css(e,t));if(d&&d[3]!==l){for(c/=2,l=l||d[3],d=+c||1;r--;)E.style(e,t,d+l),(1-o)*(1-(o=a()/c||.5))<=0&&(r=0),d/=o;d*=2,E.style(e,t,d+l),n=n||[]}return n&&(d=+d||+c||0,s=n[1]?d+(n[1]+1)*n[2]:+n[2],i&&(i.unit=l,i.start=d,i.end=s)),s}var ue={};function he(e){var t,n=e.ownerDocument,i=e.nodeName,s=ue[i];return s||(t=n.body.appendChild(n.createElement(i)),s=E.css(t,"display"),t.parentNode.removeChild(t),"none"===s&&(s="block"),ue[i]=s,s)}function pe(e,t){for(var n,i,s=[],o=0,r=e.length;o<r;o++)(i=e[o]).style&&(n=i.style.display,t?("none"===n&&(s[o]=Z.get(i,"display")||null,s[o]||(i.style.display="")),""===i.style.display&&le(i)&&(s[o]=he(i))):"none"!==n&&(s[o]="none",Z.set(i,"display",n)));for(o=0;o<r;o++)null!=s[o]&&(e[o].style.display=s[o]);return e}E.fn.extend({show:function(){return pe(this,!0)},hide:function(){return pe(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){le(this)?E(this).show():E(this).hide()}))}});var me,we,ge=/^(?:checkbox|radio)$/i,fe=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,ve=/^$|^module$|\/(?:java|ecma)script/i;me=b.createDocumentFragment().appendChild(b.createElement("div")),(we=b.createElement("input")).setAttribute("type","radio"),we.setAttribute("checked","checked"),we.setAttribute("name","t"),me.appendChild(we),g.checkClone=me.cloneNode(!0).cloneNode(!0).lastChild.checked,me.innerHTML="<textarea>x</textarea>",g.noCloneChecked=!!me.cloneNode(!0).lastChild.defaultValue,me.innerHTML="<option></option>",g.option=!!me.lastChild;var be={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function _e(e,t){var n;return n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&R(e,t)?E.merge([e],n):n}function ye(e,t){for(var n=0,i=e.length;n<i;n++)Z.set(e[n],"globalEval",!t||Z.get(t[n],"globalEval"))}be.tbody=be.tfoot=be.colgroup=be.caption=be.thead,be.th=be.td,g.option||(be.optgroup=be.option=[1,"<select multiple='multiple'>","</select>"]);var Ce=/<|&#?\w+;/;function Se(e,t,n,i,s){for(var o,r,a,c,l,d,u=t.createDocumentFragment(),h=[],p=0,m=e.length;p<m;p++)if((o=e[p])||0===o)if("object"===C(o))E.merge(h,o.nodeType?[o]:o);else if(Ce.test(o)){for(r=r||u.appendChild(t.createElement("div")),a=(fe.exec(o)||["",""])[1].toLowerCase(),c=be[a]||be._default,r.innerHTML=c[1]+E.htmlPrefilter(o)+c[2],d=c[0];d--;)r=r.lastChild;E.merge(h,r.childNodes),(r=u.firstChild).textContent=""}else h.push(t.createTextNode(o));for(u.textContent="",p=0;o=h[p++];)if(i&&E.inArray(o,i)>-1)s&&s.push(o);else if(l=ae(o),r=_e(u.appendChild(o),"script"),l&&ye(r),n)for(d=0;o=r[d++];)ve.test(o.type||"")&&n.push(o);return u}var Ee=/^key/,xe=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,ke=/^([^.]*)(?:\.(.+)|)/;function Me(){return!0}function Te(){return!1}function Ie(e,t){return e===function(){try{return b.activeElement}catch(e){}}()==("focus"===t)}function Re(e,t,n,i,s,o){var r,a;if("object"==typeof t){for(a in"string"!=typeof n&&(i=i||n,n=void 0),t)Re(e,a,n,i,t[a],o);return e}if(null==i&&null==s?(s=n,i=n=void 0):null==s&&("string"==typeof n?(s=i,i=void 0):(s=i,i=n,n=void 0)),!1===s)s=Te;else if(!s)return e;return 1===o&&(r=s,s=function(e){return E().off(e),r.apply(this,arguments)},s.guid=r.guid||(r.guid=E.guid++)),e.each((function(){E.event.add(this,t,s,i,n)}))}function Ae(e,t,n){n?(Z.set(e,t,!1),E.event.add(e,t,{namespace:!1,handler:function(e){var i,s,o=Z.get(this,t);if(1&e.isTrigger&&this[t]){if(o.length)(E.event.special[t]||{}).delegateType&&e.stopPropagation();else if(o=a.call(arguments),Z.set(this,t,o),i=n(this,t),this[t](),o!==(s=Z.get(this,t))||i?Z.set(this,t,!1):s={},o!==s)return e.stopImmediatePropagation(),e.preventDefault(),s.value}else o.length&&(Z.set(this,t,{value:E.event.trigger(E.extend(o[0],E.Event.prototype),o.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===Z.get(e,t)&&E.event.add(e,t,Me)}E.event={global:{},add:function(e,t,n,i,s){var o,r,a,c,l,d,u,h,p,m,w,g=Z.get(e);if(K(e))for(n.handler&&(n=(o=n).handler,s=o.selector),s&&E.find.matchesSelector(re,s),n.guid||(n.guid=E.guid++),(c=g.events)||(c=g.events=Object.create(null)),(r=g.handle)||(r=g.handle=function(t){return void 0!==E&&E.event.triggered!==t.type?E.event.dispatch.apply(e,arguments):void 0}),l=(t=(t||"").match(B)||[""]).length;l--;)p=w=(a=ke.exec(t[l])||[])[1],m=(a[2]||"").split(".").sort(),p&&(u=E.event.special[p]||{},p=(s?u.delegateType:u.bindType)||p,u=E.event.special[p]||{},d=E.extend({type:p,origType:w,data:i,handler:n,guid:n.guid,selector:s,needsContext:s&&E.expr.match.needsContext.test(s),namespace:m.join(".")},o),(h=c[p])||((h=c[p]=[]).delegateCount=0,u.setup&&!1!==u.setup.call(e,i,m,r)||e.addEventListener&&e.addEventListener(p,r)),u.add&&(u.add.call(e,d),d.handler.guid||(d.handler.guid=n.guid)),s?h.splice(h.delegateCount++,0,d):h.push(d),E.event.global[p]=!0)},remove:function(e,t,n,i,s){var o,r,a,c,l,d,u,h,p,m,w,g=Z.hasData(e)&&Z.get(e);if(g&&(c=g.events)){for(l=(t=(t||"").match(B)||[""]).length;l--;)if(p=w=(a=ke.exec(t[l])||[])[1],m=(a[2]||"").split(".").sort(),p){for(u=E.event.special[p]||{},h=c[p=(i?u.delegateType:u.bindType)||p]||[],a=a[2]&&new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"),r=o=h.length;o--;)d=h[o],!s&&w!==d.origType||n&&n.guid!==d.guid||a&&!a.test(d.namespace)||i&&i!==d.selector&&("**"!==i||!d.selector)||(h.splice(o,1),d.selector&&h.delegateCount--,u.remove&&u.remove.call(e,d));r&&!h.length&&(u.teardown&&!1!==u.teardown.call(e,m,g.handle)||E.removeEvent(e,p,g.handle),delete c[p])}else for(p in c)E.event.remove(e,p+t[l],n,i,!0);E.isEmptyObject(c)&&Z.remove(e,"handle events")}},dispatch:function(e){var t,n,i,s,o,r,a=new Array(arguments.length),c=E.event.fix(e),l=(Z.get(this,"events")||Object.create(null))[c.type]||[],d=E.event.special[c.type]||{};for(a[0]=c,t=1;t<arguments.length;t++)a[t]=arguments[t];if(c.delegateTarget=this,!d.preDispatch||!1!==d.preDispatch.call(this,c)){for(r=E.event.handlers.call(this,c,l),t=0;(s=r[t++])&&!c.isPropagationStopped();)for(c.currentTarget=s.elem,n=0;(o=s.handlers[n++])&&!c.isImmediatePropagationStopped();)c.rnamespace&&!1!==o.namespace&&!c.rnamespace.test(o.namespace)||(c.handleObj=o,c.data=o.data,void 0!==(i=((E.event.special[o.origType]||{}).handle||o.handler).apply(s.elem,a))&&!1===(c.result=i)&&(c.preventDefault(),c.stopPropagation()));return d.postDispatch&&d.postDispatch.call(this,c),c.result}},handlers:function(e,t){var n,i,s,o,r,a=[],c=t.delegateCount,l=e.target;if(c&&l.nodeType&&!("click"===e.type&&e.button>=1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],r={},n=0;n<c;n++)void 0===r[s=(i=t[n]).selector+" "]&&(r[s]=i.needsContext?E(s,this).index(l)>-1:E.find(s,this,null,[l]).length),r[s]&&o.push(i);o.length&&a.push({elem:l,handlers:o})}return l=this,c<t.length&&a.push({elem:l,handlers:t.slice(c)}),a},addProp:function(e,t){Object.defineProperty(E.Event.prototype,e,{enumerable:!0,configurable:!0,get:f(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[E.expando]?e:new E.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return ge.test(t.type)&&t.click&&R(t,"input")&&Ae(t,"click",Me),!1},trigger:function(e){var t=this||e;return ge.test(t.type)&&t.click&&R(t,"input")&&Ae(t,"click"),!0},_default:function(e){var t=e.target;return ge.test(t.type)&&t.click&&R(t,"input")&&Z.get(t,"click")||R(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},E.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},E.Event=function(e,t){if(!(this instanceof E.Event))return new E.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Me:Te,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&E.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[E.expando]=!0},E.Event.prototype={constructor:E.Event,isDefaultPrevented:Te,isPropagationStopped:Te,isImmediatePropagationStopped:Te,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Me,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Me,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Me,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},E.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&Ee.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&xe.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},E.event.addProp),E.each({focus:"focusin",blur:"focusout"},(function(e,t){E.event.special[e]={setup:function(){return Ae(this,e,Ie),!1},trigger:function(){return Ae(this,e),!0},delegateType:t}})),E.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(e,t){E.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=e.relatedTarget,s=e.handleObj;return i&&(i===this||E.contains(this,i))||(e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t),n}}})),E.fn.extend({on:function(e,t,n,i){return Re(this,e,t,n,i)},one:function(e,t,n,i){return Re(this,e,t,n,i,1)},off:function(e,t,n){var i,s;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,E(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(s in e)this.off(s,t,e[s]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Te),this.each((function(){E.event.remove(this,e,n,t)}))}});var $e=/<script|<style|<link/i,Le=/checked\s*(?:[^=]|=\s*.checked.)/i,Pe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function De(e,t){return R(e,"table")&&R(11!==t.nodeType?t:t.firstChild,"tr")&&E(e).children("tbody")[0]||e}function Ne(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Oe(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Be(e,t){var n,i,s,o,r,a;if(1===t.nodeType){if(Z.hasData(e)&&(a=Z.get(e).events))for(s in Z.remove(t,"handle events"),a)for(n=0,i=a[s].length;n<i;n++)E.event.add(t,s,a[s][n]);Q.hasData(e)&&(o=Q.access(e),r=E.extend({},o),Q.set(t,r))}}function Fe(e,t){var n=t.nodeName.toLowerCase();"input"===n&&ge.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function Ue(e,t,n,i){t=c(t);var s,o,r,a,l,d,u=0,h=e.length,p=h-1,m=t[0],w=f(m);if(w||h>1&&"string"==typeof m&&!g.checkClone&&Le.test(m))return e.each((function(s){var o=e.eq(s);w&&(t[0]=m.call(this,s,o.html())),Ue(o,t,n,i)}));if(h&&(o=(s=Se(t,e[0].ownerDocument,!1,e,i)).firstChild,1===s.childNodes.length&&(s=o),o||i)){for(a=(r=E.map(_e(s,"script"),Ne)).length;u<h;u++)l=s,u!==p&&(l=E.clone(l,!0,!0),a&&E.merge(r,_e(l,"script"))),n.call(e[u],l,u);if(a)for(d=r[r.length-1].ownerDocument,E.map(r,Oe),u=0;u<a;u++)l=r[u],ve.test(l.type||"")&&!Z.access(l,"globalEval")&&E.contains(d,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?E._evalUrl&&!l.noModule&&E._evalUrl(l.src,{nonce:l.nonce||l.getAttribute("nonce")},d):y(l.textContent.replace(Pe,""),l,d))}return e}function je(e,t,n){for(var i,s=t?E.filter(t,e):e,o=0;null!=(i=s[o]);o++)n||1!==i.nodeType||E.cleanData(_e(i)),i.parentNode&&(n&&ae(i)&&ye(_e(i,"script")),i.parentNode.removeChild(i));return e}E.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var i,s,o,r,a=e.cloneNode(!0),c=ae(e);if(!(g.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||E.isXMLDoc(e)))for(r=_e(a),i=0,s=(o=_e(e)).length;i<s;i++)Fe(o[i],r[i]);if(t)if(n)for(o=o||_e(e),r=r||_e(a),i=0,s=o.length;i<s;i++)Be(o[i],r[i]);else Be(e,a);return(r=_e(a,"script")).length>0&&ye(r,!c&&_e(e,"script")),a},cleanData:function(e){for(var t,n,i,s=E.event.special,o=0;void 0!==(n=e[o]);o++)if(K(n)){if(t=n[Z.expando]){if(t.events)for(i in t.events)s[i]?E.event.remove(n,i):E.removeEvent(n,i,t.handle);n[Z.expando]=void 0}n[Q.expando]&&(n[Q.expando]=void 0)}}}),E.fn.extend({detach:function(e){return je(this,e,!0)},remove:function(e){return je(this,e)},text:function(e){return H(this,(function(e){return void 0===e?E.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),null,e,arguments.length)},append:function(){return Ue(this,arguments,(function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||De(this,e).appendChild(e)}))},prepend:function(){return Ue(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=De(this,e);t.insertBefore(e,t.firstChild)}}))},before:function(){return Ue(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after:function(){return Ue(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(E.cleanData(_e(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map((function(){return E.clone(this,e,t)}))},html:function(e){return H(this,(function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!$e.test(e)&&!be[(fe.exec(e)||["",""])[1].toLowerCase()]){e=E.htmlPrefilter(e);try{for(;n<i;n++)1===(t=this[n]||{}).nodeType&&(E.cleanData(_e(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)}),null,e,arguments.length)},replaceWith:function(){var e=[];return Ue(this,arguments,(function(t){var n=this.parentNode;E.inArray(this,e)<0&&(E.cleanData(_e(this)),n&&n.replaceChild(t,this))}),e)}}),E.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(e,t){E.fn[e]=function(e){for(var n,i=[],s=E(e),o=s.length-1,r=0;r<=o;r++)n=r===o?this:this.clone(!0),E(s[r])[t](n),l.apply(i,n.get());return this.pushStack(i)}}));var Ve=new RegExp("^("+ie+")(?!px)[a-z%]+$","i"),Ge=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=i),t.getComputedStyle(e)},qe=function(e,t,n){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];for(s in i=n.call(e),t)e.style[s]=o[s];return i},He=new RegExp(oe.join("|"),"i");function ze(e,t,n){var i,s,o,r,a=e.style;return(n=n||Ge(e))&&(""!==(r=n.getPropertyValue(t)||n[t])||ae(e)||(r=E.style(e,t)),!g.pixelBoxStyles()&&Ve.test(r)&&He.test(t)&&(i=a.width,s=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=r,r=n.width,a.width=i,a.minWidth=s,a.maxWidth=o)),void 0!==r?r+"":r}function We(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(d){l.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",d.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",re.appendChild(l).appendChild(d);var e=i.getComputedStyle(d);n="1%"!==e.top,c=12===t(e.marginLeft),d.style.right="60%",r=36===t(e.right),s=36===t(e.width),d.style.position="absolute",o=12===t(d.offsetWidth/3),re.removeChild(l),d=null}}function t(e){return Math.round(parseFloat(e))}var n,s,o,r,a,c,l=b.createElement("div"),d=b.createElement("div");d.style&&(d.style.backgroundClip="content-box",d.cloneNode(!0).style.backgroundClip="",g.clearCloneStyle="content-box"===d.style.backgroundClip,E.extend(g,{boxSizingReliable:function(){return e(),s},pixelBoxStyles:function(){return e(),r},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),c},scrollboxSize:function(){return e(),o},reliableTrDimensions:function(){var e,t,n,s;return null==a&&(e=b.createElement("table"),t=b.createElement("tr"),n=b.createElement("div"),e.style.cssText="position:absolute;left:-11111px",t.style.height="1px",n.style.height="9px",re.appendChild(e).appendChild(t).appendChild(n),s=i.getComputedStyle(t),a=parseInt(s.height)>3,re.removeChild(e)),a}}))}();var Je=["Webkit","Moz","ms"],Ye=b.createElement("div").style,Ke={};function Xe(e){return E.cssProps[e]||Ke[e]||(e in Ye?e:Ke[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),n=Je.length;n--;)if((e=Je[n]+t)in Ye)return e}(e)||e)}var Ze=/^(none|table(?!-c[ea]).+)/,Qe=/^--/,et={position:"absolute",visibility:"hidden",display:"block"},tt={letterSpacing:"0",fontWeight:"400"};function nt(e,t,n){var i=se.exec(t);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):t}function it(e,t,n,i,s,o){var r="width"===t?1:0,a=0,c=0;if(n===(i?"border":"content"))return 0;for(;r<4;r+=2)"margin"===n&&(c+=E.css(e,n+oe[r],!0,s)),i?("content"===n&&(c-=E.css(e,"padding"+oe[r],!0,s)),"margin"!==n&&(c-=E.css(e,"border"+oe[r]+"Width",!0,s))):(c+=E.css(e,"padding"+oe[r],!0,s),"padding"!==n?c+=E.css(e,"border"+oe[r]+"Width",!0,s):a+=E.css(e,"border"+oe[r]+"Width",!0,s));return!i&&o>=0&&(c+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-c-a-.5))||0),c}function st(e,t,n){var i=Ge(e),s=(!g.boxSizingReliable()||n)&&"border-box"===E.css(e,"boxSizing",!1,i),o=s,r=ze(e,t,i),a="offset"+t[0].toUpperCase()+t.slice(1);if(Ve.test(r)){if(!n)return r;r="auto"}return(!g.boxSizingReliable()&&s||!g.reliableTrDimensions()&&R(e,"tr")||"auto"===r||!parseFloat(r)&&"inline"===E.css(e,"display",!1,i))&&e.getClientRects().length&&(s="border-box"===E.css(e,"boxSizing",!1,i),(o=a in e)&&(r=e[a])),(r=parseFloat(r)||0)+it(e,t,n||(s?"border":"content"),o,i,r)+"px"}function ot(e,t,n,i,s){return new ot.prototype.init(e,t,n,i,s)}E.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=ze(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var s,o,r,a=Y(t),c=Qe.test(t),l=e.style;if(c||(t=Xe(a)),r=E.cssHooks[t]||E.cssHooks[a],void 0===n)return r&&"get"in r&&void 0!==(s=r.get(e,!1,i))?s:l[t];"string"==(o=typeof n)&&(s=se.exec(n))&&s[1]&&(n=de(e,t,s),o="number"),null!=n&&n==n&&("number"!==o||c||(n+=s&&s[3]||(E.cssNumber[a]?"":"px")),g.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),r&&"set"in r&&void 0===(n=r.set(e,n,i))||(c?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,i){var s,o,r,a=Y(t);return Qe.test(t)||(t=Xe(a)),(r=E.cssHooks[t]||E.cssHooks[a])&&"get"in r&&(s=r.get(e,!0,n)),void 0===s&&(s=ze(e,t,i)),"normal"===s&&t in tt&&(s=tt[t]),""===n||n?(o=parseFloat(s),!0===n||isFinite(o)?o||0:s):s}}),E.each(["height","width"],(function(e,t){E.cssHooks[t]={get:function(e,n,i){if(n)return!Ze.test(E.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?st(e,t,i):qe(e,et,(function(){return st(e,t,i)}))},set:function(e,n,i){var s,o=Ge(e),r=!g.scrollboxSize()&&"absolute"===o.position,a=(r||i)&&"border-box"===E.css(e,"boxSizing",!1,o),c=i?it(e,t,i,a,o):0;return a&&r&&(c-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(o[t])-it(e,t,"border",!1,o)-.5)),c&&(s=se.exec(n))&&"px"!==(s[3]||"px")&&(e.style[t]=n,n=E.css(e,t)),nt(0,n,c)}}})),E.cssHooks.marginLeft=We(g.reliableMarginLeft,(function(e,t){if(t)return(parseFloat(ze(e,"marginLeft"))||e.getBoundingClientRect().left-qe(e,{marginLeft:0},(function(){return e.getBoundingClientRect().left})))+"px"})),E.each({margin:"",padding:"",border:"Width"},(function(e,t){E.cssHooks[e+t]={expand:function(n){for(var i=0,s={},o="string"==typeof n?n.split(" "):[n];i<4;i++)s[e+oe[i]+t]=o[i]||o[i-2]||o[0];return s}},"margin"!==e&&(E.cssHooks[e+t].set=nt)})),E.fn.extend({css:function(e,t){return H(this,(function(e,t,n){var i,s,o={},r=0;if(Array.isArray(t)){for(i=Ge(e),s=t.length;r<s;r++)o[t[r]]=E.css(e,t[r],!1,i);return o}return void 0!==n?E.style(e,t,n):E.css(e,t)}),e,t,arguments.length>1)}}),E.Tween=ot,ot.prototype={constructor:ot,init:function(e,t,n,i,s,o){this.elem=e,this.prop=n,this.easing=s||E.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=o||(E.cssNumber[n]?"":"px")},cur:function(){var e=ot.propHooks[this.prop];return e&&e.get?e.get(this):ot.propHooks._default.get(this)},run:function(e){var t,n=ot.propHooks[this.prop];return this.options.duration?this.pos=t=E.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):ot.propHooks._default.set(this),this}},ot.prototype.init.prototype=ot.prototype,ot.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=E.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){E.fx.step[e.prop]?E.fx.step[e.prop](e):1!==e.elem.nodeType||!E.cssHooks[e.prop]&&null==e.elem.style[Xe(e.prop)]?e.elem[e.prop]=e.now:E.style(e.elem,e.prop,e.now+e.unit)}}},ot.propHooks.scrollTop=ot.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},E.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},E.fx=ot.prototype.init,E.fx.step={};var rt,at,ct=/^(?:toggle|show|hide)$/,lt=/queueHooks$/;function dt(){at&&(!1===b.hidden&&i.requestAnimationFrame?i.requestAnimationFrame(dt):i.setTimeout(dt,E.fx.interval),E.fx.tick())}function ut(){return i.setTimeout((function(){rt=void 0})),rt=Date.now()}function ht(e,t){var n,i=0,s={height:e};for(t=t?1:0;i<4;i+=2-t)s["margin"+(n=oe[i])]=s["padding"+n]=e;return t&&(s.opacity=s.width=e),s}function pt(e,t,n){for(var i,s=(mt.tweeners[t]||[]).concat(mt.tweeners["*"]),o=0,r=s.length;o<r;o++)if(i=s[o].call(n,t,e))return i}function mt(e,t,n){var i,s,o=0,r=mt.prefilters.length,a=E.Deferred().always((function(){delete c.elem})),c=function(){if(s)return!1;for(var t=rt||ut(),n=Math.max(0,l.startTime+l.duration-t),i=1-(n/l.duration||0),o=0,r=l.tweens.length;o<r;o++)l.tweens[o].run(i);return a.notifyWith(e,[l,i,n]),i<1&&r?n:(r||a.notifyWith(e,[l,1,0]),a.resolveWith(e,[l]),!1)},l=a.promise({elem:e,props:E.extend({},t),opts:E.extend(!0,{specialEasing:{},easing:E.easing._default},n),originalProperties:t,originalOptions:n,startTime:rt||ut(),duration:n.duration,tweens:[],createTween:function(t,n){var i=E.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(i),i},stop:function(t){var n=0,i=t?l.tweens.length:0;if(s)return this;for(s=!0;n<i;n++)l.tweens[n].run(1);return t?(a.notifyWith(e,[l,1,0]),a.resolveWith(e,[l,t])):a.rejectWith(e,[l,t]),this}}),d=l.props;for(function(e,t){var n,i,s,o,r;for(n in e)if(s=t[i=Y(n)],o=e[n],Array.isArray(o)&&(s=o[1],o=e[n]=o[0]),n!==i&&(e[i]=o,delete e[n]),(r=E.cssHooks[i])&&"expand"in r)for(n in o=r.expand(o),delete e[i],o)n in e||(e[n]=o[n],t[n]=s);else t[i]=s}(d,l.opts.specialEasing);o<r;o++)if(i=mt.prefilters[o].call(l,e,d,l.opts))return f(i.stop)&&(E._queueHooks(l.elem,l.opts.queue).stop=i.stop.bind(i)),i;return E.map(d,pt,l),f(l.opts.start)&&l.opts.start.call(e,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),E.fx.timer(E.extend(c,{elem:e,anim:l,queue:l.opts.queue})),l}E.Animation=E.extend(mt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return de(n.elem,e,se.exec(t),n),n}]},tweener:function(e,t){f(e)?(t=e,e=["*"]):e=e.match(B);for(var n,i=0,s=e.length;i<s;i++)n=e[i],mt.tweeners[n]=mt.tweeners[n]||[],mt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var i,s,o,r,a,c,l,d,u="width"in t||"height"in t,h=this,p={},m=e.style,w=e.nodeType&&le(e),g=Z.get(e,"fxshow");for(i in n.queue||(null==(r=E._queueHooks(e,"fx")).unqueued&&(r.unqueued=0,a=r.empty.fire,r.empty.fire=function(){r.unqueued||a()}),r.unqueued++,h.always((function(){h.always((function(){r.unqueued--,E.queue(e,"fx").length||r.empty.fire()}))}))),t)if(s=t[i],ct.test(s)){if(delete t[i],o=o||"toggle"===s,s===(w?"hide":"show")){if("show"!==s||!g||void 0===g[i])continue;w=!0}p[i]=g&&g[i]||E.style(e,i)}if((c=!E.isEmptyObject(t))||!E.isEmptyObject(p))for(i in u&&1===e.nodeType&&(n.overflow=[m.overflow,m.overflowX,m.overflowY],null==(l=g&&g.display)&&(l=Z.get(e,"display")),"none"===(d=E.css(e,"display"))&&(l?d=l:(pe([e],!0),l=e.style.display||l,d=E.css(e,"display"),pe([e]))),("inline"===d||"inline-block"===d&&null!=l)&&"none"===E.css(e,"float")&&(c||(h.done((function(){m.display=l})),null==l&&(d=m.display,l="none"===d?"":d)),m.display="inline-block")),n.overflow&&(m.overflow="hidden",h.always((function(){m.overflow=n.overflow[0],m.overflowX=n.overflow[1],m.overflowY=n.overflow[2]}))),c=!1,p)c||(g?"hidden"in g&&(w=g.hidden):g=Z.access(e,"fxshow",{display:l}),o&&(g.hidden=!w),w&&pe([e],!0),h.done((function(){for(i in w||pe([e]),Z.remove(e,"fxshow"),p)E.style(e,i,p[i])}))),c=pt(w?g[i]:0,i,h),i in g||(g[i]=c.start,w&&(c.end=c.start,c.start=0))}],prefilter:function(e,t){t?mt.prefilters.unshift(e):mt.prefilters.push(e)}}),E.speed=function(e,t,n){var i=e&&"object"==typeof e?E.extend({},e):{complete:n||!n&&t||f(e)&&e,duration:e,easing:n&&t||t&&!f(t)&&t};return E.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration in E.fx.speeds?i.duration=E.fx.speeds[i.duration]:i.duration=E.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){f(i.old)&&i.old.call(this),i.queue&&E.dequeue(this,i.queue)},i},E.fn.extend({fadeTo:function(e,t,n,i){return this.filter(le).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var s=E.isEmptyObject(e),o=E.speed(t,n,i),r=function(){var t=mt(this,E.extend({},e),o);(s||Z.get(this,"finish"))&&t.stop(!0)};return r.finish=r,s||!1===o.queue?this.each(r):this.queue(o.queue,r)},stop:function(e,t,n){var i=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&this.queue(e||"fx",[]),this.each((function(){var t=!0,s=null!=e&&e+"queueHooks",o=E.timers,r=Z.get(this);if(s)r[s]&&r[s].stop&&i(r[s]);else for(s in r)r[s]&&r[s].stop&&lt.test(s)&&i(r[s]);for(s=o.length;s--;)o[s].elem!==this||null!=e&&o[s].queue!==e||(o[s].anim.stop(n),t=!1,o.splice(s,1));!t&&n||E.dequeue(this,e)}))},finish:function(e){return!1!==e&&(e=e||"fx"),this.each((function(){var t,n=Z.get(this),i=n[e+"queue"],s=n[e+"queueHooks"],o=E.timers,r=i?i.length:0;for(n.finish=!0,E.queue(this,e,[]),s&&s.stop&&s.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<r;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish}))}}),E.each(["toggle","show","hide"],(function(e,t){var n=E.fn[t];E.fn[t]=function(e,i,s){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ht(t,!0),e,i,s)}})),E.each({slideDown:ht("show"),slideUp:ht("hide"),slideToggle:ht("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(e,t){E.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}})),E.timers=[],E.fx.tick=function(){var e,t=0,n=E.timers;for(rt=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||E.fx.stop(),rt=void 0},E.fx.timer=function(e){E.timers.push(e),E.fx.start()},E.fx.interval=13,E.fx.start=function(){at||(at=!0,dt())},E.fx.stop=function(){at=null},E.fx.speeds={slow:600,fast:200,_default:400},E.fn.delay=function(e,t){return e=E.fx&&E.fx.speeds[e]||e,t=t||"fx",this.queue(t,(function(t,n){var s=i.setTimeout(t,e);n.stop=function(){i.clearTimeout(s)}}))},function(){var e=b.createElement("input"),t=b.createElement("select").appendChild(b.createElement("option"));e.type="checkbox",g.checkOn=""!==e.value,g.optSelected=t.selected,(e=b.createElement("input")).value="t",e.type="radio",g.radioValue="t"===e.value}();var wt,gt=E.expr.attrHandle;E.fn.extend({attr:function(e,t){return H(this,E.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each((function(){E.removeAttr(this,e)}))}}),E.extend({attr:function(e,t,n){var i,s,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?E.prop(e,t,n):(1===o&&E.isXMLDoc(e)||(s=E.attrHooks[t.toLowerCase()]||(E.expr.match.bool.test(t)?wt:void 0)),void 0!==n?null===n?void E.removeAttr(e,t):s&&"set"in s&&void 0!==(i=s.set(e,n,t))?i:(e.setAttribute(t,n+""),n):s&&"get"in s&&null!==(i=s.get(e,t))?i:null==(i=E.find.attr(e,t))?void 0:i)},attrHooks:{type:{set:function(e,t){if(!g.radioValue&&"radio"===t&&R(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,i=0,s=t&&t.match(B);if(s&&1===e.nodeType)for(;n=s[i++];)e.removeAttribute(n)}}),wt={set:function(e,t,n){return!1===t?E.removeAttr(e,n):e.setAttribute(n,n),n}},E.each(E.expr.match.bool.source.match(/\w+/g),(function(e,t){var n=gt[t]||E.find.attr;gt[t]=function(e,t,i){var s,o,r=t.toLowerCase();return i||(o=gt[r],gt[r]=s,s=null!=n(e,t,i)?r:null,gt[r]=o),s}}));var ft=/^(?:input|select|textarea|button)$/i,vt=/^(?:a|area)$/i;function bt(e){return(e.match(B)||[]).join(" ")}function _t(e){return e.getAttribute&&e.getAttribute("class")||""}function yt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(B)||[]}E.fn.extend({prop:function(e,t){return H(this,E.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each((function(){delete this[E.propFix[e]||e]}))}}),E.extend({prop:function(e,t,n){var i,s,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&E.isXMLDoc(e)||(t=E.propFix[t]||t,s=E.propHooks[t]),void 0!==n?s&&"set"in s&&void 0!==(i=s.set(e,n,t))?i:e[t]=n:s&&"get"in s&&null!==(i=s.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){var t=E.find.attr(e,"tabindex");return t?parseInt(t,10):ft.test(e.nodeName)||vt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),g.optSelected||(E.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),E.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){E.propFix[this.toLowerCase()]=this})),E.fn.extend({addClass:function(e){var t,n,i,s,o,r,a,c=0;if(f(e))return this.each((function(t){E(this).addClass(e.call(this,t,_t(this)))}));if((t=yt(e)).length)for(;n=this[c++];)if(s=_t(n),i=1===n.nodeType&&" "+bt(s)+" "){for(r=0;o=t[r++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");s!==(a=bt(i))&&n.setAttribute("class",a)}return this},removeClass:function(e){var t,n,i,s,o,r,a,c=0;if(f(e))return this.each((function(t){E(this).removeClass(e.call(this,t,_t(this)))}));if(!arguments.length)return this.attr("class","");if((t=yt(e)).length)for(;n=this[c++];)if(s=_t(n),i=1===n.nodeType&&" "+bt(s)+" "){for(r=0;o=t[r++];)for(;i.indexOf(" "+o+" ")>-1;)i=i.replace(" "+o+" "," ");s!==(a=bt(i))&&n.setAttribute("class",a)}return this},toggleClass:function(e,t){var n=typeof e,i="string"===n||Array.isArray(e);return"boolean"==typeof t&&i?t?this.addClass(e):this.removeClass(e):f(e)?this.each((function(n){E(this).toggleClass(e.call(this,n,_t(this),t),t)})):this.each((function(){var t,s,o,r;if(i)for(s=0,o=E(this),r=yt(e);t=r[s++];)o.hasClass(t)?o.removeClass(t):o.addClass(t);else void 0!==e&&"boolean"!==n||((t=_t(this))&&Z.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":Z.get(this,"__className__")||""))}))},hasClass:function(e){var t,n,i=0;for(t=" "+e+" ";n=this[i++];)if(1===n.nodeType&&(" "+bt(_t(n))+" ").indexOf(t)>-1)return!0;return!1}});var Ct=/\r/g;E.fn.extend({val:function(e){var t,n,i,s=this[0];return arguments.length?(i=f(e),this.each((function(n){var s;1===this.nodeType&&(null==(s=i?e.call(this,n,E(this).val()):e)?s="":"number"==typeof s?s+="":Array.isArray(s)&&(s=E.map(s,(function(e){return null==e?"":e+""}))),(t=E.valHooks[this.type]||E.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,s,"value")||(this.value=s))}))):s?(t=E.valHooks[s.type]||E.valHooks[s.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(s,"value"))?n:"string"==typeof(n=s.value)?n.replace(Ct,""):null==n?"":n:void 0}}),E.extend({valHooks:{option:{get:function(e){var t=E.find.attr(e,"value");return null!=t?t:bt(E.text(e))}},select:{get:function(e){var t,n,i,s=e.options,o=e.selectedIndex,r="select-one"===e.type,a=r?null:[],c=r?o+1:s.length;for(i=o<0?c:r?o:0;i<c;i++)if(((n=s[i]).selected||i===o)&&!n.disabled&&(!n.parentNode.disabled||!R(n.parentNode,"optgroup"))){if(t=E(n).val(),r)return t;a.push(t)}return a},set:function(e,t){for(var n,i,s=e.options,o=E.makeArray(t),r=s.length;r--;)((i=s[r]).selected=E.inArray(E.valHooks.option.get(i),o)>-1)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),E.each(["radio","checkbox"],(function(){E.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=E.inArray(E(e).val(),t)>-1}},g.checkOn||(E.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})})),g.focusin="onfocusin"in i;var St=/^(?:focusinfocus|focusoutblur)$/,Et=function(e){e.stopPropagation()};E.extend(E.event,{trigger:function(e,t,n,s){var o,r,a,c,l,d,u,h,m=[n||b],w=p.call(e,"type")?e.type:e,g=p.call(e,"namespace")?e.namespace.split("."):[];if(r=h=a=n=n||b,3!==n.nodeType&&8!==n.nodeType&&!St.test(w+E.event.triggered)&&(w.indexOf(".")>-1&&(g=w.split("."),w=g.shift(),g.sort()),l=w.indexOf(":")<0&&"on"+w,(e=e[E.expando]?e:new E.Event(w,"object"==typeof e&&e)).isTrigger=s?2:3,e.namespace=g.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:E.makeArray(t,[e]),u=E.event.special[w]||{},s||!u.trigger||!1!==u.trigger.apply(n,t))){if(!s&&!u.noBubble&&!v(n)){for(c=u.delegateType||w,St.test(c+w)||(r=r.parentNode);r;r=r.parentNode)m.push(r),a=r;a===(n.ownerDocument||b)&&m.push(a.defaultView||a.parentWindow||i)}for(o=0;(r=m[o++])&&!e.isPropagationStopped();)h=r,e.type=o>1?c:u.bindType||w,(d=(Z.get(r,"events")||Object.create(null))[e.type]&&Z.get(r,"handle"))&&d.apply(r,t),(d=l&&r[l])&&d.apply&&K(r)&&(e.result=d.apply(r,t),!1===e.result&&e.preventDefault());return e.type=w,s||e.isDefaultPrevented()||u._default&&!1!==u._default.apply(m.pop(),t)||!K(n)||l&&f(n[w])&&!v(n)&&((a=n[l])&&(n[l]=null),E.event.triggered=w,e.isPropagationStopped()&&h.addEventListener(w,Et),n[w](),e.isPropagationStopped()&&h.removeEventListener(w,Et),E.event.triggered=void 0,a&&(n[l]=a)),e.result}},simulate:function(e,t,n){var i=E.extend(new E.Event,n,{type:e,isSimulated:!0});E.event.trigger(i,null,t)}}),E.fn.extend({trigger:function(e,t){return this.each((function(){E.event.trigger(e,t,this)}))},triggerHandler:function(e,t){var n=this[0];if(n)return E.event.trigger(e,t,n,!0)}}),g.focusin||E.each({focus:"focusin",blur:"focusout"},(function(e,t){var n=function(e){E.event.simulate(t,e.target,E.event.fix(e))};E.event.special[t]={setup:function(){var i=this.ownerDocument||this.document||this,s=Z.access(i,t);s||i.addEventListener(e,n,!0),Z.access(i,t,(s||0)+1)},teardown:function(){var i=this.ownerDocument||this.document||this,s=Z.access(i,t)-1;s?Z.access(i,t,s):(i.removeEventListener(e,n,!0),Z.remove(i,t))}}}));var xt=i.location,kt={guid:Date.now()},Mt=/\?/;E.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{t=(new i.DOMParser).parseFromString(e,"text/xml")}catch(e){t=void 0}return t&&!t.getElementsByTagName("parsererror").length||E.error("Invalid XML: "+e),t};var Tt=/\[\]$/,It=/\r?\n/g,Rt=/^(?:submit|button|image|reset|file)$/i,At=/^(?:input|select|textarea|keygen)/i;function $t(e,t,n,i){var s;if(Array.isArray(t))E.each(t,(function(t,s){n||Tt.test(e)?i(e,s):$t(e+"["+("object"==typeof s&&null!=s?t:"")+"]",s,n,i)}));else if(n||"object"!==C(t))i(e,t);else for(s in t)$t(e+"["+s+"]",t[s],n,i)}E.param=function(e,t){var n,i=[],s=function(e,t){var n=f(t)?t():t;i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!E.isPlainObject(e))E.each(e,(function(){s(this.name,this.value)}));else for(n in e)$t(n,e[n],t,s);return i.join("&")},E.fn.extend({serialize:function(){return E.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=E.prop(this,"elements");return e?E.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!E(this).is(":disabled")&&At.test(this.nodeName)&&!Rt.test(e)&&(this.checked||!ge.test(e))})).map((function(e,t){var n=E(this).val();return null==n?null:Array.isArray(n)?E.map(n,(function(e){return{name:t.name,value:e.replace(It,"\r\n")}})):{name:t.name,value:n.replace(It,"\r\n")}})).get()}});var Lt=/%20/g,Pt=/#.*$/,Dt=/([?&])_=[^&]*/,Nt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ot=/^(?:GET|HEAD)$/,Bt=/^\/\//,Ft={},Ut={},jt="*/".concat("*"),Vt=b.createElement("a");function Gt(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,s=0,o=t.toLowerCase().match(B)||[];if(f(n))for(;i=o[s++];)"+"===i[0]?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function qt(e,t,n,i){var s={},o=e===Ut;function r(a){var c;return s[a]=!0,E.each(e[a]||[],(function(e,a){var l=a(t,n,i);return"string"!=typeof l||o||s[l]?o?!(c=l):void 0:(t.dataTypes.unshift(l),r(l),!1)})),c}return r(t.dataTypes[0])||!s["*"]&&r("*")}function Ht(e,t){var n,i,s=E.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((s[n]?e:i||(i={}))[n]=t[n]);return i&&E.extend(!0,e,i),e}Vt.href=xt.href,E.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:xt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(xt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":jt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":E.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Ht(Ht(e,E.ajaxSettings),t):Ht(E.ajaxSettings,e)},ajaxPrefilter:Gt(Ft),ajaxTransport:Gt(Ut),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,s,o,r,a,c,l,d,u,h,p=E.ajaxSetup({},t),m=p.context||p,w=p.context&&(m.nodeType||m.jquery)?E(m):E.event,g=E.Deferred(),f=E.Callbacks("once memory"),v=p.statusCode||{},_={},y={},C="canceled",S={readyState:0,getResponseHeader:function(e){var t;if(l){if(!r)for(r={};t=Nt.exec(o);)r[t[1].toLowerCase()+" "]=(r[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=r[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return l?o:null},setRequestHeader:function(e,t){return null==l&&(e=y[e.toLowerCase()]=y[e.toLowerCase()]||e,_[e]=t),this},overrideMimeType:function(e){return null==l&&(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(l)S.always(e[S.status]);else for(t in e)v[t]=[v[t],e[t]];return this},abort:function(e){var t=e||C;return n&&n.abort(t),x(0,t),this}};if(g.promise(S),p.url=((e||p.url||xt.href)+"").replace(Bt,xt.protocol+"//"),p.type=t.method||t.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(B)||[""],null==p.crossDomain){c=b.createElement("a");try{c.href=p.url,c.href=c.href,p.crossDomain=Vt.protocol+"//"+Vt.host!=c.protocol+"//"+c.host}catch(e){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=E.param(p.data,p.traditional)),qt(Ft,p,t,S),l)return S;for(u in(d=E.event&&p.global)&&0==E.active++&&E.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Ot.test(p.type),s=p.url.replace(Pt,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(Lt,"+")):(h=p.url.slice(s.length),p.data&&(p.processData||"string"==typeof p.data)&&(s+=(Mt.test(s)?"&":"?")+p.data,delete p.data),!1===p.cache&&(s=s.replace(Dt,"$1"),h=(Mt.test(s)?"&":"?")+"_="+kt.guid+++h),p.url=s+h),p.ifModified&&(E.lastModified[s]&&S.setRequestHeader("If-Modified-Since",E.lastModified[s]),E.etag[s]&&S.setRequestHeader("If-None-Match",E.etag[s])),(p.data&&p.hasContent&&!1!==p.contentType||t.contentType)&&S.setRequestHeader("Content-Type",p.contentType),S.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+jt+"; q=0.01":""):p.accepts["*"]),p.headers)S.setRequestHeader(u,p.headers[u]);if(p.beforeSend&&(!1===p.beforeSend.call(m,S,p)||l))return S.abort();if(C="abort",f.add(p.complete),S.done(p.success),S.fail(p.error),n=qt(Ut,p,t,S)){if(S.readyState=1,d&&w.trigger("ajaxSend",[S,p]),l)return S;p.async&&p.timeout>0&&(a=i.setTimeout((function(){S.abort("timeout")}),p.timeout));try{l=!1,n.send(_,x)}catch(e){if(l)throw e;x(-1,e)}}else x(-1,"No Transport");function x(e,t,r,c){var u,h,b,_,y,C=t;l||(l=!0,a&&i.clearTimeout(a),n=void 0,o=c||"",S.readyState=e>0?4:0,u=e>=200&&e<300||304===e,r&&(_=function(e,t,n){for(var i,s,o,r,a=e.contents,c=e.dataTypes;"*"===c[0];)c.shift(),void 0===i&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(s in a)if(a[s]&&a[s].test(i)){c.unshift(s);break}if(c[0]in n)o=c[0];else{for(s in n){if(!c[0]||e.converters[s+" "+c[0]]){o=s;break}r||(r=s)}o=o||r}if(o)return o!==c[0]&&c.unshift(o),n[o]}(p,S,r)),!u&&E.inArray("script",p.dataTypes)>-1&&(p.converters["text script"]=function(){}),_=function(e,t,n,i){var s,o,r,a,c,l={},d=e.dataTypes.slice();if(d[1])for(r in e.converters)l[r.toLowerCase()]=e.converters[r];for(o=d.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!c&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),c=o,o=d.shift())if("*"===o)o=c;else if("*"!==c&&c!==o){if(!(r=l[c+" "+o]||l["* "+o]))for(s in l)if((a=s.split(" "))[1]===o&&(r=l[c+" "+a[0]]||l["* "+a[0]])){!0===r?r=l[s]:!0!==l[s]&&(o=a[0],d.unshift(a[1]));break}if(!0!==r)if(r&&e.throws)t=r(t);else try{t=r(t)}catch(e){return{state:"parsererror",error:r?e:"No conversion from "+c+" to "+o}}}return{state:"success",data:t}}(p,_,S,u),u?(p.ifModified&&((y=S.getResponseHeader("Last-Modified"))&&(E.lastModified[s]=y),(y=S.getResponseHeader("etag"))&&(E.etag[s]=y)),204===e||"HEAD"===p.type?C="nocontent":304===e?C="notmodified":(C=_.state,h=_.data,u=!(b=_.error))):(b=C,!e&&C||(C="error",e<0&&(e=0))),S.status=e,S.statusText=(t||C)+"",u?g.resolveWith(m,[h,C,S]):g.rejectWith(m,[S,C,b]),S.statusCode(v),v=void 0,d&&w.trigger(u?"ajaxSuccess":"ajaxError",[S,p,u?h:b]),f.fireWith(m,[S,C]),d&&(w.trigger("ajaxComplete",[S,p]),--E.active||E.event.trigger("ajaxStop")))}return S},getJSON:function(e,t,n){return E.get(e,t,n,"json")},getScript:function(e,t){return E.get(e,void 0,t,"script")}}),E.each(["get","post"],(function(e,t){E[t]=function(e,n,i,s){return f(n)&&(s=s||i,i=n,n=void 0),E.ajax(E.extend({url:e,type:t,dataType:s,data:n,success:i},E.isPlainObject(e)&&e))}})),E.ajaxPrefilter((function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")})),E._evalUrl=function(e,t,n){return E.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){E.globalEval(e,t,n)}})},E.fn.extend({wrapAll:function(e){var t;return this[0]&&(f(e)&&(e=e.call(this[0])),t=E(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map((function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this},wrapInner:function(e){return f(e)?this.each((function(t){E(this).wrapInner(e.call(this,t))})):this.each((function(){var t=E(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)}))},wrap:function(e){var t=f(e);return this.each((function(n){E(this).wrapAll(t?e.call(this,n):e)}))},unwrap:function(e){return this.parent(e).not("body").each((function(){E(this).replaceWith(this.childNodes)})),this}}),E.expr.pseudos.hidden=function(e){return!E.expr.pseudos.visible(e)},E.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},E.ajaxSettings.xhr=function(){try{return new i.XMLHttpRequest}catch(e){}};var zt={0:200,1223:204},Wt=E.ajaxSettings.xhr();g.cors=!!Wt&&"withCredentials"in Wt,g.ajax=Wt=!!Wt,E.ajaxTransport((function(e){var t,n;if(g.cors||Wt&&!e.crossDomain)return{send:function(s,o){var r,a=e.xhr();if(a.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(r in e.xhrFields)a[r]=e.xhrFields[r];for(r in e.mimeType&&a.overrideMimeType&&a.overrideMimeType(e.mimeType),e.crossDomain||s["X-Requested-With"]||(s["X-Requested-With"]="XMLHttpRequest"),s)a.setRequestHeader(r,s[r]);t=function(e){return function(){t&&(t=n=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===e?a.abort():"error"===e?"number"!=typeof a.status?o(0,"error"):o(a.status,a.statusText):o(zt[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=t(),n=a.onerror=a.ontimeout=t("error"),void 0!==a.onabort?a.onabort=n:a.onreadystatechange=function(){4===a.readyState&&i.setTimeout((function(){t&&n()}))},t=t("abort");try{a.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}})),E.ajaxPrefilter((function(e){e.crossDomain&&(e.contents.script=!1)})),E.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return E.globalEval(e),e}}}),E.ajaxPrefilter("script",(function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),E.ajaxTransport("script",(function(e){var t,n;if(e.crossDomain||e.scriptAttrs)return{send:function(i,s){t=E("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&s("error"===e.type?404:200,e.type)}),b.head.appendChild(t[0])},abort:function(){n&&n()}}}));var Jt,Yt=[],Kt=/(=)\?(?=&|$)|\?\?/;E.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Yt.pop()||E.expando+"_"+kt.guid++;return this[e]=!0,e}}),E.ajaxPrefilter("json jsonp",(function(e,t,n){var s,o,r,a=!1!==e.jsonp&&(Kt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Kt.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return s=e.jsonpCallback=f(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Kt,"$1"+s):!1!==e.jsonp&&(e.url+=(Mt.test(e.url)?"&":"?")+e.jsonp+"="+s),e.converters["script json"]=function(){return r||E.error(s+" was not called"),r[0]},e.dataTypes[0]="json",o=i[s],i[s]=function(){r=arguments},n.always((function(){void 0===o?E(i).removeProp(s):i[s]=o,e[s]&&(e.jsonpCallback=t.jsonpCallback,Yt.push(s)),r&&f(o)&&o(r[0]),r=o=void 0})),"script"})),g.createHTMLDocument=((Jt=b.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Jt.childNodes.length),E.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(g.createHTMLDocument?((i=(t=b.implementation.createHTMLDocument("")).createElement("base")).href=b.location.href,t.head.appendChild(i)):t=b),o=!n&&[],(s=A.exec(e))?[t.createElement(s[1])]:(s=Se([e],t,o),o&&o.length&&E(o).remove(),E.merge([],s.childNodes)));var i,s,o},E.fn.load=function(e,t,n){var i,s,o,r=this,a=e.indexOf(" ");return a>-1&&(i=bt(e.slice(a)),e=e.slice(0,a)),f(t)?(n=t,t=void 0):t&&"object"==typeof t&&(s="POST"),r.length>0&&E.ajax({url:e,type:s||"GET",dataType:"html",data:t}).done((function(e){o=arguments,r.html(i?E("<div>").append(E.parseHTML(e)).find(i):e)})).always(n&&function(e,t){r.each((function(){n.apply(this,o||[e.responseText,t,e])}))}),this},E.expr.pseudos.animated=function(e){return E.grep(E.timers,(function(t){return e===t.elem})).length},E.offset={setOffset:function(e,t,n){var i,s,o,r,a,c,l=E.css(e,"position"),d=E(e),u={};"static"===l&&(e.style.position="relative"),a=d.offset(),o=E.css(e,"top"),c=E.css(e,"left"),("absolute"===l||"fixed"===l)&&(o+c).indexOf("auto")>-1?(r=(i=d.position()).top,s=i.left):(r=parseFloat(o)||0,s=parseFloat(c)||0),f(t)&&(t=t.call(e,n,E.extend({},a))),null!=t.top&&(u.top=t.top-a.top+r),null!=t.left&&(u.left=t.left-a.left+s),"using"in t?t.using.call(e,u):("number"==typeof u.top&&(u.top+="px"),"number"==typeof u.left&&(u.left+="px"),d.css(u))}},E.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each((function(t){E.offset.setOffset(this,e,t)}));var t,n,i=this[0];return i?i.getClientRects().length?(t=i.getBoundingClientRect(),n=i.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,i=this[0],s={top:0,left:0};if("fixed"===E.css(i,"position"))t=i.getBoundingClientRect();else{for(t=this.offset(),n=i.ownerDocument,e=i.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===E.css(e,"position");)e=e.parentNode;e&&e!==i&&1===e.nodeType&&((s=E(e).offset()).top+=E.css(e,"borderTopWidth",!0),s.left+=E.css(e,"borderLeftWidth",!0))}return{top:t.top-s.top-E.css(i,"marginTop",!0),left:t.left-s.left-E.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent;e&&"static"===E.css(e,"position");)e=e.offsetParent;return e||re}))}}),E.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,t){var n="pageYOffset"===t;E.fn[e]=function(i){return H(this,(function(e,i,s){var o;if(v(e)?o=e:9===e.nodeType&&(o=e.defaultView),void 0===s)return o?o[t]:e[i];o?o.scrollTo(n?o.pageXOffset:s,n?s:o.pageYOffset):e[i]=s}),e,i,arguments.length)}})),E.each(["top","left"],(function(e,t){E.cssHooks[t]=We(g.pixelPosition,(function(e,n){if(n)return n=ze(e,t),Ve.test(n)?E(e).position()[t]+"px":n}))})),E.each({Height:"height",Width:"width"},(function(e,t){E.each({padding:"inner"+e,content:t,"":"outer"+e},(function(n,i){E.fn[i]=function(s,o){var r=arguments.length&&(n||"boolean"!=typeof s),a=n||(!0===s||!0===o?"margin":"border");return H(this,(function(t,n,s){var o;return v(t)?0===i.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===s?E.css(t,n,a):E.style(t,n,s,a)}),t,r?s:void 0,r)}}))})),E.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,t){E.fn[t]=function(e){return this.on(t,e)}})),E.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),E.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(e,t){E.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}));var Xt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;E.proxy=function(e,t){var n,i,s;if("string"==typeof t&&(n=e[t],t=e,e=n),f(e))return i=a.call(arguments,2),s=function(){return e.apply(t||this,i.concat(a.call(arguments)))},s.guid=e.guid=e.guid||E.guid++,s},E.holdReady=function(e){e?E.readyWait++:E.ready(!0)},E.isArray=Array.isArray,E.parseJSON=JSON.parse,E.nodeName=R,E.isFunction=f,E.isWindow=v,E.camelCase=Y,E.type=C,E.now=Date.now,E.isNumeric=function(e){var t=E.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},E.trim=function(e){return null==e?"":(e+"").replace(Xt,"")},void 0===(n=function(){return E}.apply(t,[]))||(e.exports=n);var Zt=i.jQuery,Qt=i.$;return E.noConflict=function(e){return i.$===E&&(i.$=Qt),e&&i.jQuery===E&&(i.jQuery=Zt),E},void 0===s&&(i.jQuery=i.$=E),E}))},1480:(e,t,n)=>{"use strict";const{Deflate:i,deflate:s,deflateRaw:o,gzip:r}=n(1256),{Inflate:a,inflate:c,inflateRaw:l,ungzip:d}=n(7264),u=n(6624);e.exports.Deflate=i,e.exports.deflate=s,e.exports.deflateRaw=o,e.exports.gzip=r,e.exports.Inflate=a,e.exports.inflate=c,e.exports.inflateRaw=l,e.exports.ungzip=d,e.exports.constants=u},1256:(e,t,n)=>{"use strict";const i=n(6268),s=n(6512),o=n(3456),r=n(6704),a=n(8207),c=Object.prototype.toString,{Z_NO_FLUSH:l,Z_SYNC_FLUSH:d,Z_FULL_FLUSH:u,Z_FINISH:h,Z_OK:p,Z_STREAM_END:m,Z_DEFAULT_COMPRESSION:w,Z_DEFAULT_STRATEGY:g,Z_DEFLATED:f}=n(6624);function v(e){this.options=s.assign({level:w,method:f,chunkSize:16384,windowBits:15,memLevel:8,strategy:g},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;let n=i.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==p)throw new Error(r[n]);if(t.header&&i.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?o.string2buf(t.dictionary):"[object ArrayBuffer]"===c.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=i.deflateSetDictionary(this.strm,e),n!==p)throw new Error(r[n]);this._dict_set=!0}}function b(e,t){const n=new v(t);if(n.push(e,!0),n.err)throw n.msg||r[n.err];return n.result}v.prototype.push=function(e,t){const n=this.strm,s=this.options.chunkSize;let r,a;if(this.ended)return!1;for(a=t===~~t?t:!0===t?h:l,"string"==typeof e?n.input=o.string2buf(e):"[object ArrayBuffer]"===c.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(s),n.next_out=0,n.avail_out=s),(a===d||a===u)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(r=i.deflate(n,a),r===m)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),r=i.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===p;if(0!==n.avail_out){if(a>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},v.prototype.onData=function(e){this.chunks.push(e)},v.prototype.onEnd=function(e){e===p&&(this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Deflate=v,e.exports.deflate=b,e.exports.deflateRaw=function(e,t){return(t=t||{}).raw=!0,b(e,t)},e.exports.gzip=function(e,t){return(t=t||{}).gzip=!0,b(e,t)},e.exports.constants=n(6624)},7264:(e,t,n)=>{"use strict";const i=n(2024),s=n(6512),o=n(3456),r=n(6704),a=n(8207),c=n(2515),l=Object.prototype.toString,{Z_NO_FLUSH:d,Z_FINISH:u,Z_OK:h,Z_STREAM_END:p,Z_NEED_DICT:m,Z_STREAM_ERROR:w,Z_DATA_ERROR:g,Z_MEM_ERROR:f}=n(6624);function v(e){this.options=s.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;let n=i.inflateInit2(this.strm,t.windowBits);if(n!==h)throw new Error(r[n]);if(this.header=new c,i.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=o.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=i.inflateSetDictionary(this.strm,t.dictionary),n!==h)))throw new Error(r[n])}function b(e,t){const n=new v(t);if(n.push(e),n.err)throw n.msg||r[n.err];return n.result}v.prototype.push=function(e,t){const n=this.strm,s=this.options.chunkSize,r=this.options.dictionary;let a,c,v;if(this.ended)return!1;for(c=t===~~t?t:!0===t?u:d,"[object ArrayBuffer]"===l.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(s),n.next_out=0,n.avail_out=s),a=i.inflate(n,c),a===m&&r&&(a=i.inflateSetDictionary(n,r),a===h?a=i.inflate(n,c):a===g&&(a=m));n.avail_in>0&&a===p&&n.state.wrap>0&&0!==e[n.next_in];)i.inflateReset(n),a=i.inflate(n,c);switch(a){case w:case g:case m:case f:return this.onEnd(a),this.ended=!0,!1}if(v=n.avail_out,n.next_out&&(0===n.avail_out||a===p))if("string"===this.options.to){let e=o.utf8border(n.output,n.next_out),t=n.next_out-e,i=o.buf2string(n.output,e);n.next_out=t,n.avail_out=s-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(i)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(a!==h||0!==v){if(a===p)return a=i.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},v.prototype.onData=function(e){this.chunks.push(e)},v.prototype.onEnd=function(e){e===h&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Inflate=v,e.exports.inflate=b,e.exports.inflateRaw=function(e,t){return(t=t||{}).raw=!0,b(e,t)},e.exports.ungzip=b,e.exports.constants=n(6624)},6512:e=>{"use strict";const t=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);e.exports.assign=function(e){const n=Array.prototype.slice.call(arguments,1);for(;n.length;){const i=n.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(const n in i)t(i,n)&&(e[n]=i[n])}}return e},e.exports.flattenChunks=e=>{let t=0;for(let n=0,i=e.length;n<i;n++)t+=e[n].length;const n=new Uint8Array(t);for(let t=0,i=0,s=e.length;t<s;t++){let s=e[t];n.set(s,i),i+=s.length}return n}},3456:e=>{"use strict";let t=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){t=!1}const n=new Uint8Array(256);for(let e=0;e<256;e++)n[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;n[254]=n[254]=1,e.exports.string2buf=e=>{let t,n,i,s,o,r=e.length,a=0;for(s=0;s<r;s++)n=e.charCodeAt(s),55296==(64512&n)&&s+1<r&&(i=e.charCodeAt(s+1),56320==(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),s++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(a),o=0,s=0;o<a;s++)n=e.charCodeAt(s),55296==(64512&n)&&s+1<r&&(i=e.charCodeAt(s+1),56320==(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),s++)),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t},e.exports.buf2string=(e,i)=>{let s,o;const r=i||e.length,a=new Array(2*r);for(o=0,s=0;s<r;){let t=e[s++];if(t<128){a[o++]=t;continue}let i=n[t];if(i>4)a[o++]=65533,s+=i-1;else{for(t&=2===i?31:3===i?15:7;i>1&&s<r;)t=t<<6|63&e[s++],i--;i>1?a[o++]=65533:t<65536?a[o++]=t:(t-=65536,a[o++]=55296|t>>10&1023,a[o++]=56320|1023&t)}}return((e,n)=>{if(n<65534&&e.subarray&&t)return String.fromCharCode.apply(null,e.length===n?e:e.subarray(0,n));let i="";for(let t=0;t<n;t++)i+=String.fromCharCode(e[t]);return i})(a,o)},e.exports.utf8border=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let i=t-1;for(;i>=0&&128==(192&e[i]);)i--;return i<0||0===i?t:i+n[e[i]]>t?i:t}},1472:e=>{"use strict";e.exports=(e,t,n,i)=>{let s=65535&e|0,o=e>>>16&65535|0,r=0;for(;0!==n;){r=n>2e3?2e3:n,n-=r;do{s=s+t[i++]|0,o=o+s|0}while(--r);s%=65521,o%=65521}return s|o<<16|0}},6624:e=>{"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},2444:e=>{"use strict";const t=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());e.exports=(e,n,i,s)=>{const o=t,r=s+i;e^=-1;for(let t=s;t<r;t++)e=e>>>8^o[255&(e^n[t])];return-1^e}},6268:(e,t,n)=>{"use strict";const{_tr_init:i,_tr_stored_block:s,_tr_flush_block:o,_tr_tally:r,_tr_align:a}=n(3736),c=n(1472),l=n(2444),d=n(6704),{Z_NO_FLUSH:u,Z_PARTIAL_FLUSH:h,Z_FULL_FLUSH:p,Z_FINISH:m,Z_BLOCK:w,Z_OK:g,Z_STREAM_END:f,Z_STREAM_ERROR:v,Z_DATA_ERROR:b,Z_BUF_ERROR:_,Z_DEFAULT_COMPRESSION:y,Z_FILTERED:C,Z_HUFFMAN_ONLY:S,Z_RLE:E,Z_FIXED:x,Z_DEFAULT_STRATEGY:k,Z_UNKNOWN:M,Z_DEFLATED:T}=n(6624),I=258,R=262,A=103,$=113,L=666,P=(e,t)=>(e.msg=d[t],t),D=e=>(e<<1)-(e>4?9:0),N=e=>{let t=e.length;for(;--t>=0;)e[t]=0};let O=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const B=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},F=(e,t)=>{o(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,B(e.strm)},U=(e,t)=>{e.pending_buf[e.pending++]=t},j=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},V=(e,t,n,i)=>{let s=e.avail_in;return s>i&&(s=i),0===s?0:(e.avail_in-=s,t.set(e.input.subarray(e.next_in,e.next_in+s),n),1===e.state.wrap?e.adler=c(e.adler,t,s,n):2===e.state.wrap&&(e.adler=l(e.adler,t,s,n)),e.next_in+=s,e.total_in+=s,s)},G=(e,t)=>{let n,i,s=e.max_chain_length,o=e.strstart,r=e.prev_length,a=e.nice_match;const c=e.strstart>e.w_size-R?e.strstart-(e.w_size-R):0,l=e.window,d=e.w_mask,u=e.prev,h=e.strstart+I;let p=l[o+r-1],m=l[o+r];e.prev_length>=e.good_match&&(s>>=2),a>e.lookahead&&(a=e.lookahead);do{if(n=t,l[n+r]===m&&l[n+r-1]===p&&l[n]===l[o]&&l[++n]===l[o+1]){o+=2,n++;do{}while(l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&o<h);if(i=I-(h-o),o=h-I,i>r){if(e.match_start=t,r=i,i>=a)break;p=l[o+r-1],m=l[o+r]}}}while((t=u[t&d])>c&&0!=--s);return r<=e.lookahead?r:e.lookahead},q=e=>{const t=e.w_size;let n,i,s,o,r;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-R)){e.window.set(e.window.subarray(t,t+t),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,i=e.hash_size,n=i;do{s=e.head[--n],e.head[n]=s>=t?s-t:0}while(--i);i=t,n=i;do{s=e.prev[--n],e.prev[n]=s>=t?s-t:0}while(--i);o+=t}if(0===e.strm.avail_in)break;if(i=V(e.strm,e.window,e.strstart+e.lookahead,o),e.lookahead+=i,e.lookahead+e.insert>=3)for(r=e.strstart-e.insert,e.ins_h=e.window[r],e.ins_h=O(e,e.ins_h,e.window[r+1]);e.insert&&(e.ins_h=O(e,e.ins_h,e.window[r+3-1]),e.prev[r&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=r,r++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<R&&0!==e.strm.avail_in)},H=(e,t)=>{let n,i;for(;;){if(e.lookahead<R){if(q(e),e.lookahead<R&&t===u)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=O(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-R&&(e.match_length=G(e,n)),e.match_length>=3)if(i=r(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=O(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=O(e,e.ins_h,e.window[e.strstart+1]);else i=r(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(F(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===m?(F(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(F(e,!1),0===e.strm.avail_out)?1:2},z=(e,t)=>{let n,i,s;for(;;){if(e.lookahead<R){if(q(e),e.lookahead<R&&t===u)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=O(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-R&&(e.match_length=G(e,n),e.match_length<=5&&(e.strategy===C||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-3,i=r(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=s&&(e.ins_h=O(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(F(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(i=r(e,0,e.window[e.strstart-1]),i&&F(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=r(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===m?(F(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(F(e,!1),0===e.strm.avail_out)?1:2};function W(e,t,n,i,s){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=s}const J=[new W(0,0,0,0,((e,t)=>{let n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(q(e),0===e.lookahead&&t===u)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;const i=e.block_start+n;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,F(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-R&&(F(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===m?(F(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(F(e,!1),e.strm.avail_out),1)})),new W(4,4,8,4,H),new W(4,5,16,8,H),new W(4,6,32,32,H),new W(4,4,16,16,z),new W(8,16,32,32,z),new W(8,16,128,128,z),new W(8,32,128,256,z),new W(32,128,258,1024,z),new W(32,258,258,4096,z)];function Y(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=T,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),N(this.dyn_ltree),N(this.dyn_dtree),N(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),N(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),N(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const K=e=>{if(!e||!e.state)return P(e,v);e.total_in=e.total_out=0,e.data_type=M;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:$,e.adler=2===t.wrap?0:1,t.last_flush=u,i(t),g},X=e=>{const t=K(e);var n;return t===g&&((n=e.state).window_size=2*n.w_size,N(n.head),n.max_lazy_match=J[n.level].max_lazy,n.good_match=J[n.level].good_length,n.nice_match=J[n.level].nice_length,n.max_chain_length=J[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),t},Z=(e,t,n,i,s,o)=>{if(!e)return v;let r=1;if(t===y&&(t=6),i<0?(r=0,i=-i):i>15&&(r=2,i-=16),s<1||s>9||n!==T||i<8||i>15||t<0||t>9||o<0||o>x)return P(e,v);8===i&&(i=9);const a=new Y;return e.state=a,a.strm=e,a.wrap=r,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=s+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<s+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=t,a.strategy=o,a.method=n,X(e)};e.exports.deflateInit=(e,t)=>Z(e,t,T,15,8,k),e.exports.deflateInit2=Z,e.exports.deflateReset=X,e.exports.deflateResetKeep=K,e.exports.deflateSetHeader=(e,t)=>e&&e.state?2!==e.state.wrap?v:(e.state.gzhead=t,g):v,e.exports.deflate=(e,t)=>{let n,i;if(!e||!e.state||t>w||t<0)return e?P(e,v):v;const o=e.state;if(!e.output||!e.input&&0!==e.avail_in||o.status===L&&t!==m)return P(e,0===e.avail_out?_:v);o.strm=e;const c=o.last_flush;if(o.last_flush=t,42===o.status)if(2===o.wrap)e.adler=0,U(o,31),U(o,139),U(o,8),o.gzhead?(U(o,(o.gzhead.text?1:0)+(o.gzhead.hcrc?2:0)+(o.gzhead.extra?4:0)+(o.gzhead.name?8:0)+(o.gzhead.comment?16:0)),U(o,255&o.gzhead.time),U(o,o.gzhead.time>>8&255),U(o,o.gzhead.time>>16&255),U(o,o.gzhead.time>>24&255),U(o,9===o.level?2:o.strategy>=S||o.level<2?4:0),U(o,255&o.gzhead.os),o.gzhead.extra&&o.gzhead.extra.length&&(U(o,255&o.gzhead.extra.length),U(o,o.gzhead.extra.length>>8&255)),o.gzhead.hcrc&&(e.adler=l(e.adler,o.pending_buf,o.pending,0)),o.gzindex=0,o.status=69):(U(o,0),U(o,0),U(o,0),U(o,0),U(o,0),U(o,9===o.level?2:o.strategy>=S||o.level<2?4:0),U(o,3),o.status=$);else{let t=T+(o.w_bits-8<<4)<<8,n=-1;n=o.strategy>=S||o.level<2?0:o.level<6?1:6===o.level?2:3,t|=n<<6,0!==o.strstart&&(t|=32),t+=31-t%31,o.status=$,j(o,t),0!==o.strstart&&(j(o,e.adler>>>16),j(o,65535&e.adler)),e.adler=1}if(69===o.status)if(o.gzhead.extra){for(n=o.pending;o.gzindex<(65535&o.gzhead.extra.length)&&(o.pending!==o.pending_buf_size||(o.gzhead.hcrc&&o.pending>n&&(e.adler=l(e.adler,o.pending_buf,o.pending-n,n)),B(e),n=o.pending,o.pending!==o.pending_buf_size));)U(o,255&o.gzhead.extra[o.gzindex]),o.gzindex++;o.gzhead.hcrc&&o.pending>n&&(e.adler=l(e.adler,o.pending_buf,o.pending-n,n)),o.gzindex===o.gzhead.extra.length&&(o.gzindex=0,o.status=73)}else o.status=73;if(73===o.status)if(o.gzhead.name){n=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>n&&(e.adler=l(e.adler,o.pending_buf,o.pending-n,n)),B(e),n=o.pending,o.pending===o.pending_buf_size)){i=1;break}i=o.gzindex<o.gzhead.name.length?255&o.gzhead.name.charCodeAt(o.gzindex++):0,U(o,i)}while(0!==i);o.gzhead.hcrc&&o.pending>n&&(e.adler=l(e.adler,o.pending_buf,o.pending-n,n)),0===i&&(o.gzindex=0,o.status=91)}else o.status=91;if(91===o.status)if(o.gzhead.comment){n=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>n&&(e.adler=l(e.adler,o.pending_buf,o.pending-n,n)),B(e),n=o.pending,o.pending===o.pending_buf_size)){i=1;break}i=o.gzindex<o.gzhead.comment.length?255&o.gzhead.comment.charCodeAt(o.gzindex++):0,U(o,i)}while(0!==i);o.gzhead.hcrc&&o.pending>n&&(e.adler=l(e.adler,o.pending_buf,o.pending-n,n)),0===i&&(o.status=A)}else o.status=A;if(o.status===A&&(o.gzhead.hcrc?(o.pending+2>o.pending_buf_size&&B(e),o.pending+2<=o.pending_buf_size&&(U(o,255&e.adler),U(o,e.adler>>8&255),e.adler=0,o.status=$)):o.status=$),0!==o.pending){if(B(e),0===e.avail_out)return o.last_flush=-1,g}else if(0===e.avail_in&&D(t)<=D(c)&&t!==m)return P(e,_);if(o.status===L&&0!==e.avail_in)return P(e,_);if(0!==e.avail_in||0!==o.lookahead||t!==u&&o.status!==L){let n=o.strategy===S?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(q(e),0===e.lookahead)){if(t===u)return 1;break}if(e.match_length=0,n=r(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(F(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===m?(F(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(F(e,!1),0===e.strm.avail_out)?1:2})(o,t):o.strategy===E?((e,t)=>{let n,i,s,o;const a=e.window;for(;;){if(e.lookahead<=I){if(q(e),e.lookahead<=I&&t===u)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(s=e.strstart-1,i=a[s],i===a[++s]&&i===a[++s]&&i===a[++s])){o=e.strstart+I;do{}while(i===a[++s]&&i===a[++s]&&i===a[++s]&&i===a[++s]&&i===a[++s]&&i===a[++s]&&i===a[++s]&&i===a[++s]&&s<o);e.match_length=I-(o-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=r(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=r(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(F(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===m?(F(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(F(e,!1),0===e.strm.avail_out)?1:2})(o,t):J[o.level].func(o,t);if(3!==n&&4!==n||(o.status=L),1===n||3===n)return 0===e.avail_out&&(o.last_flush=-1),g;if(2===n&&(t===h?a(o):t!==w&&(s(o,0,0,!1),t===p&&(N(o.head),0===o.lookahead&&(o.strstart=0,o.block_start=0,o.insert=0))),B(e),0===e.avail_out))return o.last_flush=-1,g}return t!==m?g:o.wrap<=0?f:(2===o.wrap?(U(o,255&e.adler),U(o,e.adler>>8&255),U(o,e.adler>>16&255),U(o,e.adler>>24&255),U(o,255&e.total_in),U(o,e.total_in>>8&255),U(o,e.total_in>>16&255),U(o,e.total_in>>24&255)):(j(o,e.adler>>>16),j(o,65535&e.adler)),B(e),o.wrap>0&&(o.wrap=-o.wrap),0!==o.pending?g:f)},e.exports.deflateEnd=e=>{if(!e||!e.state)return v;const t=e.state.status;return 42!==t&&69!==t&&73!==t&&91!==t&&t!==A&&t!==$&&t!==L?P(e,v):(e.state=null,t===$?P(e,b):g)},e.exports.deflateSetDictionary=(e,t)=>{let n=t.length;if(!e||!e.state)return v;const i=e.state,s=i.wrap;if(2===s||1===s&&42!==i.status||i.lookahead)return v;if(1===s&&(e.adler=c(e.adler,t,n,0)),i.wrap=0,n>=i.w_size){0===s&&(N(i.head),i.strstart=0,i.block_start=0,i.insert=0);let e=new Uint8Array(i.w_size);e.set(t.subarray(n-i.w_size,n),0),t=e,n=i.w_size}const o=e.avail_in,r=e.next_in,a=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,q(i);i.lookahead>=3;){let e=i.strstart,t=i.lookahead-2;do{i.ins_h=O(i,i.ins_h,i.window[e+3-1]),i.prev[e&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=e,e++}while(--t);i.strstart=e,i.lookahead=2,q(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,e.next_in=r,e.input=a,e.avail_in=o,i.wrap=s,g},e.exports.deflateInfo="pako deflate (from Nodeca project)"},2515:e=>{"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},5176:e=>{"use strict";e.exports=function(e,t){let n,i,s,o,r,a,c,l,d,u,h,p,m,w,g,f,v,b,_,y,C,S,E,x;const k=e.state;n=e.next_in,E=e.input,i=n+(e.avail_in-5),s=e.next_out,x=e.output,o=s-(t-e.avail_out),r=s+(e.avail_out-257),a=k.dmax,c=k.wsize,l=k.whave,d=k.wnext,u=k.window,h=k.hold,p=k.bits,m=k.lencode,w=k.distcode,g=(1<<k.lenbits)-1,f=(1<<k.distbits)-1;e:do{p<15&&(h+=E[n++]<<p,p+=8,h+=E[n++]<<p,p+=8),v=m[h&g];t:for(;;){if(b=v>>>24,h>>>=b,p-=b,b=v>>>16&255,0===b)x[s++]=65535&v;else{if(!(16&b)){if(0==(64&b)){v=m[(65535&v)+(h&(1<<b)-1)];continue t}if(32&b){k.mode=12;break e}e.msg="invalid literal/length code",k.mode=30;break e}_=65535&v,b&=15,b&&(p<b&&(h+=E[n++]<<p,p+=8),_+=h&(1<<b)-1,h>>>=b,p-=b),p<15&&(h+=E[n++]<<p,p+=8,h+=E[n++]<<p,p+=8),v=w[h&f];n:for(;;){if(b=v>>>24,h>>>=b,p-=b,b=v>>>16&255,!(16&b)){if(0==(64&b)){v=w[(65535&v)+(h&(1<<b)-1)];continue n}e.msg="invalid distance code",k.mode=30;break e}if(y=65535&v,b&=15,p<b&&(h+=E[n++]<<p,p+=8,p<b&&(h+=E[n++]<<p,p+=8)),y+=h&(1<<b)-1,y>a){e.msg="invalid distance too far back",k.mode=30;break e}if(h>>>=b,p-=b,b=s-o,y>b){if(b=y-b,b>l&&k.sane){e.msg="invalid distance too far back",k.mode=30;break e}if(C=0,S=u,0===d){if(C+=c-b,b<_){_-=b;do{x[s++]=u[C++]}while(--b);C=s-y,S=x}}else if(d<b){if(C+=c+d-b,b-=d,b<_){_-=b;do{x[s++]=u[C++]}while(--b);if(C=0,d<_){b=d,_-=b;do{x[s++]=u[C++]}while(--b);C=s-y,S=x}}}else if(C+=d-b,b<_){_-=b;do{x[s++]=u[C++]}while(--b);C=s-y,S=x}for(;_>2;)x[s++]=S[C++],x[s++]=S[C++],x[s++]=S[C++],_-=3;_&&(x[s++]=S[C++],_>1&&(x[s++]=S[C++]))}else{C=s-y;do{x[s++]=x[C++],x[s++]=x[C++],x[s++]=x[C++],_-=3}while(_>2);_&&(x[s++]=x[C++],_>1&&(x[s++]=x[C++]))}break}}break}}while(n<i&&s<r);_=p>>3,n-=_,p-=_<<3,h&=(1<<p)-1,e.next_in=n,e.next_out=s,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=s<r?r-s+257:257-(s-r),k.hold=h,k.bits=p}},2024:(e,t,n)=>{"use strict";const i=n(1472),s=n(2444),o=n(5176),r=n(520),{Z_FINISH:a,Z_BLOCK:c,Z_TREES:l,Z_OK:d,Z_STREAM_END:u,Z_NEED_DICT:h,Z_STREAM_ERROR:p,Z_DATA_ERROR:m,Z_MEM_ERROR:w,Z_BUF_ERROR:g,Z_DEFLATED:f}=n(6624),v=12,b=30,_=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const C=e=>{if(!e||!e.state)return p;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,d},S=e=>{if(!e||!e.state)return p;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,C(e)},E=(e,t)=>{let n;if(!e||!e.state)return p;const i=e.state;return t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?p:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,S(e))},x=(e,t)=>{if(!e)return p;const n=new y;e.state=n,n.window=null;const i=E(e,t);return i!==d&&(e.state=null),i};let k,M,T=!0;const I=e=>{if(T){k=new Int32Array(512),M=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(r(1,e.lens,0,288,k,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;r(2,e.lens,0,32,M,0,e.work,{bits:5}),T=!1}e.lencode=k,e.lenbits=9,e.distcode=M,e.distbits=5},R=(e,t,n,i)=>{let s;const o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),i>=o.wsize?(o.window.set(t.subarray(n-o.wsize,n),0),o.wnext=0,o.whave=o.wsize):(s=o.wsize-o.wnext,s>i&&(s=i),o.window.set(t.subarray(n-i,n-i+s),o.wnext),(i-=s)?(o.window.set(t.subarray(n-i,n),0),o.wnext=i,o.whave=o.wsize):(o.wnext+=s,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=s))),0};e.exports.inflateReset=S,e.exports.inflateReset2=E,e.exports.inflateResetKeep=C,e.exports.inflateInit=e=>x(e,15),e.exports.inflateInit2=x,e.exports.inflate=(e,t)=>{let n,y,C,S,E,x,k,M,T,A,$,L,P,D,N,O,B,F,U,j,V,G,q=0;const H=new Uint8Array(4);let z,W;const J=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return p;n=e.state,n.mode===v&&(n.mode=13),E=e.next_out,C=e.output,k=e.avail_out,S=e.next_in,y=e.input,x=e.avail_in,M=n.hold,T=n.bits,A=x,$=k,G=d;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;T<16;){if(0===x)break e;x--,M+=y[S++]<<T,T+=8}if(2&n.wrap&&35615===M){n.check=0,H[0]=255&M,H[1]=M>>>8&255,n.check=s(n.check,H,2,0),M=0,T=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&M)<<8)+(M>>8))%31){e.msg="incorrect header check",n.mode=b;break}if((15&M)!==f){e.msg="unknown compression method",n.mode=b;break}if(M>>>=4,T-=4,V=8+(15&M),0===n.wbits)n.wbits=V;else if(V>n.wbits){e.msg="invalid window size",n.mode=b;break}n.dmax=1<<n.wbits,e.adler=n.check=1,n.mode=512&M?10:v,M=0,T=0;break;case 2:for(;T<16;){if(0===x)break e;x--,M+=y[S++]<<T,T+=8}if(n.flags=M,(255&n.flags)!==f){e.msg="unknown compression method",n.mode=b;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=b;break}n.head&&(n.head.text=M>>8&1),512&n.flags&&(H[0]=255&M,H[1]=M>>>8&255,n.check=s(n.check,H,2,0)),M=0,T=0,n.mode=3;case 3:for(;T<32;){if(0===x)break e;x--,M+=y[S++]<<T,T+=8}n.head&&(n.head.time=M),512&n.flags&&(H[0]=255&M,H[1]=M>>>8&255,H[2]=M>>>16&255,H[3]=M>>>24&255,n.check=s(n.check,H,4,0)),M=0,T=0,n.mode=4;case 4:for(;T<16;){if(0===x)break e;x--,M+=y[S++]<<T,T+=8}n.head&&(n.head.xflags=255&M,n.head.os=M>>8),512&n.flags&&(H[0]=255&M,H[1]=M>>>8&255,n.check=s(n.check,H,2,0)),M=0,T=0,n.mode=5;case 5:if(1024&n.flags){for(;T<16;){if(0===x)break e;x--,M+=y[S++]<<T,T+=8}n.length=M,n.head&&(n.head.extra_len=M),512&n.flags&&(H[0]=255&M,H[1]=M>>>8&255,n.check=s(n.check,H,2,0)),M=0,T=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(L=n.length,L>x&&(L=x),L&&(n.head&&(V=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(y.subarray(S,S+L),V)),512&n.flags&&(n.check=s(n.check,y,L,S)),x-=L,S+=L,n.length-=L),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===x)break e;L=0;do{V=y[S+L++],n.head&&V&&n.length<65536&&(n.head.name+=String.fromCharCode(V))}while(V&&L<x);if(512&n.flags&&(n.check=s(n.check,y,L,S)),x-=L,S+=L,V)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===x)break e;L=0;do{V=y[S+L++],n.head&&V&&n.length<65536&&(n.head.comment+=String.fromCharCode(V))}while(V&&L<x);if(512&n.flags&&(n.check=s(n.check,y,L,S)),x-=L,S+=L,V)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;T<16;){if(0===x)break e;x--,M+=y[S++]<<T,T+=8}if(M!==(65535&n.check)){e.msg="header crc mismatch",n.mode=b;break}M=0,T=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=v;break;case 10:for(;T<32;){if(0===x)break e;x--,M+=y[S++]<<T,T+=8}e.adler=n.check=_(M),M=0,T=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=E,e.avail_out=k,e.next_in=S,e.avail_in=x,n.hold=M,n.bits=T,h;e.adler=n.check=1,n.mode=v;case v:if(t===c||t===l)break e;case 13:if(n.last){M>>>=7&T,T-=7&T,n.mode=27;break}for(;T<3;){if(0===x)break e;x--,M+=y[S++]<<T,T+=8}switch(n.last=1&M,M>>>=1,T-=1,3&M){case 0:n.mode=14;break;case 1:if(I(n),n.mode=20,t===l){M>>>=2,T-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=b}M>>>=2,T-=2;break;case 14:for(M>>>=7&T,T-=7&T;T<32;){if(0===x)break e;x--,M+=y[S++]<<T,T+=8}if((65535&M)!=(M>>>16^65535)){e.msg="invalid stored block lengths",n.mode=b;break}if(n.length=65535&M,M=0,T=0,n.mode=15,t===l)break e;case 15:n.mode=16;case 16:if(L=n.length,L){if(L>x&&(L=x),L>k&&(L=k),0===L)break e;C.set(y.subarray(S,S+L),E),x-=L,S+=L,k-=L,E+=L,n.length-=L;break}n.mode=v;break;case 17:for(;T<14;){if(0===x)break e;x--,M+=y[S++]<<T,T+=8}if(n.nlen=257+(31&M),M>>>=5,T-=5,n.ndist=1+(31&M),M>>>=5,T-=5,n.ncode=4+(15&M),M>>>=4,T-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=b;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;T<3;){if(0===x)break e;x--,M+=y[S++]<<T,T+=8}n.lens[J[n.have++]]=7&M,M>>>=3,T-=3}for(;n.have<19;)n.lens[J[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,z={bits:n.lenbits},G=r(0,n.lens,0,19,n.lencode,0,n.work,z),n.lenbits=z.bits,G){e.msg="invalid code lengths set",n.mode=b;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;q=n.lencode[M&(1<<n.lenbits)-1],N=q>>>24,O=q>>>16&255,B=65535&q,!(N<=T);){if(0===x)break e;x--,M+=y[S++]<<T,T+=8}if(B<16)M>>>=N,T-=N,n.lens[n.have++]=B;else{if(16===B){for(W=N+2;T<W;){if(0===x)break e;x--,M+=y[S++]<<T,T+=8}if(M>>>=N,T-=N,0===n.have){e.msg="invalid bit length repeat",n.mode=b;break}V=n.lens[n.have-1],L=3+(3&M),M>>>=2,T-=2}else if(17===B){for(W=N+3;T<W;){if(0===x)break e;x--,M+=y[S++]<<T,T+=8}M>>>=N,T-=N,V=0,L=3+(7&M),M>>>=3,T-=3}else{for(W=N+7;T<W;){if(0===x)break e;x--,M+=y[S++]<<T,T+=8}M>>>=N,T-=N,V=0,L=11+(127&M),M>>>=7,T-=7}if(n.have+L>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=b;break}for(;L--;)n.lens[n.have++]=V}}if(n.mode===b)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=b;break}if(n.lenbits=9,z={bits:n.lenbits},G=r(1,n.lens,0,n.nlen,n.lencode,0,n.work,z),n.lenbits=z.bits,G){e.msg="invalid literal/lengths set",n.mode=b;break}if(n.distbits=6,n.distcode=n.distdyn,z={bits:n.distbits},G=r(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,z),n.distbits=z.bits,G){e.msg="invalid distances set",n.mode=b;break}if(n.mode=20,t===l)break e;case 20:n.mode=21;case 21:if(x>=6&&k>=258){e.next_out=E,e.avail_out=k,e.next_in=S,e.avail_in=x,n.hold=M,n.bits=T,o(e,$),E=e.next_out,C=e.output,k=e.avail_out,S=e.next_in,y=e.input,x=e.avail_in,M=n.hold,T=n.bits,n.mode===v&&(n.back=-1);break}for(n.back=0;q=n.lencode[M&(1<<n.lenbits)-1],N=q>>>24,O=q>>>16&255,B=65535&q,!(N<=T);){if(0===x)break e;x--,M+=y[S++]<<T,T+=8}if(O&&0==(240&O)){for(F=N,U=O,j=B;q=n.lencode[j+((M&(1<<F+U)-1)>>F)],N=q>>>24,O=q>>>16&255,B=65535&q,!(F+N<=T);){if(0===x)break e;x--,M+=y[S++]<<T,T+=8}M>>>=F,T-=F,n.back+=F}if(M>>>=N,T-=N,n.back+=N,n.length=B,0===O){n.mode=26;break}if(32&O){n.back=-1,n.mode=v;break}if(64&O){e.msg="invalid literal/length code",n.mode=b;break}n.extra=15&O,n.mode=22;case 22:if(n.extra){for(W=n.extra;T<W;){if(0===x)break e;x--,M+=y[S++]<<T,T+=8}n.length+=M&(1<<n.extra)-1,M>>>=n.extra,T-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;q=n.distcode[M&(1<<n.distbits)-1],N=q>>>24,O=q>>>16&255,B=65535&q,!(N<=T);){if(0===x)break e;x--,M+=y[S++]<<T,T+=8}if(0==(240&O)){for(F=N,U=O,j=B;q=n.distcode[j+((M&(1<<F+U)-1)>>F)],N=q>>>24,O=q>>>16&255,B=65535&q,!(F+N<=T);){if(0===x)break e;x--,M+=y[S++]<<T,T+=8}M>>>=F,T-=F,n.back+=F}if(M>>>=N,T-=N,n.back+=N,64&O){e.msg="invalid distance code",n.mode=b;break}n.offset=B,n.extra=15&O,n.mode=24;case 24:if(n.extra){for(W=n.extra;T<W;){if(0===x)break e;x--,M+=y[S++]<<T,T+=8}n.offset+=M&(1<<n.extra)-1,M>>>=n.extra,T-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=b;break}n.mode=25;case 25:if(0===k)break e;if(L=$-k,n.offset>L){if(L=n.offset-L,L>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=b;break}L>n.wnext?(L-=n.wnext,P=n.wsize-L):P=n.wnext-L,L>n.length&&(L=n.length),D=n.window}else D=C,P=E-n.offset,L=n.length;L>k&&(L=k),k-=L,n.length-=L;do{C[E++]=D[P++]}while(--L);0===n.length&&(n.mode=21);break;case 26:if(0===k)break e;C[E++]=n.length,k--,n.mode=21;break;case 27:if(n.wrap){for(;T<32;){if(0===x)break e;x--,M|=y[S++]<<T,T+=8}if($-=k,e.total_out+=$,n.total+=$,$&&(e.adler=n.check=n.flags?s(n.check,C,$,E-$):i(n.check,C,$,E-$)),$=k,(n.flags?M:_(M))!==n.check){e.msg="incorrect data check",n.mode=b;break}M=0,T=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;T<32;){if(0===x)break e;x--,M+=y[S++]<<T,T+=8}if(M!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=b;break}M=0,T=0}n.mode=29;case 29:G=u;break e;case b:G=m;break e;case 31:return w;default:return p}return e.next_out=E,e.avail_out=k,e.next_in=S,e.avail_in=x,n.hold=M,n.bits=T,(n.wsize||$!==e.avail_out&&n.mode<b&&(n.mode<27||t!==a))&&R(e,e.output,e.next_out,$-e.avail_out)?(n.mode=31,w):(A-=e.avail_in,$-=e.avail_out,e.total_in+=A,e.total_out+=$,n.total+=$,n.wrap&&$&&(e.adler=n.check=n.flags?s(n.check,C,$,e.next_out-$):i(n.check,C,$,e.next_out-$)),e.data_type=n.bits+(n.last?64:0)+(n.mode===v?128:0)+(20===n.mode||15===n.mode?256:0),(0===A&&0===$||t===a)&&G===d&&(G=g),G)},e.exports.inflateEnd=e=>{if(!e||!e.state)return p;let t=e.state;return t.window&&(t.window=null),e.state=null,d},e.exports.inflateGetHeader=(e,t)=>{if(!e||!e.state)return p;const n=e.state;return 0==(2&n.wrap)?p:(n.head=t,t.done=!1,d)},e.exports.inflateSetDictionary=(e,t)=>{const n=t.length;let s,o,r;return e&&e.state?(s=e.state,0!==s.wrap&&11!==s.mode?p:11===s.mode&&(o=1,o=i(o,t,n,0),o!==s.check)?m:(r=R(e,t,n,n),r?(s.mode=31,w):(s.havedict=1,d))):p},e.exports.inflateInfo="pako inflate (from Nodeca project)"},520:e=>{"use strict";const t=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),n=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),i=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),s=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);e.exports=(e,o,r,a,c,l,d,u)=>{const h=u.bits;let p,m,w,g,f,v,b=0,_=0,y=0,C=0,S=0,E=0,x=0,k=0,M=0,T=0,I=null,R=0;const A=new Uint16Array(16),$=new Uint16Array(16);let L,P,D,N=null,O=0;for(b=0;b<=15;b++)A[b]=0;for(_=0;_<a;_++)A[o[r+_]]++;for(S=h,C=15;C>=1&&0===A[C];C--);if(S>C&&(S=C),0===C)return c[l++]=20971520,c[l++]=20971520,u.bits=1,0;for(y=1;y<C&&0===A[y];y++);for(S<y&&(S=y),k=1,b=1;b<=15;b++)if(k<<=1,k-=A[b],k<0)return-1;if(k>0&&(0===e||1!==C))return-1;for($[1]=0,b=1;b<15;b++)$[b+1]=$[b]+A[b];for(_=0;_<a;_++)0!==o[r+_]&&(d[$[o[r+_]]++]=_);if(0===e?(I=N=d,v=19):1===e?(I=t,R-=257,N=n,O-=257,v=256):(I=i,N=s,v=-1),T=0,_=0,b=y,f=l,E=S,x=0,w=-1,M=1<<S,g=M-1,1===e&&M>852||2===e&&M>592)return 1;for(;;){L=b-x,d[_]<v?(P=0,D=d[_]):d[_]>v?(P=N[O+d[_]],D=I[R+d[_]]):(P=96,D=0),p=1<<b-x,m=1<<E,y=m;do{m-=p,c[f+(T>>x)+m]=L<<24|P<<16|D|0}while(0!==m);for(p=1<<b-1;T&p;)p>>=1;if(0!==p?(T&=p-1,T+=p):T=0,_++,0==--A[b]){if(b===C)break;b=o[r+d[_]]}if(b>S&&(T&g)!==w){for(0===x&&(x=S),f+=y,E=b-x,k=1<<E;E+x<C&&(k-=A[E+x],!(k<=0));)E++,k<<=1;if(M+=1<<E,1===e&&M>852||2===e&&M>592)return 1;w=T&g,c[w]=S<<24|E<<16|f-l|0}}return 0!==T&&(c[f+T]=b-x<<24|64<<16|0),u.bits=S,0}},6704:e=>{"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},3736:e=>{"use strict";function t(e){let t=e.length;for(;--t>=0;)e[t]=0}const n=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),i=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),s=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),o=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),r=new Array(576);t(r);const a=new Array(60);t(a);const c=new Array(512);t(c);const l=new Array(256);t(l);const d=new Array(29);t(d);const u=new Array(30);function h(e,t,n,i,s){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=s,this.has_stree=e&&e.length}let p,m,w;function g(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}t(u);const f=e=>e<256?c[e]:c[256+(e>>>7)],v=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},b=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,v(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},_=(e,t,n)=>{b(e,n[2*t],n[2*t+1])},y=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},C=(e,t,n)=>{const i=new Array(16);let s,o,r=0;for(s=1;s<=15;s++)i[s]=r=r+n[s-1]<<1;for(o=0;o<=t;o++){let t=e[2*o+1];0!==t&&(e[2*o]=y(i[t]++,t))}},S=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},E=e=>{e.bi_valid>8?v(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},x=(e,t,n,i)=>{const s=2*t,o=2*n;return e[s]<e[o]||e[s]===e[o]&&i[t]<=i[n]},k=(e,t,n)=>{const i=e.heap[n];let s=n<<1;for(;s<=e.heap_len&&(s<e.heap_len&&x(t,e.heap[s+1],e.heap[s],e.depth)&&s++,!x(t,i,e.heap[s],e.depth));)e.heap[n]=e.heap[s],n=s,s<<=1;e.heap[n]=i},M=(e,t,s)=>{let o,r,a,c,h=0;if(0!==e.last_lit)do{o=e.pending_buf[e.d_buf+2*h]<<8|e.pending_buf[e.d_buf+2*h+1],r=e.pending_buf[e.l_buf+h],h++,0===o?_(e,r,t):(a=l[r],_(e,a+256+1,t),c=n[a],0!==c&&(r-=d[a],b(e,r,c)),o--,a=f(o),_(e,a,s),c=i[a],0!==c&&(o-=u[a],b(e,o,c)))}while(h<e.last_lit);_(e,256,t)},T=(e,t)=>{const n=t.dyn_tree,i=t.stat_desc.static_tree,s=t.stat_desc.has_stree,o=t.stat_desc.elems;let r,a,c,l=-1;for(e.heap_len=0,e.heap_max=573,r=0;r<o;r++)0!==n[2*r]?(e.heap[++e.heap_len]=l=r,e.depth[r]=0):n[2*r+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=l<2?++l:0,n[2*c]=1,e.depth[c]=0,e.opt_len--,s&&(e.static_len-=i[2*c+1]);for(t.max_code=l,r=e.heap_len>>1;r>=1;r--)k(e,n,r);c=o;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],k(e,n,1),a=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=a,n[2*c]=n[2*r]+n[2*a],e.depth[c]=(e.depth[r]>=e.depth[a]?e.depth[r]:e.depth[a])+1,n[2*r+1]=n[2*a+1]=c,e.heap[1]=c++,k(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,i=t.max_code,s=t.stat_desc.static_tree,o=t.stat_desc.has_stree,r=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,c=t.stat_desc.max_length;let l,d,u,h,p,m,w=0;for(h=0;h<=15;h++)e.bl_count[h]=0;for(n[2*e.heap[e.heap_max]+1]=0,l=e.heap_max+1;l<573;l++)d=e.heap[l],h=n[2*n[2*d+1]+1]+1,h>c&&(h=c,w++),n[2*d+1]=h,d>i||(e.bl_count[h]++,p=0,d>=a&&(p=r[d-a]),m=n[2*d],e.opt_len+=m*(h+p),o&&(e.static_len+=m*(s[2*d+1]+p)));if(0!==w){do{for(h=c-1;0===e.bl_count[h];)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[c]--,w-=2}while(w>0);for(h=c;0!==h;h--)for(d=e.bl_count[h];0!==d;)u=e.heap[--l],u>i||(n[2*u+1]!==h&&(e.opt_len+=(h-n[2*u+1])*n[2*u],n[2*u+1]=h),d--)}})(e,t),C(n,l,e.bl_count)},I=(e,t,n)=>{let i,s,o=-1,r=t[1],a=0,c=7,l=4;for(0===r&&(c=138,l=3),t[2*(n+1)+1]=65535,i=0;i<=n;i++)s=r,r=t[2*(i+1)+1],++a<c&&s===r||(a<l?e.bl_tree[2*s]+=a:0!==s?(s!==o&&e.bl_tree[2*s]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,o=s,0===r?(c=138,l=3):s===r?(c=6,l=3):(c=7,l=4))},R=(e,t,n)=>{let i,s,o=-1,r=t[1],a=0,c=7,l=4;for(0===r&&(c=138,l=3),i=0;i<=n;i++)if(s=r,r=t[2*(i+1)+1],!(++a<c&&s===r)){if(a<l)do{_(e,s,e.bl_tree)}while(0!=--a);else 0!==s?(s!==o&&(_(e,s,e.bl_tree),a--),_(e,16,e.bl_tree),b(e,a-3,2)):a<=10?(_(e,17,e.bl_tree),b(e,a-3,3)):(_(e,18,e.bl_tree),b(e,a-11,7));a=0,o=s,0===r?(c=138,l=3):s===r?(c=6,l=3):(c=7,l=4)}};let A=!1;const $=(e,t,n,i)=>{b(e,0+(i?1:0),3),((e,t,n,i)=>{E(e),v(e,n),v(e,~n),e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n})(e,t,n)};e.exports._tr_init=e=>{A||((()=>{let e,t,o,g,f;const v=new Array(16);for(o=0,g=0;g<28;g++)for(d[g]=o,e=0;e<1<<n[g];e++)l[o++]=g;for(l[o-1]=g,f=0,g=0;g<16;g++)for(u[g]=f,e=0;e<1<<i[g];e++)c[f++]=g;for(f>>=7;g<30;g++)for(u[g]=f<<7,e=0;e<1<<i[g]-7;e++)c[256+f++]=g;for(t=0;t<=15;t++)v[t]=0;for(e=0;e<=143;)r[2*e+1]=8,e++,v[8]++;for(;e<=255;)r[2*e+1]=9,e++,v[9]++;for(;e<=279;)r[2*e+1]=7,e++,v[7]++;for(;e<=287;)r[2*e+1]=8,e++,v[8]++;for(C(r,287,v),e=0;e<30;e++)a[2*e+1]=5,a[2*e]=y(e,5);p=new h(r,n,257,286,15),m=new h(a,i,0,30,15),w=new h(new Array(0),s,0,19,7)})(),A=!0),e.l_desc=new g(e.dyn_ltree,p),e.d_desc=new g(e.dyn_dtree,m),e.bl_desc=new g(e.bl_tree,w),e.bi_buf=0,e.bi_valid=0,S(e)},e.exports._tr_stored_block=$,e.exports._tr_flush_block=(e,t,n,i)=>{let s,c,l=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),T(e,e.l_desc),T(e,e.d_desc),l=(e=>{let t;for(I(e,e.dyn_ltree,e.l_desc.max_code),I(e,e.dyn_dtree,e.d_desc.max_code),T(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*o[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),s=e.opt_len+3+7>>>3,c=e.static_len+3+7>>>3,c<=s&&(s=c)):s=c=n+5,n+4<=s&&-1!==t?$(e,t,n,i):4===e.strategy||c===s?(b(e,2+(i?1:0),3),M(e,r,a)):(b(e,4+(i?1:0),3),((e,t,n,i)=>{let s;for(b(e,t-257,5),b(e,n-1,5),b(e,i-4,4),s=0;s<i;s++)b(e,e.bl_tree[2*o[s]+1],3);R(e,e.dyn_ltree,t-1),R(e,e.dyn_dtree,n-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),M(e,e.dyn_ltree,e.dyn_dtree)),S(e),i&&E(e)},e.exports._tr_tally=(e,t,n)=>(e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(l[n]+256+1)]++,e.dyn_dtree[2*f(t)]++),e.last_lit===e.lit_bufsize-1),e.exports._tr_align=e=>{b(e,2,3),_(e,256,r),(e=>{16===e.bi_valid?(v(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}},8207:e=>{"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},1880:e=>{var t=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),(t+=null!=e["network-id"]?" network-id %d":"%v")+(null!=e["network-cost"]?" network-cost %d":"%v")}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",(t+=null!=e.rateNumerator?" rate=%s":"")+(null!=e.rateDenominator?"/%s":"")}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(t).forEach((function(e){t[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}))},1692:(e,t,n)=>{var i=n(456);n(7888),t.K0=i.parse,i.parseParams,i.parseFmtpConfig,i.parsePayloads,i.parseRemoteCandidates,i.parseImageAttributes,i.parseSimulcastStreamList},456:(e,t,n)=>{var i=function(e){return String(Number(e))===e?Number(e):e},s=function(e,t,n){var s=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:s&&!t[e.name]&&(t[e.name]={});var o=e.push?{}:s?t[e.name]:t;!function(e,t,n,s){if(s&&!n)t[s]=i(e[1]);else for(var o=0;o<n.length;o+=1)null!=e[o+1]&&(t[n[o]]=i(e[o+1]))}(n.match(e.reg),o,e.names,e.name),e.push&&t[e.push].push(o)},o=n(1880),r=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},n=[],i=t;return e.split(/(\r\n|\r|\n)/).filter(r).forEach((function(e){var t=e[0],r=e.slice(2);"m"===t&&(n.push({rtp:[],fmtp:[]}),i=n[n.length-1]);for(var a=0;a<(o[t]||[]).length;a+=1){var c=o[t][a];if(c.reg.test(r))return s(c,i,r)}})),t.media=n,t};var a=function(e,t){var n=t.split(/=(.+)/,2);return 2===n.length?e[n[0]]=i(n[1]):1===n.length&&t.length>1&&(e[n[0]]=void 0),e};t.parseParams=function(e){return e.split(/;\s?/).reduce(a,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(i),s=0;s<n.length;s+=3)t.push({component:n[s],ip:n[s+1],port:n[s+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(a,{})}))},t.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var t,n=!1;return"~"!==e[0]?t=i(e):(t=i(e.substring(1,e.length)),n=!0),{scid:t,paused:n}}))}))}},7888:(e,t,n)=>{var i=n(1880),s=/%[sdv%]/g,o=function(e){var t=1,n=arguments,i=n.length;return e.replace(s,(function(e){if(t>=i)return e;var s=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(s);case"%d":return Number(s);case"%v":return""}}))},r=function(e,t,n){var i=[e+"="+(t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format)];if(t.names)for(var s=0;s<t.names.length;s+=1){var r=t.names[s];t.name?i.push(n[t.name][r]):i.push(n[t.names[s]])}else i.push(n[t.name]);return o.apply(null,i)},a=["v","o","s","i","u","e","p","c","b","t","r","z","a"],c=["i","c","b","a"];e.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var n=t.outerOrder||a,s=t.innerOrder||c,o=[];return n.forEach((function(t){i[t].forEach((function(n){n.name in e&&null!=e[n.name]?o.push(r(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){o.push(r(t,n,e))}))}))})),e.media.forEach((function(e){o.push(r("m",i.m[0],e)),s.forEach((function(t){i[t].forEach((function(n){n.name in e&&null!=e[n.name]?o.push(r(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){o.push(r(t,n,e))}))}))}))})),o.join("\r\n")+"\r\n"}},541:e=>{"use strict";const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((e=>e.trim()))},t.splitSections=function(e){return e.split("\nm=").map(((e,t)=>(t>0?"m="+e:e).trim()+"\r\n"))},t.getDescription=function(e){const n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){const n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter((e=>0===e.indexOf(n)))},t.parseCandidate=function(e){let t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");const n={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let e=8;e<t.length;e+=2)switch(t[e]){case"raddr":n.relatedAddress=t[e+1];break;case"rport":n.relatedPort=parseInt(t[e+1],10);break;case"tcptype":n.tcpType=t[e+1];break;case"ufrag":n.ufrag=t[e+1],n.usernameFragment=t[e+1];break;default:void 0===n[t[e]]&&(n[t[e]]=t[e+1])}return n},t.writeCandidate=function(e){const t=[];t.push(e.foundation);const n=e.component;"rtp"===n?t.push(1):"rtcp"===n?t.push(2):t.push(n),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);const i=e.type;return t.push("typ"),t.push(i),"host"!==i&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substring(14).split(" ")},t.parseRtpMap=function(e){let t=e.substring(9).split(" ");const n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){let t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);const n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){const t=e.substring(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1],attributes:t.slice(2).join(" ")}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+(e.attributes?" "+e.attributes:"")+"\r\n"},t.parseFmtp=function(e){const t={};let n;const i=e.substring(e.indexOf(" ")+1).split(";");for(let e=0;e<i.length;e++)n=i[e].trim().split("="),t[n[0].trim()]=n[1];return t},t.writeFmtp=function(e){let t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const i=[];Object.keys(e.parameters).forEach((t=>{void 0!==e.parameters[t]?i.push(t+"="+e.parameters[t]):i.push(t)})),t+="a=fmtp:"+n+" "+i.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){const t=e.substring(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){let t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((e=>{t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){const t=e.indexOf(" "),n={ssrc:parseInt(e.substring(7,t),10)},i=e.indexOf(":",t);return i>-1?(n.attribute=e.substring(t+1,i),n.value=e.substring(i+1)):n.attribute=e.substring(t+1),n},t.parseSsrcGroup=function(e){const t=e.substring(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((e=>parseInt(e,10)))}},t.getMid=function(e){const n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substring(6)},t.parseFingerprint=function(e){const t=e.substring(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){let n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((e=>{n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},t.parseCryptoLine=function(e){const t=e.substring(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;const t=e.substring(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){const i=t.matchPrefix(e+n,"a=ice-ufrag:")[0],s=t.matchPrefix(e+n,"a=ice-pwd:")[0];return i&&s?{usernameFragment:i.substring(12),password:s.substring(10)}:null},t.writeIceParameters=function(e){let t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){const n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=t.splitLines(e)[0].split(" ");n.profile=i[2];for(let s=3;s<i.length;s++){const o=i[s],r=t.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(r){const i=t.parseRtpMap(r),s=t.matchPrefix(e,"a=fmtp:"+o+" ");switch(i.parameters=s.length?t.parseFmtp(s[0]):{},i.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(t.parseRtcpFb),n.codecs.push(i),i.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(i.name.toUpperCase())}}}t.matchPrefix(e,"a=extmap:").forEach((e=>{n.headerExtensions.push(t.parseExtmap(e))}));const s=t.matchPrefix(e,"a=rtcp-fb:* ").map(t.parseRtcpFb);return n.codecs.forEach((e=>{s.forEach((t=>{e.rtcpFeedback.find((e=>e.type===t.type&&e.parameter===t.parameter))||e.rtcpFeedback.push(t)}))})),n},t.writeRtpDescription=function(e,n){let i="";i+="m="+e+" ",i+=n.codecs.length>0?"9":"0",i+=" "+(n.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=n.codecs.map((e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType)).join(" ")+"\r\n",i+="c=IN IP4 0.0.0.0\r\n",i+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach((e=>{i+=t.writeRtpMap(e),i+=t.writeFmtp(e),i+=t.writeRtcpFb(e)}));let s=0;return n.codecs.forEach((e=>{e.maxptime>s&&(s=e.maxptime)})),s>0&&(i+="a=maxptime:"+s+"\r\n"),n.headerExtensions&&n.headerExtensions.forEach((e=>{i+=t.writeExtmap(e)})),i},t.parseRtpEncodingParameters=function(e){const n=[],i=t.parseRtpParameters(e),s=-1!==i.fecMechanisms.indexOf("RED"),o=-1!==i.fecMechanisms.indexOf("ULPFEC"),r=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute)),a=r.length>0&&r[0].ssrc;let c;const l=t.matchPrefix(e,"a=ssrc-group:FID").map((e=>e.substring(17).split(" ").map((e=>parseInt(e,10)))));l.length>0&&l[0].length>1&&l[0][0]===a&&(c=l[0][1]),i.codecs.forEach((e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){let t={ssrc:a,codecPayloadType:parseInt(e.parameters.apt,10)};a&&c&&(t.rtx={ssrc:c}),n.push(t),s&&(t=JSON.parse(JSON.stringify(t)),t.fec={ssrc:a,mechanism:o?"red+ulpfec":"red"},n.push(t))}})),0===n.length&&a&&n.push({ssrc:a});let d=t.matchPrefix(e,"b=");return d.length&&(d=0===d[0].indexOf("b=TIAS:")?parseInt(d[0].substring(7),10):0===d[0].indexOf("b=AS:")?1e3*parseInt(d[0].substring(5),10)*.95-16e3:void 0,n.forEach((e=>{e.maxBitrate=d}))),n},t.parseRtcpParameters=function(e){const n={},i=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute))[0];i&&(n.cname=i.value,n.ssrc=i.ssrc);const s=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=s.length>0,n.compound=0===s.length;const o=t.matchPrefix(e,"a=rtcp-mux");return n.mux=o.length>0,n},t.writeRtcpParameters=function(e){let t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){let n;const i=t.matchPrefix(e,"a=msid:");if(1===i.length)return n=i[0].substring(7).split(" "),{stream:n[0],track:n[1]};const s=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"msid"===e.attribute));return s.length>0?(n=s[0].value.split(" "),{stream:n[0],track:n[1]}):void 0},t.parseSctpDescription=function(e){const n=t.parseMLine(e),i=t.matchPrefix(e,"a=max-message-size:");let s;i.length>0&&(s=parseInt(i[0].substring(19),10)),isNaN(s)&&(s=65536);const o=t.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:n.fmt,maxMessageSize:s};const r=t.matchPrefix(e,"a=sctpmap:");if(r.length>0){const e=r[0].substring(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:s}}},t.writeSctpDescription=function(e,t){let n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(e,n,i){let s;const o=void 0!==n?n:2;return s=e||t.generateSessionId(),"v=0\r\no="+(i||"thisisadapterortc")+" "+s+" "+o+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,n){const i=t.splitLines(e);for(let e=0;e<i.length;e++)switch(i[e]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[e].substring(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substring(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){const n=t.splitLines(e)[0].substring(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){const n=t.matchPrefix(e,"o=")[0].substring(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;const n=t.splitLines(e);for(let e=0;e<n.length;e++)if(n[e].length<2||"="!==n[e].charAt(1))return!1;return!0},e.exports=t},5764:(e,t,n)=>{"use strict";n.d(t,{c:()=>h});var i=n(1503),s=n.n(i),o=n(2416),r=n.n(o),a=n(5664),c=n.n(a),l=new URL(n(5600),n.b),d=r()(s()),u=c()(l);d.push([e.id,`/**\n * Swiper 11.0.6\n * Most modern mobile touch slider and framework with hardware accelerated transitions\n * https://swiperjs.com\n *\n * Copyright 2014-2024 Vladimir Kharlampidi\n *\n * Released under the MIT License\n *\n * Released on: February 5, 2024\n */\n\n/* FONT_START */\n@font-face {\n  font-family: 'swiper-icons';\n  src: url(${u});\n  font-weight: 400;\n  font-style: normal;\n}\n/* FONT_END */\n:root {\n  --swiper-theme-color: #007aff;\n  /*\n  --swiper-preloader-color: var(--swiper-theme-color);\n  --swiper-wrapper-transition-timing-function: initial;\n  */\n}\n:host {\n  position: relative;\n  display: block;\n  margin-left: auto;\n  margin-right: auto;\n  z-index: 1;\n}\n.swiper {\n  margin-left: auto;\n  margin-right: auto;\n  position: relative;\n  overflow: hidden;\n  list-style: none;\n  padding: 0;\n  /* Fix of Webkit flickering */\n  z-index: 1;\n  display: block;\n}\n.swiper-vertical > .swiper-wrapper {\n  flex-direction: column;\n}\n.swiper-wrapper {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  z-index: 1;\n  display: flex;\n  transition-property: transform;\n  transition-timing-function: var(--swiper-wrapper-transition-timing-function, initial);\n  box-sizing: content-box;\n}\n.swiper-android .swiper-slide,\n.swiper-ios .swiper-slide,\n.swiper-wrapper {\n  transform: translate3d(0px, 0, 0);\n}\n.swiper-horizontal {\n  touch-action: pan-y;\n}\n.swiper-vertical {\n  touch-action: pan-x;\n}\n.swiper-slide {\n  flex-shrink: 0;\n  width: 100%;\n  height: 100%;\n  position: relative;\n  transition-property: transform;\n  display: block;\n}\n.swiper-slide-invisible-blank {\n  visibility: hidden;\n}\n/* Auto Height */\n.swiper-autoheight,\n.swiper-autoheight .swiper-slide {\n  height: auto;\n}\n.swiper-autoheight .swiper-wrapper {\n  align-items: flex-start;\n  transition-property: transform, height;\n}\n.swiper-backface-hidden .swiper-slide {\n  transform: translateZ(0);\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n}\n/* 3D Effects */\n.swiper-3d.swiper-css-mode .swiper-wrapper {\n  perspective: 1200px;\n}\n.swiper-3d .swiper-wrapper {\n  transform-style: preserve-3d;\n}\n.swiper-3d {\n  perspective: 1200px;\n}\n.swiper-3d .swiper-slide,\n.swiper-3d .swiper-cube-shadow {\n  transform-style: preserve-3d;\n}\n/* CSS Mode */\n.swiper-css-mode > .swiper-wrapper {\n  overflow: auto;\n  scrollbar-width: none;\n  /* For Firefox */\n  -ms-overflow-style: none;\n  /* For Internet Explorer and Edge */\n}\n.swiper-css-mode > .swiper-wrapper::-webkit-scrollbar {\n  display: none;\n}\n.swiper-css-mode > .swiper-wrapper > .swiper-slide {\n  scroll-snap-align: start start;\n}\n.swiper-css-mode.swiper-horizontal > .swiper-wrapper {\n  scroll-snap-type: x mandatory;\n}\n.swiper-css-mode.swiper-vertical > .swiper-wrapper {\n  scroll-snap-type: y mandatory;\n}\n.swiper-css-mode.swiper-free-mode > .swiper-wrapper {\n  scroll-snap-type: none;\n}\n.swiper-css-mode.swiper-free-mode > .swiper-wrapper > .swiper-slide {\n  scroll-snap-align: none;\n}\n.swiper-css-mode.swiper-centered > .swiper-wrapper::before {\n  content: '';\n  flex-shrink: 0;\n  order: 9999;\n}\n.swiper-css-mode.swiper-centered > .swiper-wrapper > .swiper-slide {\n  scroll-snap-align: center center;\n  scroll-snap-stop: always;\n}\n.swiper-css-mode.swiper-centered.swiper-horizontal > .swiper-wrapper > .swiper-slide:first-child {\n  margin-inline-start: var(--swiper-centered-offset-before);\n}\n.swiper-css-mode.swiper-centered.swiper-horizontal > .swiper-wrapper::before {\n  height: 100%;\n  min-height: 1px;\n  width: var(--swiper-centered-offset-after);\n}\n.swiper-css-mode.swiper-centered.swiper-vertical > .swiper-wrapper > .swiper-slide:first-child {\n  margin-block-start: var(--swiper-centered-offset-before);\n}\n.swiper-css-mode.swiper-centered.swiper-vertical > .swiper-wrapper::before {\n  width: 100%;\n  min-width: 1px;\n  height: var(--swiper-centered-offset-after);\n}\n/* Slide styles start */\n/* 3D Shadows */\n.swiper-3d .swiper-slide-shadow,\n.swiper-3d .swiper-slide-shadow-left,\n.swiper-3d .swiper-slide-shadow-right,\n.swiper-3d .swiper-slide-shadow-top,\n.swiper-3d .swiper-slide-shadow-bottom,\n.swiper-3d .swiper-slide-shadow,\n.swiper-3d .swiper-slide-shadow-left,\n.swiper-3d .swiper-slide-shadow-right,\n.swiper-3d .swiper-slide-shadow-top,\n.swiper-3d .swiper-slide-shadow-bottom {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  pointer-events: none;\n  z-index: 10;\n}\n.swiper-3d .swiper-slide-shadow {\n  background: rgba(0, 0, 0, 0.15);\n}\n.swiper-3d .swiper-slide-shadow-left {\n  background-image: linear-gradient(to left, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0));\n}\n.swiper-3d .swiper-slide-shadow-right {\n  background-image: linear-gradient(to right, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0));\n}\n.swiper-3d .swiper-slide-shadow-top {\n  background-image: linear-gradient(to top, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0));\n}\n.swiper-3d .swiper-slide-shadow-bottom {\n  background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0));\n}\n.swiper-lazy-preloader {\n  width: 42px;\n  height: 42px;\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  margin-left: -21px;\n  margin-top: -21px;\n  z-index: 10;\n  transform-origin: 50%;\n  box-sizing: border-box;\n  border: 4px solid var(--swiper-preloader-color, var(--swiper-theme-color));\n  border-radius: 50%;\n  border-top-color: transparent;\n}\n.swiper:not(.swiper-watch-progress) .swiper-lazy-preloader,\n.swiper-watch-progress .swiper-slide-visible .swiper-lazy-preloader {\n  animation: swiper-preloader-spin 1s infinite linear;\n}\n.swiper-lazy-preloader-white {\n  --swiper-preloader-color: #fff;\n}\n.swiper-lazy-preloader-black {\n  --swiper-preloader-color: #000;\n}\n@keyframes swiper-preloader-spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n/* Slide styles end */\n.swiper-virtual .swiper-slide {\n  -webkit-backface-visibility: hidden;\n  transform: translateZ(0);\n}\n.swiper-virtual.swiper-css-mode .swiper-wrapper::after {\n  content: '';\n  position: absolute;\n  left: 0;\n  top: 0;\n  pointer-events: none;\n}\n.swiper-virtual.swiper-css-mode.swiper-horizontal .swiper-wrapper::after {\n  height: 1px;\n  width: var(--swiper-virtual-size);\n}\n.swiper-virtual.swiper-css-mode.swiper-vertical .swiper-wrapper::after {\n  width: 1px;\n  height: var(--swiper-virtual-size);\n}\n:root {\n  --swiper-navigation-size: 44px;\n  /*\n  --swiper-navigation-top-offset: 50%;\n  --swiper-navigation-sides-offset: 10px;\n  --swiper-navigation-color: var(--swiper-theme-color);\n  */\n}\n.swiper-button-prev,\n.swiper-button-next {\n  position: absolute;\n  top: var(--swiper-navigation-top-offset, 50%);\n  width: calc(var(--swiper-navigation-size) / 44 * 27);\n  height: var(--swiper-navigation-size);\n  margin-top: calc(0px - (var(--swiper-navigation-size) / 2));\n  z-index: 10;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: var(--swiper-navigation-color, var(--swiper-theme-color));\n}\n.swiper-button-prev.swiper-button-disabled,\n.swiper-button-next.swiper-button-disabled {\n  opacity: 0.35;\n  cursor: auto;\n  pointer-events: none;\n}\n.swiper-button-prev.swiper-button-hidden,\n.swiper-button-next.swiper-button-hidden {\n  opacity: 0;\n  cursor: auto;\n  pointer-events: none;\n}\n.swiper-navigation-disabled .swiper-button-prev,\n.swiper-navigation-disabled .swiper-button-next {\n  display: none !important;\n}\n.swiper-button-prev svg,\n.swiper-button-next svg {\n  width: 100%;\n  height: 100%;\n  object-fit: contain;\n  transform-origin: center;\n}\n.swiper-rtl .swiper-button-prev svg,\n.swiper-rtl .swiper-button-next svg {\n  transform: rotate(180deg);\n}\n.swiper-button-prev,\n.swiper-rtl .swiper-button-next {\n  left: var(--swiper-navigation-sides-offset, 10px);\n  right: auto;\n}\n.swiper-button-next,\n.swiper-rtl .swiper-button-prev {\n  right: var(--swiper-navigation-sides-offset, 10px);\n  left: auto;\n}\n.swiper-button-lock {\n  display: none;\n}\n/* Navigation font start */\n.swiper-button-prev:after,\n.swiper-button-next:after {\n  font-family: swiper-icons;\n  font-size: var(--swiper-navigation-size);\n  text-transform: none !important;\n  letter-spacing: 0;\n  font-variant: initial;\n  line-height: 1;\n}\n.swiper-button-prev:after,\n.swiper-rtl .swiper-button-next:after {\n  content: 'prev';\n}\n.swiper-button-next,\n.swiper-rtl .swiper-button-prev {\n  right: var(--swiper-navigation-sides-offset, 10px);\n  left: auto;\n}\n.swiper-button-next:after,\n.swiper-rtl .swiper-button-prev:after {\n  content: 'next';\n}\n/* Navigation font end */\n:root {\n  /*\n  --swiper-pagination-color: var(--swiper-theme-color);\n  --swiper-pagination-left: auto;\n  --swiper-pagination-right: 8px;\n  --swiper-pagination-bottom: 8px;\n  --swiper-pagination-top: auto;\n  --swiper-pagination-fraction-color: inherit;\n  --swiper-pagination-progressbar-bg-color: rgba(0,0,0,0.25);\n  --swiper-pagination-progressbar-size: 4px;\n  --swiper-pagination-bullet-size: 8px;\n  --swiper-pagination-bullet-width: 8px;\n  --swiper-pagination-bullet-height: 8px;\n  --swiper-pagination-bullet-border-radius: 50%;\n  --swiper-pagination-bullet-inactive-color: #000;\n  --swiper-pagination-bullet-inactive-opacity: 0.2;\n  --swiper-pagination-bullet-opacity: 1;\n  --swiper-pagination-bullet-horizontal-gap: 4px;\n  --swiper-pagination-bullet-vertical-gap: 6px;\n  */\n}\n.swiper-pagination {\n  position: absolute;\n  text-align: center;\n  transition: 300ms opacity;\n  transform: translate3d(0, 0, 0);\n  z-index: 10;\n}\n.swiper-pagination.swiper-pagination-hidden {\n  opacity: 0;\n}\n.swiper-pagination-disabled > .swiper-pagination,\n.swiper-pagination.swiper-pagination-disabled {\n  display: none !important;\n}\n/* Common Styles */\n.swiper-pagination-fraction,\n.swiper-pagination-custom,\n.swiper-horizontal > .swiper-pagination-bullets,\n.swiper-pagination-bullets.swiper-pagination-horizontal {\n  bottom: var(--swiper-pagination-bottom, 8px);\n  top: var(--swiper-pagination-top, auto);\n  left: 0;\n  width: 100%;\n}\n/* Bullets */\n.swiper-pagination-bullets-dynamic {\n  overflow: hidden;\n  font-size: 0;\n}\n.swiper-pagination-bullets-dynamic .swiper-pagination-bullet {\n  transform: scale(0.33);\n  position: relative;\n}\n.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active {\n  transform: scale(1);\n}\n.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-main {\n  transform: scale(1);\n}\n.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-prev {\n  transform: scale(0.66);\n}\n.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-prev-prev {\n  transform: scale(0.33);\n}\n.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-next {\n  transform: scale(0.66);\n}\n.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-next-next {\n  transform: scale(0.33);\n}\n.swiper-pagination-bullet {\n  width: var(--swiper-pagination-bullet-width, var(--swiper-pagination-bullet-size, 8px));\n  height: var(--swiper-pagination-bullet-height, var(--swiper-pagination-bullet-size, 8px));\n  display: inline-block;\n  border-radius: var(--swiper-pagination-bullet-border-radius, 50%);\n  background: var(--swiper-pagination-bullet-inactive-color, #000);\n  opacity: var(--swiper-pagination-bullet-inactive-opacity, 0.2);\n}\nbutton.swiper-pagination-bullet {\n  border: none;\n  margin: 0;\n  padding: 0;\n  box-shadow: none;\n  -webkit-appearance: none;\n          appearance: none;\n}\n.swiper-pagination-clickable .swiper-pagination-bullet {\n  cursor: pointer;\n}\n.swiper-pagination-bullet:only-child {\n  display: none !important;\n}\n.swiper-pagination-bullet-active {\n  opacity: var(--swiper-pagination-bullet-opacity, 1);\n  background: var(--swiper-pagination-color, var(--swiper-theme-color));\n}\n.swiper-vertical > .swiper-pagination-bullets,\n.swiper-pagination-vertical.swiper-pagination-bullets {\n  right: var(--swiper-pagination-right, 8px);\n  left: var(--swiper-pagination-left, auto);\n  top: 50%;\n  transform: translate3d(0px, -50%, 0);\n}\n.swiper-vertical > .swiper-pagination-bullets .swiper-pagination-bullet,\n.swiper-pagination-vertical.swiper-pagination-bullets .swiper-pagination-bullet {\n  margin: var(--swiper-pagination-bullet-vertical-gap, 6px) 0;\n  display: block;\n}\n.swiper-vertical > .swiper-pagination-bullets.swiper-pagination-bullets-dynamic,\n.swiper-pagination-vertical.swiper-pagination-bullets.swiper-pagination-bullets-dynamic {\n  top: 50%;\n  transform: translateY(-50%);\n  width: 8px;\n}\n.swiper-vertical > .swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet,\n.swiper-pagination-vertical.swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet {\n  display: inline-block;\n  transition: 200ms transform,\n        200ms top;\n}\n.swiper-horizontal > .swiper-pagination-bullets .swiper-pagination-bullet,\n.swiper-pagination-horizontal.swiper-pagination-bullets .swiper-pagination-bullet {\n  margin: 0 var(--swiper-pagination-bullet-horizontal-gap, 4px);\n}\n.swiper-horizontal > .swiper-pagination-bullets.swiper-pagination-bullets-dynamic,\n.swiper-pagination-horizontal.swiper-pagination-bullets.swiper-pagination-bullets-dynamic {\n  left: 50%;\n  transform: translateX(-50%);\n  white-space: nowrap;\n}\n.swiper-horizontal > .swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet,\n.swiper-pagination-horizontal.swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet {\n  transition: 200ms transform,\n        200ms left;\n}\n.swiper-horizontal.swiper-rtl > .swiper-pagination-bullets-dynamic .swiper-pagination-bullet {\n  transition: 200ms transform,\n    200ms right;\n}\n/* Fraction */\n.swiper-pagination-fraction {\n  color: var(--swiper-pagination-fraction-color, inherit);\n}\n/* Progress */\n.swiper-pagination-progressbar {\n  background: var(--swiper-pagination-progressbar-bg-color, rgba(0, 0, 0, 0.25));\n  position: absolute;\n}\n.swiper-pagination-progressbar .swiper-pagination-progressbar-fill {\n  background: var(--swiper-pagination-color, var(--swiper-theme-color));\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  transform: scale(0);\n  transform-origin: left top;\n}\n.swiper-rtl .swiper-pagination-progressbar .swiper-pagination-progressbar-fill {\n  transform-origin: right top;\n}\n.swiper-horizontal > .swiper-pagination-progressbar,\n.swiper-pagination-progressbar.swiper-pagination-horizontal,\n.swiper-vertical > .swiper-pagination-progressbar.swiper-pagination-progressbar-opposite,\n.swiper-pagination-progressbar.swiper-pagination-vertical.swiper-pagination-progressbar-opposite {\n  width: 100%;\n  height: var(--swiper-pagination-progressbar-size, 4px);\n  left: 0;\n  top: 0;\n}\n.swiper-vertical > .swiper-pagination-progressbar,\n.swiper-pagination-progressbar.swiper-pagination-vertical,\n.swiper-horizontal > .swiper-pagination-progressbar.swiper-pagination-progressbar-opposite,\n.swiper-pagination-progressbar.swiper-pagination-horizontal.swiper-pagination-progressbar-opposite {\n  width: var(--swiper-pagination-progressbar-size, 4px);\n  height: 100%;\n  left: 0;\n  top: 0;\n}\n.swiper-pagination-lock {\n  display: none;\n}\n:root {\n  /*\n  --swiper-scrollbar-border-radius: 10px;\n  --swiper-scrollbar-top: auto;\n  --swiper-scrollbar-bottom: 4px;\n  --swiper-scrollbar-left: auto;\n  --swiper-scrollbar-right: 4px;\n  --swiper-scrollbar-sides-offset: 1%;\n  --swiper-scrollbar-bg-color: rgba(0, 0, 0, 0.1);\n  --swiper-scrollbar-drag-bg-color: rgba(0, 0, 0, 0.5);\n  --swiper-scrollbar-size: 4px;\n  */\n}\n.swiper-scrollbar {\n  border-radius: var(--swiper-scrollbar-border-radius, 10px);\n  position: relative;\n  touch-action: none;\n  background: var(--swiper-scrollbar-bg-color, rgba(0, 0, 0, 0.1));\n}\n.swiper-scrollbar-disabled > .swiper-scrollbar,\n.swiper-scrollbar.swiper-scrollbar-disabled {\n  display: none !important;\n}\n.swiper-horizontal > .swiper-scrollbar,\n.swiper-scrollbar.swiper-scrollbar-horizontal {\n  position: absolute;\n  left: var(--swiper-scrollbar-sides-offset, 1%);\n  bottom: var(--swiper-scrollbar-bottom, 4px);\n  top: var(--swiper-scrollbar-top, auto);\n  z-index: 50;\n  height: var(--swiper-scrollbar-size, 4px);\n  width: calc(100% - 2 * var(--swiper-scrollbar-sides-offset, 1%));\n}\n.swiper-vertical > .swiper-scrollbar,\n.swiper-scrollbar.swiper-scrollbar-vertical {\n  position: absolute;\n  left: var(--swiper-scrollbar-left, auto);\n  right: var(--swiper-scrollbar-right, 4px);\n  top: var(--swiper-scrollbar-sides-offset, 1%);\n  z-index: 50;\n  width: var(--swiper-scrollbar-size, 4px);\n  height: calc(100% - 2 * var(--swiper-scrollbar-sides-offset, 1%));\n}\n.swiper-scrollbar-drag {\n  height: 100%;\n  width: 100%;\n  position: relative;\n  background: var(--swiper-scrollbar-drag-bg-color, rgba(0, 0, 0, 0.5));\n  border-radius: var(--swiper-scrollbar-border-radius, 10px);\n  left: 0;\n  top: 0;\n}\n.swiper-scrollbar-cursor-drag {\n  cursor: move;\n}\n.swiper-scrollbar-lock {\n  display: none;\n}\n/* Zoom container styles start */\n.swiper-zoom-container {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  text-align: center;\n}\n.swiper-zoom-container > img,\n.swiper-zoom-container > svg,\n.swiper-zoom-container > canvas {\n  max-width: 100%;\n  max-height: 100%;\n  object-fit: contain;\n}\n/* Zoom container styles end */\n.swiper-slide-zoomed {\n  cursor: move;\n  touch-action: none;\n}\n/* a11y */\n.swiper .swiper-notification {\n  position: absolute;\n  left: 0;\n  top: 0;\n  pointer-events: none;\n  opacity: 0;\n  z-index: -1000;\n}\n.swiper-free-mode > .swiper-wrapper {\n  transition-timing-function: ease-out;\n  margin: 0 auto;\n}\n.swiper-grid > .swiper-wrapper {\n  flex-wrap: wrap;\n}\n.swiper-grid-column > .swiper-wrapper {\n  flex-wrap: wrap;\n  flex-direction: column;\n}\n.swiper-fade.swiper-free-mode .swiper-slide {\n  transition-timing-function: ease-out;\n}\n.swiper-fade .swiper-slide {\n  pointer-events: none;\n  transition-property: opacity;\n}\n.swiper-fade .swiper-slide .swiper-slide {\n  pointer-events: none;\n}\n.swiper-fade .swiper-slide-active {\n  pointer-events: auto;\n}\n.swiper-fade .swiper-slide-active .swiper-slide-active {\n  pointer-events: auto;\n}\n.swiper-cube {\n  overflow: visible;\n}\n.swiper-cube .swiper-slide {\n  pointer-events: none;\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n  z-index: 1;\n  visibility: hidden;\n  transform-origin: 0 0;\n  width: 100%;\n  height: 100%;\n}\n.swiper-cube .swiper-slide .swiper-slide {\n  pointer-events: none;\n}\n.swiper-cube.swiper-rtl .swiper-slide {\n  transform-origin: 100% 0;\n}\n.swiper-cube .swiper-slide-active,\n.swiper-cube .swiper-slide-active .swiper-slide-active {\n  pointer-events: auto;\n}\n.swiper-cube .swiper-slide-active,\n.swiper-cube .swiper-slide-next,\n.swiper-cube .swiper-slide-prev {\n  pointer-events: auto;\n  visibility: visible;\n}\n.swiper-cube .swiper-cube-shadow {\n  position: absolute;\n  left: 0;\n  bottom: 0px;\n  width: 100%;\n  height: 100%;\n  opacity: 0.6;\n  z-index: 0;\n}\n.swiper-cube .swiper-cube-shadow:before {\n  content: '';\n  background: #000;\n  position: absolute;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  filter: blur(50px);\n}\n.swiper-cube .swiper-slide-next + .swiper-slide {\n  pointer-events: auto;\n  visibility: visible;\n}\n/* Cube slide shadows start */\n.swiper-cube .swiper-slide-shadow-cube.swiper-slide-shadow-top,\n.swiper-cube .swiper-slide-shadow-cube.swiper-slide-shadow-bottom,\n.swiper-cube .swiper-slide-shadow-cube.swiper-slide-shadow-left,\n.swiper-cube .swiper-slide-shadow-cube.swiper-slide-shadow-right {\n  z-index: 0;\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n}\n/* Cube slide shadows end */\n.swiper-flip {\n  overflow: visible;\n}\n.swiper-flip .swiper-slide {\n  pointer-events: none;\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n  z-index: 1;\n}\n.swiper-flip .swiper-slide .swiper-slide {\n  pointer-events: none;\n}\n.swiper-flip .swiper-slide-active,\n.swiper-flip .swiper-slide-active .swiper-slide-active {\n  pointer-events: auto;\n}\n/* Flip slide shadows start */\n.swiper-flip .swiper-slide-shadow-flip.swiper-slide-shadow-top,\n.swiper-flip .swiper-slide-shadow-flip.swiper-slide-shadow-bottom,\n.swiper-flip .swiper-slide-shadow-flip.swiper-slide-shadow-left,\n.swiper-flip .swiper-slide-shadow-flip.swiper-slide-shadow-right {\n  z-index: 0;\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n}\n/* Flip slide shadows end */\n.swiper-creative .swiper-slide {\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n  overflow: hidden;\n  transition-property: transform, opacity, height;\n}\n.swiper-cards {\n  overflow: visible;\n}\n.swiper-cards .swiper-slide {\n  transform-origin: center bottom;\n  -webkit-backface-visibility: hidden;\n          backface-visibility: hidden;\n  overflow: hidden;\n}\n`,""]);const h=d},4596:e=>{"use strict";var t=[];function n(e){for(var n=-1,i=0;i<t.length;i++)if(t[i].identifier===e){n=i;break}return n}function i(e,i){for(var o={},r=[],a=0;a<e.length;a++){var c=e[a],l=i.base?c[0]+i.base:c[0],d=o[l]||0,u="".concat(l," ").concat(d);o[l]=d+1;var h=n(u),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==h)t[h].references++,t[h].updater(p);else{var m=s(p,i);i.byIndex=a,t.splice(a,0,{identifier:u,updater:m,references:1})}r.push(u)}return r}function s(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,s){var o=i(e=e||[],s=s||{});return function(e){e=e||[];for(var r=0;r<o.length;r++){var a=n(o[r]);t[a].references--}for(var c=i(e,s),l=0;l<o.length;l++){var d=n(o[l]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}o=c}}},6176:e=>{"use strict";var t={};e.exports=function(e,n){var i=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},6808:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},5120:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},6520:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var s=void 0!==n.layer;s&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,s&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},1936:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},5600:e=>{"use strict";e.exports="data:application/font-woff;charset=utf-8;base64, d09GRgABAAAAAAZgABAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAGRAAAABoAAAAci6qHkUdERUYAAAWgAAAAIwAAACQAYABXR1BPUwAABhQAAAAuAAAANuAY7+xHU1VCAAAFxAAAAFAAAABm2fPczU9TLzIAAAHcAAAASgAAAGBP9V5RY21hcAAAAkQAAACIAAABYt6F0cBjdnQgAAACzAAAAAQAAAAEABEBRGdhc3AAAAWYAAAACAAAAAj//wADZ2x5ZgAAAywAAADMAAAD2MHtryVoZWFkAAABbAAAADAAAAA2E2+eoWhoZWEAAAGcAAAAHwAAACQC9gDzaG10eAAAAigAAAAZAAAArgJkABFsb2NhAAAC0AAAAFoAAABaFQAUGG1heHAAAAG8AAAAHwAAACAAcABAbmFtZQAAA/gAAAE5AAACXvFdBwlwb3N0AAAFNAAAAGIAAACE5s74hXjaY2BkYGAAYpf5Hu/j+W2+MnAzMYDAzaX6QjD6/4//Bxj5GA8AuRwMYGkAPywL13jaY2BkYGA88P8Agx4j+/8fQDYfA1AEBWgDAIB2BOoAeNpjYGRgYNBh4GdgYgABEMnIABJzYNADCQAACWgAsQB42mNgYfzCOIGBlYGB0YcxjYGBwR1Kf2WQZGhhYGBiYGVmgAFGBiQQkOaawtDAoMBQxXjg/wEGPcYDDA4wNUA2CCgwsAAAO4EL6gAAeNpj2M0gyAACqxgGNWBkZ2D4/wMA+xkDdgAAAHjaY2BgYGaAYBkGRgYQiAHyGMF8FgYHIM3DwMHABGQrMOgyWDLEM1T9/w8UBfEMgLzE////P/5//f/V/xv+r4eaAAeMbAxwIUYmIMHEgKYAYjUcsDAwsLKxc3BycfPw8jEQA/gZBASFhEVExcQlJKWkZWTl5BUUlZRVVNXUNTQZBgMAAMR+E+gAEQFEAAAAKgAqACoANAA+AEgAUgBcAGYAcAB6AIQAjgCYAKIArAC2AMAAygDUAN4A6ADyAPwBBgEQARoBJAEuATgBQgFMAVYBYAFqAXQBfgGIAZIBnAGmAbIBzgHsAAB42u2NMQ6CUAyGW568x9AneYYgm4MJbhKFaExIOAVX8ApewSt4Bic4AfeAid3VOBixDxfPYEza5O+Xfi04YADggiUIULCuEJK8VhO4bSvpdnktHI5QCYtdi2sl8ZnXaHlqUrNKzdKcT8cjlq+rwZSvIVczNiezsfnP/uznmfPFBNODM2K7MTQ45YEAZqGP81AmGGcF3iPqOop0r1SPTaTbVkfUe4HXj97wYE+yNwWYxwWu4v1ugWHgo3S1XdZEVqWM7ET0cfnLGxWfkgR42o2PvWrDMBSFj/IHLaF0zKjRgdiVMwScNRAoWUoH78Y2icB/yIY09An6AH2Bdu/UB+yxopYshQiEvnvu0dURgDt8QeC8PDw7Fpji3fEA4z/PEJ6YOB5hKh4dj3EvXhxPqH/SKUY3rJ7srZ4FZnh1PMAtPhwP6fl2PMJMPDgeQ4rY8YT6Gzao0eAEA409DuggmTnFnOcSCiEiLMgxCiTI6Cq5DZUd3Qmp10vO0LaLTd2cjN4fOumlc7lUYbSQcZFkutRG7g6JKZKy0RmdLY680CDnEJ+UMkpFFe1RN7nxdVpXrC4aTtnaurOnYercZg2YVmLN/d/gczfEimrE/fs/bOuq29Zmn8tloORaXgZgGa78yO9/cnXm2BpaGvq25Dv9S4E9+5SIc9PqupJKhYFSSl47+Qcr1mYNAAAAeNptw0cKwkAAAMDZJA8Q7OUJvkLsPfZ6zFVERPy8qHh2YER+3i/BP83vIBLLySsoKimrqKqpa2hp6+jq6RsYGhmbmJqZSy0sraxtbO3sHRydnEMU4uR6yx7JJXveP7WrDycAAAAAAAH//wACeNpjYGRgYOABYhkgZgJCZgZNBkYGLQZtIJsFLMYAAAw3ALgAeNolizEKgDAQBCchRbC2sFER0YD6qVQiBCv/H9ezGI6Z5XBAw8CBK/m5iQQVauVbXLnOrMZv2oLdKFa8Pjuru2hJzGabmOSLzNMzvutpB3N42mNgZGBg4GKQYzBhYMxJLMlj4GBgAYow/P/PAJJhLM6sSoWKfWCAAwDAjgbRAAB42mNgYGBkAIIbCZo5IPrmUn0hGA0AO8EFTQAA"},3706:e=>{"use strict";e.exports=JSON.parse('{"name":"axios","version":"0.21.4","description":"Promise based HTTP client for the browser and node.js","main":"index.js","scripts":{"test":"grunt test","start":"node ./sandbox/server.js","build":"NODE_ENV=production grunt build","preversion":"npm test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json","postversion":"git push && git push --tags","examples":"node ./examples/server.js","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","fix":"eslint --fix lib/**/*.js"},"repository":{"type":"git","url":"https://github.com/axios/axios.git"},"keywords":["xhr","http","ajax","promise","node"],"author":"Matt Zabriskie","license":"MIT","bugs":{"url":"https://github.com/axios/axios/issues"},"homepage":"https://axios-http.com","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"jsdelivr":"dist/axios.min.js","unpkg":"dist/axios.min.js","typings":"./index.d.ts","dependencies":{"follow-redirects":"^1.14.0"},"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}]}')}},t={};function n(i){var s=t[i];if(void 0!==s)return s.exports;var o=t[i]={id:i,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.b=document.baseURI||self.location.href,n.nc=void 0,(()=>{"use strict";var e={};n.r(e),n.d(e,{requestAnimationFrame:()=>ps,setTimeout:()=>ls});var t={};n.r(t),n.d(t,{requestAnimationFrame:()=>gs,setTimeout:()=>ms});var i={};n.r(i),n.d(i,{fixNegotiationNeeded:()=>gc,shimAddTrackRemoveTrack:()=>mc,shimAddTrackRemoveTrackWithNative:()=>pc,shimGetDisplayMedia:()=>ac,shimGetSendersWithDtmf:()=>dc,shimGetStats:()=>uc,shimGetUserMedia:()=>rc,shimMediaStream:()=>cc,shimOnTrack:()=>lc,shimPeerConnection:()=>wc,shimSenderReceiverGetStats:()=>hc});var s={};n.r(s),n.d(s,{shimAddTransceiver:()=>kc,shimCreateAnswer:()=>Ic,shimCreateOffer:()=>Tc,shimGetDisplayMedia:()=>vc,shimGetParameters:()=>Mc,shimGetUserMedia:()=>fc,shimOnTrack:()=>_c,shimPeerConnection:()=>yc,shimRTCDataChannel:()=>xc,shimReceiverGetStats:()=>Sc,shimRemoveStream:()=>Ec,shimSenderGetStats:()=>Cc});var o={};n.r(o),n.d(o,{shimAudioContext:()=>Fc,shimCallbacksAPI:()=>Lc,shimConstraints:()=>Dc,shimCreateOfferLegacy:()=>Bc,shimGetUserMedia:()=>Pc,shimLocalStreamsAPI:()=>Ac,shimRTCIceServerUrls:()=>Nc,shimRemoteStreamsAPI:()=>$c,shimTrackEventTransceiver:()=>Oc});var r={};n.r(r),n.d(r,{removeExtmapAllowMixed:()=>Wc,shimAddIceCandidateNullOrEmpty:()=>Jc,shimConnectionState:()=>zc,shimMaxMessageSize:()=>qc,shimParameterlessSetLocalDescription:()=>Yc,shimRTCIceCandidate:()=>Vc,shimRTCIceCandidateRelayProtocol:()=>Gc,shimSendThrowTypeError:()=>Hc});var a={};n.r(a),n.d(a,{c:()=>Pd});var c=n(436),l=n.n(c);function d(e,t,n){const i=new Date;i.setDate(i.getDate()+n);const s=`${e}=${t}; expires=${i.toUTCString()}; path=/`;document.cookie=s}function u(e){const t=`${e}=`,n=document.cookie.split(";");for(let e=0;e<n.length;e+=1){let i=n[e];for(;" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(t))return i.substring(t.length,i.length)}return""}function h(e){d(e,"",-1)}class p{constructor(){this.analyticId="",this.acsServer="",this.anyCharRegex="",this.api="",this.apiServer="",this.assets="",this.atRegex="",this.audioRequestCollaboration="",this.audioTimeIsRunningOut="",this.audioSessionError="",this.authToken="",this.channel="",this.clientType="",this.config={},this.csmChannelEnable=!1,this.csmRoomEnable=!1,this.csmSpa="",this.deviceId="",this.email="",this.emoticons="",this.emoticonRegex="",this.engineNick="",this.feedSpa="",this.filesBaseUrl="",this.fullName="",this.getCommentRegex="",this.google_sigin=!1,this.groupColor="",this.guest=!1,this.hashTagRegex="",this.invite=null,this.ip="",this.irmServers=[],this.janusServer=[],this.lives=0,this.mailRegex="",this.masHttpUrl="",this.masUrl="",this.metarverseFixed=[],this.metaverseChannelEnable=!1,this.metaverseEphemeralEnable=!1,this.metaverseIdleTimeout=36e5,this.metaverseMaxRooms=0,this.metaverseRoomEnable=!1,this.metaverseRooms=[],this.mobile=!1,this.msgDropRate=200,this.msgPerDay=-1,this.multRealm=!1,this._name="",this.navigatorData="",this.nick="",this.password="",this.permissions={},this.platforms="",this.ppcsServer="",this.realm="",this.realmFavicon="",this.realmLogo="",this.realmName="",this.role="",this.room={},this.roomServer="",this.roomsList=[],this.roomsCategoriesFilter=[],this.roomsCategoriesList=[],this.roomsCategoriesListIds=[],this.roomsSelectedFilter="-1",this.selectedRealm="",this.selectedRoom="",this.session="",this.title="",this.tmsSpa="",this.token="",this.ts=0,this.tsDiff=0,this.urlRegex="",this.userData="",this.version="",this.websocketUrl="",this.webviewUrl=""}static set ACS_SERVER(e){this.acsServer=e}static get ACS_SERVER(){return this.acsServer}static set ANALYTIC_ID(e){this.analyticId=e}static get ANALYTIC_ID(){return this.analyticId}static set ANY_CHAR_REGEX(e){this.anyCharRegex=e}static get ANY_CHAR_REGEX(){return this.anyCharRegex}static set API(e){this.api=e}static get API(){return this.api}static set API_SERVER(e){this.apiServer=e}static get API_SERVER(){return this.apiServer}static set ASSETS(e){this.assets=e}static get ASSETS(){return this.assets}static set AT_REGEX(e){this.atRegex=e}static get AT_REGEX(){return this.atRegex}static set AUDIO_REQUEST_COLLABORATION(e){this.audioRequestCollaboration=e}static get AUDIO_REQUEST_COLLABORATION(){return this.audioRequestCollaboration}static set AUDIO_TIME_IS_RUNNING_OUT(e){this.audioTimeIsRunningOut=e}static get AUDIO_TIME_IS_RUNNING_OUT(){return this.audioTimeIsRunningOut}static set AUDIO_SESSION_ERROR(e){this.audioSessionError=e}static get AUDIO_SESSION_ERROR(){return this.audioSessionError}static set AUTH_TOKEN(e){this.authToken=e}static get AUTH_TOKEN(){return this.authToken}static set CHANNEL(e){this.channel=e}static get CHANNEL(){return this.channel}static set CLIENT_TYPE(e){this.clientType=e}static get CLIENT_TYPE(){return this.clientType}static set CONFIG(e){this.config=e}static get CONFIG(){return this.config}static set CSM_CHANNEL_ENABLE(e){this.csmChannelEnable=e}static get CSM_CHANNEL_ENABLE(){return this.csmChannelEnable}static set CSM_ROOM_ENABLE(e){this.csmRoomEnable=e}static get CSM_ROOM_ENABLE(){return this.csmRoomEnable}static set CSM_SPA(e){this.csmSpa=e}static get CSM_SPA(){return this.csmSpa}static set DEVICE_ID(e){this.deviceId=e}static get DEVICE_ID(){return this.deviceId}static set EMAIL(e){this.email=e}static get EMAIL(){return this.email}static set EMOTICONS(e){this.emoticons=e}static get EMOTICONS(){return this.emoticons}static set EMOTICON_REGEX(e){this.emoticonRegex=e}static get EMOTICON_REGEX(){return this.emoticonRegex}static set ENGINE_NICK(e){this.engineNick=e}static get ENGINE_NICK(){return this.engineNick}static set FEED_SPA(e){this.feedSpa=e}static get FEED_SPA(){return this.feedSpa}static set FILES_BASE_URL(e){this.filesBaseUrl=e}static get FILES_BASE_URL(){return this.filesBaseUrl}static set FULLNAME(e){this.fullName=e}static get FULLNAME(){return this.fullName}static set GET_COMMENT_REGEX(e){this.getCommentRegex=e}static get GET_COMMENT_REGEX(){return this.getCommentRegex}static set GOOGLE_SIGNIN(e){this.google_sigin=e}static get GOOGLE_SIGNIN(){return this.google_sigin}static set GROUP_COLOR(e){this.groupColor=e}static get GROUP_COLOR(){return this.groupColor}static set GUEST(e){this.guest=e}static get GUEST(){return this.guest}static set HASHTAG_REGEX(e){this.hashTagRegex=e}static get HASHTAG_REGEX(){return this.hashTagRegex}static set INVITE(e){this.invite=e}static get INVITE(){return this.invite}static set IP(e){this.ip=e}static get IP(){return this.ip}static set IRM_SERVERS(e){this.irmServers=e}static get IRM_SERVERS(){return this.irmServers}static set JANUS_SERVER(e){this.janusServer=e}static get JANUS_SERVER(){return this.janusServer}static set LIVES(e){this.lives=e}static get LIVES(){return this.lives}static set MAIL_REGEX(e){this.mailRegex=e}static get MAIL_REGEX(){return this.mailRegex}static set MAS_HTTP_URL(e){this.masHttpUrl=e}static get MAS_HTTP_URL(){return this.masHttpUrl}static set MAS_URL(e){this.masUrl=e}static get MAS_URL(){return this.masUrl}static set METAVERSE_FIXED(e){this.metaverseFixed=e}static get METAVERSE_FIXED(){return this.metaverseFixed}static set METAVERSE_EPHEMERAL_ENABLE(e){this.metaverseEphemeralEnable=e}static get METAVERSE_EPHEMERAL_ENABLE(){return this.metaverseEphemeralEnable}static set METAVERSE_CHANNEL_ENABLE(e){this.metaverseChannelEnable=e}static get METAVERSE_CHANNEL_ENABLE(){return this.metaverseChannelEnable}static set METAVERSE_IDLE_TIMEOUT(e){this.metaverseIdleTimeout=e}static get METAVERSE_IDLE_TIMEOUT(){return this.metaverseIdleTimeout}static set METAVERSE_MAX_ROOMS(e){this.metaverseMaxRooms=e}static get METAVERSE_MAX_ROOMS(){return this.metaverseMaxRooms}static set METAVERSE_ROOM_ENABLE(e){this.metaverseRoomEnable=e}static get METAVERSE_ROOM_ENABLE(){return this.metaverseRoomEnable}static set METAVERSE_ROOMS(e){this.metaverseRooms=e}static get METAVERSE_ROOMS(){return this.metaverseRooms}static set MOBILE(e){this.mobile=e}static get MOBILE(){return this.mobile}static set MSG_DROP_RATE(e){this.msgDropRate=e}static get MSG_DROP_RATE(){return this.msgDropRate}static set MSG_PER_DAY(e){this.msgPerDay=e}static get MSG_PER_DAY(){return this.msgPerDay}static set MULT_REALM(e){this.multRealm=e}static get MULT_REALM(){return this.multRealm}static set NAME(e){this._name=e}static get NAME(){return this._name}static set NAVIGATOR_DATA(e){this.navigatorData=e}static get NAVIGATOR_DATA(){return this.navigatorData}static set NICK(e){this.nick=e}static get NICK(){return this.nick}static set PASSWORD(e){this.password=e}static get PASSWORD(){return this.password}static set PERMISSIONS(e){this.permissions=e}static get PERMISSIONS(){return this.permissions}static set PLATFORMS(e){this.platforms=e}static get PLATFORMS(){return this.platforms}static set PPCS_SERVER(e){this.ppcsServer=e}static get PPCS_SERVER(){return this.ppcsServer}static set REALM(e){this.realm=e}static get REALM(){return this.realm}static set REALM_FAVICON(e){this.realmFavicon=e}static get REALM_FAVICON(){return this.realmFavicon}static set REALM_LOGO(e){this.realmLogo=e}static get REALM_LOGO(){return this.realmLogo}static set REALM_NAME(e){this.realmName=e}static get REALM_NAME(){return this.realmName}static set ROLE(e){this.role=e}static get ROLE(){return this.role}static set ROOM(e){this.room=e}static get ROOM(){return this.room}static set ROOM_SERVER(e){this.roomServer=e}static get ROOM_SERVER(){return this.roomServer}static set ROOMS_LIST(e){this.roomsList=e}static get ROOMS_LIST(){return this.roomsList}static set ROOMS_CATEGORIES_FILTER(e){this.roomsCategoriesFilter=e}static get ROOMS_CATEGORIES_FILTER(){return this.roomsCategoriesFilter}static set ROOMS_CATEGORIES_LIST(e){this.roomsCategoriesList=e}static get ROOMS_CATEGORIES_LIST(){return this.roomsCategoriesList}static set ROOMS_CATEGORIES_LIST_IDS(e){this.roomsCategoriesListIds=e}static get ROOMS_CATEGORIES_LIST_IDS(){return this.roomsCategoriesListIds}static set ROOMS_SELECTED_FILTER(e){this.roomsSelectedFilter=e}static get ROOMS_SELECTED_FILTER(){return this.roomsSelectedFilter}static set SELECTED_REALM(e){this.selectedRealm=e}static get SELECTED_REALM(){return this.selectedRealm}static set SELECTED_ROOM(e){this.selectedRoom=e}static get SELECTED_ROOM(){return this.selectedRoom}static set SESSION(e){this.session=e}static get SESSION(){return this.session}static set TITLE(e){this.title=e}static get TITLE(){return this.title}static set TMS_SPA(e){this.tmsSpa=e}static get TMS_SPA(){return this.tmsSpa}static set TOKEN(e){this.token=e}static get TOKEN(){return this.token}static set TS(e){this.ts=e}static get TS(){return this.ts}static set TS_DIFF(e){this.tsDiff=e}static get TS_DIFF(){return this.tsDiff}static set URL_REGEX(e){this.urlRegex=e}static get URL_REGEX(){return this.urlRegex}static set USER_DATA(e){this.userData=e}static get USER_DATA(){return this.userData}static set VERSION(e){this.version=e}static get VERSION(){return this.version}static set WEBSOCKET_URL(e){this.websocketUrl=e}static get WEBSOCKET_URL(){return this.websocketUrl}static set WEBVIEW_URL(e){this.webviewUrl=e}static get WEBVIEW_URL(){return this.webviewUrl}static getConstants(){return{ACS_SERVER:this.acsServer,AUDIO_TIME_IS_RUNNING_OUT:this.audioTimeIsRunningOut,AUDIO_REQUEST_COLLABORATION:this.audioRequestCollaboration,AUDIO_SESSION_ERROR:this.audioSessionError,ANALYTIC_ID:this.analyticId,ANY_CHAR_REGEX:this.anyCharRegex,API:this.api,API_SERVER:this.apiServer,ASSETS:this.assets,AT_REGEX:this.atRegex,AUTH_TOKEN:this.authToken,CHANNEL:this.channel,CLIENT_TYPE:this.clientType,CONFIG:this.config,CSM_CHANNEL_ENABLE:this.csmChannelEnable,CSM_ROOM_ENABLE:this.csmRoomEnable,CSM_SPA:this.csmSpa,DEVICE_ID:this.deviceId,EMAIL:this.email,EMOTICONS:this.emoticons,EMOTICON_REGEX:this.emoticonRegex,ENGINE_NICK:this.engineNick,FEED_SPA:this.feedSpa,FILES_BASE_URL:this.filesBaseUrl,FULLNAME:this.fullName,GET_COMMENT_REGEX:this.getCommentRegex,GOOGLE_SIGNIN:this.google_sigin,GROUP_COLOR:this.groupColor,GUEST:this.guest,HASHTAG_REGEX:this.hashTagRegex,INVITE:this.invite,IP:this.ip,IRM_SERVERS:this.irmServers,JANUS_SERVER:this.janusServer,LIVES:this.lives,MAIL_REGEX:this.mailRegex,MAS_HTTP_URL:this.masHttpUrl,MAS_URL:this.masUrl,METAVERSE_CHANNEL_ENABLE:this.metaverseChannelEnable,METAVERSE_EPHEMERAL_ENABLE:this.metaverseEphemeralEnable,METAVERSE_FIXED:this.metaverseFixed,METAVERSE_IDLE_TIMEOUT:this.metaverseIdleTimeout,METAVERSE_MAX_ROOMS:this.metaverseMaxRooms,METAVERSE_ROOM_ENABLE:this.metaverseRoomEnable,METAVERSE_ROOMS:this.metaverseRooms,MOBILE:this.mobile,MSG_DROP_RATE:this.msgDropRate,MSG_PER_DAY:this.msgPerDay,MULT_REALM:this.multRealm,NAME:this.name,NAVIGATOR_DATA:this.navigatorData,NICK:this.nick,PASSWORD:this.password,PERMISSIONS:this.permissions,PLATFORMS:this.platforms,PPCS_SERVER:this.ppcsServer,REALM:this.realm,REALM_FAVICON:this.realmFavicon,REALM_LOGO:this.realmLogo,REALM_NAME:this.realmName,REALM_ROLE:this.role,ROOM:this.room,ROOM_SERVER:this.roomServer,ROOMS_LIST:this.roomsList,ROOMS_CATEGORIES_FILTER:this.roomsCategoriesFilter,ROOMS_CATEGORIES_LIST:this.roomsCategoriesList,ROOMS_CATEGORIES_LIST_IDS:this.roomsCategoriesListId,ROOMS_SELECTED_FILTER:this.roomsSelectedFilter,SELECTED_REALM:this.selectedRealm,SELECTED_ROOM:this.selectedRoom,SESSION:this.session,TITLE:this.title,TMS_SPA:this.tmsSpa,TOKEN:this.token,TS:this.ts,TS_DIFF:this.tsDiff,URL_REGEX:this.urlRegex,USER_DATA:this.userData,VERSION:this.version,WEBSOCKET_URL:this.websocketUrl,WEBVIEW_URL:this.webviewUrl}}}const m=["#C5C5C5","#00FFFF","#078E2E","#FE0000","#FF07FE","#FF5A00","#FF8EC4","#9A7F4F","#2C5C8E","#00C5FF","#8EC5C6","#2D5B5C","#5BFEC4","#8FC52D","#FF5A2E","#994B74","#C27496","#FF8F5B","#FFC48E","#FF5B5B","#FF005B","#8E5BC4","#C47146","#914807","#AF9413","#E7BE2E"],w=/((?:(http|https|Http|Https|rtsp|Rtsp):\/\/(?:(?:[a-zA-Z0-9\$\-\_\.\+\!\*\'\(\)\,\;\?\&\=]|(?:\%[a-fA-F0-9]{2})){1,64}(?:\:(?:[a-zA-Z0-9\$\-\_\.\+\!\*\'\(\)\,\;\?\&\=]|(?:\%[a-fA-F0-9]{2})){1,25})?\@)?)?((?:(?:[a-zA-Z0-9][a-zA-Z0-9\-\@]{0,64}\.)+(?:(?:aero|arpa|asia|a[cdefgilmnoqrstuwxz])|(?:biz|b[abdefghijmnorstvwyz])|(?:cat|com|coop|c[acdfghiklmnoruvxyz])|d[ejkmoz]|(?:edu|e[cegrstu])|f[ijkmor]|(?:gov|g[abdefghilmnpqrstuwy])|h[kmnrtu]|(?:info|int|i[delmnoqrst])|(?:jobs|j[emop])|k[eghimnrwyz]|l[abcikrstuvy]|(?:mil|mobi|museum|m[acdghklmnopqrstuvwxyz])|(?:name|net|n[acefgilopruz])|(?:org|om)|(?:pro|p[aefghklmnrstwy])|qa|r[eouw]|s[abcdeghijklmnortuvyz]|(?:tel|travel|t[cdfghjklmnoprtvwz])|u[agkmsyz]|v[aceginu]|w[fs]|y[etu]|z[amw]))|(?:(?:25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[1-9])\.(?:25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[1-9]|0)\.(?:25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[1-9]|0)\.(?:25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[0-9])))(?:\:\d{1,5})?)(\/(?:(?:[a-zA-Z0-9\;\/\?\:\@\&\=\#\~\-\.\+\!\*\'\(\)\,\_])|(?:\%[a-fA-F0-9]{2}))*)?(?:\b|$)/gi,g=/(\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*)/,f=/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?)*/,v=/\w+/i,b=new RegExp(`^${String.fromCharCode(2)}(.*)${String.fromCharCode(2)}`),_=/(^|\s)(#)([a-z\d-]+)/gi,y=/(^|\s|\n|\n\n)(@)([a-z\d-\_]+)/gi,S=[{type:"recent",title:"Recentes",imageCode:"&#xE192;",data:[]},{type:"smiles_people",title:"Emojis & Pessoas",imageCode:"&#xE24E;",data:["ð","ð","ð","ð","ð","ð","ð","ð¤£","ð","âºï¸","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð¤","ð","ð","ð","ð","ð","ð","ð","ð","â¹ï¸","ð£","ð","ð«","ð©","ð¢","ð­","ð¤","ð ","ð¡","ð³","ð±","ð¨","ð°","ð¥","ð","ð¤","ð¤","ð¤¥","ð¶","ð","ð","ð¬","ð","ð¯","ð¦","ð§","ð®","ð²","ð´","ð¤¤","ðª","ðµ","ð¤","ð¤¢","ð¤§","ð·","ð¤","ð¤","ð¤","ð¤ ","ð","ð¿","ð¹","ðº","ð¤¡","ð©","ð»","ð","ð½","ð¾","ð¤","ð","ðº","ð¸","ð¹","ð»","ð¼","ð½","ð","ð¿","ð¾","ð","ð","ð","ð¤","ð","ð","ð","â","ð¤","ð¤","ð¤","ð¤","ð","ð","ð","ð","ð","â","ð¤","ð","ð","ð","ð¤","ðª","ð","âï¸","ð","ð","ð","ð","ð","ð","ð","ð","ð£","ð","ð","ð£","ð¤","ð¥","ð¶","ð§","ð¦","ð©","ð¨","ð±ââ","ð±ââ","ðµ","ð´","ð²","ð³ââ","ð³ââ","ð®ââ","ð®ââ","ð·ââ","ð·ââ","ðââ","ðââ","ðµââ","ðµââ","ð©ââ","ð¨ââ","ð©âð¾","ð¨âð¾","ð©âð³","ð¨âð³","ð©âð","ð¨âð","ð©âð¤","ð¨âð¤","ð©âð«","ð¨âð«","ð©âð­","ð¨âð­","ð©âð»","ð¨âð»","ð©âð¼","ð¨âð¼","ð©âð§","ð¨âð§","ð©âð¬","ð¨âð¬","ð©âð¨","ð¨âð¨","ð©âð","ð¨âð","ð©ââ","ð¨ââ","ð©âð","ð¨âð","ð©ââ","ð¨ââ","ð°","ð¤µ","ð¸","ð¤´","ð¤¶","ð","ð¼","ð¤°","ðââ","ðââ","ðââ","ðââ","ðââ","ðââ","ðââ","ðââ","ðââ","ðââ","ð¤¦ââ","ð¤¦ââ","ð¤·ââ","ð¤·ââ","ðââ","ðââ","ðââ","ðââ","ðââ","ðââ","ðââ","ðââ","ð","ð¤³","ð","ðº","ð¯ââ","ð¯ââ","ð´","ð¶ââ","ð¶ââ","ðââ","ðââ","ð«","ð­","ð¬","ð","ð©ââ¤âð©","ð¨ââ¤âð¨","ð","ð©ââ¤âðâð©","ð¨ââ¤âðâð¨","ðª","ð¨âð©âð§","ð¨âð©âð§âð¦","ð¨âð©âð¦âð¦","ð¨âð©âð§âð§","ð©âð©âð¦","ð©âð©âð§","ð©âð©âð§âð¦","ð©âð©âð¦âð¦","ð©âð©âð§âð§","ð¨âð¨âð¦","ð¨âð¨âð§","ð¨âð¨âð§âð¦","ð¨âð¨âð¦âð¦","ð¨âð¨âð§âð§","ð©âð¦","ð©âð§","ð©âð§âð¦","ð©âð¦âð¦","ð©âð§âð§","ð¨âð¦","ð¨âð§","ð¨âð§âð¦","ð¨âð¦âð¦","ð¨âð§âð§","ð","ð","ð","ð","ð","ð","ð","ð ","ð¡","ð¢","ð","ð","ð©","ð","ð","â","ð","ð","ð","ð","ð¼","ð","ð","ð¶","ð"]},{type:"animals_nature",title:"Animais & Natureza",imageCode:"&#xE91D",data:["ð¶","ð±","ð­","ð¹","ð°","ð¦","ð»","ð¼","ð¨","ð¯","ð¦","ð®","ð·","ð½","ð¸","ðµ","ð","ð","ð","ð","ð","ð§","ð¦","ð¤","ð£","ð¥","ð¦","ð¦","ð¦","ð¦","ðº","ð","ð´","ð¦","ð","ð","ð¦","ð","ð","ð","ð","ð·","ð¸","ð¦","ð¢","ð","ð¦","ð","ð¦","ð¦","ð¦","ð¡","ð ","ð","ð¬","ð³","ð","ð¦","ð","ð","ð","ð¦","ð","ð¦","ðª","ð«","ð","ð","ð","ð","ð","ð","ð","ð","ð¦","ð","ð©","ð","ð","ð¦","ð","ð","ð","ð","ð¿","ð¾","ð","ð²","ðµ","ð","ð²","ð³","ð´","ð±","ð¿","âï¸","ð","ð","ð","ð","ð","ð","ð","ð¾","ð","ð·","ð¹","ð¥","ðº","ð¸","ð¼","ð»","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð«","â­","ð","â¨","â¡ï¸","âï¸","ð¥","ð¥","ðª","ð","â","ð¤","â","ð¥","ð¦","ð§","â","ð©","ð¨","âï¸","âï¸","â","ð¬","ð¨","ð§","ð¦","âï¸","âï¸","ð","ð«"]},{type:"food_drink",title:"Comida & Bebida",imageCode:"&#xE540",data:["ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð¥","ð","ð","ð¥","ð¥","ð¶","ð½","ð¥","ð¥","ð ","ð¥","ð","ð¥","ð§","ð¥","ð³","ð¥","ð¥","ð","ð","ð­","ð","ð","ð","ð¥","ð®","ð¯","ð¥","ð¥","ð","ð","ð²","ð","ð£","ð±","ð¤","ð","ð","ð","ð¥","ð¢","ð¡","ð§","ð¨","ð¦","ð°","ð","ð®","ð­","ð¬","ð«","ð¿","ð©","ðª","ð°","ð¥","ð¯","ð¥","ð¼","ðµ","ð¶","ðº","ð»","ð¥","ð·","ð¥","ð¸","ð¹","ð¾","ð¥","ð´","ð½"]},{type:"activity",title:"Atividade",imageCode:"&#xE52F",data:["â½","ð","ð","â¾","ð¾","ð","ð","ð±","ð","ð¸","ð¥","ð","ð","ð","â³","ð¹","ð£","ð¥","ð¥","ð½","â¸","ð¿","â·","ð","ðââ","ðââ","ð¤¼ââ","ð¤¼ââ","ð¤¸ââ","ð¤¸ââ","â¹ââ","â¹ââ","ð¤º","ð¤¾ââ","ð¤¾ââ","ðââ","ðââ","ð","ðââ","ðââ","ðââ","ðââ","ð¤½ââ","ð¤½ââ","ð£ââ","ð£ââ","ðµââ","ðµââ","ð´ââ","ð´ââ","ð","ð¥","ð¥","ð¥","ð","ð","ðµ","ð","ð«","ð","ðª","ð¤¹ââ","ð¤¹ââ","ð­","ð¨","ð¬","ð¤","ð§","ð¼","ð¹","ð¥","ð·","ðº","ð¸","ð»","ð²","ð¯","ð³","ð®","ð°"]},{type:"travel_places",title:"Viagens & Locais",imageCode:"&#xE531",data:["ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð´","ð²","ðµ","ð","ð¨","ð","ð","ð","ð","ð¡","ð ","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","âï¸","ð«","ð¬","ð©","ðº","ð°","ð","ð","ð¶","âµ","ð¤","ð¥","ð³","â´","ð¢","âï¸","â½","ð§","ð¦","ð¥","ð","ðº","ð¿","ð½","ð¼","ð°","ð¯","ð","ð¡","ð¢","ð ","â²","â±","ð","ð","ð","ð","â°","ð","ð»","ð","âº","ð ","ð¡","ð","ð","ð","ð­","ð¢","ð¬","ð£","ð¤","ð¥","ð¦","ð¨","ðª","ð«","ð©","ð","ð","âª","ð","ð","ð","â©","ð¤","ð£","ð¾","ð","ð","ð","ð","ð ","ð","ð","ð","ð","ð","ð","ð","ð","ð"]},{type:"objects",title:"Objetos",imageCode:"&#xE334",data:["â","ð±","ð²","ð»","â¨ï¸","ð¥","ð¨","ð±","ð²","ð¹","ð","ð½","ð¾","ð¿","ð","ð¼","ð·","ð¸","ð¹","ð¥","ð½","ð","ð","âï¸","ð","ð ","ðº","ð»","ð","ð","ð","â±","â²","â°","ð°","â","â³","ð¡","ð","ð","ð¡","ð¦","ð¯","ð","ð¢","ð¸","ðµ","ð´","ð¶","ð·","ð°","ð³","ð","ð§","ð¨","â","ð ","â","ð©","âï¸","â","ð«","ð£","ðª","ð¡","âï¸","ð¡","ð¬","â°ï¸","â±ï¸","ðº","ð®","ð¿","ð","âï¸","ð­","ð¬","ð³","ð","ð","ð¡","ð½","ð°","ð¿","ð","ð","ð","ð","ð","ðª","ð","ð","ð","ð¼","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð®","ð","ð©","ð¨","ð§","ð","ð¥","ð¤","ð¦","ð·","ðª","ð«","ð¬","ð­","ð®","ð¯","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð³","ð","ð","ð","ð","ð","ð","ð°","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","âï¸","ð","ð","ð","âï¸","ð","ð","ð","ð","ð","ð"]},{type:"simbols",title:"SÃ­mbolos",imageCode:"&#xE021",data:["â¤ï¸","ð","ð","ð","ð","ð¤","ð","â£ï¸","ð","ð","ð","ð","ð","ð","ð","ð","â®ï¸","âï¸","âªï¸","ð","â¸ï¸","â¡ï¸","ð¯","ð","â¯ï¸","â¦ï¸","ð","â","âï¸","âï¸","âï¸","âï¸","âï¸","âï¸","âï¸","âï¸","âï¸","âï¸","âï¸","âï¸","ð","âï¸","ð","â¢ï¸","â£ï¸","ð´","ð³","ð¶","ð","ð¸","ðº","ð·ï¸","â´ï¸","ð","ð®","ð","ãï¸","ãï¸","ð´","ðµ","ð¹","ð²","ð°ï¸","ð±ï¸","ð","ð","ð¾ï¸","ð","â","â­","ð","â","ð","ð«","ð¯","ð¢","â¨ï¸","ð·","ð¯","ð³","ð±","ð","ðµ","ð­","â","â","â","â","â¼ï¸","âï¸","ð","ð","ã½ï¸","â ï¸","ð¸","ð±","âï¸","ð°","â»ï¸","â","ð¯","ð¹","âï¸","â³ï¸","â","ð","ð ","âï¸","ð","ð¤","ð§","ð¾","â¿ï¸","ð¿ï¸","ð³","ðï¸","ð","ð","ð","ð","ð¹","ðº","ð¼","ð»","ð®","ð¦","ð¶","ð","ð£","â¹ï¸","ð¤","ð¡","ð ","ð","ð","ð","ð","ð","ð","0ï¸â£","1ï¸â£","2ï¸â£","3ï¸â£","4ï¸â£","5ï¸â£","6ï¸â£","7ï¸â£","8ï¸â£","9ï¸â£","ð","ð¢","#ï¸â£","*ï¸â£","â¶ï¸","â¸","â¯","â¹","âº","â­","â®","â©","âª","â«","â¬","âï¸","ð¼","ð½","â¡ï¸","â¬ï¸","â¬ï¸","â¬ï¸","âï¸","âï¸","âï¸","âï¸","âï¸","âï¸","âªï¸","â©ï¸","â¤´ï¸","â¤µï¸","ð","ð","ð","ð","ð","ðµ","ð¶","â","â","â","âï¸","ð²","ð±","â¢ï¸","Â©ï¸","Â®ï¸","ã°ï¸","â°","â¿","ð","ð","ð","ð","ð","âï¸","âï¸","ð","âª","â«","ð´","ðµ","ðº","ð»","ð¸","ð¹","ð¶","ð·","ð³","ð²","âªï¸","â«ï¸","â¾ï¸","â½ï¸","â¼ï¸","â»ï¸","â¬","â¬ï¸","ð","ð","ð","ð","ð","ð","ð£","ð¢","ðâð¨","ð¬","ð­","ð¯","â ï¸","â£ï¸","â¥ï¸","â¦ï¸","ð","ð´","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð ","ð¡","ð¢","ð£","ð¤","ð¥","ð¦","ð§"]},{type:"flags",title:"Bandeiras",imageCode:"&#xE153",data:["ð³","ð´","ð","ð©","ð³âð","ð¦ð«","ð¦ð½","ð¦ð±","ð©ð¿","ð¦ð¸","ð¦ð©","ð¦ð´","ð¦ð®","ð¦ð¶","ð¦ð¬","ð¦ð·","ð¦ð²","ð¦ð¼","ð¦ðº","ð¦ð¹","ð¦ð¿","ð§ð¸","ð§ð­","ð§ð©","ð§ð§","ð§ð¾","ð§ðª","ð§ð¿","ð§ð¯","ð§ð²","ð§ð¹","ð§ð´","ð§ð¦","ð§ð¼","ð§ð·","ð®ð´","ð»ð¬","ð§ð³","ð§ð¬","ð§ð«","ð§ð®","ð°ð­","ð¨ð²","ð¨ð¦","ð®ð¨","ð¨ð»","ð§ð¶","ð°ð¾","ð¨ð«","ð¹ð©","ð¨ð±","ð¨ð³","ð¨ð½","ð¨ð¨","ð¨ð´","ð°ð²","ð¨ð¬","ð¨ð©","ð¨ð°","ð¨ð·","ð¨ð®","ð­ð·","ð¨ðº","ð¨ð¼","ð¨ð¾","ð¨ð¿","ð©ð°","ð©ð¯","ð©ð²","ð©ð´","ðªð¨","ðªð¬","ð¸ð»","ð¬ð¶","ðªð·","ðªðª","ðªð¹","ðªðº","ð«ð°","ð«ð´","ð«ð¯","ð«ð®","ð«ð·","ð¬ð«","ðµð«","ð¹ð«","ð¬ð¦","ð¬ð²","ð¬ðª","ð©ðª","ð¬ð­","ð¬ð®","ð¬ð·","ð¬ð±","ð¬ð©","ð¬ðµ","ð¬ðº","ð¬ð¹","ð¬ð¬","ð¬ð³","ð¬ð¼","ð¬ð¾","ð­ð¹","ð­ð³","ð­ð°","ð­ðº","ð®ð¸","ð®ð³","ð®ð©","ð®ð·","ð®ð¶","ð®ðª","ð®ð²","ð®ð±","ð®ð¹","ð¯ð²","ð¯ðµ","ð","ð¯ðª","ð¯ð´","ð°ð¿","ð°ðª","ð°ð®","ð½ð°","ð°ð¼","ð°ð¬","ð±ð¦","ð±ð»","ð±ð§","ð±ð¸","ð±ð·","ð±ð¾","ð±ð®","ð±ð¹","ð±ðº","ð²ð´","ð²ð°","ð²ð¬","ð²ð¼","ð²ð¾","ð²ð»","ð²ð±","ð²ð¹","ð²ð­","ð²ð¶","ð²ð·","ð²ðº","ð¾ð¹","ð²ð½","ð«ð²","ð²ð©","ð²ð¨","ð²ð³","ð²ðª","ð²ð¸","ð²ð¦","ð²ð¿","ð²ð²","ð³ð¦","ð³ð·","ð³ðµ","ð³ð±","ð³ð¨","ð³ð¿","ð³ð®","ð³ðª","ð³ð¬","ð³ðº","ð³ð«","ð°ðµ","ð²ðµ","ð³ð´","ð´ð²","ðµð°","ðµð¼","ðµð¸","ðµð¦","ðµð¬","ðµð¾","ðµðª","ðµð­","ðµð³","ðµð±","ðµð¹","ðµð·","ð¶ð¦","ð·ðª","ð·ð´","ð·ðº","ð·ð¼","ð¼ð¸","ð¸ð²","ð¸ð¹","ð¸ð¦","ð¸ð³","ð·ð¸","ð¸ð¨","ð¸ð±","ð¸ð¬","ð¸ð½","ð¸ð°","ð¸ð®","ð¬ð¸","ð¸ð§","ð¸ð´","ð¿ð¦","ð°ð·","ð¸ð¸","ðªð¸","ð±ð°","ð§ð±","ð¸ð­","ð°ð³","ð±ð¨","ðµð²","ð»ð¨","ð¸ð©","ð¸ð·","ð¸ð¿","ð¸ðª","ð¨ð­","ð¸ð¾","ð¹ð¼","ð¹ð¯","ð¹ð¿","ð¹ð­","ð¹ð±","ð¹ð¬","ð¹ð°","ð¹ð´","ð¹ð¹","ð¹ð³","ð¹ð·","ð¹ð²","ð¹ð¨","ð¹ð»","ð»ð®","ðºð¬","ðºð¦","ð¦ðª","ð¬ð§","ó §ó ¢ó ·ó ¬ó ³ó ¿ðºð¸","ðºð¾","ðºð¿","ð»ðº","ð»ð¦","ð»ðª","ð»ð³","ð¼ð«","ðªð­","ð¾ðª","ð¿ð²","ð¿ð¼"]}];function E(e){"iptvcorp"!==window.realm&&"staging"!==window.realm&&"school"!==window.realm||(window.storeLog=!0);const t="object"==typeof e?JSON.stringify(e):e;if(window.disableJanusLog&&(t.includes("MyHeartJanus")||t.includes("JanusHandle : onmessage")||t.includes("[Janus]")))return!1;if(window.activity&&window.storeLog&&window.activity.insertDebug(t),!1===window.showLog)return!1;if(window.debug&&!1===window.showLog&&!window.debug.isActive())return!1;const n=new Date,i=`[${n.getYear()+1900}/${n.getMonth()+1}/${n.getDate()} ${n.getHours()}:${n.getMinutes()}:${n.getSeconds()}]`;return window.showLog&&console.log(`${i} ${t}`),window.debug&&window.debug.isActive()&&window._engine.currentChannel()&&window.debug.sendText(`[DEBUG] from ${p.ENGINE_NICK} ${i}: ${t}`),!1}function x(){return document.getElementById("block").style.cursor}function k(e){return"wait"===e?(l()("#block").show(),l()("body").height()<l()("#channelArea").height()?l()("#block").height(l()("#channelArea").height()):l()("#block").height(l()("body").height()),document.getElementById("block").style.cursor=e):(l()("#block").hide(),document.getElementById("block").style.cursor=e),!0}function M(e){return e<1e3?e:e<1e5?`${(e/1e3).toFixed(2)}K`:e<1e8&&`${(e/1e6).toFixed(2)}M`}function T(e){let t=5381;for(let n=0;n<e.length;n+=1)t=(t<<5)+t+e.charCodeAt(n);return t}function I(e){const t=new Array(0,0,0,0),n=e.length;switch(n){case 0:t[0]=0,t[1]=0,t[2]=0,t[3]=0;break;case 1:t[0]=e.charCodeAt(0),t[1]=0,t[2]=e.charCodeAt(0),t[3]=0;break;default:t[0]=e.charCodeAt(0),t[1]=e.charCodeAt(1),t[2]=e.charCodeAt(n-1),t[3]=e.charCodeAt(n-2)}return t[0]+3*t[1]+7*t[2]+11*t[3]}function R(e){if(f.test(e.text)&&e.text.length<13&&!v.test(e.text))return`<span style="font-size:50px">${e.text}</span>`;let t=e.text;if(t=t.replace(/\u0002\n\n\@/g,"\n\n @"),null!=t.match(b)){const e=t.split(String.fromCharCode(2));let n,i;t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"),t=t.replace(/ {2}/g," &nbsp;"),t=t.replace(/\t/g,"&nbsp;&nbsp;&nbsp;"),n=null!=e[1].match(/\:\s.*\]$/i)?e[1].match(/\:\s.*\]$/i)[0]:e[1].replace(/^\[/,""),n=n.replace(/^\:\s/,""),n=n.replace(/\]$/,""),null!=e[1].match(/\@\w+/i)?(i=e[1].match(/\@\w+/i)[0],i=i.replace("@","")):(i=null!=e[1].match(/^\[\w+.*\:/i)?e[1].match(/^\[\w+.*\:/i)[0]:null!=e[1].match(/^\[\S+\s/i)?e[1].match(/^\[\S+\s/i)[0]:"",i=i.replace("[",""),i=i.replace(":","")),t=`<div class="commentedMessage fr w100 bor br bgg" style="overflow:hidden;"><div class="fic bgbl bor br" style="width:5px;min-width:5px;min-height:80px;max-height:80px;"></div><div class="fic fc bgg" style="min-width:220px;min-height:80px;max-height:80px"><div class="pt5 pl5 pr5 bor tr bgg w100" style="min-width:220px;">${i}</div><div class="bgg bor w100 p5">${n}</div></div></div><span class="comment">${e[2].replace(/^(\r\n|\n|\r)(\r\n|\n|\r)/i,"")}</span>`,t=t.replace(/(\r\n|\n|\r)/g,"<br />")}else t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"),t=t.replace(/ {2}/g," &nbsp;"),t=t.replace(/\t/g,"&nbsp;&nbsp;&nbsp;"),t=t.replace(/(\r\n|\n|\r)/g,"<br /> ");return t=t.replace(_,"$1<span class='channelHashTag hash$3 toj pt' channel='$2$3'>&nbsp; $2$3 &nbsp;</span>"),t=t.replace(y,"<span class='targetInfo toj pt' t='$3' group='false'>&nbsp; $2$3 &nbsp;</span>"),t.replace(w,(function(e){return e.match(g)?`<a href="mailto:${e}" target="_blank" class="tb">${e}</a>`:-1===e.indexOf("http")?`<a href="http://${e}" target="_blank" class="tb">${e}</a>`:`<a href="${e}" target="_blank" class="tb">${e}</a>`}))}function A(e){const t=function(){l()("#hp__Channel__ video").on("play",(function(){window.playing+=1;const e=l()(this)[0];l()("#hp__Channel__ audio").each((function(){!1===l()(this)[0].paused&&l()(this)[0].pause()})),l()("#hp__Channel__ video").each((function(){l()(this)[0]!==e&&!1===l()(this)[0].paused&&l()(this)[0].pause()}))})),l()("#hp__Channel__ video").on("pause ended",(function(){window.playing-=1,window.playing})),l()("#hp__Channel__ audio").on("play",(function(){window.playing+=1;const e=l()(this)[0];l()("#hp__Channel__ video").each((function(){!1===l()(this)[0].paused&&l()(this)[0].pause()})),l()("#hp__Channel__ audio").each((function(){l()(this)[0]!==e&&l()(this)[0].pause()}))})),l()("#hp__Channel__ audio").on("pause ended",(function(){window.playing-=1,window.playing}))};if(0===e.type)return R(e);if(1===e.type)return`<audio controls><source src="${e.file_url}" type="audio/ogg" s="${e.sequence}"><source src="${e.file_url}" type="audio/mpeg"></audio>`;if(2===e.type)return"<span>[Contact]</span>";if(3===e.type){const t=window.brokenUrls.includes(e.file_url)?"":e.file_url;return`<span><a href="${e.file_url}" target="_blank" type="3"><img class="br" style="max-width:220px;width:auto;max-height:220px;" src="${t}" s="${e.sequence}" onerror="messageImageError(this);" /></a></span>`}if(4===e.type)return"Location";if(5===e.type)return`<a href="${e.file_url}" target="_blank" class="tb"><span class="material-icons pdf">&#xE873;</span><span class="sn"> PDF</span></a>`;if(6===e.type){const n=e.text.split("=");let i;if("image"===n[0]||"Image"===n[0])return i=e.text.slice(7,e.text.lenght),`<span><a href="${i}" target="_blank"><img class="br" style="max-width:220px;width:auto;max-height:220px;" src="${window.brokenUrls.includes(i)?"":i}" s="${e.sequence}" onerror="messageImageError(this);" /></a></span>`;if("audio"===n[0]||"Audio"===n[0])return i=e.text.slice(7,e.text.lenght).split(" "),setTimeout((function(){t()}),2e3),`<audio controls><source src="${i[0]}" type="audio/ogg" s="${e.sequence}"><source src="${i[0]}" type="audio/mpeg"></audio>`;if("video"===n[0]||"Video"===n[0])return i=e.text.slice(7,e.text.lenght).split(" "),setTimeout((function(){t()}),2e3),`<span><video class="br" style="max-width:220px;min-height:124px;max-height:220px" controls><source src="${i[0]}" type="video/mp4" s="${e.sequence}"></video></span>`;if("document"===n[0]||"Document"===n[0])return i=e.text.slice(10,e.text.lenght).split(" "),`<a href="${i[0]}" target="_blank" class="tb"><span class="material-icons pdf">&#xE873;</span><span class="sn"> PDF</span></a>`;if("link"!==n[0])return R(e);{i=[],i[0]=e.text.slice(5,e.text.lenght);let t={name:"",title:"",href:"",text:""};E(i[0]);try{if(t=JSON.parse(i[0]),void 0!==t.url&&void 0===t.href&&(t.href=t.url),void 0===t.description&&(void 0!==t.site_name?t.description=t.site_name:t.description=""),void 0===t.name&&(void 0!==t.href?t.name=t.href:t.name=""),void 0===t.href&&(t.href="/#"),void 0===t.text&&(t.text=""),void 0===t.image||""===t.image)return`<a href="${t.href}" target="_blank"><div style="color:#262626;background-color:#F9F9F9;min-height:120px;width:100%" class="fc p10 br"><div>${t.title}</div><div class="fr fig"><div class="fic"></div><div class="fig sxs" style="overflow:hidden;text-overflow:ellipsis;text-align:justify;">${t.description}</div></div><div class="sxs pt5 pb5 tb">${t.name}</div></div><span style="color:#262626;">${t.text}</span></a>`;const e=t.image.replace("http://","https://");return`<a href="${t.href}" target="_blank"><div style="color:#262626;background-color:#F9F9F9;min-height:120px;width:100%" class="fc p10 br"><div>${t.title}</div><div class="fr fig"><div class="fic"><img src="${e}" class="linkImg p5 br" style="max-width:105px;min-width:105px;width:100%;max-height:105px;" onerror="loadDefaultOG(this);" /></div><div class="fig sxs" style="overflow:hidden;text-overflow:ellipsis;text-align:justify;">${t.description}</div></div><div class="sxs pt5 pb5 tb">${t.name}</div></div><span style="color:#262626;">${t.text}</span></a>`}catch(t){return E(t),e.text}}}else{if(7===e.type)return`<span><video class="br" style="max-width:220px;min-height:124px;max-height:220px" controls><source src="${e.file_url}" type="video/mp4" s="${e.sequence}"></video></span>`;if(8===e.type)return"[Aplication]";if(9===e.type)return"[Proposal]";if(10===e.type)return"[Game]";if(11!==e.type)return 12===e.type?"[Banner]":13===e.type?"[Question]":14===e.type?"[Answer]":15===e.type?"[GIF]":"";E(e.data);try{let t="";void 0!==JSON.parse(e.data).description&&(t=JSON.parse(e.data).description);let n="";if(void 0!==JSON.parse(e.data).text&&(n=JSON.parse(e.data).text),void 0===JSON.parse(e.data).image||""===JSON.parse(e.data).image)return`<a href="${JSON.parse(e.data).href}" target="_blank"><div style="color:#262626;background-color:#F9F9F9;min-height:120px;width:100%" class="fc p10 br"><div>${JSON.parse(e.data).title}</div><div class="fr fig"><div class="fic"></div><div class="fig sxs" style="overflow:hidden;text-overflow:ellipsis;text-align:justify;">${t}</div></div><div class="sxs pt5 pb5 tb">${JSON.parse(e.data).name}</div></div><span style="color:#262626;">${n}</span></a>`;const i=JSON.parse(e.data).image.replace("http://","https://");return`<a href="${JSON.parse(e.data).href}" target="_blank"><div style="color:#262626;background-color:#F9F9F9;min-height:120px;width:100%" class="fc p10 br"><div>${JSON.parse(e.data).title}</div><div class="fr fig"><div class="fic"><img src="${i}" class="linkImg p5 br" style="max-width:105px;min-width:105px;width:100%;max-height:105px;" onerror="loadDefaultOG(this);" /></div><div class="fig sxs" style="overflow:hidden;text-overflow:ellipsis;text-align:justify;">${t}</div></div><div class="sxs pt5 pb5 tb">${JSON.parse(e.data).name}</div></div><span style="color:#262626;">${n}</span></a>`}catch(e){return""}}}function L(e){try{window.mutationObserver[e].disconnect()}catch(e){}const t=document.getElementById(e);window.mutationObserver[e]=new MutationObserver((function(){const t=l()(`#${e}`);t[0]&&t.scrollTop()>t[0].scrollHeight-t.height()-l()(`#${e} .msg:last`).height()-200&&t.scrollTop(t[0].scrollHeight)}));try{window.mutationObserver[e].observe(t,{attributes:!1,childList:!0,subtree:!1})}catch(e){}}function P(e){if(0===e)return" , ";const t=new Date,n=60*t.getHours()*60*1e3+60*t.getMinutes()*1e3+1e3*t.getSeconds()-1,i=t.getTime()-n,s=new Date(1e3*e);let o="";s.getMinutes()<10&&(o="0");const r=(i-1e3*e)/864e5;return r<0?`${s.getHours()}:${o}${s.getMinutes()},Hoje`:r<1?`${s.getHours()}:${o}${s.getMinutes()},Ontem`:r<8?`${s.getHours()}:${o}${s.getMinutes()},${["domingo","segunda-feira","ter&ccedil;a-feira","quarta-feira","quinta-feira","sexta-feira","s&aacute;bado"][s.getDay()]}`:`${s.getHours()}:${o}${s.getMinutes()},${s.getDate()}/${s.getMonth()+1}/${s.getYear()+1900}`}function D(e){const t=window.i18n.get("yesterday"),n=window.i18n.get("today"),i=[window.i18n.get("sunday"),window.i18n.get("monday"),window.i18n.get("tuesday"),window.i18n.get("wednesday"),window.i18n.get("thusday"),window.i18n.get("friday"),window.i18n.get("saturday")],s=new Date(1e3*e),o=s.getDate(),r=s.getMonth()+1,a=s.getYear()+1900,c=new Date,l=c.getDate(),d=c.getMonth()+1,u=c.getYear()+1900,h=new Date(c.getTime()-864e5),p=h.getDate(),m=h.getMonth()+1,w=h.getYear()+1900;if(l===o&&d===r&&u===a)return n;if(p===o&&m===r&&w===a)return t;if(s.getTime()>c.getTime()-5184e5)return`${i[s.getDay()]}`;let g;return g="pt-BR"!==window.navigator.language&&"ptBr"!==window.i18n.getLanguage()?`${r}/${o}/${a}`:`${o}/${r}/${a}`,g}function N(){let e="";l()("#rpchnrequestvoicelist").html(""),"requests"===l()(".rpchnhcount").attr("type")&&(0!==Object.keys(window.lChannelVoices).length?l()(".rpchnhcount").html(` (${Object.keys(window.lChannelVoices).length})`):l()(".rpchnhcount").html("")),0!==Object.keys(window.lChannelVoices).length?(l()("#channelAdmRequestCount").html(` (${Object.keys(window.lChannelVoices).length})`),l()("#rpchnhvoicebadge").html(Object.keys(window.lChannelVoices).length),l()("#rpchnhvoicebadge").show()):(l()("#channelAdmRequestCount").html(""),l()("#rpchnhvoicebadge").html(""),l()("#rpchnhvoicebadge").hide());for(const t in window.lChannelVoices){const n="-web"===t.slice(-4)?t.substr(0,t.length-4):t;1===window.lChannelVoices[t]?(e=`<div id="voice_${t}" class="chnu fr w100 pl10 pt10 pr10 pt">\n                <img src="${window.files_base_url}avatars/user/${n}/thumb.jpeg" class="cp lpci" onerror="loadDefaultAvatar(this);">\n                <div class="fc fic fig pl5"><div class="fr w100"><span class="sn n toj">${t}</span><span class="fig"></span>\n                <span class="userVoiceIcon tb p0 pr5 sxxl tg material-icons" t="${t}">&#xE04B;</span>\n                </div><div>&nbsp;</div>\n                <div class="li w100"></div></div></div>`,l()("#rpchnrequestvoicelist").append(e)):0===window.lChannelVoices[t]&&(e=`<div id="voice_${t}" class="chnu fr w100 pl10 pt10 pr10 pt">\n                <img src="${window.files_base_url}avatars/user/${n}/thumb.jpeg" class="cp lpci" onerror="loadDefaultAvatar(this);">\n                <div class="fc fic fig pl5"><div class="fr w100"><span class="sn n toj">${t}</span><span class="fig"></span>\n                <span class="userVoiceIcon p0 pr5 sxxl tg material-icons" t="${t}">&#xE04C;</span>\n                </div><div>&nbsp;</div>\n                <div class="li w100"></div></div></div>`,l()("#rpchnrequestvoicelist").append(e))}}function O(){const e=navigator.userAgent;let t,n=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(t=/\brv[ :]+(\d+)/g.exec(e)||[],{name:"IE",version:t[1]||""}):"Chrome"===n[1]&&(t=e.match(/\bOPR|Edge\/(\d+)/),null!=t)?{name:"Opera",version:t[1]}:(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.userAgent,"-?"],null!=(t=e.match(/version\/(\d+)/i))&&n.splice(1,1,t[1]),{name:n[0],version:n[1]})}function B(e,t){return e.filter((function(e){return e!==t}))}function F(e,t,n){return e?e.filter((function(e){return e[t]!==n})):e}function U(e){let t="";const n=parseInt(e/3600),i=parseInt((e-60*n*60)/60),s=parseInt(e-60*i-60*n*60);return n>0&&(t=`${n}:`),t+=`${i}:`,t+=s>9?s:`0${s}`,t}class j{static stopStream(e){j.stopStreamVideo(e),j.stopStreamAudio(e)}static stopStreamVideo(e){if(!e)return;const t=e.getVideoTracks();if(t.length>0){const n=t[0];e.removeTrack(n),n.stop()}}static stopStreamAudio(e){if(!e)return;const t=e.getAudioTracks();if(t.length>0){const n=t[0];e.removeTrack(n),n.stop()}}static isEnded(e){let t=!0;const n=e.getVideoTracks();for(let e=0;e<n.length;e++)"ended"!=n[e].readyState&&(t=!1);const i=e.getAudioTracks();for(let e=0;e<i.length;e++)"ended"!=i[e].readyState&&(t=!1);return t}}class V{static enableCtrl(e,t){e.prop("disabled",!t)}static getCanvas(e,t,n){const i=l()("<canvas/>"),s=i[0];s.width=e,s.height=t;const o=s.getContext("2d");return n&&(o.fillStyle=n,o.fillRect(0,0,e,t)),{jEl:i,el:s,ctx:o,width:e,height:t}}static comboSelectedVal(e){return e.find("option:selected").text()}static checkBoxVal(e){return e.is(":checked")}}function G(e,t,n){const i=window.time.now()+e,s=e,o=t,r=n;let a=null,c=!1;function l(e){const t=e,n=parseInt(t/1e3/60/60),i=parseInt((t-1e3*n*60*60)/1e3/60),s=i>9?`${i}`:`0${i}`,o=parseInt((t-1e3*n*60*60-1e3*i*60)/1e3),r=o>9?`${o}`:`0${o}`;let a;return a=n>0?`${n}:${s}:${r}`:`${i}:${r}`,a}function d(){c=!1,clearInterval(a)}return window.activeIntervals=window.activeIntervals||[],window.clearAllIntervals=function(){for(var e=0;e<window.activeIntervals.length;e++)clearInterval(window.activeIntervals[e]);window.activeIntervals=[]},{start:function(){window.clearAllIntervals(),clearInterval(a),c=!0,a=setInterval((()=>{const e=window.time.now();let t=i-e;t<1&&(t=0,o&&o(l(t),s),r&&(d(),r())),o&&o(l(t),t)}),500),window.activeIntervals.push(a)},stop:d,isStarted:function(){return c}}}function q(e,t){return e.sort((function(e,n){return e[t]>n[t]?1:e[t]<n[t]?-1:0}))}function H(e){return Object.keys(e).sort().reduce((function(t,n){return t[n]=e[n],t}),{})}function z(e){const t=e.errors;let n=!1,i=!1;t&&(t.forEach((async e=>{E(JSON.stringify(e)),console.log(`[Error Handle] ${JSON.stringify(e)}`);const t=e.message;if(t)if(C.AUDIO_SESSION_ERROR&&C.AUDIO_SESSION_ERROR.play(),t.includes("csm_session_create not allowed")||t.includes("csm_session_edit not allowed"))window._channel.showModalMessage(window.i18n.get("error-session-create-permission"),"alert"),n=!0,i=!0;else if(t.includes("x-api-key"))window.session.setStarted(!1),window._channel.showModalMessage(window.i18n.get("error-session-request-not-allowed"),"alert"),n=!0,i=!0;else if(t.includes("session timeout"))window.session.setStarted(!1),window._channel.showModalMessage(window.i18n.get("error-session-request-not-allowed"),"alert",window.session.reconnect);else if(t.includes("wrong credentials"))window.session.setStarted(!1),window._channel.showModalMessage(window.i18n.get("error-wrong-credentials"),"alert"),n=!0;else if(t.includes("ack error")){window.Events.dispatch("session/disconnect",t),window.session.setStarted(!1);const e=window.i18n.get("record-reconnecting");window._channel.showTemporaryMessage(e,"loading",12e4),window.session.isReconnecting()||await window.session.reconnect()}else if(t.includes("ping timeout")){window.Events.dispatch("session/disconnect",t),window.session.setStarted(!1);const e=window.i18n.get("record-reconnecting");window._channel.showTemporaryMessage(e,"loading",12e4),window.session.isReconnecting()||await window.session.reconnect()}else if(t.includes("chunks lost")){window.Events.dispatch("session/disconnect",t),window.session.setStarted(!1);const e=window.i18n.get("record-reconnecting");window._channel.showTemporaryMessage(e,"loading",12e4),window.session.isReconnecting()||await window.session.reconnect()}else if(t.includes("disconnect error")){window.Events.dispatch("session/disconnect",t),window.session.setStarted(!1);const e=window.i18n.get("record-reconnecting");window._channel.showTemporaryMessage(e,"loading",12e4),window.session.isReconnecting()||await window.session.reconnect()}else if(t.includes("startrec timeout")){window.session.setStarted(!1);const e=window.i18n.get("record-reconnecting");window._channel.showTemporaryMessage(e,"loading",12e4),window.session.isReconnecting()||await window.session.reconnect()}else t.includes("Session Record: connection failed")?window._channel.showModalMessage(window.i18n.get("error-session-record-connection-failed"),"alert"):(window._channel.showTemporaryMessage(t,"alert"),n=!0,i=!0)})),l()(".dialog").hide())}window.encodeBase64URI=function(e){return encodeURIComponent(btoa(e))},window.decodeBase64URI=function(e){return atob(decodeURIComponent(e))};const W=function(){return{method:"POST",headers:new Headers({"Content-Type":"application/json","x-api-key":window.auth_token})}},J=async function(e){const t=e,n=W(),i=`${window.apiServer}/csm/session`;let s;n.body=JSON.stringify(t),E(`[CMS session] Creating session with body: ${JSON.stringify(t)}`);try{s=await fetch(i,n).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`createSession error: ${JSON.stringify(e.errors)}`),!1):e)).catch((e=>(e.json().then((e=>{z(e)})),!1)))}catch(e){return!1}return s},Y=async function(e){const t=`${window.apiServer}/mas/invite/${e}`,n={method:"DELETE",headers:new Headers({"Content-Type":"application/json","x-api-key":window.auth_token})};let i;try{i=await fetch(t,n).then((e=>e.ok?e.json():Promise.reject(e))).then((t=>t.errors?(E(`[Invite] Delete invite id "${e}" error: ${JSON.stringify(t.errors)}`),!1):t)).catch((e=>{E(e)}))}catch(e){E(e)}return i},K=async function(e,t){if(!t)return z({field:"sessionId",cause:"undefined",status:404,value:"sessionId",message:"action: startSession - undefined sessionId"}),!1;const n=t,i=e,s=W(),o=`${window.apiServer}/csm/session/${n}/start`;let r;s.body=JSON.stringify(i),E(`[CMS session] Setting start session with body: ${JSON.stringify(i)}`);try{r=await fetch(o,s).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`startSession error: ${JSON.stringify(e.errors)}`),!1):e)).catch((e=>(e.json().then((e=>{z(e)})),!1)))}catch(e){return!1}return r},X=function(){return{method:"GET",headers:new Headers({"Content-Type":"application/json","x-api-key":window.auth_token})}},Z=async function(e){const t=e,n=X(),i=`${window.apiServer}/csm/session/${t}?with_categories=true&with_report=true&realm=${window.realm}`;let s;try{s=await fetch(i,n).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`CSM getSession error: ${JSON.stringify(e.errors)}`),!1):e)).catch((e=>(e.json().then((e=>{z(e)})),!1)))}catch(e){return!1}return s},Q=async function(e){const t=e||window._engine.currentChannel(),n=X(),i=`${window.apiServer}/csm/session/active?channel=${t}`;let s;try{return s=await fetch(i,n).then((async e=>{const t=await e.json();return e.ok?t:Promise.reject(t)})).catch((e=>"session_id must be a number"===e.errors[0].message?{active:!1}:(z(e),!1))),s}catch(e){return!1}},ee=async function(e){const t=X();let n,i=`${window.apiServer}/csm/session?realm=${window.realm}`;e&&(i+=`&${new URLSearchParams(e)}`);try{n=await fetch(i,t).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`CSM getSession error: ${JSON.stringify(e.errors)}`),!1):e)).catch((e=>(e.json().then((e=>{z(e)})),!1)))}catch(e){return E(e),!1}return n},te=async function(e,t){if(!e)return z({field:"sessionId",cause:"undefined",status:404,value:"sessionId",message:"action: finishSession - undefined sessionId"}),!1;const n=e,i=t,s=W(),o=`${window.apiServer}/csm/session/${n}/finish`;let r;s.body=JSON.stringify(i),E(`[CMS session] Finishing session with body: ${JSON.stringify(i)}`);try{r=await fetch(o,s).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`Session finish error: ${JSON.stringify(e.errors)}`),!1):e)).catch((e=>(e.json().then((e=>{z(e)})),!1)))}catch(e){return!1}return r},ne=function(){return{method:"PUT",headers:new Headers({"Content-Type":"application/json","x-api-key":window.auth_token})}},ie=async function(e,t){const n=e,i=t,s=ne(),o=`${window.apiServer}/csm/session/${n}/partial`;let r;s.body=JSON.stringify(i),E(`[CMS session] Updating session partial with body: ${JSON.stringify(i)}`);try{r=await fetch(o,s).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`Session update partial error: ${JSON.stringify(e.errors)}`),!1):e)).catch((e=>(e.json().then((e=>{z(e)})),!1)))}catch(e){return!1}return r};function se(e){let t=e.length;for(;--t>=0;)e[t]=0}const oe=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),re=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),ae=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),ce=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),le=new Array(576);se(le);const de=new Array(60);se(de);const ue=new Array(512);se(ue);const he=new Array(256);se(he);const pe=new Array(29);se(pe);const me=new Array(30);function we(e,t,n,i,s){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=s,this.has_stree=e&&e.length}let ge,fe,ve;function be(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}se(me);const _e=e=>e<256?ue[e]:ue[256+(e>>>7)],ye=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},Ce=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,ye(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},Se=(e,t,n)=>{Ce(e,n[2*t],n[2*t+1])},Ee=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},xe=(e,t,n)=>{const i=new Array(16);let s,o,r=0;for(s=1;s<=15;s++)i[s]=r=r+n[s-1]<<1;for(o=0;o<=t;o++){let t=e[2*o+1];0!==t&&(e[2*o]=Ee(i[t]++,t))}},ke=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},Me=e=>{e.bi_valid>8?ye(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Te=(e,t,n,i)=>{const s=2*t,o=2*n;return e[s]<e[o]||e[s]===e[o]&&i[t]<=i[n]},Ie=(e,t,n)=>{const i=e.heap[n];let s=n<<1;for(;s<=e.heap_len&&(s<e.heap_len&&Te(t,e.heap[s+1],e.heap[s],e.depth)&&s++,!Te(t,i,e.heap[s],e.depth));)e.heap[n]=e.heap[s],n=s,s<<=1;e.heap[n]=i},Re=(e,t,n)=>{let i,s,o,r,a=0;if(0!==e.last_lit)do{i=e.pending_buf[e.d_buf+2*a]<<8|e.pending_buf[e.d_buf+2*a+1],s=e.pending_buf[e.l_buf+a],a++,0===i?Se(e,s,t):(o=he[s],Se(e,o+256+1,t),r=oe[o],0!==r&&(s-=pe[o],Ce(e,s,r)),i--,o=_e(i),Se(e,o,n),r=re[o],0!==r&&(i-=me[o],Ce(e,i,r)))}while(a<e.last_lit);Se(e,256,t)},Ae=(e,t)=>{const n=t.dyn_tree,i=t.stat_desc.static_tree,s=t.stat_desc.has_stree,o=t.stat_desc.elems;let r,a,c,l=-1;for(e.heap_len=0,e.heap_max=573,r=0;r<o;r++)0!==n[2*r]?(e.heap[++e.heap_len]=l=r,e.depth[r]=0):n[2*r+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=l<2?++l:0,n[2*c]=1,e.depth[c]=0,e.opt_len--,s&&(e.static_len-=i[2*c+1]);for(t.max_code=l,r=e.heap_len>>1;r>=1;r--)Ie(e,n,r);c=o;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Ie(e,n,1),a=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=a,n[2*c]=n[2*r]+n[2*a],e.depth[c]=(e.depth[r]>=e.depth[a]?e.depth[r]:e.depth[a])+1,n[2*r+1]=n[2*a+1]=c,e.heap[1]=c++,Ie(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,i=t.max_code,s=t.stat_desc.static_tree,o=t.stat_desc.has_stree,r=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,c=t.stat_desc.max_length;let l,d,u,h,p,m,w=0;for(h=0;h<=15;h++)e.bl_count[h]=0;for(n[2*e.heap[e.heap_max]+1]=0,l=e.heap_max+1;l<573;l++)d=e.heap[l],h=n[2*n[2*d+1]+1]+1,h>c&&(h=c,w++),n[2*d+1]=h,d>i||(e.bl_count[h]++,p=0,d>=a&&(p=r[d-a]),m=n[2*d],e.opt_len+=m*(h+p),o&&(e.static_len+=m*(s[2*d+1]+p)));if(0!==w){do{for(h=c-1;0===e.bl_count[h];)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[c]--,w-=2}while(w>0);for(h=c;0!==h;h--)for(d=e.bl_count[h];0!==d;)u=e.heap[--l],u>i||(n[2*u+1]!==h&&(e.opt_len+=(h-n[2*u+1])*n[2*u],n[2*u+1]=h),d--)}})(e,t),xe(n,l,e.bl_count)},$e=(e,t,n)=>{let i,s,o=-1,r=t[1],a=0,c=7,l=4;for(0===r&&(c=138,l=3),t[2*(n+1)+1]=65535,i=0;i<=n;i++)s=r,r=t[2*(i+1)+1],++a<c&&s===r||(a<l?e.bl_tree[2*s]+=a:0!==s?(s!==o&&e.bl_tree[2*s]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,o=s,0===r?(c=138,l=3):s===r?(c=6,l=3):(c=7,l=4))},Le=(e,t,n)=>{let i,s,o=-1,r=t[1],a=0,c=7,l=4;for(0===r&&(c=138,l=3),i=0;i<=n;i++)if(s=r,r=t[2*(i+1)+1],!(++a<c&&s===r)){if(a<l)do{Se(e,s,e.bl_tree)}while(0!=--a);else 0!==s?(s!==o&&(Se(e,s,e.bl_tree),a--),Se(e,16,e.bl_tree),Ce(e,a-3,2)):a<=10?(Se(e,17,e.bl_tree),Ce(e,a-3,3)):(Se(e,18,e.bl_tree),Ce(e,a-11,7));a=0,o=s,0===r?(c=138,l=3):s===r?(c=6,l=3):(c=7,l=4)}};let Pe=!1;const De=(e,t,n,i)=>{Ce(e,0+(i?1:0),3),((e,t,n,i)=>{Me(e),ye(e,n),ye(e,~n),e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n})(e,t,n)};var Ne={_tr_init:e=>{Pe||((()=>{let e,t,n,i,s;const o=new Array(16);for(n=0,i=0;i<28;i++)for(pe[i]=n,e=0;e<1<<oe[i];e++)he[n++]=i;for(he[n-1]=i,s=0,i=0;i<16;i++)for(me[i]=s,e=0;e<1<<re[i];e++)ue[s++]=i;for(s>>=7;i<30;i++)for(me[i]=s<<7,e=0;e<1<<re[i]-7;e++)ue[256+s++]=i;for(t=0;t<=15;t++)o[t]=0;for(e=0;e<=143;)le[2*e+1]=8,e++,o[8]++;for(;e<=255;)le[2*e+1]=9,e++,o[9]++;for(;e<=279;)le[2*e+1]=7,e++,o[7]++;for(;e<=287;)le[2*e+1]=8,e++,o[8]++;for(xe(le,287,o),e=0;e<30;e++)de[2*e+1]=5,de[2*e]=Ee(e,5);ge=new we(le,oe,257,286,15),fe=new we(de,re,0,30,15),ve=new we(new Array(0),ae,0,19,7)})(),Pe=!0),e.l_desc=new be(e.dyn_ltree,ge),e.d_desc=new be(e.dyn_dtree,fe),e.bl_desc=new be(e.bl_tree,ve),e.bi_buf=0,e.bi_valid=0,ke(e)},_tr_stored_block:De,_tr_flush_block:(e,t,n,i)=>{let s,o,r=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),Ae(e,e.l_desc),Ae(e,e.d_desc),r=(e=>{let t;for($e(e,e.dyn_ltree,e.l_desc.max_code),$e(e,e.dyn_dtree,e.d_desc.max_code),Ae(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*ce[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),s=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=s&&(s=o)):s=o=n+5,n+4<=s&&-1!==t?De(e,t,n,i):4===e.strategy||o===s?(Ce(e,2+(i?1:0),3),Re(e,le,de)):(Ce(e,4+(i?1:0),3),((e,t,n,i)=>{let s;for(Ce(e,t-257,5),Ce(e,n-1,5),Ce(e,i-4,4),s=0;s<i;s++)Ce(e,e.bl_tree[2*ce[s]+1],3);Le(e,e.dyn_ltree,t-1),Le(e,e.dyn_dtree,n-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,r+1),Re(e,e.dyn_ltree,e.dyn_dtree)),ke(e),i&&Me(e)},_tr_tally:(e,t,n)=>(e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(he[n]+256+1)]++,e.dyn_dtree[2*_e(t)]++),e.last_lit===e.lit_bufsize-1),_tr_align:e=>{Ce(e,2,3),Se(e,256,le),(e=>{16===e.bi_valid?(ye(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}},Oe=(e,t,n,i)=>{let s=65535&e|0,o=e>>>16&65535|0,r=0;for(;0!==n;){r=n>2e3?2e3:n,n-=r;do{s=s+t[i++]|0,o=o+s|0}while(--r);s%=65521,o%=65521}return s|o<<16|0};const Be=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());var Fe=(e,t,n,i)=>{const s=Be,o=i+n;e^=-1;for(let n=i;n<o;n++)e=e>>>8^s[255&(e^t[n])];return-1^e},Ue={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},je={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Ve,_tr_stored_block:Ge,_tr_flush_block:qe,_tr_tally:He,_tr_align:ze}=Ne,{Z_NO_FLUSH:We,Z_PARTIAL_FLUSH:Je,Z_FULL_FLUSH:Ye,Z_FINISH:Ke,Z_BLOCK:Xe,Z_OK:Ze,Z_STREAM_END:Qe,Z_STREAM_ERROR:et,Z_DATA_ERROR:tt,Z_BUF_ERROR:nt,Z_DEFAULT_COMPRESSION:it,Z_FILTERED:st,Z_HUFFMAN_ONLY:ot,Z_RLE:rt,Z_FIXED:at,Z_DEFAULT_STRATEGY:ct,Z_UNKNOWN:lt,Z_DEFLATED:dt}=je,ut=258,ht=262,pt=103,mt=113,wt=666,gt=(e,t)=>(e.msg=Ue[t],t),ft=e=>(e<<1)-(e>4?9:0),vt=e=>{let t=e.length;for(;--t>=0;)e[t]=0};let bt=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const _t=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},yt=(e,t)=>{qe(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,_t(e.strm)},Ct=(e,t)=>{e.pending_buf[e.pending++]=t},St=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},Et=(e,t,n,i)=>{let s=e.avail_in;return s>i&&(s=i),0===s?0:(e.avail_in-=s,t.set(e.input.subarray(e.next_in,e.next_in+s),n),1===e.state.wrap?e.adler=Oe(e.adler,t,s,n):2===e.state.wrap&&(e.adler=Fe(e.adler,t,s,n)),e.next_in+=s,e.total_in+=s,s)},xt=(e,t)=>{let n,i,s=e.max_chain_length,o=e.strstart,r=e.prev_length,a=e.nice_match;const c=e.strstart>e.w_size-ht?e.strstart-(e.w_size-ht):0,l=e.window,d=e.w_mask,u=e.prev,h=e.strstart+ut;let p=l[o+r-1],m=l[o+r];e.prev_length>=e.good_match&&(s>>=2),a>e.lookahead&&(a=e.lookahead);do{if(n=t,l[n+r]===m&&l[n+r-1]===p&&l[n]===l[o]&&l[++n]===l[o+1]){o+=2,n++;do{}while(l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&o<h);if(i=ut-(h-o),o=h-ut,i>r){if(e.match_start=t,r=i,i>=a)break;p=l[o+r-1],m=l[o+r]}}}while((t=u[t&d])>c&&0!=--s);return r<=e.lookahead?r:e.lookahead},kt=e=>{const t=e.w_size;let n,i,s,o,r;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-ht)){e.window.set(e.window.subarray(t,t+t),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,i=e.hash_size,n=i;do{s=e.head[--n],e.head[n]=s>=t?s-t:0}while(--i);i=t,n=i;do{s=e.prev[--n],e.prev[n]=s>=t?s-t:0}while(--i);o+=t}if(0===e.strm.avail_in)break;if(i=Et(e.strm,e.window,e.strstart+e.lookahead,o),e.lookahead+=i,e.lookahead+e.insert>=3)for(r=e.strstart-e.insert,e.ins_h=e.window[r],e.ins_h=bt(e,e.ins_h,e.window[r+1]);e.insert&&(e.ins_h=bt(e,e.ins_h,e.window[r+3-1]),e.prev[r&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=r,r++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<ht&&0!==e.strm.avail_in)},Mt=(e,t)=>{let n,i;for(;;){if(e.lookahead<ht){if(kt(e),e.lookahead<ht&&t===We)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=bt(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-ht&&(e.match_length=xt(e,n)),e.match_length>=3)if(i=He(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=bt(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=bt(e,e.ins_h,e.window[e.strstart+1]);else i=He(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(yt(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===Ke?(yt(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(yt(e,!1),0===e.strm.avail_out)?1:2},Tt=(e,t)=>{let n,i,s;for(;;){if(e.lookahead<ht){if(kt(e),e.lookahead<ht&&t===We)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=bt(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-ht&&(e.match_length=xt(e,n),e.match_length<=5&&(e.strategy===st||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-3,i=He(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=s&&(e.ins_h=bt(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(yt(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(i=He(e,0,e.window[e.strstart-1]),i&&yt(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=He(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===Ke?(yt(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(yt(e,!1),0===e.strm.avail_out)?1:2};function It(e,t,n,i,s){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=s}const Rt=[new It(0,0,0,0,((e,t)=>{let n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(kt(e),0===e.lookahead&&t===We)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;const i=e.block_start+n;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,yt(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-ht&&(yt(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Ke?(yt(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(yt(e,!1),e.strm.avail_out),1)})),new It(4,4,8,4,Mt),new It(4,5,16,8,Mt),new It(4,6,32,32,Mt),new It(4,4,16,16,Tt),new It(8,16,32,32,Tt),new It(8,16,128,128,Tt),new It(8,32,128,256,Tt),new It(32,128,258,1024,Tt),new It(32,258,258,4096,Tt)];function At(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=dt,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),vt(this.dyn_ltree),vt(this.dyn_dtree),vt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),vt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),vt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const $t=e=>{if(!e||!e.state)return gt(e,et);e.total_in=e.total_out=0,e.data_type=lt;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:mt,e.adler=2===t.wrap?0:1,t.last_flush=We,Ve(t),Ze},Lt=e=>{const t=$t(e);return t===Ze&&(e=>{e.window_size=2*e.w_size,vt(e.head),e.max_lazy_match=Rt[e.level].max_lazy,e.good_match=Rt[e.level].good_length,e.nice_match=Rt[e.level].nice_length,e.max_chain_length=Rt[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0})(e.state),t},Pt=(e,t,n,i,s,o)=>{if(!e)return et;let r=1;if(t===it&&(t=6),i<0?(r=0,i=-i):i>15&&(r=2,i-=16),s<1||s>9||n!==dt||i<8||i>15||t<0||t>9||o<0||o>at)return gt(e,et);8===i&&(i=9);const a=new At;return e.state=a,a.strm=e,a.wrap=r,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=s+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<s+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=t,a.strategy=o,a.method=n,Lt(e)};var Dt={deflateInit:(e,t)=>Pt(e,t,dt,15,8,ct),deflateInit2:Pt,deflateReset:Lt,deflateResetKeep:$t,deflateSetHeader:(e,t)=>e&&e.state?2!==e.state.wrap?et:(e.state.gzhead=t,Ze):et,deflate:(e,t)=>{let n,i;if(!e||!e.state||t>Xe||t<0)return e?gt(e,et):et;const s=e.state;if(!e.output||!e.input&&0!==e.avail_in||s.status===wt&&t!==Ke)return gt(e,0===e.avail_out?nt:et);s.strm=e;const o=s.last_flush;if(s.last_flush=t,42===s.status)if(2===s.wrap)e.adler=0,Ct(s,31),Ct(s,139),Ct(s,8),s.gzhead?(Ct(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),Ct(s,255&s.gzhead.time),Ct(s,s.gzhead.time>>8&255),Ct(s,s.gzhead.time>>16&255),Ct(s,s.gzhead.time>>24&255),Ct(s,9===s.level?2:s.strategy>=ot||s.level<2?4:0),Ct(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(Ct(s,255&s.gzhead.extra.length),Ct(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(e.adler=Fe(e.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=69):(Ct(s,0),Ct(s,0),Ct(s,0),Ct(s,0),Ct(s,0),Ct(s,9===s.level?2:s.strategy>=ot||s.level<2?4:0),Ct(s,3),s.status=mt);else{let t=dt+(s.w_bits-8<<4)<<8,n=-1;n=s.strategy>=ot||s.level<2?0:s.level<6?1:6===s.level?2:3,t|=n<<6,0!==s.strstart&&(t|=32),t+=31-t%31,s.status=mt,St(s,t),0!==s.strstart&&(St(s,e.adler>>>16),St(s,65535&e.adler)),e.adler=1}if(69===s.status)if(s.gzhead.extra){for(n=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>n&&(e.adler=Fe(e.adler,s.pending_buf,s.pending-n,n)),_t(e),n=s.pending,s.pending!==s.pending_buf_size));)Ct(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>n&&(e.adler=Fe(e.adler,s.pending_buf,s.pending-n,n)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=73)}else s.status=73;if(73===s.status)if(s.gzhead.name){n=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>n&&(e.adler=Fe(e.adler,s.pending_buf,s.pending-n,n)),_t(e),n=s.pending,s.pending===s.pending_buf_size)){i=1;break}i=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,Ct(s,i)}while(0!==i);s.gzhead.hcrc&&s.pending>n&&(e.adler=Fe(e.adler,s.pending_buf,s.pending-n,n)),0===i&&(s.gzindex=0,s.status=91)}else s.status=91;if(91===s.status)if(s.gzhead.comment){n=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>n&&(e.adler=Fe(e.adler,s.pending_buf,s.pending-n,n)),_t(e),n=s.pending,s.pending===s.pending_buf_size)){i=1;break}i=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,Ct(s,i)}while(0!==i);s.gzhead.hcrc&&s.pending>n&&(e.adler=Fe(e.adler,s.pending_buf,s.pending-n,n)),0===i&&(s.status=pt)}else s.status=pt;if(s.status===pt&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&_t(e),s.pending+2<=s.pending_buf_size&&(Ct(s,255&e.adler),Ct(s,e.adler>>8&255),e.adler=0,s.status=mt)):s.status=mt),0!==s.pending){if(_t(e),0===e.avail_out)return s.last_flush=-1,Ze}else if(0===e.avail_in&&ft(t)<=ft(o)&&t!==Ke)return gt(e,nt);if(s.status===wt&&0!==e.avail_in)return gt(e,nt);if(0!==e.avail_in||0!==s.lookahead||t!==We&&s.status!==wt){let n=s.strategy===ot?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(kt(e),0===e.lookahead)){if(t===We)return 1;break}if(e.match_length=0,n=He(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(yt(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Ke?(yt(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(yt(e,!1),0===e.strm.avail_out)?1:2})(s,t):s.strategy===rt?((e,t)=>{let n,i,s,o;const r=e.window;for(;;){if(e.lookahead<=ut){if(kt(e),e.lookahead<=ut&&t===We)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(s=e.strstart-1,i=r[s],i===r[++s]&&i===r[++s]&&i===r[++s])){o=e.strstart+ut;do{}while(i===r[++s]&&i===r[++s]&&i===r[++s]&&i===r[++s]&&i===r[++s]&&i===r[++s]&&i===r[++s]&&i===r[++s]&&s<o);e.match_length=ut-(o-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=He(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=He(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(yt(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Ke?(yt(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(yt(e,!1),0===e.strm.avail_out)?1:2})(s,t):Rt[s.level].func(s,t);if(3!==n&&4!==n||(s.status=wt),1===n||3===n)return 0===e.avail_out&&(s.last_flush=-1),Ze;if(2===n&&(t===Je?ze(s):t!==Xe&&(Ge(s,0,0,!1),t===Ye&&(vt(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),_t(e),0===e.avail_out))return s.last_flush=-1,Ze}return t!==Ke?Ze:s.wrap<=0?Qe:(2===s.wrap?(Ct(s,255&e.adler),Ct(s,e.adler>>8&255),Ct(s,e.adler>>16&255),Ct(s,e.adler>>24&255),Ct(s,255&e.total_in),Ct(s,e.total_in>>8&255),Ct(s,e.total_in>>16&255),Ct(s,e.total_in>>24&255)):(St(s,e.adler>>>16),St(s,65535&e.adler)),_t(e),s.wrap>0&&(s.wrap=-s.wrap),0!==s.pending?Ze:Qe)},deflateEnd:e=>{if(!e||!e.state)return et;const t=e.state.status;return 42!==t&&69!==t&&73!==t&&91!==t&&t!==pt&&t!==mt&&t!==wt?gt(e,et):(e.state=null,t===mt?gt(e,tt):Ze)},deflateSetDictionary:(e,t)=>{let n=t.length;if(!e||!e.state)return et;const i=e.state,s=i.wrap;if(2===s||1===s&&42!==i.status||i.lookahead)return et;if(1===s&&(e.adler=Oe(e.adler,t,n,0)),i.wrap=0,n>=i.w_size){0===s&&(vt(i.head),i.strstart=0,i.block_start=0,i.insert=0);let e=new Uint8Array(i.w_size);e.set(t.subarray(n-i.w_size,n),0),t=e,n=i.w_size}const o=e.avail_in,r=e.next_in,a=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,kt(i);i.lookahead>=3;){let e=i.strstart,t=i.lookahead-2;do{i.ins_h=bt(i,i.ins_h,i.window[e+3-1]),i.prev[e&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=e,e++}while(--t);i.strstart=e,i.lookahead=2,kt(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,e.next_in=r,e.input=a,e.avail_in=o,i.wrap=s,Ze},deflateInfo:"pako deflate (from Nodeca project)"};const Nt=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Ot={assign:function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const t in n)Nt(n,t)&&(e[t]=n[t])}}return e},flattenChunks:e=>{let t=0;for(let n=0,i=e.length;n<i;n++)t+=e[n].length;const n=new Uint8Array(t);for(let t=0,i=0,s=e.length;t<s;t++){let s=e[t];n.set(s,i),i+=s.length}return n}};let Bt=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){Bt=!1}const Ft=new Uint8Array(256);for(let e=0;e<256;e++)Ft[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Ft[254]=Ft[254]=1;var Ut={string2buf:e=>{let t,n,i,s,o,r=e.length,a=0;for(s=0;s<r;s++)n=e.charCodeAt(s),55296==(64512&n)&&s+1<r&&(i=e.charCodeAt(s+1),56320==(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),s++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(a),o=0,s=0;o<a;s++)n=e.charCodeAt(s),55296==(64512&n)&&s+1<r&&(i=e.charCodeAt(s+1),56320==(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),s++)),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t},buf2string:(e,t)=>{let n,i;const s=t||e.length,o=new Array(2*s);for(i=0,n=0;n<s;){let t=e[n++];if(t<128){o[i++]=t;continue}let r=Ft[t];if(r>4)o[i++]=65533,n+=r-1;else{for(t&=2===r?31:3===r?15:7;r>1&&n<s;)t=t<<6|63&e[n++],r--;r>1?o[i++]=65533:t<65536?o[i++]=t:(t-=65536,o[i++]=55296|t>>10&1023,o[i++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&Bt)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let i=0;i<t;i++)n+=String.fromCharCode(e[i]);return n})(o,i)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+Ft[e[n]]>t?n:t}},jt=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Vt=Object.prototype.toString,{Z_NO_FLUSH:Gt,Z_SYNC_FLUSH:qt,Z_FULL_FLUSH:Ht,Z_FINISH:zt,Z_OK:Wt,Z_STREAM_END:Jt,Z_DEFAULT_COMPRESSION:Yt,Z_DEFAULT_STRATEGY:Kt,Z_DEFLATED:Xt}=je;function Zt(e){this.options=Ot.assign({level:Yt,method:Xt,chunkSize:16384,windowBits:15,memLevel:8,strategy:Kt},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new jt,this.strm.avail_out=0;let n=Dt.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==Wt)throw new Error(Ue[n]);if(t.header&&Dt.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?Ut.string2buf(t.dictionary):"[object ArrayBuffer]"===Vt.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=Dt.deflateSetDictionary(this.strm,e),n!==Wt)throw new Error(Ue[n]);this._dict_set=!0}}function Qt(e,t){const n=new Zt(t);if(n.push(e,!0),n.err)throw n.msg||Ue[n.err];return n.result}Zt.prototype.push=function(e,t){const n=this.strm,i=this.options.chunkSize;let s,o;if(this.ended)return!1;for(o=t===~~t?t:!0===t?zt:Gt,"string"==typeof e?n.input=Ut.string2buf(e):"[object ArrayBuffer]"===Vt.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),(o===qt||o===Ht)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(s=Dt.deflate(n,o),s===Jt)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),s=Dt.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===Wt;if(0!==n.avail_out){if(o>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},Zt.prototype.onData=function(e){this.chunks.push(e)},Zt.prototype.onEnd=function(e){e===Wt&&(this.result=Ot.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var en={Deflate:Zt,deflate:Qt,deflateRaw:function(e,t){return(t=t||{}).raw=!0,Qt(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,Qt(e,t)},constants:je},tn=function(e,t){let n,i,s,o,r,a,c,l,d,u,h,p,m,w,g,f,v,b,_,y,C,S,E,x;const k=e.state;n=e.next_in,E=e.input,i=n+(e.avail_in-5),s=e.next_out,x=e.output,o=s-(t-e.avail_out),r=s+(e.avail_out-257),a=k.dmax,c=k.wsize,l=k.whave,d=k.wnext,u=k.window,h=k.hold,p=k.bits,m=k.lencode,w=k.distcode,g=(1<<k.lenbits)-1,f=(1<<k.distbits)-1;e:do{p<15&&(h+=E[n++]<<p,p+=8,h+=E[n++]<<p,p+=8),v=m[h&g];t:for(;;){if(b=v>>>24,h>>>=b,p-=b,b=v>>>16&255,0===b)x[s++]=65535&v;else{if(!(16&b)){if(0==(64&b)){v=m[(65535&v)+(h&(1<<b)-1)];continue t}if(32&b){k.mode=12;break e}e.msg="invalid literal/length code",k.mode=30;break e}_=65535&v,b&=15,b&&(p<b&&(h+=E[n++]<<p,p+=8),_+=h&(1<<b)-1,h>>>=b,p-=b),p<15&&(h+=E[n++]<<p,p+=8,h+=E[n++]<<p,p+=8),v=w[h&f];n:for(;;){if(b=v>>>24,h>>>=b,p-=b,b=v>>>16&255,!(16&b)){if(0==(64&b)){v=w[(65535&v)+(h&(1<<b)-1)];continue n}e.msg="invalid distance code",k.mode=30;break e}if(y=65535&v,b&=15,p<b&&(h+=E[n++]<<p,p+=8,p<b&&(h+=E[n++]<<p,p+=8)),y+=h&(1<<b)-1,y>a){e.msg="invalid distance too far back",k.mode=30;break e}if(h>>>=b,p-=b,b=s-o,y>b){if(b=y-b,b>l&&k.sane){e.msg="invalid distance too far back",k.mode=30;break e}if(C=0,S=u,0===d){if(C+=c-b,b<_){_-=b;do{x[s++]=u[C++]}while(--b);C=s-y,S=x}}else if(d<b){if(C+=c+d-b,b-=d,b<_){_-=b;do{x[s++]=u[C++]}while(--b);if(C=0,d<_){b=d,_-=b;do{x[s++]=u[C++]}while(--b);C=s-y,S=x}}}else if(C+=d-b,b<_){_-=b;do{x[s++]=u[C++]}while(--b);C=s-y,S=x}for(;_>2;)x[s++]=S[C++],x[s++]=S[C++],x[s++]=S[C++],_-=3;_&&(x[s++]=S[C++],_>1&&(x[s++]=S[C++]))}else{C=s-y;do{x[s++]=x[C++],x[s++]=x[C++],x[s++]=x[C++],_-=3}while(_>2);_&&(x[s++]=x[C++],_>1&&(x[s++]=x[C++]))}break}}break}}while(n<i&&s<r);_=p>>3,n-=_,p-=_<<3,h&=(1<<p)-1,e.next_in=n,e.next_out=s,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=s<r?r-s+257:257-(s-r),k.hold=h,k.bits=p};const nn=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),sn=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),on=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),rn=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var an=(e,t,n,i,s,o,r,a)=>{const c=a.bits;let l,d,u,h,p,m,w=0,g=0,f=0,v=0,b=0,_=0,y=0,C=0,S=0,E=0,x=null,k=0;const M=new Uint16Array(16),T=new Uint16Array(16);let I,R,A,$=null,L=0;for(w=0;w<=15;w++)M[w]=0;for(g=0;g<i;g++)M[t[n+g]]++;for(b=c,v=15;v>=1&&0===M[v];v--);if(b>v&&(b=v),0===v)return s[o++]=20971520,s[o++]=20971520,a.bits=1,0;for(f=1;f<v&&0===M[f];f++);for(b<f&&(b=f),C=1,w=1;w<=15;w++)if(C<<=1,C-=M[w],C<0)return-1;if(C>0&&(0===e||1!==v))return-1;for(T[1]=0,w=1;w<15;w++)T[w+1]=T[w]+M[w];for(g=0;g<i;g++)0!==t[n+g]&&(r[T[t[n+g]]++]=g);if(0===e?(x=$=r,m=19):1===e?(x=nn,k-=257,$=sn,L-=257,m=256):(x=on,$=rn,m=-1),E=0,g=0,w=f,p=o,_=b,y=0,u=-1,S=1<<b,h=S-1,1===e&&S>852||2===e&&S>592)return 1;for(;;){I=w-y,r[g]<m?(R=0,A=r[g]):r[g]>m?(R=$[L+r[g]],A=x[k+r[g]]):(R=96,A=0),l=1<<w-y,d=1<<_,f=d;do{d-=l,s[p+(E>>y)+d]=I<<24|R<<16|A|0}while(0!==d);for(l=1<<w-1;E&l;)l>>=1;if(0!==l?(E&=l-1,E+=l):E=0,g++,0==--M[w]){if(w===v)break;w=t[n+r[g]]}if(w>b&&(E&h)!==u){for(0===y&&(y=b),p+=f,_=w-y,C=1<<_;_+y<v&&(C-=M[_+y],!(C<=0));)_++,C<<=1;if(S+=1<<_,1===e&&S>852||2===e&&S>592)return 1;u=E&h,s[u]=b<<24|_<<16|p-o|0}}return 0!==E&&(s[p+E]=w-y<<24|64<<16|0),a.bits=b,0};const{Z_FINISH:cn,Z_BLOCK:ln,Z_TREES:dn,Z_OK:un,Z_STREAM_END:hn,Z_NEED_DICT:pn,Z_STREAM_ERROR:mn,Z_DATA_ERROR:wn,Z_MEM_ERROR:gn,Z_BUF_ERROR:fn,Z_DEFLATED:vn}=je,bn=12,_n=30,yn=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function Cn(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Sn=e=>{if(!e||!e.state)return mn;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,un},En=e=>{if(!e||!e.state)return mn;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Sn(e)},xn=(e,t)=>{let n;if(!e||!e.state)return mn;const i=e.state;return t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?mn:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,En(e))},kn=(e,t)=>{if(!e)return mn;const n=new Cn;e.state=n,n.window=null;const i=xn(e,t);return i!==un&&(e.state=null),i};let Mn,Tn,In=!0;const Rn=e=>{if(In){Mn=new Int32Array(512),Tn=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(an(1,e.lens,0,288,Mn,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;an(2,e.lens,0,32,Tn,0,e.work,{bits:5}),In=!1}e.lencode=Mn,e.lenbits=9,e.distcode=Tn,e.distbits=5},An=(e,t,n,i)=>{let s;const o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),i>=o.wsize?(o.window.set(t.subarray(n-o.wsize,n),0),o.wnext=0,o.whave=o.wsize):(s=o.wsize-o.wnext,s>i&&(s=i),o.window.set(t.subarray(n-i,n-i+s),o.wnext),(i-=s)?(o.window.set(t.subarray(n-i,n),0),o.wnext=i,o.whave=o.wsize):(o.wnext+=s,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=s))),0};var $n={inflateReset:En,inflateReset2:xn,inflateResetKeep:Sn,inflateInit:e=>kn(e,15),inflateInit2:kn,inflate:(e,t)=>{let n,i,s,o,r,a,c,l,d,u,h,p,m,w,g,f,v,b,_,y,C,S,E=0;const x=new Uint8Array(4);let k,M;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return mn;n=e.state,n.mode===bn&&(n.mode=13),r=e.next_out,s=e.output,c=e.avail_out,o=e.next_in,i=e.input,a=e.avail_in,l=n.hold,d=n.bits,u=a,h=c,S=un;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;d<16;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}if(2&n.wrap&&35615===l){n.check=0,x[0]=255&l,x[1]=l>>>8&255,n.check=Fe(n.check,x,2,0),l=0,d=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&l)<<8)+(l>>8))%31){e.msg="incorrect header check",n.mode=_n;break}if((15&l)!==vn){e.msg="unknown compression method",n.mode=_n;break}if(l>>>=4,d-=4,C=8+(15&l),0===n.wbits)n.wbits=C;else if(C>n.wbits){e.msg="invalid window size",n.mode=_n;break}n.dmax=1<<n.wbits,e.adler=n.check=1,n.mode=512&l?10:bn,l=0,d=0;break;case 2:for(;d<16;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}if(n.flags=l,(255&n.flags)!==vn){e.msg="unknown compression method",n.mode=_n;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=_n;break}n.head&&(n.head.text=l>>8&1),512&n.flags&&(x[0]=255&l,x[1]=l>>>8&255,n.check=Fe(n.check,x,2,0)),l=0,d=0,n.mode=3;case 3:for(;d<32;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}n.head&&(n.head.time=l),512&n.flags&&(x[0]=255&l,x[1]=l>>>8&255,x[2]=l>>>16&255,x[3]=l>>>24&255,n.check=Fe(n.check,x,4,0)),l=0,d=0,n.mode=4;case 4:for(;d<16;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}n.head&&(n.head.xflags=255&l,n.head.os=l>>8),512&n.flags&&(x[0]=255&l,x[1]=l>>>8&255,n.check=Fe(n.check,x,2,0)),l=0,d=0,n.mode=5;case 5:if(1024&n.flags){for(;d<16;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}n.length=l,n.head&&(n.head.extra_len=l),512&n.flags&&(x[0]=255&l,x[1]=l>>>8&255,n.check=Fe(n.check,x,2,0)),l=0,d=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(p=n.length,p>a&&(p=a),p&&(n.head&&(C=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(o,o+p),C)),512&n.flags&&(n.check=Fe(n.check,i,p,o)),a-=p,o+=p,n.length-=p),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===a)break e;p=0;do{C=i[o+p++],n.head&&C&&n.length<65536&&(n.head.name+=String.fromCharCode(C))}while(C&&p<a);if(512&n.flags&&(n.check=Fe(n.check,i,p,o)),a-=p,o+=p,C)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===a)break e;p=0;do{C=i[o+p++],n.head&&C&&n.length<65536&&(n.head.comment+=String.fromCharCode(C))}while(C&&p<a);if(512&n.flags&&(n.check=Fe(n.check,i,p,o)),a-=p,o+=p,C)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;d<16;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}if(l!==(65535&n.check)){e.msg="header crc mismatch",n.mode=_n;break}l=0,d=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=bn;break;case 10:for(;d<32;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}e.adler=n.check=yn(l),l=0,d=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=r,e.avail_out=c,e.next_in=o,e.avail_in=a,n.hold=l,n.bits=d,pn;e.adler=n.check=1,n.mode=bn;case bn:if(t===ln||t===dn)break e;case 13:if(n.last){l>>>=7&d,d-=7&d,n.mode=27;break}for(;d<3;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}switch(n.last=1&l,l>>>=1,d-=1,3&l){case 0:n.mode=14;break;case 1:if(Rn(n),n.mode=20,t===dn){l>>>=2,d-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=_n}l>>>=2,d-=2;break;case 14:for(l>>>=7&d,d-=7&d;d<32;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}if((65535&l)!=(l>>>16^65535)){e.msg="invalid stored block lengths",n.mode=_n;break}if(n.length=65535&l,l=0,d=0,n.mode=15,t===dn)break e;case 15:n.mode=16;case 16:if(p=n.length,p){if(p>a&&(p=a),p>c&&(p=c),0===p)break e;s.set(i.subarray(o,o+p),r),a-=p,o+=p,c-=p,r+=p,n.length-=p;break}n.mode=bn;break;case 17:for(;d<14;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}if(n.nlen=257+(31&l),l>>>=5,d-=5,n.ndist=1+(31&l),l>>>=5,d-=5,n.ncode=4+(15&l),l>>>=4,d-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=_n;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;d<3;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}n.lens[T[n.have++]]=7&l,l>>>=3,d-=3}for(;n.have<19;)n.lens[T[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,k={bits:n.lenbits},S=an(0,n.lens,0,19,n.lencode,0,n.work,k),n.lenbits=k.bits,S){e.msg="invalid code lengths set",n.mode=_n;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;E=n.lencode[l&(1<<n.lenbits)-1],g=E>>>24,f=E>>>16&255,v=65535&E,!(g<=d);){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}if(v<16)l>>>=g,d-=g,n.lens[n.have++]=v;else{if(16===v){for(M=g+2;d<M;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}if(l>>>=g,d-=g,0===n.have){e.msg="invalid bit length repeat",n.mode=_n;break}C=n.lens[n.have-1],p=3+(3&l),l>>>=2,d-=2}else if(17===v){for(M=g+3;d<M;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}l>>>=g,d-=g,C=0,p=3+(7&l),l>>>=3,d-=3}else{for(M=g+7;d<M;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}l>>>=g,d-=g,C=0,p=11+(127&l),l>>>=7,d-=7}if(n.have+p>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=_n;break}for(;p--;)n.lens[n.have++]=C}}if(n.mode===_n)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=_n;break}if(n.lenbits=9,k={bits:n.lenbits},S=an(1,n.lens,0,n.nlen,n.lencode,0,n.work,k),n.lenbits=k.bits,S){e.msg="invalid literal/lengths set",n.mode=_n;break}if(n.distbits=6,n.distcode=n.distdyn,k={bits:n.distbits},S=an(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,k),n.distbits=k.bits,S){e.msg="invalid distances set",n.mode=_n;break}if(n.mode=20,t===dn)break e;case 20:n.mode=21;case 21:if(a>=6&&c>=258){e.next_out=r,e.avail_out=c,e.next_in=o,e.avail_in=a,n.hold=l,n.bits=d,tn(e,h),r=e.next_out,s=e.output,c=e.avail_out,o=e.next_in,i=e.input,a=e.avail_in,l=n.hold,d=n.bits,n.mode===bn&&(n.back=-1);break}for(n.back=0;E=n.lencode[l&(1<<n.lenbits)-1],g=E>>>24,f=E>>>16&255,v=65535&E,!(g<=d);){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}if(f&&0==(240&f)){for(b=g,_=f,y=v;E=n.lencode[y+((l&(1<<b+_)-1)>>b)],g=E>>>24,f=E>>>16&255,v=65535&E,!(b+g<=d);){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}l>>>=b,d-=b,n.back+=b}if(l>>>=g,d-=g,n.back+=g,n.length=v,0===f){n.mode=26;break}if(32&f){n.back=-1,n.mode=bn;break}if(64&f){e.msg="invalid literal/length code",n.mode=_n;break}n.extra=15&f,n.mode=22;case 22:if(n.extra){for(M=n.extra;d<M;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}n.length+=l&(1<<n.extra)-1,l>>>=n.extra,d-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;E=n.distcode[l&(1<<n.distbits)-1],g=E>>>24,f=E>>>16&255,v=65535&E,!(g<=d);){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}if(0==(240&f)){for(b=g,_=f,y=v;E=n.distcode[y+((l&(1<<b+_)-1)>>b)],g=E>>>24,f=E>>>16&255,v=65535&E,!(b+g<=d);){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}l>>>=b,d-=b,n.back+=b}if(l>>>=g,d-=g,n.back+=g,64&f){e.msg="invalid distance code",n.mode=_n;break}n.offset=v,n.extra=15&f,n.mode=24;case 24:if(n.extra){for(M=n.extra;d<M;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}n.offset+=l&(1<<n.extra)-1,l>>>=n.extra,d-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=_n;break}n.mode=25;case 25:if(0===c)break e;if(p=h-c,n.offset>p){if(p=n.offset-p,p>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=_n;break}p>n.wnext?(p-=n.wnext,m=n.wsize-p):m=n.wnext-p,p>n.length&&(p=n.length),w=n.window}else w=s,m=r-n.offset,p=n.length;p>c&&(p=c),c-=p,n.length-=p;do{s[r++]=w[m++]}while(--p);0===n.length&&(n.mode=21);break;case 26:if(0===c)break e;s[r++]=n.length,c--,n.mode=21;break;case 27:if(n.wrap){for(;d<32;){if(0===a)break e;a--,l|=i[o++]<<d,d+=8}if(h-=c,e.total_out+=h,n.total+=h,h&&(e.adler=n.check=n.flags?Fe(n.check,s,h,r-h):Oe(n.check,s,h,r-h)),h=c,(n.flags?l:yn(l))!==n.check){e.msg="incorrect data check",n.mode=_n;break}l=0,d=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;d<32;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}if(l!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=_n;break}l=0,d=0}n.mode=29;case 29:S=hn;break e;case _n:S=wn;break e;case 31:return gn;default:return mn}return e.next_out=r,e.avail_out=c,e.next_in=o,e.avail_in=a,n.hold=l,n.bits=d,(n.wsize||h!==e.avail_out&&n.mode<_n&&(n.mode<27||t!==cn))&&An(e,e.output,e.next_out,h-e.avail_out),u-=e.avail_in,h-=e.avail_out,e.total_in+=u,e.total_out+=h,n.total+=h,n.wrap&&h&&(e.adler=n.check=n.flags?Fe(n.check,s,h,e.next_out-h):Oe(n.check,s,h,e.next_out-h)),e.data_type=n.bits+(n.last?64:0)+(n.mode===bn?128:0)+(20===n.mode||15===n.mode?256:0),(0===u&&0===h||t===cn)&&S===un&&(S=fn),S},inflateEnd:e=>{if(!e||!e.state)return mn;let t=e.state;return t.window&&(t.window=null),e.state=null,un},inflateGetHeader:(e,t)=>{if(!e||!e.state)return mn;const n=e.state;return 0==(2&n.wrap)?mn:(n.head=t,t.done=!1,un)},inflateSetDictionary:(e,t)=>{const n=t.length;let i,s,o;return e&&e.state?(i=e.state,0!==i.wrap&&11!==i.mode?mn:11===i.mode&&(s=1,s=Oe(s,t,n,0),s!==i.check)?wn:(o=An(e,t,n,n),o?(i.mode=31,gn):(i.havedict=1,un))):mn},inflateInfo:"pako inflate (from Nodeca project)"},Ln=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const Pn=Object.prototype.toString,{Z_NO_FLUSH:Dn,Z_FINISH:Nn,Z_OK:On,Z_STREAM_END:Bn,Z_NEED_DICT:Fn,Z_STREAM_ERROR:Un,Z_DATA_ERROR:jn,Z_MEM_ERROR:Vn}=je;function Gn(e){this.options=Ot.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new jt,this.strm.avail_out=0;let n=$n.inflateInit2(this.strm,t.windowBits);if(n!==On)throw new Error(Ue[n]);if(this.header=new Ln,$n.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=Ut.string2buf(t.dictionary):"[object ArrayBuffer]"===Pn.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=$n.inflateSetDictionary(this.strm,t.dictionary),n!==On)))throw new Error(Ue[n])}function qn(e,t){const n=new Gn(t);if(n.push(e),n.err)throw n.msg||Ue[n.err];return n.result}Gn.prototype.push=function(e,t){const n=this.strm,i=this.options.chunkSize,s=this.options.dictionary;let o,r,a;if(this.ended)return!1;for(r=t===~~t?t:!0===t?Nn:Dn,"[object ArrayBuffer]"===Pn.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),o=$n.inflate(n,r),o===Fn&&s&&(o=$n.inflateSetDictionary(n,s),o===On?o=$n.inflate(n,r):o===jn&&(o=Fn));n.avail_in>0&&o===Bn&&n.state.wrap>0&&0!==e[n.next_in];)$n.inflateReset(n),o=$n.inflate(n,r);switch(o){case Un:case jn:case Fn:case Vn:return this.onEnd(o),this.ended=!0,!1}if(a=n.avail_out,n.next_out&&(0===n.avail_out||o===Bn))if("string"===this.options.to){let e=Ut.utf8border(n.output,n.next_out),t=n.next_out-e,s=Ut.buf2string(n.output,e);n.next_out=t,n.avail_out=i-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(s)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(o!==On||0!==a){if(o===Bn)return o=$n.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},Gn.prototype.onData=function(e){this.chunks.push(e)},Gn.prototype.onEnd=function(e){e===On&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Ot.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Hn={Inflate:Gn,inflate:qn,inflateRaw:function(e,t){return(t=t||{}).raw=!0,qn(e,t)},ungzip:qn,constants:je};const{Deflate:zn,deflate:Wn,deflateRaw:Jn,gzip:Yn}=en,{Inflate:Kn,inflate:Xn,inflateRaw:Zn,ungzip:Qn}=Hn;var ei=Yn;const ti=async function(e){const t={method:"POST",headers:new Headers({"Content-Type":"application/x-ldjson","x-api-key":window.auth_token,"Content-Encoding":"gzip"})};t.body=await ei(e);const n=`${window.apiServer}/ingestion/fact`;let i;try{i=await fetch(n,t).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`setAnalyticsFacts error: ${JSON.stringify(e.errors)}`),[]):e)).catch((e=>{e.json().then((e=>{z(e)})),E(e)}))}catch(e){E(e)}return i},ni=async function(){const e=X(),t=`${window.apiServer}/ingestion/fact`;let n;try{n=await fetch(t,e).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`getAnalyticsFacts error: ${JSON.stringify(e.errors)}`),[]):e)).catch((e=>{E(e)}))}catch(e){}return n},ii=async function(e,t,n,i){const s=new URLSearchParams;e&&s.set("category",e),t&&s.set("filter",t),n&&s.set("limit",n),i&&s.set("offset",i);let o=`${window.apiServer}/css/channel`;""!==s.toString()&&(o+=`?${s.toString()}`);const r=X();let a;try{a=await fetch(o,r).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`getChannels error: ${JSON.stringify(e.errors)}`),[]):e.channels)).catch((e=>{E(e)}))}catch(e){E(e)}return a},si=async function(e){const t=e;let n,i;n="p"===window._channel.getSuffix(t)?`${window.apiServer}/mas/channel/${t}?fields=*`:`${window.apiServer}/room/detail/${t}`;const s=X();try{i=await fetch(n,s).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`getChannelData error: ${JSON.stringify(e.errors)}`),[]):e)).catch((e=>{E(e)}))}catch(e){E(e)}return i},oi=async function(){const e=`${window.apiServer}/device/${p.DEVICE_ID}/category`,t=`SHA1 ${(await function(e){const t=(new TextEncoder).encode(e);return crypto.subtle.digest("SHA-1",t).then((e=>Array.from(new Uint8Array(e)).map((e=>e.toString(16).padStart(2,"0"))).join("")))}(p.PASSWORD)).toUpperCase()}`,n={method:"GET",headers:new Headers({"Content-Type":"application/json","X-Authorization":t})};let i;try{return i=await fetch(e,n).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`getChannelCategories error: ${JSON.stringify(e.errors)}`),[]):e)).catch((e=>{E(e)})),i}catch(e){return E(e),e}},ri=async function(e){let t=`${window.apiServer}/mas/invite`;if("-g"===window._channel.getName().substr(-2))return E(`[Invite] Get Channel Invites for channel ${e} not possible because it is an ephemeral channel!`),[];const n=new URLSearchParams;if(!e)return E("[Invite] Get Channel Invites: missing channel parameter!"),!1;n.set("channel",e),""!==n.toString()&&(t+=`?${n.toString()}`);const i=X();let s;try{s=await fetch(t,i).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`[Invite] Get Channel Invites error: ${JSON.stringify(e.errors)}`),!1):e)).catch((e=>{E(e)}))}catch(e){E(e)}return s},ai=async function(e){const t=p.NICK;let n=`${window.apiServer}/mas/channel/${e}/member/verify`;const i=new URLSearchParams;i.set("name",t),n+=`?${i.toString()}`;const s=X();let o;try{o=await fetch(n,s).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`[Channel] Verify member error: ${JSON.stringify(e.errors)}`),!1):e)).catch((e=>{E(e)}))}catch(e){E(e)}return o},ci=async function(e,t,n,i){const s=new URLSearchParams;t&&s.set("filter",t),n&&s.set("limit",n),i&&s.set("offset",i);let o=`${window.apiServer}/css/featured`;""!==s.toString()&&(o+=`?${s.toString()}`);const r=X();let a;try{a=await fetch(o,r).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`getFeaturedChannels error: ${JSON.stringify(e.errors)}`),[]):e.channels)).catch((e=>{E(e)}))}catch(e){E(e)}return a},li=async function(e,t,n){const i=new URLSearchParams;e&&i.set("filter",e),t&&i.set("limit",t),n&&i.set("offset",n);let s=`${window.apiServer}/css/activity`;""!==i.toString()&&(s+=`?${i.toString()}`);const o=X();let r;try{r=await fetch(s,o).then((e=>e.json())).then((e=>e.errors?(E(`getActivityChannels error: ${JSON.stringify(e.errors)}`),[]):e.channels)).catch((e=>{E(e)}))}catch(e){E(e)}return r},di=async function(){const e=`${window.apiServer}/room/user?list_all=true&with_cards=true`,t=X();let n;try{n=await fetch(e,t).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`getRooms error: ${JSON.stringify(e.errors)}`),null):e)).catch((e=>(E(e),null)))}catch(e){return E(e),null}return n},ui=async function(e){const t=new URLSearchParams;if(t.set("realm",p.REALM),t.append("fields","id"),t.append("fields","name"),t.append("fields","parent_id"),t.append("fields","show_in_filter"),t.append("fields","show_in_list"),e)for(let n=0;n<e.length;n+=1)t.append("category_ids",e[n]);let n=`${window.apiServer}/room/category`;""!==t.toString()&&(n+=`?${t.toString()}`);const i=X();let s;try{s=await fetch(n,i).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`getRooms error: ${JSON.stringify(e.errors)}`),[]):e)).catch((e=>{E(e)}))}catch(e){E(e)}return s},hi=async function(e,t,n){const i=new URLSearchParams;t&&i.set("limit",t),n&&i.set("offset",n);let s=`${window.apiServer}/ppcs/channel/${e}/message`;""!==i.toString()&&(s+=`?${i.toString()}`);const o=X();let r;try{r=await fetch(s,o).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`getChannelMessages error: ${JSON.stringify(e.errors)}`),[]):e)).catch((e=>{E(e)}))}catch(e){E(e)}return r},pi=async function(e=window._engine.currentChannel(),t=100,n=0){const i=window._channel.getSuffix(e),s=(new Date).getTime(),o=p.DEVICE_ID;let r=await function(e){const t=(new TextEncoder).encode(e);return crypto.subtle.digest("SHA-1",t).then((e=>Array.from(new Uint8Array(e)).map((e=>e.toString(16).padStart(2,"0"))).join("")))}(p.PASSWORD);r=r.toUpperCase();const a=new URLSearchParams;let c;t&&a.set("limit",t),void 0!==n&&a.set("offset",n),c="p"===i?`${window.apiServer}/ppcs/channel/${e}/message`:`${window.apiServer}/room/${e}/message`,""!==a.toString()?c+=`?mas_token=sha1:${o}:${r}&${a.toString()}`:c+=`?mas_token=sha1:${o}:${r}`;const l=X();let d;l.headers=new Headers({"Content-Type":"application/json"}),l["X-Authorization"]=`SHA1:${r}`,l["X-Sequence-Number"]=s;try{d=await fetch(c,l).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`getChannelMessages2 error: ${JSON.stringify(e.errors)}`),[]):e)).catch((e=>{E(e)}))}catch(e){E(e)}return d},mi=async function(e){const t=e,n=new URLSearchParams;n.set("realm",window.realm),t.name&&n.set("name",t.name),t.like&&n.set("like",t.like),t.parent_id&&n.set("parent_id",t.parent_id),t.root_tree&&n.set("root_tree",t.root_tree),t.show_in_navigation&&n.set("show_in_navigation",t.show_in_navigation),t.limit&&n.set("limit",t.limit),t.offset&&n.set("offset",t.offset);let i=`${window.apiServer}/csm/category`;""!==n.toString()&&(i+=`?${n.toString()}`);const s=X();let o;try{o=await fetch(i,s).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`getSessionCategory error: ${JSON.stringify(e.errors)}`),[]):e)).catch((e=>(e.json().then((e=>{z(e)})),!1)))}catch(e){return!1}return o},wi=async function(e){const t=e,n=W(),i=`${window.apiServer}/csm/report/notify/sendme`;let s;n.body=JSON.stringify(t),E(`[CMS session] Send session CSV report with body: ${JSON.stringify(t)}`);try{s=await fetch(i,n).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`[CSM session] Send session CSV report error: ${JSON.stringify(e.errors)}`),!1):e)).catch((e=>(e.json().then((e=>{z(e)})),!1)))}catch(e){return!1}return s},gi="seducsp_token",fi="auth_token",vi="room_name",bi=async function(e,t){const n=e,i=t;let s,o;switch(n){case gi:s=`${window.apiServer}/mas/external-auth/${n}/generate?card_label=${i}`;break;case fi:o={},o.token=p.AUTH_TOKEN;break;case vi:o={},o.room_name=p.SELECTED_ROOM;break;default:E(`[Request] getExternalAuth: not a valid placeholder = ${n} card_label = ${i}`),s=""}if(o)return o;if(s){E(`[Request] getExternalAuth: placeholder = ${n} label = ${i}`);const e=X();let t;try{t=await fetch(s,e).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`[Request] getExternalAuth error: ${JSON.stringify(e.errors)}`),[]):e)).catch((e=>{E(e)}))}catch(e){E(e)}return t}return!1},_i=async function(e,t,n){const i=e,s=t,o=n;let r,a;switch(i){case gi:r=`${window.apiServer}/mas/external-auth/${i}/check?token=${s}&card_label=${o}`;break;case fi:case vi:case"!email":case"email":a=!0;break;default:E(`[Request] checkExternalAuth: not a valid placeholder = "${i}" card_label = "${o}"`),r=""}if(a)return a;if(r){E(`[Request] checkExternalAuth: placeholder = "${i}" value = "${s}"`);const e=X();let t;try{t=await fetch(r,e).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`[Request] checkExternalAuth error: ${JSON.stringify(e.errors)}`),[]):e)).catch((e=>{E(e)}))}catch(e){E(e)}return!!t.success}return!1},yi={"en-US":{realmLabel:"Insert realm code",invalidRealm:"invalid realm!",select:"Select",forgotPassword:"Password recovery",username:"Username:",password:"Password:",enter:"Enter",or:"or",emailaccess:"E-mail access",authError401:"Incorrect username or password!",authError403:"Unauthorized user!",authErrorOther:"Sorry, we were unable to authenticate your user at this time. Please try again later.",authErrorNoInternet:"Sorry, we were unable to authenticate your user at this time. Please check your internet connection and try again.",userRecovery:"Enter your username for password recovery:",emailSent:"Password recovery email sent!",emailNotFound:"E-mail not registered!",userNotFound:"User not registered!",systemProblem:"System unavailable, please try again later!",send:"Send",back:"Back",enterQRCode:"Login with QrCode"},"pt-BR":{realmLabel:"Informe o realm",invalidRealm:"realm invÃ¡lido!",select:"Selecionar",forgotPassword:"Esqueci minha senha",username:"UsuÃ¡rio",password:"Senha:",enter:"Entrar",or:"ou",emailaccess:"Acesse com seu e-mail",authError401:"UsuÃ¡rio ou senha incorretos!",authError403:"UsuÃ¡rio nÃ£o autorizado!",authErrorOther:"Desculpe, mas nÃ£o foi possÃ­vel autenticar seu usuÃ¡rio neste momento. Por favor, tente novamente mais tarde.",authErrorNoInternet:"Desculpe, mas nÃ£o foi possÃ­vel autenticar seu usuÃ¡rio neste momento. Verifique sua conexÃ£o com a internet e tente novamente.",userRecovery:"Insira seu usuÃ¡rio para a recuperaÃ§Ã£o de senha:",emailSent:"Enviamos um e-mail com instruÃ§Ãµes de como redefinir sua senha!",emailNotFound:"E-mail nÃ£o cadastrado!",userNotFound:"UsuÃ¡rio nÃ£o encontrado!",systemProblem:"Sistema indisponÃ­vel, tente novamente mais tarde!",send:"Enviar",back:"Voltar",enterQRCode:"Entrar com QrCode"}};async function Ci(){await window.i18n;const e=document.querySelectorAll(".btnLogin-qr"),t=document.querySelector("body"),n=await window.login.getRealmConfig(window.login.realmConfig.realm),i=new URLSearchParams(window.location.search);let s,o,r,a,c,l,d,u,h,p,m,w,g;function f(){(function(){if(document.getElementById("qrcode-info-panel"))return;let e=`\n            <div id="qrcode-info-panel" class="modal"\n            style="display: none; height: 100vh; width: 100vw; position: absolute; top: 0; left: 0; flex-direction: row; justify-content: center; align-items: center;">\n                <div id="main-container"\n                    style="width: 400px; height: 547px; background-color: white; padding: 20px; border-radius: 10px; box-shadow: 2px 4px 2px 0px rgba(0, 0, 0, 0.25); display: flex; flex-direction: column; justify-content: center; align-items: center;">\n                    <img src="${s}" class="logo"\n                    style="max-width: 260px;">\n                    <br>\n                    <p id="scan-qrcode-text" style="width: 297px; color:#2E3E4B; font-size: 16px; margin: 0; text-align: justify; margin-bottom: 15px;">Para realizar o login, escaneie o QrCode que estÃ¡ no verso da sua carteirinha de estudante apontando ele para a cÃ¢mera.</p>\n                    <img src="${window.login.realmConfig.assets}/common/img/student_card.png"\n                    style="max-width: 260px; margin-bottom: 20px; border-radius:4.79px;" />\n                    <div id="buttons-div" style="display: flex; flex-direction: column; justify-content: center; align-items:center; width: 100%; gap: 10px; margin-bottom: 10px;">\n                    <button id="start-button"\n                        style="width: 297px; height: 47px; border: 0; border-radius: 5px; background-color: #1A3975; color: white; font-size: 16px; cursor: pointer;">Ler com QrCode</button>\n                    <button id="back-login-panel-button"\n                        style="width: 297px; height: 47px; border: solid 1px #EAECED; border-radius: 5px; box-shadow: 1px 1px 4px 0px rgba(0, 0, 0, 0.25); background-color: #FEFEFE; color: #2E3E4B; font-size: 16px; cursor: pointer;">Voltar</button>\n                    </div>\n                </div>\n            </div>\n        `,n=document.createElement("div");e=e.replace("{{asset}}",window.login.realmConfig.assets),e=e.replace("{{logoUrl}}",s),n.innerHTML=e,t.appendChild(n),o=document.getElementById("qrcode-info-panel"),u=document.getElementById("start-button"),p=document.getElementById("back-login-panel-button"),document.getElementById("scan-qrcode-text").innerHTML=`${window.i18n.get("scan-qrcode-text")}`,document.getElementById("start-button").innerHTML=`${window.i18n.get("start-button")}`,document.getElementById("back-login-panel-button").innerHTML=`${window.i18n.get("back-login-panel-button")}`,p.addEventListener("click",(()=>{o.style.display="none",document.querySelector(".login-panel").style.display="flex"})),u.addEventListener("click",(()=>{o.style.display="none",function(){if(document.getElementById("qrcode-login-panel"))return;let e=`\n            <div id="qrcode-login-panel" class="modal" style="display: none; height: 100vh; width: 100vw; position: absolute; top: 0; left: 0; flex-direction: row; justify-content: center; align-items: center;">\n                <div id="main-container" style="width: 400px; height: 539px; background-color: white; padding: 20px; border-radius: 10px; box-shadow: 1px 2px 4px rgba(0, 0, 0, 0.5); display: flex; flex-direction: column; justify-content: center; align-items: center;">\n                    <img src="${s}" class="logo" style="max-width: 260px; margin-bottom:20px;">\n                    <div id="point-message" class="pb5"><p></p></div>\n                    <div id="video-container" style="line-height: 0; width: 234px; height: 234px; border-radius: 5px; display: flex; justify-content: center; align-items: center;">\n                        <video id="qr-video" style="height: 226px; width: 226px; object-fit: cover; border-radius: 5px;"></video>\n                        <div id="mask"></div>\n                    </div>\n                    <div id="detected-qrcode-div" style="display: flex; flex-direction: row; justify-content: flex-start; align-items: flex-start; width: 100%; display: none;">\n                        <b>Detected QR code: </b>\n                        <span id="cam-qr-result">None</span>\n                    </div>\n                    <br>\n                    <div id="buttons-div" style="display: flex; flex-direction: column; width: 100%; gap: 10px;">\n                        <button id="back-info-panel-button" style="width: 350px; height: 47px; border: 1px solid #EAECED; border-radius: 5px; background-color: #FEFEFE; color: #2E3E4B; font-size: 16px; cursor: pointer; box-shadow: 1px 1px 4px 0px rgba(0, 0, 0, 0.25);">Voltar</button>\n                    </div>\n                    <div id="last-detected-div" style="flex-direction: row; justify-content: center; align-items: flex-start; width: 100%; display: none;">\n                    </div>\n                </div>\n            </div>\n        `,n=document.createElement("div");e=e.replace("{{logoUrl}}",s),n.innerHTML=e,t.appendChild(n),r=document.getElementById("qrcode-login-panel"),c=document.getElementById("qr-video"),l=document.getElementById("video-container"),d=document.getElementById("cam-qr-result"),m=document.getElementById("back-info-panel-button"),document.getElementById("point-message").innerHTML=`${window.i18n.get("point-message")}`,document.getElementById("back-info-panel-button").innerHTML=`${window.i18n.get("back-info-panel-button")}`,m.addEventListener("click",(()=>{r.style.display="none",o.style.display="flex",y()})),_()}(),r.style.display="flex",_()}))})(),o&&(o.style.display="flex")}function v(){!function(){if(document.getElementById("invalid-qrcode-panel"))return;let e=`\n            <div id="invalid-qrcode-panel" class="modal"\n            style="display: none; height: 100vh; width: 100vw; position: absolute; top: 0; left: 0; flex-direction: row; justify-content: center; align-items: center;">\n                <div id="main-container"\n                    style="width: 400px; height: 302px; background-color: white; padding: 20px; border-radius: 10px; box-shadow: 1px 2px 4px rgba(0, 0, 0, 0.5); display: flex; flex-direction: column; justify-content: center; align-items: center; gap: 20px;">\n                    <img src="${s}" class="logo"\n                    style="max-width: 260px;">\n                    <div id="invalid-qrcode-message" class="pb5"><p>QrCode invÃ¡lido!</p></div>\n                    <div id="buttons-div" style="display: flex; flex-direction: column; width: 100%; gap: 10px;">\n                    <button id="back-all-btn"\n                    style="width: 350px; height: 47px; border: 0; border-radius: 5px; background-color: #1A3975; color: white; font-size: 16px; cursor: pointer;">Voltar</button>\n                    </div>\n                </div>\n            </div>\n        `,n=document.createElement("div");e=e.replace("{{logoUrl}}",s),n.innerHTML=e,t.appendChild(n),a=document.getElementById("invalid-qrcode-panel"),h=document.getElementById("back-all-btn"),document.getElementById("invalid-qrcode-message").innerHTML=`${window.i18n.get("invalid-qrcode-message")}`,document.getElementById("back-all-btn").innerHTML=`${window.i18n.get("back-all-btn")}`,h.addEventListener("click",(()=>{a.style.display="none",i.has("type")?f():document.querySelector(".login-panel").style.display="flex"}))}(),b(),a.style.display="flex",l.style.backgroundColor="transparent",y()}function b(){o&&(o.style.display="none"),r&&(r.style.display="none"),a&&(a.style.display="none")}function _(){g=!1,w=new QrScanner(c,(e=>{!async function(e,t){if(g)return;let n;if(g=!0,"string"!=typeof t.data)return console.error("QR code is not of text type."),void v();try{n=JSON.parse(t.data)}catch(e){return console.error("Error parsing JSON string:",e),g=!1,void v()}const i=n.username,s=n.password;i&&s||(console.error("QrCode is missing required fields."),v()),window.login.username=i,window.login.password=s,window.login.auth_type="normal",void 0!==(await window.login.authenticate()).nick?(l.style.backgroundColor="#00A407",window.location.href=`/${window.location.search}`,b()):(l.style.backgroundColor="#C10808",setTimeout((()=>{v()}),1e3))}(0,e)}),{onDecodeError:e=>{d.textContent=e,d.style.color="inherit"}}),w.start().then((()=>{})).catch((e=>{console.error("Unable to start scanner",e)}))}function y(){if(w){const e=w.stop();e instanceof Promise&&e.then((()=>{})).catch((e=>{console.error("Unable to stop scanner",e)}))}}n&&(s=n.logo_url),e.forEach((e=>{e.addEventListener("click",(()=>{document.querySelector(".login-panel").style.display="none",f()}))})),i.has("type")&&(document.querySelector(".login-panel").style.display="none",f())}let Si;const Ei=e=>{Si=e,Si?yi[Si]||(Si="en"):Si=window.navigator.language.includes("pt-BR")||window.navigator.language.includes("pt")?"pt-BR":"en-US";const t=yi[Si];l()("#realm-label").html(t.realmLabel),l()(".btnRealm").val(t.select),l()(".btnBack").html(t.back),l()("#password-recovery").html(t.forgotPassword),l()("#user-recovery-label").html(t.userRecovery),l()(".i18n-username").html(t.username),l()(".i18n-password").html(t.password),l()(".i18n-or").html(t.or),l()(".i18n-emailaccess").html(t.emailaccess),l()("#btnLogin").attr("value",t.enter),l()("#btnLogin-qr").attr("value",t.enterQRCode),l()(".btn-send-password-request").attr("value",t.send),l()("#password-back").html(t.back)},xi=()=>yi[Si],ki=async()=>{Ci(),window.addEventListener("languagechange",(function(){let e="en";(navigator.language.includes("pt-BR")||navigator.language.includes("pt"))&&(e="pt-BR"),Ei(e)})),l()("body").keydown((function(e){13===e.which&&(e.preventDefault(),l()("#forgot-password").is(":visible")?l()(".btn-send-password-request").click():l()("#iptv-login").is(":visible")?l()("#btnLogin").click():l()("#realm-panel").is(":visible")&&l()("#btnRealm").click())}));let e=localStorage.getItem("selectedRealm");e&&"undefined"!==e||(e=!1);const t={"aulaamweb.ip.tv":"eduam","conectarmaisweb.ip.tv":"educm","seducpaweb.ip.tv":"edupa","aulaprweb.ip.tv":"edupr","vempraaularoweb.ip.tv":"eduro","cmspweb.ip.tv":"edusp","cmspiweb.ip.tv":"eduspi","web2.ip.tv":"iptv","manoweb.ip.tv":"mano","web.saladeaula.embratel.cloud":"saladeaula","schoolweb.ip.tv":"school","scibonoeduverse.ip.tv":"scibono","educarecifeweb.ip.tv":"smerec","stagingweb.ip.tv":"staging","ueaweb.ip.tv":"uea"};window.login.realmConfig.url in t&&(e=t[window.login.realmConfig.url]);let n=!1;if(e){try{n=await window.login.getRealmConfig(e)}catch(e){localStorage.removeItem("selectedRealm"),l()("#realm-panel").show(),l()("#realm").focus()}if(n){window.realmData=n,n.nick_suffix?window.suffix=n.nick_suffix:window.suffix=n.suffix,window.create_on_signin=n.create_on_signin;const e=n.allowed_signin;if(e.includes("iptv")?(l()("#iptv-login").show(),e.includes("google")?l()("#or-bar").show():l()("#or-bar").hide()):l()("#iptv-login").hide(),e.includes("google")){l()("#google-login").show();const e=n.google_client_id;e&&window.gapi.load("auth2",(function(){window.gapi.auth2.init({client_id:e}).then((async function(e){const t=window.gapi.auth2.getAuthInstance();await t.signOut(),t.disconnect(),window.gapi&&window.gapi.signin2&&window.gapi.signin2.render("google_sign_in_button",{scope:"profile email",width:180,height:40,longtitle:!1,theme:"dark"}),window.authInstance=e;const n=e.currentUser.get();window.googleUser=n,e.currentUser.listen((e=>{window.login.authenticateGoogle(e)}))}))}))}else l()("#google-login").hide();l()(".logo").attr("src",n.logo_url),l()(".logo").show(),"edusp"!==n.code&&l()("#alo").attr("src",n.logo_url),l()("#favicon").attr("href",n.favicon_url),l()("title").html(n.name),window.realm=n.code,l()(".login").show(),l()("#username").focus()}}else l()("#realm-panel").show(),l()("#realm").focus();function i(){l()("#block").show(),document.getElementById("block").style.cursor="wait"}function s(){l()("#block").hide(),document.getElementById("block").style.cursor="auto"}l()("#btnRealm").on("click",(async function(){const e=xi();await window.login.loadRealmsConfig();const t=l()("#realm").val().trim().replaceAll(" ","");if(t.length<3)return l()("#realm").focus(),localStorage.removeItem("selectedRealm"),!1;function n(){return l()(".alert").hide(),l()("#alert-realm").html(e.invalidRealm),l()("#alert-realm").show(),l()("#realm-panel").show(),l()("#realm").focus(),localStorage.removeItem("selectedRealm"),!1}let i;try{i=await window.login.getRealmConfig(t)}catch(e){return n(),!1}if(!i)return n(),!1;l()(".alert").hide(),window.realmData=i,window.suffix=window.realmData.nick_suffix?window.realmData.nick_suffix:window.realmData.suffix,window.create_on_signin=i.create_on_signin;const s=i.allowed_signin;if(s.includes("iptv")?(l()("#iptv-login").show(),s.includes("google")?l()("#or-bar").show():l()("#or-bar").hide()):l()("#iptv-login").hide(),s.includes("google")){l()("#google-login").show();const e=i.google_client_id;e&&window.gapi.auth2.init({client_id:e}).then((async function(e){const t=window.gapi.auth2.getAuthInstance();await t.signOut(),t.disconnect(),window.gapi&&window.gapi.signin2&&window.gapi.signin2.render("google_sign_in_button",{scope:"profile email",width:180,height:40,longtitle:!1,theme:"dark"}),window.authInstance=e;const n=e.currentUser.get();window.googleUser=n,e.currentUser.listen((e=>{window.login.authenticateGoogle(e)}))}))}else l()("#google-login").hide();return l()(".logo").attr("src",i.logo_url),l()(".logo").show(),l()("#favicon").attr("href",i.favicon),l()("title").html(i.name),localStorage.setItem("selectedRealm",i.code),window.realm=i.code,l()(".panel").hide(),l()(".login").show(),l()("#username").focus(),!1})),l()("#btnBackRealm").on("click",(()=>{localStorage.removeItem("selectedRealm"),l()(".panel").hide(),l()(".logo").attr("src",""),l()(".logo").hide(),l()("#realm").val(""),l()("#alert-realm").hide(),l()("#realm-panel").show(),l()(".alert").html("")})),l()("#showpassword").click((function(){"password"==l()("#password").attr("type")?(l()("#showpassword").html("&#xE8F5"),l()("#password").removeAttr("type"),l()("#password").removeProp("type")):(l()("#showpassword").html("&#xE8F4"),l()("#password").prop("type","password"),l()("#password").attr("type","password"))})),l()("body").keydown((function(e){13==e.which&&(e.preventDefault(),l()("#btnLogin").click())})),l()("#btnLogin").on("click",(async()=>{const e=xi();if(!l()("#btnLogin").hasClass("bgdg")){l()("#btnLogin").addClass("bgdg");const t={};let n;if(t.username=l()("#username").val().trim(),!t.username.endsWith(`-${window.suffix}`)&&window.suffix&&(t.username=`${t.username}-${window.suffix}`),t.password=l()("#password").val(),l()("#iptv").prop("checked")&&(t.iptv=l()("#iptv").val()),!window.navigator.onLine)return n=e.authErrorNoInternet,l()(".alert").show(),l()(".alert").html(n),l()(".btnLogin").removeClass("bgdg"),!1;window.login.username=t.username,window.login.password=t.password,window.login.auth_type="normal",i();const o=await window.login.authenticate();if(o.error&&o.status)return s(),n=401===o.status?e.authError401:403===o.status?e.authError403:e.authErrorOther,l()(".alert").show(),l()(".alert").html(n),l()(".btnLogin").removeClass("bgdg"),!1;i(),window.location.href=`/${window.location.search}`}})),l()("#password-recovery").on("click",(function(){l()("#password-request-return").html(""),l()(".login").hide(),l()("#forgot-password").show(),l()("#password-id").focus()})),l()("#password-back").on("click",(function(){l()("#forgot-password").hide(),l()(".login-panel").hide(),l()("#password-id").val(""),l()(".in").val(""),l()(".login").show(),l()("#username").focus()})),l()(".btn-send-password-request").on("click",(function(){const e=xi(),t=window.login.realmConfig.apiServer;l()("#password-request-return").html("");const n=`${t}/mas/password/forget`;let o=l()("#password-id").val().trim();-1===o.indexOf("-")&&window.suffix&&(o=`${o}-${window.suffix}`);const r={realm:window.login.realm,from:window.login.realm,nick:o,username:o};i(),l().ajax({type:"POST",url:n,dataType:"json",data:r,success(){l()("#password-request-return").removeClass("tr"),l()("#password-request-return").html(e.emailSent),l()("#password-request-return").show(),s()},error(t){const n=t.responseJSON.errors[0];l()("#password-request-return").addClass("tr"),"email"===n.field?l()("#password-request-return").html(e.emailNotFound):"nick"===n.field?l()("#password-request-return").html(e.userNotFound):l()("#password-request-return").html(e.systemProblem),l()("#password-request-return").show(),s()}})}));const o=l()("#login-select"),r=l()("#logoImg"),a=l()("#login-iptv"),c=l()("#login-google");var d;function u(){l()("#login-teacher").hide(),l()("#login-student").hide(),l()("#login-iptv").hide(),l()("#login-select").show(),l()(".alert").html("")}function i(){l()("#block").show(),document.getElementById("block").style.cursor="wait"}function s(){l()("#block").hide(),document.getElementById("block").style.cursor="auto"}return o.show(),r.on("click",(function(){let e=parseInt(l()(this).attr("c"));5===e?(l()(this).attr("c",0),o.hide(),c.hide(),a.show(),d="iptv"):l()(this).attr("c",e+1)})),l()("#access-iptv").click((function(){d="iptv",l()("#login-select").hide(),l()("#login-iptv").show()})),l()("#access-student").on("click",(function(e){l()(this).hasClass("btn-disabled")?e.preventDefault():(d="student",l()("#login-select").hide(),l()("#login-student").show())})),l()("body").keydown((function(e){13==e.which&&(e.preventDefault(),l()("#btn-login-teacher").is(":visible")&&l()("#btn-login-teacher").click(),l()("#btn-login-student").is(":visible")&&l()("#btn-login-student").click(),l()("#btn-login-iptv").is(":visible")&&l()("#btn-login-iptv").click()),27==e.which&&(e.preventDefault(),u())})),l()(".btn-back").on("click",(function(){u()})),l()(".showpassword").on("click",(function(){"password"==l()(".passwordfield").attr("type")?(l()(".showpassword").html("&#xE8F5"),l()(".passwordfield").removeAttr("type"),l()(".passwordfield").removeProp("type")):(l()(".showpassword").html("&#xE8F4"),l()(".passwordfield").prop("type","password"),l()(".passwordfield").attr("type","password"))})),l()(".access-teacher").on("click",(function(){d="teacher",l()("#login-select").hide(),l()("#login-teacher").show()})),l()("#login-iptv").on("click",(function(){d="iptv"})),l()(".doc").on("change",(function(){"rne"===l()(this).val()?(l()(".uf").hide(),l()(".uf-foreign").show()):(l()(".uf").show(),l()(".uf-foreign").hide())})),l()(".btn-login").on("click",(async()=>{const e=xi();if(!window.navigator.onLine)return authError=e.authErrorNoInternet,l()(".alert").html(authError),l()(".btnLogin").removeClass("bgdg"),!1;i();var t={};let o;if(t.realm=window.login.realm,t.platform="webclient",n=await window.login.getRealmConfig(t.realm),window.login.nick_suffix=n.nick_suffix,"iptv"==d){const e=window.login.nick_suffix?window.login.nick_suffix:"";window.suffix=e,t.username=l()("#username-iptv").val(),-1===t.username.indexOf("-")&&window.suffix&&(t.username=t.username+"-"+e),t.password=l()("#password-iptv").val(),window.login.username=t.username,window.login.password=t.password,window.login.auth_type="iptv",o=await window.login.authenticateIptv()}else{if("teacher"==d){let e,n;if(e="edupr"==t.realm?"p":l()("#doc-teacher").length?l()("#doc-teacher").val():"rg",n="eduam"==t.realm?l()("#cpf-teacher").val().replace(/[\.\-]/g,""):l()("#rg-teacher")&&l()("#rg-teacher").val().replace(/\./g,""),l()("#uf-teacher").length){const i="rg"===e?l()("#uf-teacher").val():"";t.username=e+n+i}else t.username="p"==e?e+n:n;t.password=l()("#password-teacher").val(),window.login.username=t.username,window.login.password=t.password,window.login.auth_type="normal"}if("student"==d){const e=l()("#ra-student").val().replace(/\./g,"");if(l()("#uf-student").length)switch(t.username=e+l()("#digit-student").val()+l()("#uf-student").val(),t.username.length){case 10:t.username="000000"+t.username;break;case 11:t.username="00000"+t.username;break;case 12:t.username="0000"+t.username;break;case 13:t.username="000"+t.username;break;case 14:t.username="00"+t.username;break;case 15:t.username="0"+t.username}else t.username=e;t.password=l()("#password-student").val(),window.login.username=t.username,window.login.password=t.password,window.login.auth_type="normal"}o=await window.login.authenticate()}if(o.error&&o.status){let t;return s(),t=401===o.status?e.authError401:403===o.status?e.authError403:e.authErrorOther,l()(".alert").html(t),l()(".btnLogin").removeClass("bgdg"),!1}i(),window.location.href=`/${window.location.search}`})),l()(".help-webtoken").on("click",(function(){var e=l()(this).position();l()("#hint").css("top",e.top+15),l()("#hint").css("left",e.left+15),l()("#hint").toggle()})),!0};function Mi(){const e=localStorage.getItem("realmConfig"),t=localStorage.getItem("selectedRealm"),n=localStorage.getItem("persistentConfigs");localStorage.clear(),t&&localStorage.setItem("selectedRealm",t),e&&localStorage.setItem("realmConfig",e),n&&localStorage.setItem("persistentConfigs",n)}const Ti=[{realm:"eduam",url:"aulaamweb.ip.tv",assets:"https://assets.ip.tv/webchat",apiServer:"https://eduam-api.ip.tv",authServer:"https://eduam-api.ip.tv/device/web",iptvAuthServer:"https://eduam-api.ip.tv/device/",bodyIdField:"id",bodyPasswordField:"web_token",interface:{title:"Aula em Casa Web",description:"Centro de MÃ­dias do Amazonas.",css:"https://assets.ip.tv/webchat/eduam/css.css",js:"https://assets.ip.tv/webchat/common/js.js",favicon:"https://assets.ip.tv/webchat/eduam/favicon.png",background:"https://assets.ip.tv/webchat/eduam/background.png",textMainColor:"525F98",loginLogo:"https://assets.ip.tv/webchat/eduam/login_logo.png",mainPageLogo:"https://assets.ip.tv/webchat/eduam/main_logo.png"},config:{realm:"eduam",janusServer:["wss://eduam-live1.ip.tv:443","wss://eduam-live1.ip.tv:444","wss://eduam-live1.ip.tv:451","wss://eduam-live2.ip.tv:443","wss://eduam-live2.ip.tv:444","wss://eduam-web.ip.tv:451"],roomIcon:"https://assets.ip.tv/webchat/eduam/room_avatar.png",allowPrivMessage:!0,messenger:!1,onlySpecialPrivMessage:!0,showFinderField:!1,showTransmissionIcon:!1,showChannelCategoryList:!0,showChannelFavoriteIcon:!1,showChannelMoreCategoryIcon:!1,showChannelUserListIcon:!1,showChannelsIcon:!0,showChannelTargetInfo:!1,showGroupsIcon:!0,showMainConfigIcon:!1,showPeopleIcon:!1,showOtherIcon:!0,otherLink:"https://www.sigserv.com.br/app/webview/",otherLinkNewTab:!0,showChannelOtherLink:!0,firstCategorySelected:"5892327eda99be429e00bc2b",firstCategoryType:"",allowQuiz:!0}},{realm:"educm",url:"conectarmaisweb.ip.tv",assets:"https://assets.ip.tv/webchat",apiServer:"https://educm-api.ip.tv",authServer:"https://educm-api.ip.tv/device/",iptvAuthServer:"https://educm-api.ip.tv/device/",bodyIdField:"nick",bodyPasswordField:"password",interface:{title:"Conectar+ Web",description:"Conectar+ Web.",css:"https://assets.ip.tv/webchat/educm/css.css",js:"https://assets.ip.tv/webchat/common/js.js",favicon:"https://assets.ip.tv/webchat/educm/favicon.png",background:"https://assets.ip.tv/webchat/educm/background.png",textMainColor:"525F98",loginLogo:"https://assets.ip.tv/webchat/educm/login_logo.png",mainPageLogo:"https://assets.ip.tv/webchat/educm/main_logo.png"},config:{realm:"educm",janusServer:["wss://gc-web.ip.tv:443","wss://gc-web.ip.tv:444","wss://gc-web.ip.tv:451","wss://gc-web.ip.tv:446","wss://gc-web.ip.tv:447","wss://gc-web.ip.tv:448","wss://gc-web.ip.tv:449","wss://gc-web.ip.tv:450"],roomIcon:"https://assets.ip.tv/webchat/educm/room_avatar.png",allowPrivMessage:!0,messenger:!1,onlySpecialPrivMessage:!0,showFinderField:!1,showTransmissionIcon:!1,showChannelCategoryList:!0,showChannelFavoriteIcon:!1,showChannelMoreCategoryIcon:!1,showChannelUserListIcon:!1,showChannelsIcon:!0,showChannelTargetInfo:!1,showGroupsIcon:!0,showMainConfigIcon:!1,showPeopleIcon:!1,firstCategorySelected:"",firstCategoryType:"featured"}},{realm:"edupr",url:"aulaprweb.ip.tv",assets:"https://assets.ip.tv/webchat",apiServer:"https://edupr-api.ip.tv",authServer:"https://edupr-api.ip.tv/registration/edupr",iptvAuthServer:"https://edupr-api.ip.tv/device/",bodyIdField:"id",bodyPasswordField:"password",interface:{title:"Aula PR Web",description:"Centro de MÃ­dias do ParanÃ¡.",css:"https://assets.ip.tv/webchat/edupr/css.css",js:"https://assets.ip.tv/webchat/common/js.js",favicon:"https://assets.ip.tv/webchat/edupr/favicon.png",background:"https://assets.ip.tv/webchat/edupr/background.png",textMainColor:"109AC3",loginLogo:"https://assets.ip.tv/webchat/edupr/login_logo.png",mainPageLogo:"https://assets.ip.tv/webchat/edupr/main_logo.png"},realmData:{files_base_url:"https://static.ip.tv",realm_code:"edupr",platforms:["webclient"],acs_server:"acs",ppcs_server:"ppcs",room_server:"room",msg_drop_rate:200,msg_per_day:-1,tms_spa:"",auth_token:"",webview_url:"",lifes:0},config:{realm:"edupr",janusServer:["wss://eduprwebserver.ip.tv:443","wss://eduprwebserver.ip.tv:444","wss://eduprwebserver.ip.tv:451","wss://eduprwebserver.ip.tv:446","wss://eduprwebserver.ip.tv:447","wss://eduprwebserver.ip.tv:448","wss://eduprwebserver.ip.tv:449","wss://eduprwebserver.ip.tv:450"],roomIcon:"https://assets.ip.tv/webchat/edupr/room_avatar.png",allowPrivMessage:!1,messenger:!1,onlySpecialPrivMessage:!0,showFinderField:!1,showTransmissionIcon:!1,showChannelCategoryList:!0,showChannelFavoriteIcon:!1,showChannelMoreCategoryIcon:!1,showChannelUserListIcon:!1,showChannelsIcon:!0,showChannelTargetInfo:!1,showGroupsIcon:!0,showMainConfigIcon:!1,showPeopleIcon:!1,showOtherIcon:!1,showGoogleClassroomIcon:!0,googleClassroomLink:"https://classroom.google.com/u/0/h",otherLink:"",firstCategorySelected:"5e8263508c1b5e00071734cb",firstCategoryType:"featured",initialPanel:"room",showRoomDetailPage:!0,showRoomDetailTest:!1}},{realm:"eduro",url:"vempraaularoweb.ip.tv",assets:"https://assets.ip.tv/webchat",apiServer:"https://eduro-api.ip.tv",googleAuthServer:"https://eduro-api.ip.tv/registration/eduro",authServer:"https://eduro-api.ip.tv/device/web",iptvAuthServer:"https://eduro-api.ip.tv/device/",bodyIdField:"id",bodyPasswordField:"web_token",realmData:{files_base_url:"https://eduro-static.ip.tv",realm_code:"eduro",platforms:["webclient"],acs_server:"acs",ppcs_server:"ppcs",room_server:"room",msg_drop_rate:200,msg_per_day:-1,tms_spa:"",auth_token:"",webview_url:"",lifes:0},interface:{title:"Vem pra Aula RO Web",description:"Vem pra Aula RO Web.",css:"https://assets.ip.tv/webchat/eduro/css.css",js:"https://assets.ip.tv/webchat/common/js.js",favicon:"https://assets.ip.tv/webchat/eduro/favicon.png",background:"https://assets.ip.tv/webchat/eduro/background.png",textMainColor:"325794",loginLogo:"https://assets.ip.tv/webchat/eduro/login_logo.png",mainPageLogo:"https://assets.ip.tv/webchat/eduro/main_logo.png"},config:{realm:"eduro",janusServer:["wss://edurowebserver.ip.tv:443"],roomIcon:"https://assets.ip.tv/webchat/eduro/room_avatar.png",allowPrivMessage:!1,messenger:!1,onlySpecialPrivMessage:!0,showFinderField:!1,showTransmissionIcon:!1,showChannelCategoryList:!0,showChannelFavoriteIcon:!1,showChannelMoreCategoryIcon:!1,showChannelUserListIcon:!0,showChannelTaskIcon:!0,showChannelsIcon:!0,showChannelTargetInfo:!1,showGroupsIcon:!0,showMainConfigIcon:!1,showPeopleIcon:!1,showOtherIcon:!0,otherLink:"http://www.rondonia.ro.gov.br/seduc",showChannelOtherLink:!0,showTmsIcon:!0,showGoogleClassroomIcon:!1,googleClassroomLink:"https://classroom.google.com/u/0/h",firstCategorySelected:""}},{realm:"edusp",url:"cmspweb.ip.tv",assets:"https://edusp-static.ip.tv/webinar",apiServer:"https://edusp-api.ip.tv",authServer:"https://edusp-api.ip.tv/registration/edusp",iptvAuthServer:"https://edusp-api.ip.tv/device/",bodyIdField:"id",bodyPasswordField:"password",interface:{title:"CMSP Web",description:"Centro de MÃ­dias do Estado de SÃ£o Paulo.",css:"https://edusp-static.ip.tv/edusp/css.css",js:"https://edusp-static.ip.tv/webinar/common/js.js",favicon:"https://edusp-static.ip.tv/edusp/favicon.png",background:"https://edusp-static.ip.tv/edusp/background.png",textMainColor:"325794",loginLogo:"https://edusp-static.ip.tv/webinar/edusp/login_logo.png",mainPageLogo:"https://edusp-static.ip.tv/edusp/main_logo.png"},config:{realm:"edusp",janusServer:["wss://edusp-live1.ip.tv:443","wss://edusp-live2.ip.tv:443","wss://edusp-live3.ip.tv:443","wss://edusp-live4.ip.tv:443","wss://edusp-live5.ip.tv:443","wss://edusp-live6.ip.tv:443","wss://edusp-live7.ip.tv:443","wss://edusp-live8.ip.tv:443","wss://edusp-live9.ip.tv:443","wss://edusp-live10.ip.tv:443","wss://edusp-live11.ip.tv:443","wss://edusp-live12.ip.tv:443","wss://edusp-live13.ip.tv:443","wss://edusp-live14.ip.tv:443"],roomIcon:"https://edusp-static.ip.tv/webinar/edusp/room_avatar.png",allowPrivMessage:!0,messenger:!1,onlySpecialPrivMessage:!0,showFinderField:!1,showTransmissionIcon:!1,showChannelCategoryList:!0,showChannelFavoriteIcon:!1,showChannelMoreCategoryIcon:!1,showChannelUserListIcon:!0,showChannelTaskIcon:!0,showChannelsIcon:!0,showChannelTargetInfo:!1,showGroupsIcon:!0,showMainConfigIcon:!1,showPeopleIcon:!1,showOtherIcon:!0,otherLink:"https://cmspwebview.educacao.sp.gov.br/",showChannelOtherLink:!0,showTmsIcon:!0,showGoogleClassroomIcon:!0,googleClassroomLink:"https://classroom.google.com/u/0/h",firstCategorySelected:"5e7656e2ba9eb1af8754dee6",firstCategoryType:"featured",allowQuiz:!0,allowAnalytics:!0,denySessionOnMobile:!0,webcamDefaultBitrate:256,webcamMinBitrate:128,webcamMaxBitrate:2048,screenDefaultBitrate:1024,screenMinBitrate:256,screenMaxBitrate:6144,showRoomTutorial:!0,roomTutorial:["eduspRoomTutorial001"],initialPanel:"room",showRoomDetailPage:!0,showRoomDetailTest:!0,supressRoomAreaBackground:!0,allowNewScreenDisplay:!0,breakoutRooms:!0,breakoutRoomsMax:50,showVuMeter:!0,alwaysRecordSessions:!0}},{realm:"eduspi",url:"cmspiweb.ip.tv",assets:"https://assets.ip.tv/webchat",apiServer:"https://eduspi-api.ip.tv",authServer:"https://eduspi-api.ip.tv/device/web",iptvAuthServer:"https://eduspi-api.ip.tv/device/",bodyIdField:"id",bodyPasswordField:"web_token",interface:{title:"CMSPI Web",description:"Centro de MÃ­dias do Estado de SÃ£o Paulo.",css:"https://assets.ip.tv/webchat/eduspi/css.css",js:"https://assets.ip.tv/webchat/common/js.js",favicon:"https://assets.ip.tv/webchat/eduspi/favicon.png",background:"https://assets.ip.tv/webchat/eduspi/background.png",textMainColor:"325794",loginLogo:"https://assets.ip.tv/webchat/eduspi/login_logo.png",mainPageLogo:"https://assets.ip.tv/webchat/eduspi/main_logo.png"},config:{realm:"eduspi",janusServer:["wss://seduc-sp10.ip.tv:443","wss://seduc-sp10.ip.tv:444","wss://seduc-sp10.ip.tv:451","wss://seduc-sp10.ip.tv:446","wss://seduc-sp10.ip.tv:447","wss://seduc-sp10.ip.tv:448","wss://seduc-sp10.ip.tv:449","wss://seduc-sp10.ip.tv:450","wss://seduc-sp11.ip.tv:443","wss://seduc-sp12.ip.tv:443","wss://seduc-sp12.ip.tv:444","wss://seduc-sp12.ip.tv:451","wss://seduc-sp12.ip.tv:446","wss://seduc-sp12.ip.tv:447","wss://seduc-sp12.ip.tv:448","wss://seduc-sp12.ip.tv:449","wss://seduc-sp12.ip.tv:450","wss://seduc-sp13.ip.tv:443","wss://seduc-sp13.ip.tv:444","wss://seduc-sp13.ip.tv:451","wss://seduc-sp13.ip.tv:446","wss://seduc-sp13.ip.tv:447","wss://seduc-sp13.ip.tv:448","wss://seduc-sp13.ip.tv:449","wss://seduc-sp13.ip.tv:450","wss://seduc-sp14.ip.tv:443","wss://seduc-sp14.ip.tv:444","wss://seduc-sp14.ip.tv:451","wss://seduc-sp14.ip.tv:446","wss://seduc-sp14.ip.tv:447","wss://seduc-sp14.ip.tv:448","wss://seduc-sp14.ip.tv:449","wss://seduc-sp14.ip.tv:450"],roomIcon:"https://assets.ip.tv/webchat/eduspi/room_avatar.png",allowPrivMessage:!0,messenger:!1,onlySpecialPrivMessage:!0,showFinderField:!1,showTransmissionIcon:!1,showChannelCategoryList:!0,showChannelFavoriteIcon:!1,showChannelMoreCategoryIcon:!1,showChannelUserListIcon:!1,showChannelTaskIcon:!0,showChannelsIcon:!0,showChannelTargetInfo:!1,showGroupsIcon:!0,showMainConfigIcon:!1,showPeopleIcon:!1,showOtherIcon:!0,otherLink:"https://cmspwebview.educacao.sp.gov.br/",showChannelOtherLink:!0,showTmsIcon:!0,showGoogleClassroomIcon:!0,googleClassroomLink:"https://classroom.google.com/u/0/h",firstCategorySelected:"5e9f9fd3c8eb240007997bf8",firstCategoryType:"featured",allowQuiz:!0}},{realm:"iptv",url:"web2.ip.tv",assets:"https://assets.ip.tv/webchat",apiServer:"https://iptv-api.ip.tv",authServer:"https://mas.ip.tv/device",iptvAuthServer:"https://mas.ip.tv/device",bodyIdField:"nick",bodyPasswordField:"password",interface:{title:"IPTV Web",description:"IPTV Web.",css:"https://assets.ip.tv/webchat/iptv/css.css",js:"https://assets.ip.tv/webchat/common/js.js",favicon:"https://assets.ip.tv/webchat/iptv/favicon.png",background:"https://assets.ip.tv/webchat/iptv/background.png",textMainColor:"325794",loginLogo:"https://assets.ip.tv/webchat/iptv/login_logo.png",mainPageLogo:"https://assets.ip.tv/webchat/iptv/main_logo.png"},config:{realm:"iptv",janusServer:["wss://realms-live1.ip.tv:443"],roomIcon:"https://assets.ip.tv/webchat/iptv/room_avatar.png",allowPrivMessage:!0,messenger:!1,onlySpecialPrivMessage:!1,showFinderField:!1,showTransmissionIcon:!1,showChannelCategoryList:!1,showChannelFavoriteIcon:!1,showChannelMoreCategoryIcon:!1,showChannelUserListIcon:!1,showChannelsIcon:!1,showChannelTargetInfo:!1,showGroupsIcon:!1,showMainConfigIcon:!1,showPeopleIcon:!1,firstCategorySelected:"5892327eda99be429e00bc2b"}},{realm:"mano",url:"manoweb.ip.tv",assets:"https://assets.ip.tv/webchat",apiServer:"https://mano-api.ip.tv",authServer:"https://mas.ip.tv/device",iptvAuthServer:"https://mas.ip.tv/device",bodyIdField:"nick",bodyPasswordField:"password",interface:{title:"Mano Web",description:"Mano Web.",css:"https://assets.ip.tv/webchat/mano/css.css",js:"https://assets.ip.tv/webchat/common/js2.js",favicon:"https://assets.ip.tv/webchat/mano/favicon.png",background:"https://assets.ip.tv/webchat/mano/background.png",textMainColor:"EC7F00",loginLogo:"https://assets.ip.tv/webchat/mano/login_logo.png",mainPageLogo:"https://assets.ip.tv/webchat/mano/main_logo.png"},config:{realm:"mano",janusServer:["wss://manowebserver.ip.tv:443"],roomIcon:"https://assets.ip.tv/webchat/mano/room_avatar.png",allowPrivMessage:!0,messenger:!1,onlySpecialPrivMessage:!1,showFinderField:!1,allowTransmission:!0,showTransmissionIcon:!1,showChannelCategoryList:!0,showChannelFavoriteIcon:!0,showChannelMoreCategoryIcon:!1,showChannelUserListIcon:!0,showChannelsIcon:!0,showChannelTargetInfo:!1,showGroupsIcon:!1,showMainConfigIcon:!1,showPeopleIcon:!1,firstCategorySelected:"5a7cd1aa0029dc5837827437",firstCategoryType:"featured",allowChannelChat:!0,allowMessengerNewPeopleSearch:!0,allowQuiz:!0,allowDropFiles:!0,allowNormalUserSendLink:!0}},{realm:"mano",url:"www.mywebchat.com.br",assets:"https://assets.ip.tv/webchat",apiServer:"https://mano-api.ip.tv",authServer:"https://mas.ip.tv/device",iptvAuthServer:"https://mas.ip.tv/device",bodyIdField:"nick",bodyPasswordField:"password",interface:{title:"Mano Web",description:"Mano Web.",css:"https://assets.ip.tv/webchat/mano/css.css",js:"https://assets.ip.tv/webchat/common/js2.js",favicon:"https://assets.ip.tv/webchat/mano/favicon.png",background:"https://assets.ip.tv/webchat/mano/background.png",textMainColor:"EC7F00",loginLogo:"https://assets.ip.tv/webchat/mano/login_logo.png",mainPageLogo:"https://assets.ip.tv/webchat/mano/main_logo.png"},config:{realm:"mano",janusServer:["wss://manowebserver.ip.tv:443"],roomIcon:"https://assets.ip.tv/webchat/mano/room_avatar.png",allowPrivMessage:!0,messenger:!0,onlySpecialPrivMessage:!1,showFinderField:!0,allowTransmission:!0,showTransmissionIcon:!0,showChannelCategoryList:!0,showChannelFavoriteIcon:!0,showChannelMoreCategoryIcon:!1,showChannelUserListIcon:!0,showChannelsIcon:!0,showChannelTargetInfo:!1,showGroupsIcon:!1,showMainConfigIcon:!0,showPeopleIcon:!0,firstCategorySelected:"5a7cd1aa0029dc5837827437",firstCategoryType:"featured",allowChannelChat:!0,allowMessengerNewPeopleSearch:!0,allowQuiz:!0,allowDropFiles:!0,allowNormalUserSendLink:!0}},{realm:"school",multiRealm:!0,url:"schoolweb.ip.tv",assets:"https://assets.ip.tv/webchat",apiServer:"https://school-api.ip.tv",authServer:"https://school-api.ip.tv/device/",iptvAuthServer:"https://school-api.ip.tv/device",googleRegistrationServer:"https://school-api.ip.tv/mas/registration",bodyIdField:"nick",bodyPasswordField:"password",interface:{title:"School Web",description:"School Web.",main:"https://assets.ip.tv/webchat/common/main2.html",css:"https://assets.ip.tv/webchat/school/css.css",js:"https://assets.ip.tv/webchat/common/js2.js",favicon:"https://assets.ip.tv/webchat/school/favicon.png",background:"https://assets.ip.tv/webchat/school/background.png",textMainColor:"525F98",loginLogo:"https://assets.ip.tv/webchat/school/login_logo.png",mainPageLogo:"https://assets.ip.tv/webchat/school/main_logo.png"},config:{realm:"school",janusServer:["wss://schoolwebserver.ip.tv:443"],roomIcon:"https://assets.ip.tv/webchat/school/room_avatar.png",allowPrivMessage:!0,messenger:!1,onlySpecialPrivMessage:!0,showFinderField:!1,showTransmissionIcon:!1,showChannelCategoryList:!0,showChannelFavoriteIcon:!1,showChannelMoreCategoryIcon:!1,showChannelUserListIcon:!0,showChannelTaskIcon:!0,showChannelsIcon:!0,showChannelTargetInfo:!1,showRoomAllAttachments:!0,showGroupsIcon:!0,showMainConfigIcon:!1,showChannelMoreSettings:!0,showPeopleIcon:!1,showOtherIcon:!1,otherLink:"https://www.ip.tv/landpage/",otherLinkNewTab:!0,showChannelOtherLink:!0,showLmsIcon:!1,lmsLink:"https://www.ip.tv/landpage/",showTmsIcon:!0,allowChannelInvite:!0,allowChannelCsm:!0,showVuMeter:!0,allowClosedCaption:!0,showGoogleClassroomIcon:!1,googleClassroomLink:"https://classroom.google.com/u/0/h",firstCategorySelected:"",firstCategoryType:"featured",allowQuiz:!0,allowNormalUserSendLink:!0,allowAnalytics:!0,allowChannelLinkCopy:!1,allowRoomLinkCopy:!1,denySessionOnMobile:!0,webcamDefaultBitrate:256,webcamMinBitrate:128,webcamMaxBitrate:2048,screenDefaultBitrate:256,screenMinBitrate:256,screenMaxBitrate:6144,showRoomTutorial:!0,roomTutorial:["eduspRoomTutorial001"],allowTranslate:!0,banubaEffect:!1,initialPanel:"room",showRoomDetailPage:!0,showRoomDetailTest:!1,allowDirectScreenSaving:!0,allowNewScreenDisplay:!0,breakoutRooms:!0,breakoutRoomsMax:50,alwaysRecordSessions:!0}},{realm:"school",url:"bonganiweb.ip.tv",assets:"https://assets.ip.tv/webchat",apiServer:"https://school-api.ip.tv",authServer:"https://school-api.ip.tv/device/",iptvAuthServer:"https://school-api.ip.tv/device",bodyIdField:"nick",bodyPasswordField:"password",interface:{title:"Bongani Web",description:"Bongani Web.",main:"https://assets.ip.tv/webchat/common/main2.html",css:"https://assets.ip.tv/webchat/school/css.css",js:"https://assets.ip.tv/webchat/common/js2.js",favicon:"https://assets.ip.tv/webchat/school/favicon.png",background:"https://assets.ip.tv/webchat/school/background.png",textMainColor:"525F98",loginLogo:"https://assets.ip.tv/webchat/school/login_logo.png",mainPageLogo:"https://assets.ip.tv/webchat/school/main_logo.png"},config:{realm:"school",janusServer:["wss://schoolwebserver.ip.tv:443"],roomIcon:"https://assets.ip.tv/webchat/school/room_avatar.png",allowPrivMessage:!0,messenger:!1,onlySpecialPrivMessage:!0,showFinderField:!1,showTransmissionIcon:!1,showChannelCategoryList:!0,showChannelFavoriteIcon:!1,showChannelMoreCategoryIcon:!1,showChannelUserListIcon:!0,showChannelTaskIcon:!0,showChannelsIcon:!0,showChannelTargetInfo:!1,showGroupsIcon:!0,showMainConfigIcon:!1,showPeopleIcon:!1,showOtherIcon:!1,otherLink:"",showTmsIcon:!0,allowChannelCsm:!0,allowChannelInvite:!0,showGoogleClassroomIcon:!1,googleClassroomLink:"https://classroom.google.com/u/0/h",firstCategorySelected:"",firstCategoryType:"featured",allowQuiz:!0}},{realm:"scibono",url:"scibonoeduverse.ip.tv",assets:"https://assets.ip.tv/webchat",apiServer:"https://scibono-api.ip.tv",authServer:"https://scibono-api.ip.tv/device/",iptvAuthServer:"https://scibono-api.ip.tv/device",bodyIdField:"nick",bodyPasswordField:"password",interface:{title:"Sci-Bono Web",description:"Sci-Bono Web.",main:"https://assets.ip.tv/webchat/common/main.html",css:"https://assets.ip.tv/webchat/school/css.css",js:"https://assets.ip.tv/webchat/common/js.js",favicon:"https://assets.ip.tv/webchat/scibono/favicon.png",background:"https://assets.ip.tv/webchat/scibono/background.png",textMainColor:"525F98",loginLogo:"https://assets.ip.tv/webchat/scibono/login_logo.png",mainPageLogo:"https://assets.ip.tv/webchat/scibono/main_logo.png"},config:{realm:"scibono",janusServer:["wss://africa-live1.ip.tv:443"],roomIcon:"https://assets.ip.tv/webchat/scibono/room_avatar.png",allowPrivMessage:!0,messenger:!1,onlySpecialPrivMessage:!0,showFinderField:!1,showTransmissionIcon:!1,showChannelCategoryList:!0,showChannelFavoriteIcon:!1,showChannelMoreCategoryIcon:!1,showChannelUserListIcon:!0,showChannelTaskIcon:!0,showChannelsIcon:!0,showChannelTargetInfo:!1,showGroupsIcon:!1,showMainConfigIcon:!1,showPeopleIcon:!1,showOtherIcon:!1,otherLink:"",showChannelOtherLink:!1,showLmsIcon:!1,lmsLink:"",showTmsIcon:!0,showGoogleClassroomIcon:!1,googleClassroomLink:"https://classroom.google.com/u/0/h",firstCategorySelected:"",firstCategoryType:"featured",allowQuiz:!0,allowNormalUserSendLink:!0,categoriesWhiteColor:!0}},{realm:"smerec",multiRealm:!0,url:"educarecifeweb.ip.tv",assets:"https://assets.ip.tv/webchat",apiServer:"https://smerec-api.ip.tv",authServer:"https://smerec-api.ip.tv/device",iptvAuthServer:"https://smerec-api.ip.tv/device",googleRegistrationServer:"https://smerec-api.ip.tv/mas/registration",bodyIdField:"username",bodyPasswordField:"password",interface:{title:"Educa Recife Web",description:"Educa Recife Web.",main:"https://assets.ip.tv/webchat/common/main.html",css:"https://assets.ip.tv/webchat/smerec/css.css",js:"https://assets.ip.tv/webchat/common/js.js",favicon:"https://assets.ip.tv/webchat/smerec/favicon.png",background:"https://assets.ip.tv/webchat/smerec/background.png",textMainColor:"525F98",loginLogo:"https://assets.ip.tv/webchat/smerec/login_logo.png",mainPageLogo:"https://assets.ip.tv/webchat/smerec/main_logo.png"},config:{realm:"smerec",janusServer:["wss://smerec-live1.ip.tv:443","wss://smerec-live2.ip.tv:443"],roomIcon:"https://assets.ip.tv/webchat/smerec/room_avatar.png",allowPrivMessage:!0,messenger:!1,onlySpecialPrivMessage:!0,showFinderField:!1,showTransmissionIcon:!1,showChannelCategoryList:!1,showChannelFavoriteIcon:!1,showChannelMoreCategoryIcon:!1,showChannelUserListIcon:!0,showChannelsIcon:!0,showChannelTargetInfo:!1,showGroupsIcon:!1,showMainConfigIcon:!1,showPeopleIcon:!1,showOtherIcon:!0,otherLink:"https://educ.rec.br/educarecifemenu/",showTmsIcon:!0,showChannelOtherLink:!0,firstCategorySelected:"6081a6aea19d2a00070b7195",firstCategoryType:"featured",allowChannelLinkCopy:!1,allowRoomLinkCopy:!1,showRoomDetailPage:!0,hideCategoriesMenu:!0,newCategoriesListWithChannels:!0}},{realm:"staging",multiRealm:!0,url:"stagingweb.ip.tv",assets:"https://assets.ip.tv/webchat",apiServer:"https://staging-api.ip.tv",authServer:"https://staging-api.ip.tv/device/",iptvAuthServer:"https://staging-api.ip.tv/device",googleRegistrationServer:"https://staging-api.ip.tv/mas/registration",files_base_url:"https://static.ip.tv",bodyIdField:"nick",bodyPasswordField:"password",interface:{title:"School Web",description:"School Web.",main:"https://assets.ip.tv/webchat/common/main3.html",css:"https://assets.ip.tv/webchat/school/css.css",js:"https://assets.ip.tv/webchat/common/js3.js",favicon:"https://assets.ip.tv/webchat/school/favicon.png",background:"https://assets.ip.tv/webchat/school/background.png",textMainColor:"525F98",loginLogo:"https://assets.ip.tv/webchat/school/login_logo.png",mainPageLogo:"https://assets.ip.tv/webchat/school/main_logo.png"},config:{realm:"staging",multiRealm:!0,janusServer:["wss://stagingwebserver.ip.tv:443"],roomIcon:"https://assets.ip.tv/webchat/school/room_avatar.png",allowPrivMessage:!0,messenger:!1,onlySpecialPrivMessage:!0,showFinderField:!1,showTransmissionIcon:!1,showChannelCategoryList:!0,showChannelFavoriteIcon:!1,showChannelMoreCategoryIcon:!1,showChannelUserListIcon:!0,showChannelTaskIcon:!0,showChannelsIcon:!0,showChannelTargetInfo:!1,showGroupsIcon:!0,showMainConfigIcon:!1,showPeopleIcon:!1,showOtherIcon:!1,showChannelMoreSettings:!0,showRoomAllAttachments:!0,otherLink:"https://www.ip.tv/landpage/",otherLinkNewTab:!0,showChannelOtherLink:!0,showLmsIcon:!1,allowChannelCsm:!0,allowChannelInvite:!0,showVuMeter:!0,allowClosedCaption:!0,lmsLink:"https://www.ip.tv/landpage/",showTmsIcon:!0,showGoogleClassroomIcon:!1,googleClassroomLink:"https://classroom.google.com/u/0/h",firstCategorySelected:"",firstCategoryType:"featured",allowQuiz:!0,allowNormalUserSendLink:!0,allowAnalytics:!0,allowChannelLinkCopy:!1,allowRoomLinkCopy:!1,denySessionOnMobile:!0,minCamBitrate:256,maxCamBitrate:2e3,minScreenBitrate:256,maxScreenBitrate:6e3,showRoomTutorial:!0,roomTutorial:["eduspRoomTutorial001"],banubaEffect:!1,initialPanel:"room",showRoomDetailPage:!0,showRoomDetailTest:!0,allowDirectScreenSaving:!0,allowNewScreenDisplay:!0,hideCsmRoomReferenceDate:!1,breakoutRooms:!0,breakoutRoomsMax:50,alwaysRecordSessions:!0}},{realm:"realms",multiRealm:!0,url:"realmsweb.ip.tv",assets:"https://assets.ip.tv/webchat",apiServer:"https://realms-api.ip.tv",authServer:"https://realms-api.ip.tv/device/",iptvAuthServer:"https://realms-api.ip.tv/device",googleRegistrationServer:"https://realms-api.ip.tv/mas/registration",bodyIdField:"nick",bodyPasswordField:"password",interface:{title:"Realms Web",description:"Realms Web.",main:"https://assets.ip.tv/webchat/common/main.html",css:"https://assets.ip.tv/webchat/realms/css.css",js:"https://assets.ip.tv/webchat/common/js.js",favicon:"https://assets.ip.tv/webchat/realms/favicon.png",background:"https://assets.ip.tv/webchat/realms/background.png",textMainColor:"525F98",loginLogo:"https://assets.ip.tv/webchat/realms/login_logo.png",mainPageLogo:"https://assets.ip.tv/webchat/realms/main_logo.png"},config:{realm:"realms",multiRealm:!0,janusServer:["wss://realms-live1.ip.tv:443"],roomIcon:"https://assets.ip.tv/webchat/realms/room_avatar.png",allowPrivMessage:!0,onlySpecialPrivMessage:!0,showChannelCategoryList:!0,showChannelUserListIcon:!0,showChannelTaskIcon:!0,showChannelsIcon:!0,showGroupsIcon:!0,hideChannelGroupsIcon:!0,useOtherGroupsIcon:!0,showGroupsIconRealms:["all"],showGroupsIcon2:!0,showGroupsIcon2Realms:["kclubnft"],showChannelMoreSettings:!0,showRoomAllAttachments:!0,showOtherIcon:!0,otherLink:"https://www.ip.tv/landpage/",otherLinkNewTab:!0,otherLinkRealm:{kclubnft:"https://www.kclubnft.com/",realms:"https://www.ip.tv/landpage/"},showChannelOtherLink:!0,allowChannelCsm:!0,allowChannelInvite:!0,showVuMeter:!0,allowClosedCaption:!0,showLmsIconRealms:["realms"],lmsLink:"https://www.ip.tv/landpage/",showTmsIcon:!0,googleClassroomLink:"https://classroom.google.com/u/0/h",firstCategorySelected:"",firstCategoryType:"featured",allowQuiz:!0,allowNormalUserSendLink:!0,denySessionOnMobile:!0,webcamDefaultBitrate:256,webcamMinBitrate:128,webcamMaxBitrate:2048,screenDefaultBitrate:2e3,screenMinBitrate:256,screenMaxBitrate:6144,banubaEffect:!0,showRoomDetailPage:!0,allowDirectScreenSaving:!0,allowNewScreenDisplay:!0,hideCsmRoomReferenceDate:!0}},{realm:"edupa",multiRealm:!0,url:"seducpaweb.ip.tv",assets:"https://assets.ip.tv/webchat",apiServer:"https://realms-api.ip.tv",authServer:"https://realms-api.ip.tv/device/",googleRegistrationServer:"https://realms-api.ip.tv/mas/registration",iptvAuthServer:"https://realms-api.ip.tv/device",bodyIdField:"nick",bodyPasswordField:"password",interface:{title:"Seduc PA Web",description:"Seduc PA Web.",main:"https://assets.ip.tv/webchat/common/main.html",css:"https://assets.ip.tv/webchat/realms/css.css",js:"https://assets.ip.tv/webchat/common/js.js",favicon:"https://assets.ip.tv/webchat/realms/favicon.png",background:"https://assets.ip.tv/webchat/realms/background.png",textMainColor:"525F98",loginLogo:"https://assets.ip.tv/webchat/realms/login_logo.png",mainPageLogo:"https://assets.ip.tv/webchat/realms/main_logo.png"},config:{realm:"realms",multiRealm:!0,janusServer:["wss://realms-live1.ip.tv:443"],roomIcon:"https://assets.ip.tv/webchat/realms/room_avatar.png",allowPrivMessage:!1,onlySpecialPrivMessage:!0,showChannelCategoryList:!0,showChannelUserListIcon:!0,showChannelTaskIcon:!0,showChannelsIcon:!0,showGroupsIcon:!0,hideChannelGroupsIcon:!0,useOtherGroupsIcon:!0,showGroupsIconRealms:["all"],showGroupsIcon2:!0,showGroupsIcon2Realms:["kclubnft"],showChannelMoreSettings:!0,showRoomAllAttachments:!0,showOtherIcon:!0,otherLink:"https://www.ip.tv/landpage/",otherLinkNewTab:!0,otherLinkRealm:{kclubnft:"https://www.kclubnft.com/",realms:"https://www.ip.tv/landpage/"},showChannelOtherLink:!0,allowChannelCsm:!0,allowChannelInvite:!0,showVuMeter:!0,allowClosedCaption:!0,showLmsIconRealms:["realms"],lmsLink:"https://www.ip.tv/landpage/",showTmsIcon:!0,googleClassroomLink:"https://classroom.google.com/u/0/h",firstCategorySelected:"",firstCategoryType:"featured",allowQuiz:!0,allowNormalUserSendLink:!0,denySessionOnMobile:!0,webcamDefaultBitrate:256,webcamMinBitrate:128,webcamMaxBitrate:2048,screenDefaultBitrate:2e3,screenMinBitrate:256,screenMaxBitrate:6144,banubaEffect:!0,showRoomDetailPage:!0,allowDirectScreenSaving:!0,allowNewScreenDisplay:!0,hideCsmRoomReferenceDate:!0}},{realm:"uea",url:"ueaweb.ip.tv",assets:"https://assets.ip.tv/webchat",apiServer:"https://uea-api.ip.tv",authServer:"https://uea-api.ip.tv/device/",iptvAuthServer:"https://uea-api.ip.tv/device/",bodyIdField:"nick",bodyPasswordField:"password",interface:{title:"UEA Web",description:"UEA Web.",css:"https://assets.ip.tv/webchat/uea/css.css",js:"https://assets.ip.tv/webchat/common/js.js",favicon:"https://assets.ip.tv/webchat/uea/favicon.png",background:"https://assets.ip.tv/webchat/uea/background.png",textMainColor:"525F98",loginLogo:"https://assets.ip.tv/webchat/uea/login_logo.png",mainPageLogo:"https://assets.ip.tv/webchat/uea/main_logo.png"},config:{realm:"uea",janusServer:["wss://gc-web.ip.tv:443","wss://gc-web.ip.tv:444","wss://gc-web.ip.tv:451","wss://gc-web.ip.tv:446","wss://gc-web.ip.tv:447","wss://gc-web.ip.tv:448","wss://gc-web.ip.tv:449","wss://gc-web.ip.tv:450"],roomIcon:"https://assets.ip.tv/webchat/uea/room_avatar.png",allowPrivMessage:!0,messenger:!1,onlySpecialPrivMessage:!0,showFinderField:!1,showTransmissionIcon:!1,showChannelCategoryList:!0,showChannelFavoriteIcon:!1,showChannelMoreCategoryIcon:!1,showChannelUserListIcon:!1,showChannelsIcon:!1,showChannelTargetInfo:!1,showGroupsIcon:!1,showMainConfigIcon:!1,showPeopleIcon:!1,firstCategorySelected:"",firstCategoryType:"featured"}},{realm:"eduam",url:"testeweb.ip.tv",assets:"https://assets.ip.tv/webchat",apiServer:"https://eduam-api.ip.tv",authServer:"https://eduam-api.ip.tv/device/web",iptvAuthServer:"https://eduam-api.ip.tv/device/",bodyIdField:"id",bodyPasswordField:"web_token",interface:{title:"Aula em Casa Web",description:"Centro de MÃ­dias do Amazonas.",css:"https://assets.ip.tv/webchat/eduam/css.css",js:"https://assets.ip.tv/webchat/common/js.js",favicon:"https://assets.ip.tv/webchat/eduam/favicon.png",background:"https://assets.ip.tv/webchat/eduam/background.png",textMainColor:"525F98",loginLogo:"https://assets.ip.tv/webchat/eduam/login_logo.png",mainPageLogo:"https://assets.ip.tv/webchat/eduam/main_logo.png"},config:{realm:"eduam",janusServer:["wss://eduam-web.ip.tv:443","wss://eduam-web.ip.tv:444","wss://eduam-web.ip.tv:451","wss://eduam-web.ip.tv:446","wss://eduam-web.ip.tv:447","wss://eduam-web.ip.tv:448","wss://eduam-web.ip.tv:449","wss://eduam-web.ip.tv:450"],roomIcon:"https://assets.ip.tv/webchat/eduam/room_avatar.png",allowPrivMessage:!0,messenger:!1,onlySpecialPrivMessage:!0,showFinderField:!1,showTransmissionIcon:!1,showChannelCategoryList:!0,showChannelFavoriteIcon:!1,showChannelMoreCategoryIcon:!1,showChannelUserListIcon:!1,showChannelsIcon:!0,showChannelTargetInfo:!1,showGroupsIcon:!0,showMainConfigIcon:!1,showPeopleIcon:!1,showOtherIcon:!0,otherLink:"https://www.sigserv.com.br/app/webview/",otherLinkNewTab:!0,showChannelOtherLink:!0,firstCategorySelected:"5892327eda99be429e00bc2b",firstCategoryType:"",allowQuiz:!0}},{realm:"eduam",url:"webclient.ip.tv",assets:"https://assets.ip.tv/webchat",apiServer:"https://eduam-api.ip.tv",authServer:"https://eduam-api.ip.tv/device/web",iptvAuthServer:"https://eduam-api.ip.tv/device/",bodyIdField:"id",bodyPasswordField:"web_token",interface:{title:"Aula em Casa Web",description:"Centro de MÃ­dias do Amazonas.",css:"https://assets.ip.tv/webchat/eduam/css.css",js:"https://assets.ip.tv/webchat/common/js.js",favicon:"https://assets.ip.tv/webchat/eduam/favicon.png",background:"https://assets.ip.tv/webchat/eduam/background.png",textMainColor:"525F98",loginLogo:"https://assets.ip.tv/webchat/eduam/login_logo.png",mainPageLogo:"https://assets.ip.tv/webchat/eduam/main_logo.png"},config:{realm:"eduam",janusServer:["wss://eduam-web.ip.tv:443","wss://eduam-web.ip.tv:444","wss://eduam-web.ip.tv:451","wss://eduam-web.ip.tv:446","wss://eduam-web.ip.tv:447","wss://eduam-web.ip.tv:448","wss://eduam-web.ip.tv:449","wss://eduam-web.ip.tv:450"],roomIcon:"https://assets.ip.tv/webchat/eduam/room_avatar.png",allowPrivMessage:!0,messenger:!1,onlySpecialPrivMessage:!0,showFinderField:!1,showTransmissionIcon:!1,showChannelCategoryList:!0,showChannelFavoriteIcon:!1,showChannelMoreCategoryIcon:!1,showChannelUserListIcon:!1,showChannelsIcon:!0,showChannelTargetInfo:!1,showGroupsIcon:!0,showMainConfigIcon:!1,showPeopleIcon:!1,showOtherIcon:!0,otherLink:"https://www.sigserv.com.br/app/webview/",otherLinkNewTab:!0,showChannelOtherLink:!0,firstCategorySelected:"5892327eda99be429e00bc2b",firstCategoryType:"",allowQuiz:!0}},{realm:"saladeaula",multiRealm:!0,url:"web.saladeaula.embratel.cloud",assets:"https://assets.ip.tv/webchat",apiServer:"https://saladeaula-api.ip.tv",authServer:"https://saladeaula-api.ip.tv/device/",iptvAuthServer:"https://saladeaula-api.ip.tv/device",bodyIdField:"nick",bodyPasswordField:"password",interface:{title:"Sala de Aula Web",description:"Sala de Aula Web.",main:"https://assets.ip.tv/webchat/common/main.html",css:"https://assets.ip.tv/webchat/realms/css.css",js:"https://assets.ip.tv/webchat/common/js.js",favicon:"https://assets.ip.tv/webchat/saladeaula/favicon.png",background:"https://assets.ip.tv/webchat/saladeaula/background.png",textMainColor:"525F98",loginLogo:"https://assets.ip.tv/webchat/saladeaula/login_logo.png",mainPageLogo:"https://assets.ip.tv/webchat/saladeaula/main_logo.png"},realmData:{files_base_url:"https://saladeaula-static.ip.tv",realm_code:"saladeaula",platforms:["webclient"],acs_server:"acs",ppcs_server:"ppcs",room_server:"room",msg_drop_rate:200,msg_per_day:-1,tms_spa:"",auth_token:"",webview_url:"",lifes:0},config:{realm:"saladeaula",multiRealm:!0,janusServer:["wss://saladeaula-live1.ip.tv:443"],roomIcon:"https://assets.ip.tv/webchat/saladeaula/room_avatar.png",allowPrivMessage:!0,messenger:!1,onlySpecialPrivMessage:!0,showFinderField:!1,showTransmissionIcon:!1,showChannelCategoryList:!0,showChannelFavoriteIcon:!1,showChannelMoreCategoryIcon:!1,showChannelUserListIcon:!0,showChannelTaskIcon:!0,showChannelsIcon:!0,showChannelTargetInfo:!1,showGroupsIcon:!0,showGroupsIconRealms:["all"],showMainConfigIcon:!1,showPeopleIcon:!1,showChannelMoreSettings:!0,showRoomAllAttachments:!0,showChannelOtherLink:!0,showLmsIcon:!1,allowChannelCsm:!0,allowChannelInvite:!0,showVuMeter:!1,allowClosedCaption:!0,showTmsIcon:!0,showGoogleClassroomIcon:!1,googleClassroomLink:"https://classroom.google.com/u/0/h",firstCategorySelected:"",firstCategoryType:"featured",allowQuiz:!0,allowNormalUserSendLink:!0,allowAnalytics:!1,allowChannelLinkCopy:!1,allowRoomLinkCopy:!1,denySessionOnMobile:!0,minCamBitrate:256,maxCamBitrate:2e3,minScreenBitrate:256,maxScreenBitrate:6e3,ignoreWebViewUrl:!0,initialPanel:"channel",showRoomDetailPage:!0,showRoomDetailTest:!1,banubaEffect:!0}}];const Ii=class{constructor(){this._username="",this._password="",this._realm="",this._selectedRealm="",this._apiServer="",this._authServer="",this._iptvAuthServer="",this._bodyIdField="",this.bodyPasswordField="",this._auth_type="normal",this._allowedTypes=["normal","iptv","google","guest"],this._realmConfig={},this._invite=null,this._realmLogin=!1,this._deviceData={},this.loadRealmsConfig()}load(){ki(),Ei()}setLanguage(e){Ei(e)}getRealmConfig(e){return async function(e){const t=window.login.realmConfig,n=e||t.realm;let i;if(t&&(i=t.apiServer),!i)return E("getRealmConfig: apiServer not found"),!1;const s=`${i}/mas/realm/${n}/config`;let o;const r=X();return o=await fetch(s,r).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(console.log(`getRealmConfig error: ${JSON.stringify(e.errors)}`),!1):e)).catch((e=>{throw new Error(`getRealmConfig error: ${e}`)})),o}(e)}getRealmConfig2(){return function(){let e=window.location.hostname;const t=new URLSearchParams(window.location.search).get("realm");t&&(e=t);let n={};for(let t=0;t<Ti.length;t+=1)Ti[t].url===e&&(n=Ti[t]);return n}()}async loadRealmsConfig(){const e=localStorage.getItem("realmConfig");if(u("realmConfig")){const e=decodeURIComponent(u("realmConfig"));try{this._realmConfig=JSON.parse(e)}catch(e){console.log("Error: ",e)}localStorage.setItem("realmConfig",e),h("realmConfig")}else if(e)try{this._realmConfig=JSON.parse(e)}catch(e){console.log("Error: ",e)}if(u("iframe")||window.location.href.includes("/iframe")){const e=u("iframe");e&&localStorage.setItem("iframe",e),this._realmConfig=this.getRealmConfig2(),h("iframe")}}async getIFrame(){let e=localStorage.getItem("iframe");if(!e){const t=window.location.href;e=new URL(t).pathname.split("/")[2]}return e}async getRealmLogin(){return this._realmLogin=u("realmLogin"),""!==this._realmLogin&&this._realmLogin}async clearRealmLogin(){return h("realmLogin"),!1}async getInvite(){let e;if(u("invite")){e=decodeURIComponent(u("invite"));try{const t=JSON.parse(e);this._invite=t}catch(e){console.log("Error: ",e)}localStorage.setItem("invite",e),h("invite");const t=new URL(window.location.href),n=new URLSearchParams(t.search);n.delete("api"),n.delete("token"),t.search=n.toString(),window.history.replaceState({},"",t.toString())}return this._invite}get invite(){return this._invite}async validateToken(e){return await async function(e){console.log(e);const t={token:e||localStorage.getItem("auth_token")};console.log(t);const n=W(),i=`${window.apiServer}/mas/auth/verify`;let s;n.body=JSON.stringify(t),E(`[CMS session] Setting session with body: ${JSON.stringify(t)}`);try{s=await fetch(i,n).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`Validate Token error: ${JSON.stringify(e.errors)}`),!1):e)).catch((e=>(e.json().then((e=>{z(e)})),!1)))}catch(e){return!1}return s}(e)}get realmConfig(){return this._realmConfig}set username(e){this._username=e}get username(){return this._username}set password(e){this._password=e}get password(){return this._password}set realm(e){this._realm=e}get realm(){return this._realm=this.realmConfig.realm,this._realm}set selectedRealm(e){"undefined"!==e&&(this._selectedRealm=e)}get selectedRealm(){const e=localStorage.getItem("selectedRealm");return e&&"undefined"!==e&&(this._selectedRealm=e),this._selectedRealm}set apiServer(e){this._apiServer=e}get apiServer(){return this._apiServer=this.realmConfig.apiServer,this._apiServer}set authServer(e){this._authServer=e}get authServer(){return this._authServer=this.realmConfig.authServer,this._authServer}set iptvAuthServer(e){this._iptvAuthServer=e}get iptvAuthServer(){return this._iptvAuthServer=this.realmConfig.iptvAuthServer,this._iptvAuthServer}set bodyIdField(e){this._bodyIdField=e}get bodyIdField(){return this.bodyIdField=this.realmConfig.bodyIdField,this._bodyIdField}set bodyPasswordField(e){this._bodyPasswordField=e}get bodyPasswordField(){return this._bodyPasswordField=this.realmConfig.bodyPasswordField,this._bodyPasswordField}set loginType(e){this._loginType=e}get loginType(){return this._loginType}async authenticate(){return"normal"===this._auth_type?this.authenticateNormal():"iptv"===this._auth_type?this.authenticateIptv():"google"===this._auth_type?this.authenticateGoogle():"guest"===this._auth_type&&this.authenticateGuest()}async authenticateNormal(){Mi();const e=this.selectedRealm||this.realm,t={realm:e,platform:"webclient"};t[this.bodyIdField]=this._username?this._username:window.login.username,t[this.bodyPasswordField]=this._password?this._password:window.login.password;const n=this.authServer,i=await fetch(n,{method:"POST",headers:{"User-Agent":`${e}/0.0.1 (webclient/1.0)`,"Content-Type":"application/json","x-api-realm":e,"x-api-platform":"webclient"},body:JSON.stringify(t)});if(!i.ok)return{error:"HTTP error!",status:i.status};let s={};if(i){s=await i.json(),localStorage.setItem("data",JSON.stringify(s));const{realm:e,device_id:t,password:n,auth_token:o}=s,r={realm:e,device_id:t,password:n,auth_token:o};d("device_data",JSON.stringify(r),2),this._deviceData=s}return s}async authenticateIptv(){Mi();const e=this.selectedRealm||this.realm,t={realm:e,platform:"webclient",nick:this._username,password:this._password},n=this.iptvAuthServer,i=await fetch(n,{method:"POST",headers:{"User-Agent":`${e}/0.0.1 (webclient/1.0)`,"Content-Type":"application/json","x-api-realm":e,"x-api-platform":"webclient"},body:JSON.stringify(t)});if(!i.ok)return{error:"HTTP error!",status:i.status};let s={};if(i){s=await i.json(),localStorage.setItem("data",JSON.stringify(s));const{device_id:e,password:t,auth_token:n}=s,o={device_id:e,password:t,auth_token:n};d("device_data",JSON.stringify(o),2),this._deviceData=s}return s}async logoutGoogle(){const e=window.authInstance;e.isSignedIn.get()&&await e.disconnect().then((()=>{console.log("User signed out."),window.gapi&&window.gapi.signin2&&window.gapi.signin2.render("google_sign_in_button",{scope:"profile email",width:180,height:40,longtitle:!1,theme:"dark"}),e.isSignedIn.get()?console.log("User is still signed in."):console.log("User is not signed in.")}))}async authenticateGoogle(e){Mi();const t=this.selectedRealm||this.realm,n=e.getAuthResponse().id_token,i=e.getBasicProfile(),s=this.realmConfig.googleAuthServer,o=this.realmConfig.googleRegistrationServer,r=(i.getEmail().split("@")[1],window.create_on_signin||!1);let a,c={realm:t,platform:"webclient"};if(s){a=s;const e="";c={...c,token:n,auth_type:e}}else a=o,c={...c,token:n,provider:"google",realm:t,create:r};const l=await fetch(a,{method:"POST",headers:{"User-Agent":`${t}/0.0.1 (webclient/1.0)`,"Content-Type":"application/json"},body:JSON.stringify(c)});if(!l.ok)return{error:"HTTP error!",status:l.status};let u={};if(l){u=await l.json(),localStorage.setItem("data",JSON.stringify(u));const{device_id:e,password:t,auth_token:n}=u,i={device_id:e,password:t,auth_token:n};d("device_data",JSON.stringify(i),2),this._deviceData=u}return window.location.href=`/${window.location.search}`,u}async authenticateGuest(e){const t=this.getRealmConfig2(),n=e||this.selectedRealm||this.realm||t.realm,i={realm:n,platform:"webclient"},s=`${this.apiServer}/guest`,o=await fetch(s,{method:"POST",headers:{"User-Agent":`${n}/0.0.1 (webclient/1.0)`,"Content-Type":"application/json","x-api-realm":n,"x-api-platform":"webclient"},body:JSON.stringify(i)});let r={};return o&&(r=await o.json()),localStorage.setItem("data",JSON.stringify(r)),d("device_data",localStorage.getItem("data"),2),this._deviceData=r,r}get deviceData(){return this._deviceData}getDeviceData(){const e=u("device_data")||!1;return JSON.parse(e)}removeDeviceData(){h("device_data")}async getPermissions(e){return await async function(e){const t=`${window.apiServer}/mas/permission/${e}`,n=X();let i;try{i=await fetch(t,n).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`getPermissions error: ${JSON.stringify(e.errors)}`),null):e)).catch((e=>(E(e),null)))}catch(e){return E(e),null}return i}(e)}};class Ri{static stopStream(e){Ri.stopStreamVideo(e),Ri.stopStreamAudio(e)}static stopStreamVideo(e){if(!e)return;const t=e.getVideoTracks();if(t.length>0){const n=t[0];e.removeTrack(n),n.stop()}}static stopStreamAudio(e){if(!e)return;const t=e.getAudioTracks();if(t.length>0){const n=t[0];e.removeTrack(n),n.stop()}}static isEnded(e){let t=!0;const n=e.getVideoTracks();for(let e=0;e<n.length;e++)"ended"!=n[e].readyState&&(t=!1);const i=e.getAudioTracks();for(let e=0;e<i.length;e++)"ended"!=i[e].readyState&&(t=!1);return t}}class Ai{static enableCtrl(e,t){e.prop("disabled",!t)}static comboSelectedVal(e){return e.find("option:selected").text()}static checkBoxVal(e){return e.is(":checked")}static radionButtonChange(e,t,n){$(`#${e} input`).on("change",(()=>{const i=$(`input[name=${t}]:checked`,`#${e}`).val();n(i)}))}static radionButtonChangeCtx(e,t,n){$(`input:radio[name='${t}']`,e).on("change",(function(){const e=$(this).val();n(e)}))}static setRadioButtonVal(e,t,n){$(`#${e} input[name=${t}][value=${n}]`).prop("checked",!0)}static setRadioButtonValCtx(e,t,n){$(`input[name=${t}][value=${n}]`,e).prop("checked",!0)}}function $i(e){return!e||0===e.length}class Li{static hasSuffix(e,t){return!!e&&e.endsWith(t)}static hasPrefix(e,t){return!!e&&e.startsWith(t)}static removeFirst(e,t){return e&&t>0&&t<=e.length?e.slice(t):e}static removeSuffixStartingFromSubstring(e,t){if(!e)return"";const n=e.indexOf(t);return n>=0&&(e=e.substring(0,n)),e}}let Pi=null;const Di={g:{config:(e,t,n,i)=>{Ni.g().config(e,t,n,i)},setLoglevel:e=>{Ni.g().setLoglevel(e)},setLogCallback:e=>{Ni.g().setLogCallback(e)},log:(e,t,n=0,i=!0,s=!0,o=null)=>Ni.g().log(e,t,n,i,s,o)}};class Ni{static g(){return Pi||(Pi=new Ni),Pi}constructor(e=0,t=!0){this.G_LOGLEVEL=4,this.mModules=new Map,this.mLogMask=e,this.mConsole=t,this.mLogCallback=null}config(e,t,n,i){this.mLogMask=n,this.mConsole=e,this.G_LOGLEVEL=t,this.mModules=i}setLoglevel(e){this.G_LOGLEVEL=e,this.log(0,`YLogger::setLoglevel: Log level set to ${this.G_LOGLEVEL}`)}setLogCallback(e){this.mLogCallback=e}glog(e,t,n=0,i=!0,s=!0,o=null){if($i(t))return new Date;var r="";if(0!=n){let e=this.mModules.get(n);$i(e)||(r+=`[${e}] `)}return logger.log(e,r+t,n,i,s,o)}_log(e,t,n=0,i=!0,s=!0,o,r){let a="";if(o){let e=r.getTime(),t=o.getTime();a=`(elapsed: ${e>t?e-t:0}) `+a}i&&(a=`[[${r.getYear()+1900}/${r.getMonth()+1}/${r.getDate()} ${r.getHours()}:${r.getMinutes()}:${r.getSeconds()}]] ${a}`),this.mLogCallback?this.mLogCallback(a+t):(this.mConsole||s)&&console.log(a+t)}log(e,t,n=0,i=!0,s=!0,o=null){let r=new Date;return e<=this.G_LOGLEVEL&&(0==this.mLogMask||0==n||this.mLogMask&0!=n)&&!$i(t)&&this._log(e,t,n,i,s,o,r),r}}let Oi=(e=21)=>{let t="",n=e;for(;n--;)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return t};const Bi="KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO3ZhciBjPVVpbnQ4QXJyYXkseD1VaW50MTZBcnJheSxEPVVpbnQzMkFycmF5LEg9bmV3IGMoWzAsMCwwLDAsMCwwLDAsMCwxLDEsMSwxLDIsMiwyLDIsMywzLDMsMyw0LDQsNCw0LDUsNSw1LDUsMCwwLDAsMF0pLEk9bmV3IGMoWzAsMCwwLDAsMSwxLDIsMiwzLDMsNCw0LDUsNSw2LDYsNyw3LDgsOCw5LDksMTAsMTAsMTEsMTEsMTIsMTIsMTMsMTMsMCwwXSksbDE9bmV3IGMoWzE2LDE3LDE4LDAsOCw3LDksNiwxMCw1LDExLDQsMTIsMywxMywyLDE0LDEsMTVdKSxKPWZ1bmN0aW9uKHIsdCl7Zm9yKHZhciBhPW5ldyB4KDMxKSxuPTA7bjwzMTsrK24pYVtuXT10Kz0xPDxyW24tMV07Zm9yKHZhciB2PW5ldyBEKGFbMzBdKSxuPTE7bjwzMDsrK24pZm9yKHZhciBpPWFbbl07aTxhW24rMV07KytpKXZbaV09aS1hW25dPDw1fG47cmV0dXJuW2Esdl19LEs9SihILDIpLFE9S1swXSxzMT1LWzFdO1FbMjhdPTI1OCxzMVsyNThdPTI4O2Zvcih2YXIgYzE9SihJLDApLGQxPWMxWzBdLFU9bmV3IHgoMzI3NjgpLHU9MDt1PDMyNzY4OysrdSl7dmFyIFM9KHUmNDM2OTApPj4+MXwodSYyMTg0NSk8PDE7Uz0oUyY1MjQyOCk+Pj4yfChTJjEzMTA3KTw8MixTPShTJjYxNjgwKT4+PjR8KFMmMzg1NSk8PDQsVVt1XT0oKFMmNjUyODApPj4+OHwoUyYyNTUpPDw4KT4+PjF9Zm9yKHZhciBrPWZ1bmN0aW9uKHQsYSxuKXtmb3IodmFyIHY9dC5sZW5ndGgsaT0wLHM9bmV3IHgoYSk7aTx2OysraSl0W2ldJiYrK3NbdFtpXS0xXTt2YXIgZj1uZXcgeChhKTtmb3IoaT0wO2k8YTsrK2kpZltpXT1mW2ktMV0rc1tpLTFdPDwxO3ZhciBvO2lmKG4pe289bmV3IHgoMTw8YSk7dmFyIGU9MTUtYTtmb3IoaT0wO2k8djsrK2kpaWYodFtpXSlmb3IodmFyIGw9aTw8NHx0W2ldLGI9YS10W2ldLGQ9Zlt0W2ldLTFdKys8PGIseT1kfCgxPDxiKS0xO2Q8PXk7KytkKW9bVVtkXT4+PmVdPWx9ZWxzZSBmb3Iobz1uZXcgeCh2KSxpPTA7aTx2OysraSl0W2ldJiYob1tpXT1VW2ZbdFtpXS0xXSsrXT4+PjE1LXRbaV0pO3JldHVybiBvfSxCPW5ldyBjKDI4OCksdT0wO3U8MTQ0OysrdSlCW3VdPTg7Zm9yKHZhciB1PTE0NDt1PDI1NjsrK3UpQlt1XT05O2Zvcih2YXIgdT0yNTY7dTwyODA7Kyt1KUJbdV09Nztmb3IodmFyIHU9MjgwO3U8Mjg4OysrdSlCW3VdPTg7Zm9yKHZhciBWPW5ldyBjKDMyKSx1PTA7dTwzMjsrK3UpVlt1XT01O3ZhciBoMT1rKEIsOSwxKSxnMT1rKFYsNSwxKSxXPWZ1bmN0aW9uKHIpe2Zvcih2YXIgdD1yWzBdLGE9MTthPHIubGVuZ3RoOysrYSlyW2FdPnQmJih0PXJbYV0pO3JldHVybiB0fSx3PWZ1bmN0aW9uKHIsdCxhKXt2YXIgbj10Lzh8MDtyZXR1cm4ocltuXXxyW24rMV08PDgpPj4odCY3KSZhfSxYPWZ1bmN0aW9uKHIsdCl7dmFyIGE9dC84fDA7cmV0dXJuKHJbYV18clthKzFdPDw4fHJbYSsyXTw8MTYpPj4odCY3KX0sdzE9ZnVuY3Rpb24ocil7cmV0dXJuKHIrNykvOHwwfSxqPWZ1bmN0aW9uKHIsdCxhKXsodD09bnVsbHx8dDwwKSYmKHQ9MCksKGE9PW51bGx8fGE+ci5sZW5ndGgpJiYoYT1yLmxlbmd0aCk7dmFyIG49bmV3KHIuQllURVNfUEVSX0VMRU1FTlQ9PTI/eDpyLkJZVEVTX1BFUl9FTEVNRU5UPT00P0Q6YykoYS10KTtyZXR1cm4gbi5zZXQoci5zdWJhcnJheSh0LGEpKSxufSxtMT1bInVuZXhwZWN0ZWQgRU9GIiwiaW52YWxpZCBibG9jayB0eXBlIiwiaW52YWxpZCBsZW5ndGgvbGl0ZXJhbCIsImludmFsaWQgZGlzdGFuY2UiLCJzdHJlYW0gZmluaXNoZWQiLCJubyBzdHJlYW0gaGFuZGxlciIsLCJubyBjYWxsYmFjayIsImludmFsaWQgVVRGLTggZGF0YSIsImV4dHJhIGZpZWxkIHRvbyBsb25nIiwiZGF0ZSBub3QgaW4gcmFuZ2UgMTk4MC0yMDk5IiwiZmlsZW5hbWUgdG9vIGxvbmciLCJzdHJlYW0gZmluaXNoaW5nIiwiaW52YWxpZCB6aXAgZGF0YSJdLGg9ZnVuY3Rpb24ocix0LGEpe3ZhciBuPW5ldyBFcnJvcih0fHxtMVtyXSk7aWYobi5jb2RlPXIsRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UmJkVycm9yLmNhcHR1cmVTdGFja1RyYWNlKG4saCksIWEpdGhyb3cgbjtyZXR1cm4gbn0sYjE9ZnVuY3Rpb24ocix0LGEpe3ZhciBuPXIubGVuZ3RoO2lmKCFufHxhJiZhLmYmJiFhLmwpcmV0dXJuIHR8fG5ldyBjKDApO3ZhciB2PSF0fHxhLGk9IWF8fGEuaTthfHwoYT17fSksdHx8KHQ9bmV3IGMobiozKSk7dmFyIHM9ZnVuY3Rpb24odTEpe3ZhciB2MT10Lmxlbmd0aDtpZih1MT52MSl7dmFyIGYxPW5ldyBjKE1hdGgubWF4KHYxKjIsdTEpKTtmMS5zZXQodCksdD1mMX19LGY9YS5mfHwwLG89YS5wfHwwLGU9YS5ifHwwLGw9YS5sLGI9YS5kLGQ9YS5tLHk9YS5uLFI9bio4O2Rve2lmKCFsKXtmPXcocixvLDEpO3ZhciBZPXcocixvKzEsMyk7aWYobys9MyxZKWlmKFk9PTEpbD1oMSxiPWcxLGQ9OSx5PTU7ZWxzZSBpZihZPT0yKXt2YXIgQz13KHIsbywzMSkrMjU3LHIxPXcocixvKzEwLDE1KSs0LHQxPUMrdyhyLG8rNSwzMSkrMTtvKz0xNDtmb3IodmFyIEY9bmV3IGModDEpLEc9bmV3IGMoMTkpLGc9MDtnPHIxOysrZylHW2wxW2ddXT13KHIsbytnKjMsNyk7bys9cjEqMztmb3IodmFyIGExPVcoRyksQjE9KDE8PGExKS0xLFIxPWsoRyxhMSwxKSxnPTA7Zzx0MTspe3ZhciBuMT1SMVt3KHIsbyxCMSldO28rPW4xJjE1O3ZhciBwPW4xPj4+NDtpZihwPDE2KUZbZysrXT1wO2Vsc2V7dmFyIHo9MCxOPTA7Zm9yKHA9PTE2PyhOPTMrdyhyLG8sMyksbys9Mix6PUZbZy0xXSk6cD09MTc/KE49Myt3KHIsbyw3KSxvKz0zKTpwPT0xOCYmKE49MTErdyhyLG8sMTI3KSxvKz03KTtOLS07KUZbZysrXT16fX12YXIgaTE9Ri5zdWJhcnJheSgwLEMpLF89Ri5zdWJhcnJheShDKTtkPVcoaTEpLHk9VyhfKSxsPWsoaTEsZCwxKSxiPWsoXyx5LDEpfWVsc2UgaCgxKTtlbHNle3ZhciBwPXcxKG8pKzQsTD1yW3AtNF18cltwLTNdPDw4LFo9cCtMO2lmKFo+bil7aSYmaCgwKTticmVha312JiZzKGUrTCksdC5zZXQoci5zdWJhcnJheShwLFopLGUpLGEuYj1lKz1MLGEucD1vPVoqOCxhLmY9Zjtjb250aW51ZX1pZihvPlIpe2kmJmgoMCk7YnJlYWt9fXYmJnMoZSsxMzEwNzIpO2Zvcih2YXIgWTE9KDE8PGQpLTEsRjE9KDE8PHkpLTEsJD1vOzskPW8pe3ZhciB6PWxbWChyLG8pJlkxXSxUPXo+Pj40O2lmKG8rPXomMTUsbz5SKXtpJiZoKDApO2JyZWFrfWlmKHp8fGgoMiksVDwyNTYpdFtlKytdPVQ7ZWxzZSBpZihUPT0yNTYpeyQ9byxsPW51bGw7YnJlYWt9ZWxzZXt2YXIgbzE9VC0yNTQ7aWYoVD4yNjQpe3ZhciBnPVQtMjU3LE09SFtnXTtvMT13KHIsbywoMTw8TSktMSkrUVtnXSxvKz1NfXZhciBQPWJbWChyLG8pJkYxXSxPPVA+Pj40O1B8fGgoMyksbys9UCYxNTt2YXIgXz1kMVtPXTtpZihPPjMpe3ZhciBNPUlbT107Xys9WChyLG8pJigxPDxNKS0xLG8rPU19aWYobz5SKXtpJiZoKDApO2JyZWFrfXYmJnMoZSsxMzEwNzIpO2Zvcih2YXIgZTE9ZStvMTtlPGUxO2UrPTQpdFtlXT10W2UtX10sdFtlKzFdPXRbZSsxLV9dLHRbZSsyXT10W2UrMi1fXSx0W2UrM109dFtlKzMtX107ZT1lMX19YS5sPWwsYS5wPSQsYS5iPWUsYS5mPWYsbCYmKGY9MSxhLm09ZCxhLmQ9YixhLm49eSl9d2hpbGUoIWYpO3JldHVybiBlPT10Lmxlbmd0aD90OmoodCwwLGUpfSx5MT1uZXcgYygwKSxFPWZ1bmN0aW9uKHIsdCl7cmV0dXJuIHJbdF18clt0KzFdPDw4fSxtPWZ1bmN0aW9uKHIsdCl7cmV0dXJuKHJbdF18clt0KzFdPDw4fHJbdCsyXTw8MTZ8clt0KzNdPDwyNCk+Pj4wfSxxPWZ1bmN0aW9uKHIsdCl7cmV0dXJuIG0ocix0KSttKHIsdCs0KSo0Mjk0OTY3Mjk2fTtmdW5jdGlvbiBFMShyLHQpe3JldHVybiBiMShyLHQpfXZhciBBPXR5cGVvZiBUZXh0RGVjb2RlcjwidSImJm5ldyBUZXh0RGVjb2RlcixwMT0wO3RyeXtBLmRlY29kZSh5MSx7c3RyZWFtOiEwfSkscDE9MX1jYXRjaHt9dmFyIFMxPWZ1bmN0aW9uKHIpe2Zvcih2YXIgdD0iIixhPTA7Oyl7dmFyIG49clthKytdLHY9KG4+MTI3KSsobj4yMjMpKyhuPjIzOSk7aWYoYSt2PnIubGVuZ3RoKXJldHVyblt0LGoocixhLTEpXTt2P3Y9PTM/KG49KChuJjE1KTw8MTh8KHJbYSsrXSY2Myk8PDEyfChyW2ErK10mNjMpPDw2fHJbYSsrXSY2MyktNjU1MzYsdCs9U3RyaW5nLmZyb21DaGFyQ29kZSg1NTI5NnxuPj4xMCw1NjMyMHxuJjEwMjMpKTp2JjE/dCs9U3RyaW5nLmZyb21DaGFyQ29kZSgobiYzMSk8PDZ8clthKytdJjYzKTp0Kz1TdHJpbmcuZnJvbUNoYXJDb2RlKChuJjE1KTw8MTJ8KHJbYSsrXSY2Myk8PDZ8clthKytdJjYzKTp0Kz1TdHJpbmcuZnJvbUNoYXJDb2RlKG4pfX07ZnVuY3Rpb24gQzEocix0KXtpZih0KXtmb3IodmFyIGE9IiIsbj0wO248ci5sZW5ndGg7bis9MTYzODQpYSs9U3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLHIuc3ViYXJyYXkobixuKzE2Mzg0KSk7cmV0dXJuIGF9ZWxzZXtpZihBKXJldHVybiBBLmRlY29kZShyKTt2YXIgdj1TMShyKSxpPXZbMF0scz12WzFdO3JldHVybiBzLmxlbmd0aCYmaCg4KSxpfX12YXIgXzE9ZnVuY3Rpb24ocix0KXtyZXR1cm4gdCszMCtFKHIsdCsyNikrRShyLHQrMjgpfSx4MT1mdW5jdGlvbihyLHQsYSl7dmFyIG49RShyLHQrMjgpLHY9QzEoci5zdWJhcnJheSh0KzQ2LHQrNDYrbiksIShFKHIsdCs4KSYyMDQ4KSksaT10KzQ2K24scz1tKHIsdCsyMCksZj1hJiZzPT00Mjk0OTY3Mjk1P3oxKHIsaSk6W3MsbShyLHQrMjQpLG0ocix0KzQyKV0sbz1mWzBdLGU9ZlsxXSxsPWZbMl07cmV0dXJuW0Uocix0KzEwKSxvLGUsdixpK0Uocix0KzMwKStFKHIsdCszMiksbF19LHoxPWZ1bmN0aW9uKHIsdCl7Zm9yKDtFKHIsdCkhPTE7dCs9NCtFKHIsdCsyKSk7cmV0dXJuW3Eocix0KzEyKSxxKHIsdCs0KSxxKHIsdCsyMCldfTtmdW5jdGlvbiBUMShyLHQpe2Zvcih2YXIgYT17fSxuPXIubGVuZ3RoLTIyO20ocixuKSE9MTAxMDEwMjU2Oy0tbikoIW58fHIubGVuZ3RoLW4+NjU1NTgpJiZoKDEzKTt2YXIgdj1FKHIsbis4KTtpZighdilyZXR1cm57fTt2YXIgaT1tKHIsbisxNikscz1pPT00Mjk0OTY3Mjk1O3MmJihuPW0ocixuLTEyKSxtKHIsbikhPTEwMTA3NTc5MiYmaCgxMyksdj1tKHIsbiszMiksaT1tKHIsbis0OCkpO2Zvcih2YXIgZj10JiZ0LmZpbHRlcixvPTA7bzx2Oysrbyl7dmFyIGU9eDEocixpLHMpLGw9ZVswXSxiPWVbMV0sZD1lWzJdLHk9ZVszXSxSPWVbNF0sWT1lWzVdLEM9XzEocixZKTtpPVIsKCFmfHxmKHtuYW1lOnksc2l6ZTpiLG9yaWdpbmFsU2l6ZTpkLGNvbXByZXNzaW9uOmx9KSkmJihsP2w9PTg/YVt5XT1FMShyLnN1YmFycmF5KEMsQytiKSxuZXcgYyhkKSk6aCgxNCwidW5rbm93biBjb21wcmVzc2lvbiB0eXBlICIrbCk6YVt5XT1qKHIsQyxDK2IpKX1yZXR1cm4gYX1jb25zdCBrMT1yPT5UMShyLHtmaWx0ZXI6KHtuYW1lOnQsc2l6ZTphfSk9PiEoYT09PTB8fHQuc3RhcnRzV2l0aCgiX19NQUNPU1gvIikpfSk7YWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsKHtkYXRhOnJ9KT0+e2xldCB0O3RyeXt0PXtpZDpyLmlkLGRhdGE6azEoci5kYXRhKX19Y2F0Y2goYSl7dD17aWQ6ci5pZCxlcnJvcjphLm1lc3NhZ2V9fXBvc3RNZXNzYWdlKHQpfSl9KSgpOwo=",Fi="undefined"!=typeof window&&window.Blob&&new Blob([atob(Bi)],{type:"text/javascript;charset=utf-8"});function Ui(){const e=Fi&&(window.URL||window.webkitURL).createObjectURL(Fi);try{return e?new Worker(e):new Worker("data:application/javascript;base64,"+Bi)}finally{e&&(window.URL||window.webkitURL).revokeObjectURL(e)}}let ji;const Vi=async e=>new Promise(((t,n)=>{const i={id:Oi(),data:new Uint8Array(e)};ji||(ji=new Ui);const s=({data:e})=>{e.id===i.id&&(ji.removeEventListener("message",s),"error"in e&&n(new Error(e.error)),"data"in e&&t(e.data))};ji.addEventListener("message",s),ji.postMessage(i,[e])}));var Gi=Object.defineProperty,qi=(e,t,n)=>(((e,t,n)=>{t in e?Gi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class Hi{constructor(e){qi(this,"_source",null),qi(this,"_fs",null),qi(this,"_mountpoint","/"),qi(this,"_data",{}),this._source=e}static async preload(e,t){if(Array.isArray(e)){const n=null==t?void 0:t.onProgress;return await Promise.all(e.map(((e,t)=>{const i=n?{onProgress:(...e)=>n(t,...e)}:{};return this.preload(e,i)})))}const n=new this(e);return await n.load(t),n}async _fetch(e,t){return await((e,t,n)=>fetch(e,{}).then((e=>{if(!e.body)return e;let t=0;const i=Number(e.headers.get("content-length")||0),s=e.body.getReader();return new Response(new ReadableStream({async start(e){for(var o;;){const{done:r,value:a}=await s.read();if(r?t=i:t+=a.byteLength,null==(o=null==n?void 0:n.onProgress)||o.call(n,{total:i,transferred:t}),r)break;e.enqueue(a)}e.close()}}),e)})))(e,0,t).then((t=>{if(t.ok)return t.blob();throw new Error(`Failed to fetch ${e.url} ${t.status} (${t.statusText})`)})).then((e=>{if(e.size>0)return e;throw new Error(`The source must not be empty. Received ${e.size} bytes size source.`)}))}async _unzip(e){if(!e.type.includes("zip"))throw new TypeError(`The source type must be "application/zip"-like. Received: "${e.type}".`);return await zi(e).then(Vi).then((e=>Object.entries(e))).then((e=>Object.fromEntries(e)))}async load(e){let t=this._source;return"string"==typeof t&&(t=new Request(t)),t instanceof Request&&(t=await this._fetch(t,e)),t instanceof Blob&&(t=await this._unzip(t)),t instanceof Object&&t.constructor===Object&&await Promise.all(Object.entries(t).map((([e,t])=>this.writeFile(e,t)))),this._source=null,this._data}_fsWriteFile(e,t){!this._fs||(e=`${this._mountpoint}${e.startsWith("/")?e.substring(1):e}`,this._fs.writeFile(e,t))}async writeFile(e,t){const n=new Uint8Array(t instanceof Blob?await zi(t):t);this._data[e]=n,this._fsWriteFile(e,this._data[e])}mount(e,t="/"){this._fs=e,this._mountpoint=t.endsWith("/")?t:`${t}/`,Object.entries(this._data).forEach((([e,t])=>this._fsWriteFile(e,t)))}unmount(){this._fs=null,this._mountpoint="/"}}function zi(e){return"arrayBuffer"in e?e.arrayBuffer():new Promise((t=>{const n=new FileReader;n.onload=()=>t(n.result),n.readAsArrayBuffer(e)}))}var Wi=Object.defineProperty;class Ji{constructor(e){((e,t,n)=>{((e,t,n)=>{t in e?Wi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n)})(this,"_resource"),this._resource=new Hi(e)}static async preload(e,t){if(Array.isArray(e)){const n=null==t?void 0:t.onProgress;return await Promise.all(e.map(((e,t)=>{const i=n?{onProgress:(...e)=>n(t,...e)}:{};return this.preload(e,i)})))}const n=new this(e);return await n._load(t),n}async _load(e){await this._resource.load(e)}async _bind(e){await this._resource.load(),this._resource.mount(e.FS)}}const Yi=(e,t=(e=>console.warn(e)))=>function(n,i,s){const o=s.value;if("function"!=typeof o)throw new TypeError("Only functions can be marked as deprecated");return{...s,value:function(...s){return t.call(this,`DEPRECATION: ${n.constructor.name}.${i}() is deprecated. ${e}`),o.call(this,...s)}}};var Ki=Object.defineProperty,Xi=(e,t,n)=>(((e,t,n)=>{t in e?Ki(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n),Zi=Object.defineProperty,Qi=Object.getOwnPropertyDescriptor;class es{constructor(e){Xi(this,"name",`effects/${Oi()}`),Xi(this,"_player",null),Xi(this,"_resource"),this._resource=new ts(e)}static async preload(e,t){if(Array.isArray(e)){const n=null==t?void 0:t.onProgress;return await Promise.all(e.map(((e,t)=>{const i=n?{onProgress:(...e)=>n(t,...e)}:{};return this.preload(e,i)})))}const n=new this(e);return await n._load(t),n}async _load(e){await this._resource.load(e)}async _bind(e){await this._resource.load(),this._player=e,this._resource.mount(this._player.FS,this.name)}_unbind(){this._resource.unmount(),this._player=null}async writeFile(e,t){return this._resource.writeFile(e,t)}callJsMethod(e,t=""){if(this._player)return this._player.callJsMethod(e,t);console.warn("The method won't evaluate: the effect is not applied to a player.")}async evalJs(e){if(this._player)return await this._player.evalJs(e);console.warn("The script won't evaluate: the effect is not applied to a player.")}}((e,t,n,i)=>{for(var s,o=Qi(t,n),r=e.length-1;r>=0;r--)(s=e[r])&&(o=s(t,n,o)||o);o&&Zi(t,n,o)})([Yi("Please, use Effect.evalJs() instead.")],es.prototype,"callJsMethod");class ts extends Hi{async _unzip(e){let t=await super._unzip(e);const n=Object.keys(t).map((e=>e.split("/").find(Boolean))),i=n[0];return n.every((e=>e===i))&&(t=Object.fromEntries(Object.entries(t).map((([e,t])=>[e.replace(`${i}/`,""),t])))),t}}let ns=0;const is=()=>ns++,ss="KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2FkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCh7ZGF0YTp0fSk9Pntjb25zdCBzPXtpZDp0LmlkfTtzZXRUaW1lb3V0KHBvc3RNZXNzYWdlLHQudGltZW91dCxzKX0pfSkoKTsK",os="undefined"!=typeof window&&window.Blob&&new Blob([atob(ss)],{type:"text/javascript;charset=utf-8"});function rs(){const e=os&&(window.URL||window.webkitURL).createObjectURL(os);try{return e?new Worker(e):new Worker("data:application/javascript;base64,"+ss)}finally{e&&(window.URL||window.webkitURL).revokeObjectURL(e)}}let as;const cs=new Map,ls=(e,t)=>{const n=is(),i={id:n,timeout:t};return cs.set(i.id,e),as||(as=new rs,as.onmessage=({data:e})=>{const t=cs.get(e.id);cs.delete(e.id),t()}),as.postMessage(i),n},ds=1e3/60,us=[];let hs=0;const ps=e=>{const t=is();if(0===us.length){const e=performance.now();ls((()=>{const e=hs=performance.now(),t=[...us];us.length=0,t.forEach((t=>t(e)))}),ds-(e-hs)%ds)}return us.push(e),t},ms=(...e)=>window.setTimeout(...e),ws=new Map,gs=e=>{const t=window.requestAnimationFrame(((...n)=>{ws.delete(t),e(...n)}));return ws.set(t,e),t};"undefined"!=typeof document&&document.addEventListener("visibilitychange",(()=>{"visible"!==document.visibilityState&&ws.forEach(((e,t)=>{ws.delete(t),cancelAnimationFrame(t),ps(e)}))}));const fs="undefined"!=typeof document?document:{visibilityState:"hidden"},vs=()=>"visible"===fs.visibilityState?t:e,bs=e=>vs().requestAnimationFrame(e),_s=e=>Promise.resolve().then(e);var ys=Object.defineProperty;const Cs=()=>{try{return new EventTarget}catch{return document.createDocumentFragment()}};class Ss{constructor(){((e,t,n)=>{((e,t,n)=>{t in e?ys(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n)})(this,"_emitter",Cs())}addEventListener(e,t,n){this._emitter.addEventListener(e,t,n)}removeEventListener(e,t,n){this._emitter.removeEventListener(e,t,n)}dispatchEvent(e){return this._emitter.dispatchEvent(e)}removeAllEventListeners(){this._emitter=Cs()}}var Es=Object.defineProperty,xs=(e,t,n)=>(((e,t,n)=>{t in e?Es(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class ks{constructor(e){xs(this,"_buffer"),this._buffer=new ArrayBuffer(e)}get buffer(){return this._buffer}get byteLength(){return this._buffer.byteLength}get byteOffset(){return 0}set(){}}class Ms{constructor(e){xs(this,"ptr",-1),xs(this,"length"),xs(this,"data"),this.length=e,this.data=new ks(e)}}class Ts{constructor(e,t,n){this._module=e,this._byteOffset=t,this._byteLength=n}get buffer(){return this._module.HEAPU8.buffer}get byteLength(){return this._byteLength}get byteOffset(){return this._byteOffset}set(e){return this._module.HEAPU8.set(e,this._byteOffset)}}class Is{constructor(e,t=1){xs(this,"_module"),xs(this,"_free"),xs(this,"_inuse",[]),this._module=e,this._free=new Array(t).fill(null).map((()=>({ptr:NaN,length:0})))}allocate(e){const t=this._free.shift();return t?(this._inuse.push(t),t.length!==e&&(isNaN(t.ptr)||this._module._free(t.ptr),t.ptr=this._module._malloc(e),t.length=e,t.data=new Ts(this._module,t.ptr,t.length)),t):null}release(e){let t;do{(t=this._inuse.shift())&&this._free.push(t)}while(t&&t.ptr!==e)}reset(){this._free.push(...this._inuse.splice(0,this._inuse.length)),this._free.forEach((e=>{isNaN(e.ptr)||this._module._free(e.ptr),e.ptr=NaN,e.length=0}))}}const Rs=["isAliasOf","clone","delete","isDeleted","deleteLater"],As=["size","get","set","push_back"],$s=e=>{if(null==e||"function"!=typeof e)return!1;const{prototype:t}=e;return!!t&&Rs.every((e=>e in t))},Ls=e=>null!=e&&"object"==typeof e&&$s(e.constructor),Ps=e=>Ls(e)&&As.every((t=>t in e));var Ds=Object.defineProperty,Ns=(e,t,n)=>(((e,t,n)=>{t in e?Ds(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class Os{constructor(e){Ns(this,"_fd"),Ns(this,"_cache",new Map),this._fd=e}get(e){if(Array.isArray(e))return e.map((e=>this.get(e)));const t=e.split("."),n=t.length;let i=n,s=this._fd;for(let e=!1;!e&&i>0;--i){const n=t.slice(0,i).join(".");this._cache.has(n)&&(e=!0,s=this._cache.get(n),++i)}for(;null!=s&&i<n;++i){const n=t[i];let o=s[n];if(void 0===o&&(o=s["get"+n[0].toUpperCase()+n.slice(1)]),void 0===o&&Ps(s)){const e=parseInt(n);isNaN(e)||(o=s.get(e))}if("function"==typeof o)try{o=o.apply(s)}catch{o=void 0}const r=t.slice(0,i+1).join(".");if(e===r&&Ps(o)){const e=o;o=new Array(e.size());for(let t=0,n=e.size();t<n;++t)o[t]=e.get(t)}this._cache.set(r,s=o)}return i===n?s:void 0}}function Bs(){return Bs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Bs.apply(null,arguments)}var Fs,Us=(Fs="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(e){var t,n;(e=void 0!==(e=e||{})?e:{}).ready=new Promise((function(e,i){t=e,n=i})),e.expectedDataFileDownloads||(e.expectedDataFileDownloads=0),e.expectedDataFileDownloads++,e.ENVIRONMENT_IS_PTHREAD||function(t){"object"==typeof window?window.encodeURIComponent(window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/"):"undefined"==typeof process&&"undefined"!=typeof location&&encodeURIComponent(location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/");var n="BanubaSDK.data";"function"==typeof e.locateFilePackage&&!e.locateFile&&(e.locateFile=e.locateFilePackage,d("warning: you defined Module.locateFilePackage, that has been renamed to Module.locateFile (using your locateFilePackage for now)"));var i=e.locateFile?e.locateFile(n,""):n,s=t.remote_package_size,o=null,r=e.getPreloadedPackage?e.getPreloadedPackage(i,s):null;function a(){function n(e,t){if(!e)throw t+(new Error).stack}function i(e,t,n){this.start=e,this.end=t,this.audio=n}e.FS_createPath("/","bnb_js",!0,!0),e.FS_createPath("/","bnb_shaders",!0,!0),e.FS_createPath("/bnb_shaders","bnb",!0,!0),e.FS_createPath("/bnb_shaders/bnb","lib",!0,!0),e.FS_createPath("/","frx",!0,!0),i.prototype={requests:{},open:function(t,n){this.name=n,this.requests[n]=this,e.addRunDependency("fp "+this.name)},send:function(){},onload:function(){var e=this.byteArray.subarray(this.start,this.end);this.finish(e)},finish:function(t){e.FS_createDataFile(this.name,null,t,!0,!0,!0),e.removeRunDependency("fp "+this.name),this.requests[this.name]=null}};for(var s=t.files,a=0;a<s.length;++a)new i(s[a].start,s[a].end,s[a].audio||0).open("GET",s[a].filename);function c(s){n(s,"Loading data file failed."),n(s.constructor.name===ArrayBuffer.name,"bad input to processPackageData");var o=new Uint8Array(s);i.prototype.byteArray=o;for(var r=t.files,a=0;a<r.length;++a)i.prototype.requests[r[a].filename].onload();e.removeRunDependency("datafile_BanubaSDK.data")}e.addRunDependency("datafile_BanubaSDK.data"),e.preloadResults||(e.preloadResults={}),e.preloadResults["BanubaSDK.data"]={fromCache:!1},r?(c(r),r=null):o=c}r||function(t,n,i,s){var a=new XMLHttpRequest;a.open("GET",t,!0),a.responseType="arraybuffer",a.onprogress=function(i){var s=t,o=n;if(i.total&&(o=i.total),i.loaded){a.addedTotal?e.dataFileDownloads[s].loaded=i.loaded:(a.addedTotal=!0,e.dataFileDownloads||(e.dataFileDownloads={}),e.dataFileDownloads[s]={loaded:i.loaded,total:o});var r=0,c=0,l=0;for(var d in e.dataFileDownloads){var u=e.dataFileDownloads[d];r+=u.total,c+=u.loaded,l++}r=Math.ceil(r*e.expectedDataFileDownloads/l),e.setStatus&&e.setStatus("Downloading data... ("+c+"/"+r+")")}else e.dataFileDownloads||e.setStatus&&e.setStatus("Downloading data...")},a.onerror=function(e){throw new Error("NetworkError for: "+t)},a.onload=function(e){if(!(200==a.status||304==a.status||206==a.status||0==a.status&&a.response))throw new Error(a.statusText+" : "+a.responseURL);!function(e){o?(o(e),o=null):r=e}(a.response)},a.send(null)}(i,s),e.calledRun?a():(e.preRun||(e.preRun=[]),e.preRun.push(a))}({files:[{filename:"/bnb_js/.empty",start:0,end:20},{filename:"/bnb_js/background.js",start:20,end:3353},{filename:"/bnb_js/console.js",start:3353,end:3913},{filename:"/bnb_js/global.js",start:3913,end:4294},{filename:"/bnb_js/legacy.js",start:4294,end:8571},{filename:"/bnb_js/light_streaks.js",start:8571,end:18278},{filename:"/bnb_js/timers.js",start:18278,end:21597},{filename:"/bnb_shaders/.empty",start:21597,end:21616},{filename:"/bnb_shaders/bnb/anim_transform.glsl",start:21616,end:21779},{filename:"/bnb_shaders/bnb/color_spaces.glsl",start:21779,end:26078},{filename:"/bnb_shaders/bnb/decode_int1010102.glsl",start:26078,end:26767},{filename:"/bnb_shaders/bnb/get_bone.glsl",start:26767,end:27189},{filename:"/bnb_shaders/bnb/get_transform.glsl",start:27189,end:27828},{filename:"/bnb_shaders/bnb/glsl.frag",start:27828,end:28390},{filename:"/bnb_shaders/bnb/glsl.vert",start:28390,end:29171},{filename:"/bnb_shaders/bnb/lib/apply_light_streaks.frag",start:29171,end:29483},{filename:"/bnb_shaders/bnb/lib/apply_light_streaks.vert",start:29483,end:29732},{filename:"/bnb_shaders/bnb/lib/auto_morph.frag",start:29732,end:29845},{filename:"/bnb_shaders/bnb/lib/auto_morph.vert",start:29845,end:30457},{filename:"/bnb_shaders/bnb/lib/auto_morph_fisheye.frag",start:30457,end:30570},{filename:"/bnb_shaders/bnb/lib/auto_morph_fisheye.vert",start:30570,end:31077},{filename:"/bnb_shaders/bnb/lib/beauty_morph.frag",start:31077,end:31191},{filename:"/bnb_shaders/bnb/lib/beauty_morph.vert",start:31191,end:32340},{filename:"/bnb_shaders/bnb/lib/bg_blur_downscale.frag",start:32340,end:33214},{filename:"/bnb_shaders/bnb/lib/bg_blur_downscale.vert",start:33214,end:33413},{filename:"/bnb_shaders/bnb/lib/bg_blur_upscale.frag",start:33413,end:34408},{filename:"/bnb_shaders/bnb/lib/bg_blur_upscale.vert",start:34408,end:34743},{filename:"/bnb_shaders/bnb/lib/bg_blur_upscale_apply.frag",start:34743,end:35948},{filename:"/bnb_shaders/bnb/lib/camera.frag",start:35948,end:36529},{filename:"/bnb_shaders/bnb/lib/camera.vert",start:36529,end:36848},{filename:"/bnb_shaders/bnb/lib/camera_bgmask.frag",start:36848,end:37607},{filename:"/bnb_shaders/bnb/lib/camera_bgmask.vert",start:37607,end:37996},{filename:"/bnb_shaders/bnb/lib/copy_pixels.frag",start:37996,end:38170},{filename:"/bnb_shaders/bnb/lib/copy_pixels.vert",start:38170,end:38419},{filename:"/bnb_shaders/bnb/lib/filter_light_streaks_0.frag",start:38419,end:39405},{filename:"/bnb_shaders/bnb/lib/filter_light_streaks_0.vert",start:39405,end:39990},{filename:"/bnb_shaders/bnb/lib/filter_light_streaks_1.frag",start:39990,end:40976},{filename:"/bnb_shaders/bnb/lib/filter_light_streaks_1.vert",start:40976,end:41561},{filename:"/bnb_shaders/bnb/lib/filter_light_streaks_2.frag",start:41561,end:42547},{filename:"/bnb_shaders/bnb/lib/filter_light_streaks_2.vert",start:42547,end:43132},{filename:"/bnb_shaders/bnb/lib/filter_light_streaks_3.frag",start:43132,end:44118},{filename:"/bnb_shaders/bnb/lib/filter_light_streaks_3.vert",start:44118,end:44703},{filename:"/bnb_shaders/bnb/lib/gltf.frag",start:44703,end:46993},{filename:"/bnb_shaders/bnb/lib/gltf.vert",start:46993,end:48242},{filename:"/bnb_shaders/bnb/lib/init_light_streaks.frag",start:48242,end:48572},{filename:"/bnb_shaders/bnb/lib/init_light_streaks.vert",start:48572,end:48821},{filename:"/bnb_shaders/bnb/lib/mesh_morph.frag",start:48821,end:48935},{filename:"/bnb_shaders/bnb/lib/mesh_morph.vert",start:48935,end:50818},{filename:"/bnb_shaders/bnb/lib/morph_apply.frag",start:50818,end:51161},{filename:"/bnb_shaders/bnb/lib/morph_apply.vert",start:51161,end:53343},{filename:"/bnb_shaders/bnb/lib/morph_blur.frag",start:53343,end:54666},{filename:"/bnb_shaders/bnb/lib/morph_blur.vert",start:54666,end:54992},{filename:"/bnb_shaders/bnb/lib/retouch.frag",start:54992,end:58697},{filename:"/bnb_shaders/bnb/lib/retouch.vert",start:58697,end:59255},{filename:"/bnb_shaders/bnb/lib/static_pos.frag",start:59255,end:59366},{filename:"/bnb_shaders/bnb/lib/static_pos.vert",start:59366,end:59632},{filename:"/bnb_shaders/bnb/lib/uv_morph.frag",start:59632,end:59745},{filename:"/bnb_shaders/bnb/lib/uv_morph.vert",start:59745,end:60252},{filename:"/bnb_shaders/bnb/lib/vbg.frag",start:60252,end:61008},{filename:"/bnb_shaders/bnb/lib/vbg.vert",start:61008,end:62048},{filename:"/bnb_shaders/bnb/lut.glsl",start:62048,end:66577},{filename:"/bnb_shaders/bnb/math.glsl",start:66577,end:66577},{filename:"/bnb_shaders/bnb/matrix_operations.glsl",start:66577,end:67061},{filename:"/bnb_shaders/bnb/morph_transform.glsl",start:67061,end:68119},{filename:"/bnb_shaders/bnb/quat_rotation.glsl",start:68119,end:69513},{filename:"/bnb_shaders/bnb/sample_camera.glsl",start:69513,end:70450},{filename:"/bnb_shaders/bnb/samplers_declaration.glsl",start:70450,end:73194},{filename:"/bnb_shaders/bnb/texture_bicubic.glsl",start:73194,end:74552},{filename:"/bnb_shaders/bnb/textures_lookup.glsl",start:74552,end:75752},{filename:"/bnb_shaders/bnb/transform_uv.glsl",start:75752,end:78189},{filename:"/bnb_shaders/bnb/version.glsl",start:78189,end:78411},{filename:"/frx/frx.js",start:78411,end:80933},{filename:"/resources-versions.txt",start:80933,end:83383},{filename:"/watermark.png",start:83383,end:85869},{filename:"/watermark_blurred.png",start:85869,end:108302}],remote_package_size:108302});var i,s,o=Bs({},e),r="./this.program",a=(e,t)=>{throw t},c="";"undefined"!=typeof document&&document.currentScript&&(c=document.currentScript.src),Fs&&(c=Fs),c=0!==c.indexOf("blob:")?c.substr(0,c.replace(/[?#].*/,"").lastIndexOf("/")+1):"",i=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},s=(e,t,n)=>{var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=()=>{200==i.status||0==i.status&&i.response?t(i.response):n()},i.onerror=n,i.send(null)};var l=e.print||console.log.bind(console),d=e.printErr||console.warn.bind(console);Bs(e,o),o=null,e.thisProgram&&(r=e.thisProgram),e.quit&&(a=e.quit);var u;e.wasmBinary&&(u=e.wasmBinary);var h=e.noExitRuntime||!0;"object"!=typeof WebAssembly&&G("no native wasm support detected");var p,m,w=!1;function g(e,t){e||G(t)}var f,v,b,_,y,C,S,E,x,k="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function M(e,t,n){for(var i=t+n,s=t;e[s]&&!(s>=i);)++s;if(s-t>16&&e.buffer&&k)return k.decode(e.subarray(t,s));for(var o="";t<s;){var r=e[t++];if(128&r){var a=63&e[t++];if(192!=(224&r)){var c=63&e[t++];if((r=224==(240&r)?(15&r)<<12|a<<6|c:(7&r)<<18|a<<12|c<<6|63&e[t++])<65536)o+=String.fromCharCode(r);else{var l=r-65536;o+=String.fromCharCode(55296|l>>10,56320|1023&l)}}else o+=String.fromCharCode((31&r)<<6|a)}else o+=String.fromCharCode(r)}return o}function T(e,t){return e?M(b,e,t):""}function I(e,t,n,i){if(!(i>0))return 0;for(var s=n,o=n+i-1,r=0;r<e.length;++r){var a=e.charCodeAt(r);if(a>=55296&&a<=57343&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++r)),a<=127){if(n>=o)break;t[n++]=a}else if(a<=2047){if(n+1>=o)break;t[n++]=192|a>>6,t[n++]=128|63&a}else if(a<=65535){if(n+2>=o)break;t[n++]=224|a>>12,t[n++]=128|a>>6&63,t[n++]=128|63&a}else{if(n+3>=o)break;t[n++]=240|a>>18,t[n++]=128|a>>12&63,t[n++]=128|a>>6&63,t[n++]=128|63&a}}return t[n]=0,n-s}function R(e,t,n){return I(e,b,t,n)}function A(e){for(var t=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i<=127?t++:i<=2047?t+=2:i>=55296&&i<=57343?(t+=4,++n):t+=3}return t}function $(t){f=t,e.HEAP8=v=new Int8Array(t),e.HEAP16=_=new Int16Array(t),e.HEAP32=C=new Int32Array(t),e.HEAPU8=b=new Uint8Array(t),e.HEAPU16=y=new Uint16Array(t),e.HEAPU32=S=new Uint32Array(t),e.HEAPF32=E=new Float32Array(t),e.HEAPF64=x=new Float64Array(t)}var L,P=[],D=[],N=[];function O(e){P.unshift(e)}function B(e){N.unshift(e)}var F=0,U=null;function j(t){F++,e.monitorRunDependencies&&e.monitorRunDependencies(F)}function V(t){if(F--,e.monitorRunDependencies&&e.monitorRunDependencies(F),0==F&&U){var n=U;U=null,n()}}function G(t){e.onAbort&&e.onAbort(t),d(t="Aborted("+t+")"),w=!0,m=1,t+=". Build with -sASSERTIONS for more info.";var i=new WebAssembly.RuntimeError(t);throw n(i),i}var q,H,z;function W(e){return e.startsWith("data:application/octet-stream;base64,")}function J(e){try{if(e==q&&u)return new Uint8Array(u);throw"both async and sync fetching of the wasm failed"}catch(e){G(e)}}function Y(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function K(t){for(;t.length>0;)t.shift()(e)}function X(e){this.excPtr=e,this.ptr=e-24,this.set_type=function(e){S[this.ptr+4>>2]=e},this.get_type=function(){return S[this.ptr+4>>2]},this.set_destructor=function(e){S[this.ptr+8>>2]=e},this.get_destructor=function(){return S[this.ptr+8>>2]},this.set_refcount=function(e){C[this.ptr>>2]=e},this.set_caught=function(e){e=e?1:0,v[this.ptr+12>>0]=e},this.get_caught=function(){return 0!=v[this.ptr+12>>0]},this.set_rethrown=function(e){e=e?1:0,v[this.ptr+13>>0]=e},this.get_rethrown=function(){return 0!=v[this.ptr+13>>0]},this.init=function(e,t){this.set_adjusted_ptr(0),this.set_type(e),this.set_destructor(t),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var e=C[this.ptr>>2];C[this.ptr>>2]=e+1},this.release_ref=function(){var e=C[this.ptr>>2];return C[this.ptr>>2]=e-1,1===e},this.set_adjusted_ptr=function(e){S[this.ptr+16>>2]=e},this.get_adjusted_ptr=function(){return S[this.ptr+16>>2]},this.get_exception_ptr=function(){if(Mn(this.get_type()))return S[this.excPtr>>2];var e=this.get_adjusted_ptr();return 0!==e?e:this.excPtr}}W(q="BanubaSDK.wasm")||(q=function(t){return e.locateFile?e.locateFile(t,c):c+t}(q));var Z={isAbs:e=>"/"===e.charAt(0),splitPath:e=>/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1),normalizeArray:(e,t)=>{for(var n=0,i=e.length-1;i>=0;i--){var s=e[i];"."===s?e.splice(i,1):".."===s?(e.splice(i,1),n++):n&&(e.splice(i,1),n--)}if(t)for(;n;n--)e.unshift("..");return e},normalize:e=>{var t=Z.isAbs(e),n="/"===e.substr(-1);return e=Z.normalizeArray(e.split("/").filter((e=>!!e)),!t).join("/"),!e&&!t&&(e="."),e&&n&&(e+="/"),(t?"/":"")+e},dirname:e=>{var t=Z.splitPath(e),n=t[0],i=t[1];return n||i?(i&&(i=i.substr(0,i.length-1)),n+i):"."},basename:e=>{if("/"===e)return"/";var t=(e=(e=Z.normalize(e)).replace(/\/$/,"")).lastIndexOf("/");return-1===t?e:e.substr(t+1)},join:function(){var e=Array.prototype.slice.call(arguments);return Z.normalize(e.join("/"))},join2:(e,t)=>Z.normalize(e+"/"+t)};function Q(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var e=new Uint8Array(1);return()=>(crypto.getRandomValues(e),e[0])}return()=>G("randomDevice")}var ee={resolve:function(){for(var e="",t=!1,n=arguments.length-1;n>=-1&&!t;n--){var i=n>=0?arguments[n]:re.cwd();if("string"!=typeof i)throw new TypeError("Arguments to path.resolve must be strings");if(!i)return"";e=i+"/"+e,t=Z.isAbs(i)}return e=Z.normalizeArray(e.split("/").filter((e=>!!e)),!t).join("/"),(t?"/":"")+e||"."},relative:(e,t)=>{function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=ee.resolve(e).substr(1),t=ee.resolve(t).substr(1);for(var i=n(e.split("/")),s=n(t.split("/")),o=Math.min(i.length,s.length),r=o,a=0;a<o;a++)if(i[a]!==s[a]){r=a;break}var c=[];for(a=r;a<i.length;a++)c.push("..");return(c=c.concat(s.slice(r))).join("/")}};function te(e,t,n){var i=n>0?n:A(e)+1,s=new Array(i),o=I(e,s,0,s.length);return t&&(s.length=o),s}var ne={ttys:[],init:function(){},shutdown:function(){},register:function(e,t){ne.ttys[e]={input:[],output:[],ops:t},re.registerDevice(e,ne.stream_ops)},stream_ops:{open:function(e){var t=ne.ttys[e.node.rdev];if(!t)throw new re.ErrnoError(43);e.tty=t,e.seekable=!1},close:function(e){e.tty.ops.fsync(e.tty)},fsync:function(e){e.tty.ops.fsync(e.tty)},read:function(e,t,n,i,s){if(!e.tty||!e.tty.ops.get_char)throw new re.ErrnoError(60);for(var o=0,r=0;r<i;r++){var a;try{a=e.tty.ops.get_char(e.tty)}catch{throw new re.ErrnoError(29)}if(void 0===a&&0===o)throw new re.ErrnoError(6);if(null==a)break;o++,t[n+r]=a}return o&&(e.node.timestamp=Date.now()),o},write:function(e,t,n,i,s){if(!e.tty||!e.tty.ops.put_char)throw new re.ErrnoError(60);try{for(var o=0;o<i;o++)e.tty.ops.put_char(e.tty,t[n+o])}catch{throw new re.ErrnoError(29)}return i&&(e.node.timestamp=Date.now()),o}},default_tty_ops:{get_char:function(e){if(!e.input.length){var t=null;if("undefined"!=typeof window&&"function"==typeof window.prompt?null!==(t=window.prompt("Input: "))&&(t+="\n"):"function"==typeof readline&&null!==(t=readline())&&(t+="\n"),!t)return null;e.input=te(t,!0)}return e.input.shift()},put_char:function(e,t){null===t||10===t?(l(M(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},fsync:function(e){e.output&&e.output.length>0&&(l(M(e.output,0)),e.output=[])}},default_tty1_ops:{put_char:function(e,t){null===t||10===t?(d(M(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},fsync:function(e){e.output&&e.output.length>0&&(d(M(e.output,0)),e.output=[])}}};function ie(e,t){return b.fill(0,e,e+t),e}function se(e){e=function(e,t){return 65536*Math.ceil(e/65536)}(e);var t=xn(65536,e);return t?ie(t,e):0}var oe={ops_table:null,mount:function(e){return oe.createNode(null,"/",16895,0)},createNode:function(e,t,n,i){if(re.isBlkdev(n)||re.isFIFO(n))throw new re.ErrnoError(63);oe.ops_table||(oe.ops_table={dir:{node:{getattr:oe.node_ops.getattr,setattr:oe.node_ops.setattr,lookup:oe.node_ops.lookup,mknod:oe.node_ops.mknod,rename:oe.node_ops.rename,unlink:oe.node_ops.unlink,rmdir:oe.node_ops.rmdir,readdir:oe.node_ops.readdir,symlink:oe.node_ops.symlink},stream:{llseek:oe.stream_ops.llseek}},file:{node:{getattr:oe.node_ops.getattr,setattr:oe.node_ops.setattr},stream:{llseek:oe.stream_ops.llseek,read:oe.stream_ops.read,write:oe.stream_ops.write,allocate:oe.stream_ops.allocate,mmap:oe.stream_ops.mmap,msync:oe.stream_ops.msync}},link:{node:{getattr:oe.node_ops.getattr,setattr:oe.node_ops.setattr,readlink:oe.node_ops.readlink},stream:{}},chrdev:{node:{getattr:oe.node_ops.getattr,setattr:oe.node_ops.setattr},stream:re.chrdev_stream_ops}});var s=re.createNode(e,t,n,i);return re.isDir(s.mode)?(s.node_ops=oe.ops_table.dir.node,s.stream_ops=oe.ops_table.dir.stream,s.contents={}):re.isFile(s.mode)?(s.node_ops=oe.ops_table.file.node,s.stream_ops=oe.ops_table.file.stream,s.usedBytes=0,s.contents=null):re.isLink(s.mode)?(s.node_ops=oe.ops_table.link.node,s.stream_ops=oe.ops_table.link.stream):re.isChrdev(s.mode)&&(s.node_ops=oe.ops_table.chrdev.node,s.stream_ops=oe.ops_table.chrdev.stream),s.timestamp=Date.now(),e&&(e.contents[t]=s,e.timestamp=s.timestamp),s},getFileDataAsTypedArray:function(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0)},expandFileStorage:function(e,t){var n=e.contents?e.contents.length:0;if(!(n>=t)){t=Math.max(t,n*(n<1048576?2:1.125)>>>0),0!=n&&(t=Math.max(t,256));var i=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(i.subarray(0,e.usedBytes),0)}},resizeFileStorage:function(e,t){if(e.usedBytes!=t)if(0==t)e.contents=null,e.usedBytes=0;else{var n=e.contents;e.contents=new Uint8Array(t),n&&e.contents.set(n.subarray(0,Math.min(t,e.usedBytes))),e.usedBytes=t}},node_ops:{getattr:function(e){var t={};return t.dev=re.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,re.isDir(e.mode)?t.size=4096:re.isFile(e.mode)?t.size=e.usedBytes:re.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr:function(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp),void 0!==t.size&&oe.resizeFileStorage(e,t.size)},lookup:function(e,t){throw re.genericErrors[44]},mknod:function(e,t,n,i){return oe.createNode(e,t,n,i)},rename:function(e,t,n){if(re.isDir(e.mode)){var i;try{i=re.lookupNode(t,n)}catch{}if(i)for(var s in i.contents)throw new re.ErrnoError(55)}delete e.parent.contents[e.name],e.parent.timestamp=Date.now(),e.name=n,t.contents[n]=e,t.timestamp=e.parent.timestamp,e.parent=t},unlink:function(e,t){delete e.contents[t],e.timestamp=Date.now()},rmdir:function(e,t){var n=re.lookupNode(e,t);for(var i in n.contents)throw new re.ErrnoError(55);delete e.contents[t],e.timestamp=Date.now()},readdir:function(e){var t=[".",".."];for(var n in e.contents)!e.contents.hasOwnProperty(n)||t.push(n);return t},symlink:function(e,t,n){var i=oe.createNode(e,t,41471,0);return i.link=n,i},readlink:function(e){if(!re.isLink(e.mode))throw new re.ErrnoError(28);return e.link}},stream_ops:{read:function(e,t,n,i,s){var o=e.node.contents;if(s>=e.node.usedBytes)return 0;var r=Math.min(e.node.usedBytes-s,i);if(r>8&&o.subarray)t.set(o.subarray(s,s+r),n);else for(var a=0;a<r;a++)t[n+a]=o[s+a];return r},write:function(e,t,n,i,s,o){if(t.buffer===v.buffer&&(o=!1),!i)return 0;var r=e.node;if(r.timestamp=Date.now(),t.subarray&&(!r.contents||r.contents.subarray)){if(o)return r.contents=t.subarray(n,n+i),r.usedBytes=i,i;if(0===r.usedBytes&&0===s)return r.contents=t.slice(n,n+i),r.usedBytes=i,i;if(s+i<=r.usedBytes)return r.contents.set(t.subarray(n,n+i),s),i}if(oe.expandFileStorage(r,s+i),r.contents.subarray&&t.subarray)r.contents.set(t.subarray(n,n+i),s);else for(var a=0;a<i;a++)r.contents[s+a]=t[n+a];return r.usedBytes=Math.max(r.usedBytes,s+i),i},llseek:function(e,t,n){var i=t;if(1===n?i+=e.position:2===n&&re.isFile(e.node.mode)&&(i+=e.node.usedBytes),i<0)throw new re.ErrnoError(28);return i},allocate:function(e,t,n){oe.expandFileStorage(e.node,t+n),e.node.usedBytes=Math.max(e.node.usedBytes,t+n)},mmap:function(e,t,n,i,s){if(!re.isFile(e.node.mode))throw new re.ErrnoError(43);var o,r,a=e.node.contents;if(2&s||a.buffer!==f){if((n>0||n+t<a.length)&&(a=a.subarray?a.subarray(n,n+t):Array.prototype.slice.call(a,n,n+t)),r=!0,!(o=se(t)))throw new re.ErrnoError(48);v.set(a,o)}else r=!1,o=a.byteOffset;return{ptr:o,allocated:r}},msync:function(e,t,n,i,s){return oe.stream_ops.write(e,t,0,i,n,!1),0}}},re={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath:(e,t={})=>{if(!(e=ee.resolve(e)))return{path:"",node:null};if((t=Bs({follow_mount:!0,recurse_count:0},t)).recurse_count>8)throw new re.ErrnoError(32);for(var n=e.split("/").filter((e=>!!e)),i=re.root,s="/",o=0;o<n.length;o++){var r=o===n.length-1;if(r&&t.parent)break;if(i=re.lookupNode(i,n[o]),s=Z.join2(s,n[o]),re.isMountpoint(i)&&(!r||r&&t.follow_mount)&&(i=i.mounted.root),!r||t.follow)for(var a=0;re.isLink(i.mode);){var c=re.readlink(s);if(s=ee.resolve(Z.dirname(s),c),i=re.lookupPath(s,{recurse_count:t.recurse_count+1}).node,a++>40)throw new re.ErrnoError(32)}}return{path:s,node:i}},getPath:e=>{for(var t;;){if(re.isRoot(e)){var n=e.mount.mountpoint;return t?"/"!==n[n.length-1]?n+"/"+t:n+t:n}t=t?e.name+"/"+t:e.name,e=e.parent}},hashName:(e,t)=>{for(var n=0,i=0;i<t.length;i++)n=(n<<5)-n+t.charCodeAt(i)|0;return(e+n>>>0)%re.nameTable.length},hashAddNode:e=>{var t=re.hashName(e.parent.id,e.name);e.name_next=re.nameTable[t],re.nameTable[t]=e},hashRemoveNode:e=>{var t=re.hashName(e.parent.id,e.name);if(re.nameTable[t]===e)re.nameTable[t]=e.name_next;else for(var n=re.nameTable[t];n;){if(n.name_next===e){n.name_next=e.name_next;break}n=n.name_next}},lookupNode:(e,t)=>{var n=re.mayLookup(e);if(n)throw new re.ErrnoError(n,e);for(var i=re.hashName(e.id,t),s=re.nameTable[i];s;s=s.name_next){var o=s.name;if(s.parent.id===e.id&&o===t)return s}return re.lookup(e,t)},createNode:(e,t,n,i)=>{var s=new re.FSNode(e,t,n,i);return re.hashAddNode(s),s},destroyNode:e=>{re.hashRemoveNode(e)},isRoot:e=>e===e.parent,isMountpoint:e=>!!e.mounted,isFile:e=>32768==(61440&e),isDir:e=>16384==(61440&e),isLink:e=>40960==(61440&e),isChrdev:e=>8192==(61440&e),isBlkdev:e=>24576==(61440&e),isFIFO:e=>4096==(61440&e),isSocket:e=>49152==(49152&e),flagModes:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},modeStringToFlags:e=>{var t=re.flagModes[e];if(void 0===t)throw new Error("Unknown file open mode: "+e);return t},flagsToPermissionString:e=>{var t=["r","w","rw"][3&e];return 512&e&&(t+="w"),t},nodePermissions:(e,t)=>re.ignorePermissions?0:t.includes("r")&&!(292&e.mode)||t.includes("w")&&!(146&e.mode)||t.includes("x")&&!(73&e.mode)?2:0,mayLookup:e=>re.nodePermissions(e,"x")||(e.node_ops.lookup?0:2),mayCreate:(e,t)=>{try{return re.lookupNode(e,t),20}catch{}return re.nodePermissions(e,"wx")},mayDelete:(e,t,n)=>{var i;try{i=re.lookupNode(e,t)}catch(e){return e.errno}var s=re.nodePermissions(e,"wx");if(s)return s;if(n){if(!re.isDir(i.mode))return 54;if(re.isRoot(i)||re.getPath(i)===re.cwd())return 10}else if(re.isDir(i.mode))return 31;return 0},mayOpen:(e,t)=>e?re.isLink(e.mode)?32:re.isDir(e.mode)&&("r"!==re.flagsToPermissionString(t)||512&t)?31:re.nodePermissions(e,re.flagsToPermissionString(t)):44,MAX_OPEN_FDS:4096,nextfd:(e=0,t=re.MAX_OPEN_FDS)=>{for(var n=e;n<=t;n++)if(!re.streams[n])return n;throw new re.ErrnoError(33)},getStream:e=>re.streams[e],createStream:(e,t,n)=>{re.FSStream||(re.FSStream=function(){this.shared={}},re.FSStream.prototype={},Object.defineProperties(re.FSStream.prototype,{object:{get:function(){return this.node},set:function(e){this.node=e}},isRead:{get:function(){return 1!=(2097155&this.flags)}},isWrite:{get:function(){return 0!=(2097155&this.flags)}},isAppend:{get:function(){return 1024&this.flags}},flags:{get:function(){return this.shared.flags},set:function(e){this.shared.flags=e}},position:{get:function(){return this.shared.position},set:function(e){this.shared.position=e}}})),e=Bs(new re.FSStream,e);var i=re.nextfd(t,n);return e.fd=i,re.streams[i]=e,e},closeStream:e=>{re.streams[e]=null},chrdev_stream_ops:{open:e=>{var t=re.getDevice(e.node.rdev);e.stream_ops=t.stream_ops,e.stream_ops.open&&e.stream_ops.open(e)},llseek:()=>{throw new re.ErrnoError(70)}},major:e=>e>>8,minor:e=>255&e,makedev:(e,t)=>e<<8|t,registerDevice:(e,t)=>{re.devices[e]={stream_ops:t}},getDevice:e=>re.devices[e],getMounts:e=>{for(var t=[],n=[e];n.length;){var i=n.pop();t.push(i),n.push.apply(n,i.mounts)}return t},syncfs:(e,t)=>{"function"==typeof e&&(t=e,e=!1),re.syncFSRequests++,re.syncFSRequests>1&&d("warning: "+re.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var n=re.getMounts(re.root.mount),i=0;function s(e){return re.syncFSRequests--,t(e)}function o(e){if(e)return o.errored?void 0:(o.errored=!0,s(e));++i>=n.length&&s(null)}n.forEach((t=>{if(!t.type.syncfs)return o(null);t.type.syncfs(t,e,o)}))},mount:(e,t,n)=>{var i,s="/"===n,o=!n;if(s&&re.root)throw new re.ErrnoError(10);if(!s&&!o){var r=re.lookupPath(n,{follow_mount:!1});if(n=r.path,i=r.node,re.isMountpoint(i))throw new re.ErrnoError(10);if(!re.isDir(i.mode))throw new re.ErrnoError(54)}var a={type:e,opts:t,mountpoint:n,mounts:[]},c=e.mount(a);return c.mount=a,a.root=c,s?re.root=c:i&&(i.mounted=a,i.mount&&i.mount.mounts.push(a)),c},unmount:e=>{var t=re.lookupPath(e,{follow_mount:!1});if(!re.isMountpoint(t.node))throw new re.ErrnoError(28);var n=t.node,i=n.mounted,s=re.getMounts(i);Object.keys(re.nameTable).forEach((e=>{for(var t=re.nameTable[e];t;){var n=t.name_next;s.includes(t.mount)&&re.destroyNode(t),t=n}})),n.mounted=null;var o=n.mount.mounts.indexOf(i);n.mount.mounts.splice(o,1)},lookup:(e,t)=>e.node_ops.lookup(e,t),mknod:(e,t,n)=>{var i=re.lookupPath(e,{parent:!0}).node,s=Z.basename(e);if(!s||"."===s||".."===s)throw new re.ErrnoError(28);var o=re.mayCreate(i,s);if(o)throw new re.ErrnoError(o);if(!i.node_ops.mknod)throw new re.ErrnoError(63);return i.node_ops.mknod(i,s,t,n)},create:(e,t)=>(t=void 0!==t?t:438,t&=4095,t|=32768,re.mknod(e,t,0)),mkdir:(e,t)=>(t=void 0!==t?t:511,t&=1023,t|=16384,re.mknod(e,t,0)),mkdirTree:(e,t)=>{for(var n=e.split("/"),i="",s=0;s<n.length;++s)if(n[s]){i+="/"+n[s];try{re.mkdir(i,t)}catch(e){if(20!=e.errno)throw e}}},mkdev:(e,t,n)=>(void 0===n&&(n=t,t=438),t|=8192,re.mknod(e,t,n)),symlink:(e,t)=>{if(!ee.resolve(e))throw new re.ErrnoError(44);var n=re.lookupPath(t,{parent:!0}).node;if(!n)throw new re.ErrnoError(44);var i=Z.basename(t),s=re.mayCreate(n,i);if(s)throw new re.ErrnoError(s);if(!n.node_ops.symlink)throw new re.ErrnoError(63);return n.node_ops.symlink(n,i,e)},rename:(e,t)=>{var n,i,s=Z.dirname(e),o=Z.dirname(t),r=Z.basename(e),a=Z.basename(t);if(n=re.lookupPath(e,{parent:!0}).node,i=re.lookupPath(t,{parent:!0}).node,!n||!i)throw new re.ErrnoError(44);if(n.mount!==i.mount)throw new re.ErrnoError(75);var c,l=re.lookupNode(n,r),d=ee.relative(e,o);if("."!==d.charAt(0))throw new re.ErrnoError(28);if("."!==(d=ee.relative(t,s)).charAt(0))throw new re.ErrnoError(55);try{c=re.lookupNode(i,a)}catch{}if(l!==c){var u=re.isDir(l.mode),h=re.mayDelete(n,r,u);if(h)throw new re.ErrnoError(h);if(h=c?re.mayDelete(i,a,u):re.mayCreate(i,a))throw new re.ErrnoError(h);if(!n.node_ops.rename)throw new re.ErrnoError(63);if(re.isMountpoint(l)||c&&re.isMountpoint(c))throw new re.ErrnoError(10);if(i!==n&&(h=re.nodePermissions(n,"w")))throw new re.ErrnoError(h);re.hashRemoveNode(l);try{n.node_ops.rename(l,i,a)}catch(e){throw e}finally{re.hashAddNode(l)}}},rmdir:e=>{var t=re.lookupPath(e,{parent:!0}).node,n=Z.basename(e),i=re.lookupNode(t,n),s=re.mayDelete(t,n,!0);if(s)throw new re.ErrnoError(s);if(!t.node_ops.rmdir)throw new re.ErrnoError(63);if(re.isMountpoint(i))throw new re.ErrnoError(10);t.node_ops.rmdir(t,n),re.destroyNode(i)},readdir:e=>{var t=re.lookupPath(e,{follow:!0}).node;if(!t.node_ops.readdir)throw new re.ErrnoError(54);return t.node_ops.readdir(t)},unlink:e=>{var t=re.lookupPath(e,{parent:!0}).node;if(!t)throw new re.ErrnoError(44);var n=Z.basename(e),i=re.lookupNode(t,n),s=re.mayDelete(t,n,!1);if(s)throw new re.ErrnoError(s);if(!t.node_ops.unlink)throw new re.ErrnoError(63);if(re.isMountpoint(i))throw new re.ErrnoError(10);t.node_ops.unlink(t,n),re.destroyNode(i)},readlink:e=>{var t=re.lookupPath(e).node;if(!t)throw new re.ErrnoError(44);if(!t.node_ops.readlink)throw new re.ErrnoError(28);return ee.resolve(re.getPath(t.parent),t.node_ops.readlink(t))},stat:(e,t)=>{var n=re.lookupPath(e,{follow:!t}).node;if(!n)throw new re.ErrnoError(44);if(!n.node_ops.getattr)throw new re.ErrnoError(63);return n.node_ops.getattr(n)},lstat:e=>re.stat(e,!0),chmod:(e,t,n)=>{var i;if(!(i="string"==typeof e?re.lookupPath(e,{follow:!n}).node:e).node_ops.setattr)throw new re.ErrnoError(63);i.node_ops.setattr(i,{mode:4095&t|-4096&i.mode,timestamp:Date.now()})},lchmod:(e,t)=>{re.chmod(e,t,!0)},fchmod:(e,t)=>{var n=re.getStream(e);if(!n)throw new re.ErrnoError(8);re.chmod(n.node,t)},chown:(e,t,n,i)=>{var s;if(!(s="string"==typeof e?re.lookupPath(e,{follow:!i}).node:e).node_ops.setattr)throw new re.ErrnoError(63);s.node_ops.setattr(s,{timestamp:Date.now()})},lchown:(e,t,n)=>{re.chown(e,t,n,!0)},fchown:(e,t,n)=>{var i=re.getStream(e);if(!i)throw new re.ErrnoError(8);re.chown(i.node,t,n)},truncate:(e,t)=>{if(t<0)throw new re.ErrnoError(28);var n;if(!(n="string"==typeof e?re.lookupPath(e,{follow:!0}).node:e).node_ops.setattr)throw new re.ErrnoError(63);if(re.isDir(n.mode))throw new re.ErrnoError(31);if(!re.isFile(n.mode))throw new re.ErrnoError(28);var i=re.nodePermissions(n,"w");if(i)throw new re.ErrnoError(i);n.node_ops.setattr(n,{size:t,timestamp:Date.now()})},ftruncate:(e,t)=>{var n=re.getStream(e);if(!n)throw new re.ErrnoError(8);if(0==(2097155&n.flags))throw new re.ErrnoError(28);re.truncate(n.node,t)},utime:(e,t,n)=>{var i=re.lookupPath(e,{follow:!0}).node;i.node_ops.setattr(i,{timestamp:Math.max(t,n)})},open:(t,n,i)=>{if(""===t)throw new re.ErrnoError(44);var s;if(i=void 0===i?438:i,i=64&(n="string"==typeof n?re.modeStringToFlags(n):n)?4095&i|32768:0,"object"==typeof t)s=t;else{t=Z.normalize(t);try{s=re.lookupPath(t,{follow:!(131072&n)}).node}catch{}}var o=!1;if(64&n)if(s){if(128&n)throw new re.ErrnoError(20)}else s=re.mknod(t,i,0),o=!0;if(!s)throw new re.ErrnoError(44);if(re.isChrdev(s.mode)&&(n&=-513),65536&n&&!re.isDir(s.mode))throw new re.ErrnoError(54);if(!o){var r=re.mayOpen(s,n);if(r)throw new re.ErrnoError(r)}512&n&&!o&&re.truncate(s,0),n&=-131713;var a=re.createStream({node:s,path:re.getPath(s),flags:n,seekable:!0,position:0,stream_ops:s.stream_ops,ungotten:[],error:!1});return a.stream_ops.open&&a.stream_ops.open(a),e.logReadFiles&&!(1&n)&&(re.readFiles||(re.readFiles={}),t in re.readFiles||(re.readFiles[t]=1)),a},close:e=>{if(re.isClosed(e))throw new re.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(e){throw e}finally{re.closeStream(e.fd)}e.fd=null},isClosed:e=>null===e.fd,llseek:(e,t,n)=>{if(re.isClosed(e))throw new re.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new re.ErrnoError(70);if(0!=n&&1!=n&&2!=n)throw new re.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,n),e.ungotten=[],e.position},read:(e,t,n,i,s)=>{if(i<0||s<0)throw new re.ErrnoError(28);if(re.isClosed(e))throw new re.ErrnoError(8);if(1==(2097155&e.flags))throw new re.ErrnoError(8);if(re.isDir(e.node.mode))throw new re.ErrnoError(31);if(!e.stream_ops.read)throw new re.ErrnoError(28);var o=void 0!==s;if(o){if(!e.seekable)throw new re.ErrnoError(70)}else s=e.position;var r=e.stream_ops.read(e,t,n,i,s);return o||(e.position+=r),r},write:(e,t,n,i,s,o)=>{if(i<0||s<0)throw new re.ErrnoError(28);if(re.isClosed(e))throw new re.ErrnoError(8);if(0==(2097155&e.flags))throw new re.ErrnoError(8);if(re.isDir(e.node.mode))throw new re.ErrnoError(31);if(!e.stream_ops.write)throw new re.ErrnoError(28);e.seekable&&1024&e.flags&&re.llseek(e,0,2);var r=void 0!==s;if(r){if(!e.seekable)throw new re.ErrnoError(70)}else s=e.position;var a=e.stream_ops.write(e,t,n,i,s,o);return r||(e.position+=a),a},allocate:(e,t,n)=>{if(re.isClosed(e))throw new re.ErrnoError(8);if(t<0||n<=0)throw new re.ErrnoError(28);if(0==(2097155&e.flags))throw new re.ErrnoError(8);if(!re.isFile(e.node.mode)&&!re.isDir(e.node.mode))throw new re.ErrnoError(43);if(!e.stream_ops.allocate)throw new re.ErrnoError(138);e.stream_ops.allocate(e,t,n)},mmap:(e,t,n,i,s)=>{if(0!=(2&i)&&0==(2&s)&&2!=(2097155&e.flags))throw new re.ErrnoError(2);if(1==(2097155&e.flags))throw new re.ErrnoError(2);if(!e.stream_ops.mmap)throw new re.ErrnoError(43);return e.stream_ops.mmap(e,t,n,i,s)},msync:(e,t,n,i,s)=>e.stream_ops.msync?e.stream_ops.msync(e,t,n,i,s):0,munmap:e=>0,ioctl:(e,t,n)=>{if(!e.stream_ops.ioctl)throw new re.ErrnoError(59);return e.stream_ops.ioctl(e,t,n)},readFile:(e,t={})=>{if(t.flags=t.flags||0,t.encoding=t.encoding||"binary","utf8"!==t.encoding&&"binary"!==t.encoding)throw new Error('Invalid encoding type "'+t.encoding+'"');var n,i=re.open(e,t.flags),s=re.stat(e).size,o=new Uint8Array(s);return re.read(i,o,0,s,0),"utf8"===t.encoding?n=M(o,0):"binary"===t.encoding&&(n=o),re.close(i),n},writeFile:(e,t,n={})=>{n.flags=n.flags||577;var i=re.open(e,n.flags,n.mode);if("string"==typeof t){var s=new Uint8Array(A(t)+1),o=I(t,s,0,s.length);re.write(i,s,0,o,void 0,n.canOwn)}else{if(!ArrayBuffer.isView(t))throw new Error("Unsupported data type");re.write(i,t,0,t.byteLength,void 0,n.canOwn)}re.close(i)},cwd:()=>re.currentPath,chdir:e=>{var t=re.lookupPath(e,{follow:!0});if(null===t.node)throw new re.ErrnoError(44);if(!re.isDir(t.node.mode))throw new re.ErrnoError(54);var n=re.nodePermissions(t.node,"x");if(n)throw new re.ErrnoError(n);re.currentPath=t.path},createDefaultDirectories:()=>{re.mkdir("/tmp"),re.mkdir("/home"),re.mkdir("/home/web_user")},createDefaultDevices:()=>{re.mkdir("/dev"),re.registerDevice(re.makedev(1,3),{read:()=>0,write:(e,t,n,i,s)=>i}),re.mkdev("/dev/null",re.makedev(1,3)),ne.register(re.makedev(5,0),ne.default_tty_ops),ne.register(re.makedev(6,0),ne.default_tty1_ops),re.mkdev("/dev/tty",re.makedev(5,0)),re.mkdev("/dev/tty1",re.makedev(6,0));var e=Q();re.createDevice("/dev","random",e),re.createDevice("/dev","urandom",e),re.mkdir("/dev/shm"),re.mkdir("/dev/shm/tmp")},createSpecialDirectories:()=>{re.mkdir("/proc");var e=re.mkdir("/proc/self");re.mkdir("/proc/self/fd"),re.mount({mount:()=>{var t=re.createNode(e,"fd",16895,73);return t.node_ops={lookup:(e,t)=>{var n=+t,i=re.getStream(n);if(!i)throw new re.ErrnoError(8);var s={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>i.path}};return s.parent=s,s}},t}},{},"/proc/self/fd")},createStandardStreams:()=>{e.stdin?re.createDevice("/dev","stdin",e.stdin):re.symlink("/dev/tty","/dev/stdin"),e.stdout?re.createDevice("/dev","stdout",null,e.stdout):re.symlink("/dev/tty","/dev/stdout"),e.stderr?re.createDevice("/dev","stderr",null,e.stderr):re.symlink("/dev/tty1","/dev/stderr"),re.open("/dev/stdin",0),re.open("/dev/stdout",1),re.open("/dev/stderr",1)},ensureErrnoError:()=>{re.ErrnoError||(re.ErrnoError=function(e,t){this.node=t,this.setErrno=function(e){this.errno=e},this.setErrno(e),this.message="FS error"},re.ErrnoError.prototype=new Error,re.ErrnoError.prototype.constructor=re.ErrnoError,[44].forEach((e=>{re.genericErrors[e]=new re.ErrnoError(e),re.genericErrors[e].stack="<generic error, no stack>"})))},staticInit:()=>{re.ensureErrnoError(),re.nameTable=new Array(4096),re.mount(oe,{},"/"),re.createDefaultDirectories(),re.createDefaultDevices(),re.createSpecialDirectories(),re.filesystems={MEMFS:oe}},init:(t,n,i)=>{re.init.initialized=!0,re.ensureErrnoError(),e.stdin=t||e.stdin,e.stdout=n||e.stdout,e.stderr=i||e.stderr,re.createStandardStreams()},quit:()=>{re.init.initialized=!1;for(var e=0;e<re.streams.length;e++){var t=re.streams[e];!t||re.close(t)}},getMode:(e,t)=>{var n=0;return e&&(n|=365),t&&(n|=146),n},findObject:(e,t)=>{var n=re.analyzePath(e,t);return n.exists?n.object:null},analyzePath:(e,t)=>{try{e=(i=re.lookupPath(e,{follow:!t})).path}catch{}var n={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var i=re.lookupPath(e,{parent:!0});n.parentExists=!0,n.parentPath=i.path,n.parentObject=i.node,n.name=Z.basename(e),i=re.lookupPath(e,{follow:!t}),n.exists=!0,n.path=i.path,n.object=i.node,n.name=i.node.name,n.isRoot="/"===i.path}catch(e){n.error=e.errno}return n},createPath:(e,t,n,i)=>{e="string"==typeof e?e:re.getPath(e);for(var s=t.split("/").reverse();s.length;){var o=s.pop();if(o){var r=Z.join2(e,o);try{re.mkdir(r)}catch{}e=r}}return r},createFile:(e,t,n,i,s)=>{var o=Z.join2("string"==typeof e?e:re.getPath(e),t),r=re.getMode(i,s);return re.create(o,r)},createDataFile:(e,t,n,i,s,o)=>{var r=t;e&&(e="string"==typeof e?e:re.getPath(e),r=t?Z.join2(e,t):e);var a=re.getMode(i,s),c=re.create(r,a);if(n){if("string"==typeof n){for(var l=new Array(n.length),d=0,u=n.length;d<u;++d)l[d]=n.charCodeAt(d);n=l}re.chmod(c,146|a);var h=re.open(c,577);re.write(h,n,0,n.length,0,o),re.close(h),re.chmod(c,a)}return c},createDevice:(e,t,n,i)=>{var s=Z.join2("string"==typeof e?e:re.getPath(e),t),o=re.getMode(!!n,!!i);re.createDevice.major||(re.createDevice.major=64);var r=re.makedev(re.createDevice.major++,0);return re.registerDevice(r,{open:e=>{e.seekable=!1},close:e=>{i&&i.buffer&&i.buffer.length&&i(10)},read:(e,t,i,s,o)=>{for(var r=0,a=0;a<s;a++){var c;try{c=n()}catch{throw new re.ErrnoError(29)}if(void 0===c&&0===r)throw new re.ErrnoError(6);if(null==c)break;r++,t[i+a]=c}return r&&(e.node.timestamp=Date.now()),r},write:(e,t,n,s,o)=>{for(var r=0;r<s;r++)try{i(t[n+r])}catch{throw new re.ErrnoError(29)}return s&&(e.node.timestamp=Date.now()),r}}),re.mkdev(s,o,r)},forceLoadFile:e=>{if(e.isDevice||e.isFolder||e.link||e.contents)return!0;if("undefined"!=typeof XMLHttpRequest)throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(!i)throw new Error("Cannot load without read() or XMLHttpRequest.");try{e.contents=te(i(e.url),!0),e.usedBytes=e.contents.length}catch{throw new re.ErrnoError(29)}},createLazyFile:(e,t,n,i,s)=>{function o(){this.lengthKnown=!1,this.chunks=[]}if(o.prototype.get=function(e){if(!(e>this.length-1||e<0)){var t=e%this.chunkSize,n=e/this.chunkSize|0;return this.getter(n)[t]}},o.prototype.setDataGetter=function(e){this.getter=e},o.prototype.cacheLength=function(){var e=new XMLHttpRequest;if(e.open("HEAD",n,!1),e.send(null),!(e.status>=200&&e.status<300||304===e.status))throw new Error("Couldn't load "+n+". Status: "+e.status);var t,i=Number(e.getResponseHeader("Content-length")),s=(t=e.getResponseHeader("Accept-Ranges"))&&"bytes"===t,o=(t=e.getResponseHeader("Content-Encoding"))&&"gzip"===t,r=1048576;s||(r=i);var a=this;a.setDataGetter((e=>{var t=e*r,s=(e+1)*r-1;if(s=Math.min(s,i-1),void 0===a.chunks[e]&&(a.chunks[e]=((e,t)=>{if(e>t)throw new Error("invalid range ("+e+", "+t+") or no bytes requested!");if(t>i-1)throw new Error("only "+i+" bytes available! programmer error!");var s=new XMLHttpRequest;if(s.open("GET",n,!1),i!==r&&s.setRequestHeader("Range","bytes="+e+"-"+t),s.responseType="arraybuffer",s.overrideMimeType&&s.overrideMimeType("text/plain; charset=x-user-defined"),s.send(null),!(s.status>=200&&s.status<300||304===s.status))throw new Error("Couldn't load "+n+". Status: "+s.status);return void 0!==s.response?new Uint8Array(s.response||[]):te(s.responseText||"",!0)})(t,s)),void 0===a.chunks[e])throw new Error("doXHR failed!");return a.chunks[e]})),(o||!i)&&(r=i=1,i=this.getter(0).length,r=i,l("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=i,this._chunkSize=r,this.lengthKnown=!0},"undefined"!=typeof XMLHttpRequest)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var r={isDevice:!1,url:n},a=re.createFile(e,t,r,i,s);r.contents?a.contents=r.contents:r.url&&(a.contents=null,a.url=r.url),Object.defineProperties(a,{usedBytes:{get:function(){return this.contents.length}}});var c={};function d(e,t,n,i,s){var o=e.node.contents;if(s>=o.length)return 0;var r=Math.min(o.length-s,i);if(o.slice)for(var a=0;a<r;a++)t[n+a]=o[s+a];else for(a=0;a<r;a++)t[n+a]=o.get(s+a);return r}return Object.keys(a.stream_ops).forEach((e=>{var t=a.stream_ops[e];c[e]=function(){return re.forceLoadFile(a),t.apply(null,arguments)}})),c.read=(e,t,n,i,s)=>(re.forceLoadFile(a),d(e,t,n,i,s)),c.mmap=(e,t,n,i,s)=>{re.forceLoadFile(a);var o=se(t);if(!o)throw new re.ErrnoError(48);return d(e,v,o,t,n),{ptr:o,allocated:!0}},a.stream_ops=c,a},createPreloadedFile:(e,t,n,i,o,r,a,c,l,d)=>{var u=t?ee.resolve(Z.join2(e,t)):e;function h(n){function s(n){d&&d(),c||re.createDataFile(e,t,n,i,o,l),r&&r(),V()}Ut.handledByPreloadPlugin(n,u,s,(()=>{a&&a(),V()}))||s(n)}j(),"string"==typeof n?function(e,t,n,i){var o="al "+e;s(e,(t=>{g(t,'Loading data file "'+e+'" failed (no arrayBuffer).'),h(new Uint8Array(t)),o&&V()}),(t=>{if(!n)throw'Loading data file "'+e+'" failed.';n()})),o&&j()}(n,0,a):h(n)},indexedDB:()=>window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,DB_NAME:()=>"EM_FS_"+window.location.pathname,DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:(e,t,n)=>{t=t||(()=>{}),n=n||(()=>{});var i=re.indexedDB();try{var s=i.open(re.DB_NAME(),re.DB_VERSION)}catch(e){return n(e)}s.onupgradeneeded=()=>{l("creating db"),s.result.createObjectStore(re.DB_STORE_NAME)},s.onsuccess=()=>{var i=s.result.transaction([re.DB_STORE_NAME],"readwrite"),o=i.objectStore(re.DB_STORE_NAME),r=0,a=0,c=e.length;function l(){0==a?t():n()}e.forEach((e=>{var t=o.put(re.analyzePath(e).object.contents,e);t.onsuccess=()=>{++r+a==c&&l()},t.onerror=()=>{a++,r+a==c&&l()}})),i.onerror=n},s.onerror=n},loadFilesFromDB:(e,t,n)=>{t=t||(()=>{}),n=n||(()=>{});var i=re.indexedDB();try{var s=i.open(re.DB_NAME(),re.DB_VERSION)}catch(e){return n(e)}s.onupgradeneeded=n,s.onsuccess=()=>{var i=s.result;try{var o=i.transaction([re.DB_STORE_NAME],"readonly")}catch(e){return void n(e)}var r=o.objectStore(re.DB_STORE_NAME),a=0,c=0,l=e.length;function d(){0==c?t():n()}e.forEach((e=>{var t=r.get(e);t.onsuccess=()=>{re.analyzePath(e).exists&&re.unlink(e),re.createDataFile(Z.dirname(e),Z.basename(e),t.result,!0,!0,!0),++a+c==l&&d()},t.onerror=()=>{c++,a+c==l&&d()}})),o.onerror=n},s.onerror=n}},ae={DEFAULT_POLLMASK:5,calculateAt:function(e,t,n){if(Z.isAbs(t))return t;var i;if(i=-100===e?re.cwd():ae.getStreamFromFD(e).path,0==t.length){if(!n)throw new re.ErrnoError(44);return i}return Z.join2(i,t)},doStat:function(e,t,n){try{var i=e(t)}catch(e){if(e&&e.node&&Z.normalize(t)!==Z.normalize(re.getPath(e.node)))return-54;throw e}return C[n>>2]=i.dev,C[n+8>>2]=i.ino,C[n+12>>2]=i.mode,S[n+16>>2]=i.nlink,C[n+20>>2]=i.uid,C[n+24>>2]=i.gid,C[n+28>>2]=i.rdev,z=[i.size>>>0,(H=i.size,+Math.abs(H)>=1?H>0?(0|Math.min(+Math.floor(H/4294967296),4294967295))>>>0:~~+Math.ceil((H-+(~~H>>>0))/4294967296)>>>0:0)],C[n+40>>2]=z[0],C[n+44>>2]=z[1],C[n+48>>2]=4096,C[n+52>>2]=i.blocks,z=[Math.floor(i.atime.getTime()/1e3)>>>0,(H=Math.floor(i.atime.getTime()/1e3),+Math.abs(H)>=1?H>0?(0|Math.min(+Math.floor(H/4294967296),4294967295))>>>0:~~+Math.ceil((H-+(~~H>>>0))/4294967296)>>>0:0)],C[n+56>>2]=z[0],C[n+60>>2]=z[1],S[n+64>>2]=0,z=[Math.floor(i.mtime.getTime()/1e3)>>>0,(H=Math.floor(i.mtime.getTime()/1e3),+Math.abs(H)>=1?H>0?(0|Math.min(+Math.floor(H/4294967296),4294967295))>>>0:~~+Math.ceil((H-+(~~H>>>0))/4294967296)>>>0:0)],C[n+72>>2]=z[0],C[n+76>>2]=z[1],S[n+80>>2]=0,z=[Math.floor(i.ctime.getTime()/1e3)>>>0,(H=Math.floor(i.ctime.getTime()/1e3),+Math.abs(H)>=1?H>0?(0|Math.min(+Math.floor(H/4294967296),4294967295))>>>0:~~+Math.ceil((H-+(~~H>>>0))/4294967296)>>>0:0)],C[n+88>>2]=z[0],C[n+92>>2]=z[1],S[n+96>>2]=0,z=[i.ino>>>0,(H=i.ino,+Math.abs(H)>=1?H>0?(0|Math.min(+Math.floor(H/4294967296),4294967295))>>>0:~~+Math.ceil((H-+(~~H>>>0))/4294967296)>>>0:0)],C[n+104>>2]=z[0],C[n+108>>2]=z[1],0},doMsync:function(e,t,n,i,s){if(!re.isFile(t.node.mode))throw new re.ErrnoError(43);if(2&i)return 0;var o=b.slice(e,e+n);re.msync(t,o,s,n,i)},varargs:void 0,get:function(){return ae.varargs+=4,C[ae.varargs-4>>2]},getStr:function(e){return T(e)},getStreamFromFD:function(e){var t=re.getStream(e);if(!t)throw new re.ErrnoError(8);return t}};function ce(e,t){return t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN}var le="To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking";function de(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}var ue=void 0;function he(e){for(var t="",n=e;b[n];)t+=ue[b[n++]];return t}var pe={},me={},we={},ge=48,fe=57;function ve(e){if(void 0===e)return"_unknown";var t=(e=e.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return t>=ge&&t<=fe?"_"+e:e}function be(e,t){return e=ve(e),new Function("body","return function "+e+'() {\n    "use strict";    return body.apply(this, arguments);\n};\n')(t)}function _e(e,t){var n=be(t,(function(e){this.name=t,this.message=e;var n=new Error(e).stack;void 0!==n&&(this.stack=this.toString()+"\n"+n.replace(/^Error(:[^\n]*)?\n/,""))}));return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype.toString=function(){return void 0===this.message?this.name:this.name+": "+this.message},n}var ye=void 0;function Ce(e){throw new ye(e)}var Se=void 0;function Ee(e){throw new Se(e)}function xe(e,t,n){function i(t){var i=n(t);i.length!==e.length&&Ee("Mismatched type converter count");for(var s=0;s<e.length;++s)ke(e[s],i[s])}e.forEach((function(e){we[e]=t}));var s=new Array(t.length),o=[],r=0;t.forEach(((e,t)=>{me.hasOwnProperty(e)?s[t]=me[e]:(o.push(e),pe.hasOwnProperty(e)||(pe[e]=[]),pe[e].push((()=>{s[t]=me[e],++r===o.length&&i(s)})))})),0===o.length&&i(s)}function ke(e,t,n={}){if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");var i=t.name;if(e||Ce('type "'+i+'" must have a positive integer typeid pointer'),me.hasOwnProperty(e)){if(n.ignoreDuplicateRegistrations)return;Ce("Cannot register type '"+i+"' twice")}if(me[e]=t,delete we[e],pe.hasOwnProperty(e)){var s=pe[e];delete pe[e],s.forEach((e=>e()))}}function Me(e){return{count:e.count,deleteScheduled:e.deleteScheduled,preservePointerOnDelete:e.preservePointerOnDelete,ptr:e.ptr,ptrType:e.ptrType,smartPtr:e.smartPtr,smartPtrType:e.smartPtrType}}function Te(e){Ce(function(e){return e.$$.ptrType.registeredClass.name}(e)+" instance already deleted")}var Ie=!1;function Re(e){}function Ae(e){e.count.value-=1,0===e.count.value&&function(e){e.smartPtr?e.smartPtrType.rawDestructor(e.smartPtr):e.ptrType.registeredClass.rawDestructor(e.ptr)}(e)}function $e(e,t,n){if(t===n)return e;if(void 0===n.baseClass)return null;var i=$e(e,t,n.baseClass);return null===i?null:n.downcast(i)}var Le={};var Pe=[];function De(){for(;Pe.length;){var e=Pe.pop();e.$$.deleteScheduled=!1,e.delete()}}var Ne=void 0;var Oe={};function Be(e,t){return(!t.ptrType||!t.ptr)&&Ee("makeClassHandle requires ptr and ptrType"),!!t.smartPtrType!=!!t.smartPtr&&Ee("Both smartPtrType and smartPtr must be specified"),t.count={value:1},Fe(Object.create(e,{$$:{value:t}}))}function Fe(e){return"undefined"==typeof FinalizationRegistry?(Fe=e=>e,e):(Ie=new FinalizationRegistry((e=>{Ae(e.$$)})),Fe=e=>{var t=e.$$;if(t.smartPtr){var n={$$:t};Ie.register(e,n,e)}return e},Re=e=>Ie.unregister(e),Fe(e))}function Ue(){}function je(e,t,n){if(void 0===e[t].overloadTable){var i=e[t];e[t]=function(){return e[t].overloadTable.hasOwnProperty(arguments.length)||Ce("Function '"+n+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[t].overloadTable+")!"),e[t].overloadTable[arguments.length].apply(this,arguments)},e[t].overloadTable=[],e[t].overloadTable[i.argCount]=i}}function Ve(t,n,i){e.hasOwnProperty(t)?((void 0===i||void 0!==e[t].overloadTable&&void 0!==e[t].overloadTable[i])&&Ce("Cannot register public name '"+t+"' twice"),je(e,t,t),e.hasOwnProperty(i)&&Ce("Cannot register multiple overloads of a function with the same number of arguments ("+i+")!"),e[t].overloadTable[i]=n):(e[t]=n,void 0!==i&&(e[t].numArguments=i))}function Ge(e,t,n,i,s,o,r,a){this.name=e,this.constructor=t,this.instancePrototype=n,this.rawDestructor=i,this.baseClass=s,this.getActualType=o,this.upcast=r,this.downcast=a,this.pureVirtualFunctions=[]}function qe(e,t,n){for(;t!==n;)t.upcast||Ce("Expected null or instance of "+n.name+", got an instance of "+t.name),e=t.upcast(e),t=t.baseClass;return e}function He(e,t){if(null===t)return this.isReference&&Ce("null is not a valid "+this.name),0;t.$$||Ce('Cannot pass "'+mt(t)+'" as a '+this.name),t.$$.ptr||Ce("Cannot pass deleted object as a pointer of type "+this.name);var n=t.$$.ptrType.registeredClass;return qe(t.$$.ptr,n,this.registeredClass)}function ze(e,t){var n;if(null===t)return this.isReference&&Ce("null is not a valid "+this.name),this.isSmartPointer?(n=this.rawConstructor(),null!==e&&e.push(this.rawDestructor,n),n):0;t.$$||Ce('Cannot pass "'+mt(t)+'" as a '+this.name),t.$$.ptr||Ce("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&t.$$.ptrType.isConst&&Ce("Cannot convert argument of type "+(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name)+" to parameter type "+this.name);var i=t.$$.ptrType.registeredClass;if(n=qe(t.$$.ptr,i,this.registeredClass),this.isSmartPointer)switch(void 0===t.$$.smartPtr&&Ce("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:t.$$.smartPtrType===this?n=t.$$.smartPtr:Ce("Cannot convert argument of type "+(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:n=t.$$.smartPtr;break;case 2:if(t.$$.smartPtrType===this)n=t.$$.smartPtr;else{var s=t.clone();n=this.rawShare(n,ut.toHandle((function(){s.delete()}))),null!==e&&e.push(this.rawDestructor,n)}break;default:Ce("Unsupporting sharing policy")}return n}function We(e,t){if(null===t)return this.isReference&&Ce("null is not a valid "+this.name),0;t.$$||Ce('Cannot pass "'+mt(t)+'" as a '+this.name),t.$$.ptr||Ce("Cannot pass deleted object as a pointer of type "+this.name),t.$$.ptrType.isConst&&Ce("Cannot convert argument of type "+t.$$.ptrType.name+" to parameter type "+this.name);var n=t.$$.ptrType.registeredClass;return qe(t.$$.ptr,n,this.registeredClass)}function Je(e){return this.fromWireType(C[e>>2])}function Ye(e,t,n,i,s,o,r,a,c,l,d){this.name=e,this.registeredClass=t,this.isReference=n,this.isConst=i,this.isSmartPointer=s,this.pointeeType=o,this.sharingPolicy=r,this.rawGetPointee=a,this.rawConstructor=c,this.rawShare=l,this.rawDestructor=d,s||void 0!==t.baseClass?this.toWireType=ze:i?(this.toWireType=He,this.destructorFunction=null):(this.toWireType=We,this.destructorFunction=null)}function Ke(t,n,i){e.hasOwnProperty(t)||Ee("Replacing nonexistant public symbol"),void 0!==e[t].overloadTable&&void 0!==i?e[t].overloadTable[i]=n:(e[t]=n,e[t].argCount=i)}var Xe=[];function Ze(e){var t=Xe[e];return t||(e>=Xe.length&&(Xe.length=e+1),Xe[e]=t=L.get(e)),t}function Qe(t,n){var i=(t=he(t)).includes("j")?function(t,n){var i=[];return function(){return i.length=0,Bs(i,arguments),function(t,n,i){return t.includes("j")?function(t,n,i){var s=e["dynCall_"+t];return i&&i.length?s.apply(null,[n].concat(i)):s.call(null,n)}(t,n,i):Ze(n).apply(null,i)}(t,n,i)}}(t,n):Ze(n);return"function"!=typeof i&&Ce("unknown function pointer with signature "+t+": "+n),i}var et=void 0;function tt(e){var t=yn(e),n=he(t);return _n(t),n}function nt(e,t){var n=[],i={};throw t.forEach((function e(t){if(!i[t]&&!me[t]){if(we[t])return void we[t].forEach(e);n.push(t),i[t]=!0}})),new et(e+": "+n.map(tt).join([", "]))}function it(e,t){if(!(e instanceof Function))throw new TypeError("new_ called with constructor type "+typeof e+" which is not a function");var n=be(e.name||"unknownFunctionName",(function(){}));n.prototype=e.prototype;var i=new n,s=e.apply(i,t);return s instanceof Object?s:i}function st(e){for(;e.length;){var t=e.pop();e.pop()(t)}}function ot(e,t,n,i,s){var o=t.length;o<2&&Ce("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var r=null!==t[1]&&null!==n,a=!1,c=1;c<t.length;++c)if(null!==t[c]&&void 0===t[c].destructorFunction){a=!0;break}var l="void"!==t[0].name,d="",u="";for(c=0;c<o-2;++c)d+=(0!==c?", ":"")+"arg"+c,u+=(0!==c?", ":"")+"arg"+c+"Wired";var h="return function "+ve(e)+"("+d+") {\nif (arguments.length !== "+(o-2)+") {\nthrowBindingError('function "+e+" called with ' + arguments.length + ' arguments, expected "+(o-2)+" args!');\n}\n";a&&(h+="var destructors = [];\n");var p=a?"destructors":"null",m=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],w=[Ce,i,s,st,t[0],t[1]];for(r&&(h+="var thisWired = classParam.toWireType("+p+", this);\n"),c=0;c<o-2;++c)h+="var arg"+c+"Wired = argType"+c+".toWireType("+p+", arg"+c+"); // "+t[c+2].name+"\n",m.push("argType"+c),w.push(t[c+2]);if(r&&(u="thisWired"+(u.length>0?", ":"")+u),h+=(l?"var rv = ":"")+"invoker(fn"+(u.length>0?", ":"")+u+");\n",a)h+="runDestructors(destructors);\n";else for(c=r?1:2;c<t.length;++c){var g=1===c?"thisWired":"arg"+(c-2)+"Wired";null!==t[c].destructorFunction&&(h+=g+"_dtor("+g+"); // "+t[c].name+"\n",m.push(g+"_dtor"),w.push(t[c].destructorFunction))}return l&&(h+="var ret = retType.fromWireType(rv);\nreturn ret;\n"),h+="}\n",m.push(h),it(Function,m).apply(null,w)}function rt(e,t){for(var n=[],i=0;i<e;i++)n.push(S[t+4*i>>2]);return n}function at(e,t,n){return e instanceof Object||Ce(n+' with invalid "this": '+e),e instanceof t.registeredClass.constructor||Ce(n+' incompatible with "this" of type '+e.constructor.name),e.$$.ptr||Ce("cannot call emscripten binding method "+n+" on deleted object"),qe(e.$$.ptr,e.$$.ptrType.registeredClass,t.registeredClass)}var ct=[],lt=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function dt(e){e>4&&0==--lt[e].refcount&&(lt[e]=void 0,ct.push(e))}var ut={toValue:e=>(e||Ce("Cannot use deleted val. handle = "+e),lt[e].value),toHandle:e=>{switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var t=ct.length?ct.pop():lt.length;return lt[t]={refcount:1,value:e},t}}};function ht(e,t,n){switch(t){case 0:return function(e){var t=n?v:b;return this.fromWireType(t[e])};case 1:return function(e){var t=n?_:y;return this.fromWireType(t[e>>1])};case 2:return function(e){var t=n?C:S;return this.fromWireType(t[e>>2])};default:throw new TypeError("Unknown integer type: "+e)}}function pt(e,t){var n=me[e];return void 0===n&&Ce(t+" has unknown type "+tt(e)),n}function mt(e){if(null===e)return"null";var t=typeof e;return"object"===t||"array"===t||"function"===t?e.toString():""+e}function wt(e,t){switch(t){case 2:return function(e){return this.fromWireType(E[e>>2])};case 3:return function(e){return this.fromWireType(x[e>>3])};default:throw new TypeError("Unknown float type: "+e)}}function gt(e,t,n){switch(t){case 0:return n?function(e){return v[e]}:function(e){return b[e]};case 1:return n?function(e){return _[e>>1]}:function(e){return y[e>>1]};case 2:return n?function(e){return C[e>>2]}:function(e){return S[e>>2]};default:throw new TypeError("Unknown integer type: "+e)}}var ft="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0;function vt(e,t){for(var n=e,i=n>>1,s=i+t/2;!(i>=s)&&y[i];)++i;if((n=i<<1)-e>32&&ft)return ft.decode(b.subarray(e,n));for(var o="",r=0;!(r>=t/2);++r){var a=_[e+2*r>>1];if(0==a)break;o+=String.fromCharCode(a)}return o}function bt(e,t,n){if(void 0===n&&(n=2147483647),n<2)return 0;for(var i=t,s=(n-=2)<2*e.length?n/2:e.length,o=0;o<s;++o){var r=e.charCodeAt(o);_[t>>1]=r,t+=2}return _[t>>1]=0,t-i}function _t(e){return 2*e.length}function yt(e,t){for(var n=0,i="";!(n>=t/4);){var s=C[e+4*n>>2];if(0==s)break;if(++n,s>=65536){var o=s-65536;i+=String.fromCharCode(55296|o>>10,56320|1023&o)}else i+=String.fromCharCode(s)}return i}function Ct(e,t,n){if(void 0===n&&(n=2147483647),n<4)return 0;for(var i=t,s=i+n-4,o=0;o<e.length;++o){var r=e.charCodeAt(o);if(r>=55296&&r<=57343&&(r=65536+((1023&r)<<10)|1023&e.charCodeAt(++o)),C[t>>2]=r,(t+=4)+4>s)break}return C[t>>2]=0,t-i}function St(e){for(var t=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=55296&&i<=57343&&++n,t+=4}return t}function Et(e,t){for(var n=new Array(e),i=0;i<e;++i)n[i]=pt(S[t+4*i>>2],"parameter "+i);return n}var xt={};function kt(e){var t=xt[e];return void 0===t?he(e):t}var Mt=[],Tt=[];function It(e){return S[e>>2]+4294967296*C[e+4>>2]}function Rt(e){return e%4==0&&(e%100!=0||e%400==0)}var At,$t=[0,31,60,91,121,152,182,213,244,274,305,335],Lt=[0,31,59,90,120,151,181,212,243,273,304,334];function Pt(e){return(Rt(e.getFullYear())?$t:Lt)[e.getMonth()]+e.getDate()-1}function Dt(e){var t=A(e)+1,n=vn(t);return n&&I(e,v,n,t),n}function Nt(e,t){if(Ut.mainLoop.timingMode=e,Ut.mainLoop.timingValue=t,!Ut.mainLoop.func)return 1;if(Ut.mainLoop.running||(Ut.mainLoop.running=!0),0==e)Ut.mainLoop.scheduler=function(){var e=0|Math.max(0,Ut.mainLoop.tickStartTime+t-At());setTimeout(Ut.mainLoop.runner,e)},Ut.mainLoop.method="timeout";else if(1==e)Ut.mainLoop.scheduler=function(){Ut.requestAnimationFrame(Ut.mainLoop.runner)},Ut.mainLoop.method="rAF";else if(2==e){if("undefined"==typeof setImmediate){var n=[],i="setimmediate";addEventListener("message",(e=>{(e.data===i||e.data.target===i)&&(e.stopPropagation(),n.shift()())}),!0),setImmediate=function(e){n.push(e),postMessage(i,"*")}}Ut.mainLoop.scheduler=function(){setImmediate(Ut.mainLoop.runner)},Ut.mainLoop.method="immediate"}return 0}At=()=>performance.now();function Ot(e){if(!w)try{e()}catch(e){!function(e){if(e instanceof Y||"unwind"==e)return m;a(1,e)}(e)}}function Bt(e,t){return setTimeout((function(){Ot(e)}),t)}function Ft(e){Ft.shown||(Ft.shown={}),Ft.shown[e]||(Ft.shown[e]=1,d(e))}var Ut={mainLoop:{running:!1,scheduler:null,method:"",currentlyRunningMainloop:0,func:null,arg:0,timingMode:0,timingValue:0,currentFrameNumber:0,queue:[],pause:function(){Ut.mainLoop.scheduler=null,Ut.mainLoop.currentlyRunningMainloop++},resume:function(){Ut.mainLoop.currentlyRunningMainloop++;var e=Ut.mainLoop.timingMode,t=Ut.mainLoop.timingValue,n=Ut.mainLoop.func;Ut.mainLoop.func=null,function(e,t,n,i,s){g(!Ut.mainLoop.func,"emscripten_set_main_loop: there can only be one main loop function at once: call emscripten_cancel_main_loop to cancel the previous one before setting a new one with different parameters."),Ut.mainLoop.func=e,Ut.mainLoop.arg=i;var o=Ut.mainLoop.currentlyRunningMainloop;function r(){return!(o<Ut.mainLoop.currentlyRunningMainloop)}Ut.mainLoop.running=!1,Ut.mainLoop.runner=function(){if(!w){if(Ut.mainLoop.queue.length>0){var t=Date.now(),n=Ut.mainLoop.queue.shift();if(n.func(n.arg),Ut.mainLoop.remainingBlockers){var i=Ut.mainLoop.remainingBlockers,s=i%1==0?i-1:Math.floor(i);n.counted?Ut.mainLoop.remainingBlockers=s:(s+=.5,Ut.mainLoop.remainingBlockers=(8*i+s)/9)}if(l('main loop blocker "'+n.name+'" took '+(Date.now()-t)+" ms"),Ut.mainLoop.updateStatus(),!r())return;return void setTimeout(Ut.mainLoop.runner,0)}if(r()){if(Ut.mainLoop.currentFrameNumber=Ut.mainLoop.currentFrameNumber+1|0,1==Ut.mainLoop.timingMode&&Ut.mainLoop.timingValue>1&&Ut.mainLoop.currentFrameNumber%Ut.mainLoop.timingValue!=0)return void Ut.mainLoop.scheduler();0==Ut.mainLoop.timingMode&&(Ut.mainLoop.tickStartTime=At()),Ut.mainLoop.runIter(e),r()&&("object"==typeof SDL&&SDL.audio&&SDL.audio.queueNewAudioData&&SDL.audio.queueNewAudioData(),Ut.mainLoop.scheduler())}}}}(n,0,0,Ut.mainLoop.arg),Nt(e,t),Ut.mainLoop.scheduler()},updateStatus:function(){if(e.setStatus){var t=e.statusMessage||"Please wait...",n=Ut.mainLoop.remainingBlockers,i=Ut.mainLoop.expectedBlockers;n?n<i?e.setStatus(t+" ("+(i-n)+"/"+i+")"):e.setStatus(t):e.setStatus("")}},runIter:function(t){if(!w){if(e.preMainLoop&&!1===e.preMainLoop())return;Ot(t),e.postMainLoop&&e.postMainLoop()}}},isFullscreen:!1,pointerLock:!1,moduleContextCreatedCallbacks:[],workers:[],init:function(){if(e.preloadPlugins||(e.preloadPlugins=[]),!Ut.initted){Ut.initted=!0;try{new Blob,Ut.hasBlobConstructor=!0}catch{Ut.hasBlobConstructor=!1,d("warning: no blob constructor, cannot create blobs with mimetypes")}Ut.BlobBuilder="undefined"!=typeof MozBlobBuilder?MozBlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:Ut.hasBlobConstructor?null:d("warning: no BlobBuilder"),Ut.URLObject="undefined"!=typeof window?window.URL?window.URL:window.webkitURL:void 0,!e.noImageDecoding&&void 0===Ut.URLObject&&(d("warning: Browser does not support creating object URLs. Built-in browser image decoding will not be available."),e.noImageDecoding=!0);var t={canHandle:function(t){return!e.noImageDecoding&&/\.(jpg|jpeg|png|bmp)$/i.test(t)},handle:function(e,t,n,i){var s=null;if(Ut.hasBlobConstructor)try{(s=new Blob([e],{type:Ut.getMimetype(t)})).size!==e.length&&(s=new Blob([new Uint8Array(e).buffer],{type:Ut.getMimetype(t)}))}catch(e){Ft("Blob constructor present but fails: "+e+"; falling back to blob builder")}if(!s){var o=new Ut.BlobBuilder;o.append(new Uint8Array(e).buffer),s=o.getBlob()}var r=Ut.URLObject.createObjectURL(s),a=new Image;a.onload=()=>{g(a.complete,"Image "+t+" could not be decoded");var i=document.createElement("canvas");i.width=a.width,i.height=a.height,i.getContext("2d").drawImage(a,0,0),Ut.URLObject.revokeObjectURL(r),n&&n(e)},a.onerror=e=>{l("Image "+r+" could not be decoded"),i&&i()},a.src=r}};e.preloadPlugins.push(t);var n={canHandle:function(t){return!e.noAudioDecoding&&t.substr(-4)in{".ogg":1,".wav":1,".mp3":1}},handle:function(e,t,n,i){var s=!1;function o(t){s||(s=!0,n&&n(e))}function r(){s||(s=!0,new Audio,i&&i())}if(!Ut.hasBlobConstructor)return r();try{var a=new Blob([e],{type:Ut.getMimetype(t)})}catch{return r()}var c=Ut.URLObject.createObjectURL(a),l=new Audio;l.addEventListener("canplaythrough",(()=>o()),!1),l.onerror=function(n){s||(d("warning: browser could not fully decode audio "+t+", trying slower base64 approach"),l.src="data:audio/x-"+t.substr(-3)+";base64,"+function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",i=0,s=0,o=0;o<e.length;o++)for(i=i<<8|e[o],s+=8;s>=6;){var r=i>>s-6&63;s-=6,n+=t[r]}return 2==s?(n+=t[(3&i)<<4],n+="=="):4==s&&(n+=t[(15&i)<<2],n+="="),n}(e),o())},l.src=c,Bt((function(){o()}),1e4)}};e.preloadPlugins.push(n);var i=e.canvas;i&&(i.requestPointerLock=i.requestPointerLock||i.mozRequestPointerLock||i.webkitRequestPointerLock||i.msRequestPointerLock||(()=>{}),i.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock||document.msExitPointerLock||(()=>{}),i.exitPointerLock=i.exitPointerLock.bind(document),document.addEventListener("pointerlockchange",s,!1),document.addEventListener("mozpointerlockchange",s,!1),document.addEventListener("webkitpointerlockchange",s,!1),document.addEventListener("mspointerlockchange",s,!1),e.elementPointerLock&&i.addEventListener("click",(t=>{!Ut.pointerLock&&e.canvas.requestPointerLock&&(e.canvas.requestPointerLock(),t.preventDefault())}),!1))}function s(){Ut.pointerLock=document.pointerLockElement===e.canvas||document.mozPointerLockElement===e.canvas||document.webkitPointerLockElement===e.canvas||document.msPointerLockElement===e.canvas}},handledByPreloadPlugin:function(t,n,i,s){Ut.init();var o=!1;return e.preloadPlugins.forEach((function(e){o||e.canHandle(n)&&(e.handle(t,n,i,s),o=!0)})),o},createContext:function(t,n,i,s){if(n&&e.ctx&&t==e.canvas)return e.ctx;var o,r;if(n){var a={antialias:!1,alpha:!1,majorVersion:"undefined"!=typeof WebGL2RenderingContext?2:1};if(s)for(var c in s)a[c]=s[c];void 0!==Zt&&(r=Zt.createContext(t,a))&&(o=Zt.getContext(r).GLctx)}else o=t.getContext("2d");return o?(i&&(n||g(void 0===mn,"cannot set in module if GLctx is used, but we are a non-GL context that would replace it"),e.ctx=o,n&&Zt.makeContextCurrent(r),e.useWebGL=n,Ut.moduleContextCreatedCallbacks.forEach((function(e){e()})),Ut.init()),o):null},destroyContext:function(e,t,n){},fullscreenHandlersInstalled:!1,lockPointer:void 0,resizeCanvas:void 0,requestFullscreen:function(t,n){Ut.lockPointer=t,Ut.resizeCanvas=n,void 0===Ut.lockPointer&&(Ut.lockPointer=!0),void 0===Ut.resizeCanvas&&(Ut.resizeCanvas=!1);var i=e.canvas;function s(){Ut.isFullscreen=!1;var t=i.parentNode;(document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement)===t?(i.exitFullscreen=Ut.exitFullscreen,Ut.lockPointer&&i.requestPointerLock(),Ut.isFullscreen=!0,Ut.resizeCanvas?Ut.setFullscreenCanvasSize():Ut.updateCanvasDimensions(i)):(t.parentNode.insertBefore(i,t),t.parentNode.removeChild(t),Ut.resizeCanvas?Ut.setWindowedCanvasSize():Ut.updateCanvasDimensions(i)),e.onFullScreen&&e.onFullScreen(Ut.isFullscreen),e.onFullscreen&&e.onFullscreen(Ut.isFullscreen)}Ut.fullscreenHandlersInstalled||(Ut.fullscreenHandlersInstalled=!0,document.addEventListener("fullscreenchange",s,!1),document.addEventListener("mozfullscreenchange",s,!1),document.addEventListener("webkitfullscreenchange",s,!1),document.addEventListener("MSFullscreenChange",s,!1));var o=document.createElement("div");i.parentNode.insertBefore(o,i),o.appendChild(i),o.requestFullscreen=o.requestFullscreen||o.mozRequestFullScreen||o.msRequestFullscreen||(o.webkitRequestFullscreen?()=>o.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):null)||(o.webkitRequestFullScreen?()=>o.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):null),o.requestFullscreen()},exitFullscreen:function(){return!!Ut.isFullscreen&&((document.exitFullscreen||document.cancelFullScreen||document.mozCancelFullScreen||document.msExitFullscreen||document.webkitCancelFullScreen||function(){}).apply(document,[]),!0)},nextRAF:0,fakeRequestAnimationFrame:function(e){var t=Date.now();if(0===Ut.nextRAF)Ut.nextRAF=t+1e3/60;else for(;t+2>=Ut.nextRAF;)Ut.nextRAF+=1e3/60;var n=Math.max(Ut.nextRAF-t,0);setTimeout(e,n)},requestAnimationFrame:function(e){"function"!=typeof requestAnimationFrame?(0,Ut.fakeRequestAnimationFrame)(e):requestAnimationFrame(e)},safeSetTimeout:function(e,t){return Bt(e,t)},safeRequestAnimationFrame:function(e){return Ut.requestAnimationFrame((function(){Ot(e)}))},getMimetype:function(e){return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",bmp:"image/bmp",ogg:"audio/ogg",wav:"audio/wav",mp3:"audio/mpeg"}[e.substr(e.lastIndexOf(".")+1)]},getUserMedia:function(e){window.getUserMedia||(window.getUserMedia=navigator.getUserMedia||navigator.mozGetUserMedia),window.getUserMedia(e)},getMovementX:function(e){return e.movementX||e.mozMovementX||e.webkitMovementX||0},getMovementY:function(e){return e.movementY||e.mozMovementY||e.webkitMovementY||0},getMouseWheelDelta:function(e){var t=0;switch(e.type){case"DOMMouseScroll":t=e.detail/3;break;case"mousewheel":t=e.wheelDelta/120;break;case"wheel":switch(t=e.deltaY,e.deltaMode){case 0:t/=100;break;case 1:t/=3;break;case 2:t*=80;break;default:throw"unrecognized mouse wheel delta mode: "+e.deltaMode}break;default:throw"unrecognized mouse wheel event: "+e.type}return t},mouseX:0,mouseY:0,mouseMovementX:0,mouseMovementY:0,touches:{},lastTouches:{},calculateMouseEvent:function(t){if(Ut.pointerLock)"mousemove"!=t.type&&"mozMovementX"in t?Ut.mouseMovementX=Ut.mouseMovementY=0:(Ut.mouseMovementX=Ut.getMovementX(t),Ut.mouseMovementY=Ut.getMovementY(t)),"undefined"!=typeof SDL?(Ut.mouseX=SDL.mouseX+Ut.mouseMovementX,Ut.mouseY=SDL.mouseY+Ut.mouseMovementY):(Ut.mouseX+=Ut.mouseMovementX,Ut.mouseY+=Ut.mouseMovementY);else{var n=e.canvas.getBoundingClientRect(),i=e.canvas.width,s=e.canvas.height,o=void 0!==window.scrollX?window.scrollX:window.pageXOffset,r=void 0!==window.scrollY?window.scrollY:window.pageYOffset;if("touchstart"===t.type||"touchend"===t.type||"touchmove"===t.type){var a=t.touch;if(void 0===a)return;var c=a.pageX-(o+n.left),l=a.pageY-(r+n.top),d={x:c*=i/n.width,y:l*=s/n.height};if("touchstart"===t.type)Ut.lastTouches[a.identifier]=d,Ut.touches[a.identifier]=d;else if("touchend"===t.type||"touchmove"===t.type){var u=Ut.touches[a.identifier];u||(u=d),Ut.lastTouches[a.identifier]=u,Ut.touches[a.identifier]=d}return}var h=t.pageX-(o+n.left),p=t.pageY-(r+n.top);h*=i/n.width,p*=s/n.height,Ut.mouseMovementX=h-Ut.mouseX,Ut.mouseMovementY=p-Ut.mouseY,Ut.mouseX=h,Ut.mouseY=p}},resizeListeners:[],updateResizeListeners:function(){var t=e.canvas;Ut.resizeListeners.forEach((function(e){e(t.width,t.height)}))},setCanvasSize:function(t,n,i){var s=e.canvas;Ut.updateCanvasDimensions(s,t,n),i||Ut.updateResizeListeners()},windowedWidth:0,windowedHeight:0,setFullscreenCanvasSize:function(){if("undefined"!=typeof SDL){var t=S[SDL.screen>>2];t|=8388608,C[SDL.screen>>2]=t}Ut.updateCanvasDimensions(e.canvas),Ut.updateResizeListeners()},setWindowedCanvasSize:function(){if("undefined"!=typeof SDL){var t=S[SDL.screen>>2];t&=-8388609,C[SDL.screen>>2]=t}Ut.updateCanvasDimensions(e.canvas),Ut.updateResizeListeners()},updateCanvasDimensions:function(t,n,i){n&&i?(t.widthNative=n,t.heightNative=i):(n=t.widthNative,i=t.heightNative);var s=n,o=i;if(e.forcedAspectRatio&&e.forcedAspectRatio>0&&(s/o<e.forcedAspectRatio?s=Math.round(o*e.forcedAspectRatio):o=Math.round(s/e.forcedAspectRatio)),(document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement)===t.parentNode&&"undefined"!=typeof screen){var r=Math.min(screen.width/s,screen.height/o);s=Math.round(s*r),o=Math.round(o*r)}Ut.resizeCanvas?(t.width!=s&&(t.width=s),t.height!=o&&(t.height=o),void 0!==t.style&&(t.style.removeProperty("width"),t.style.removeProperty("height"))):(t.width!=n&&(t.width=n),t.height!=i&&(t.height=i),void 0!==t.style&&(s!=n||o!=i?(t.style.setProperty("width",s+"px","important"),t.style.setProperty("height",o+"px","important")):(t.style.removeProperty("width"),t.style.removeProperty("height"))))}},jt={QUEUE_INTERVAL:25,QUEUE_LOOKAHEAD:.1,DEVICE_NAME:"Emscripten OpenAL",CAPTURE_DEVICE_NAME:"Emscripten OpenAL capture",ALC_EXTENSIONS:{ALC_SOFT_pause_device:!0,ALC_SOFT_HRTF:!0},AL_EXTENSIONS:{AL_EXT_float32:!0,AL_SOFT_loop_points:!0,AL_SOFT_source_length:!0,AL_EXT_source_distance_model:!0,AL_SOFT_source_spatialize:!0},_alcErr:0,alcErr:0,deviceRefCounts:{},alcStringCache:{},paused:!1,stringCache:{},contexts:{},currentCtx:null,buffers:{0:{id:0,refCount:0,audioBuf:null,frequency:0,bytesPerSample:2,channels:1,length:0}},paramArray:[],_nextId:1,newId:function(){return jt.freeIds.length>0?jt.freeIds.pop():jt._nextId++},freeIds:[],scheduleContextAudio:function(e){if(1!==Ut.mainLoop.timingMode||"visible"==document.visibilityState)for(var t in e.sources)jt.scheduleSourceAudio(e.sources[t])},scheduleSourceAudio:function(e,t){if((1!==Ut.mainLoop.timingMode||"visible"==document.visibilityState)&&4114===e.state){for(var n=jt.updateSourceTime(e),i=e.bufStartTime,s=e.bufOffset,o=e.bufsProcessed,r=0;r<e.audioQueue.length;r++)i=(d=e.audioQueue[r])._startTime+d._duration,s=0,o+=d._skipCount+1;t||(t=jt.QUEUE_LOOKAHEAD);for(var a=n+t,c=0;i<a;){if(o>=e.bufQueue.length){if(!e.looping)break;o%=e.bufQueue.length}var l=e.bufQueue[o%e.bufQueue.length];if(0===l.length){if(++c===e.bufQueue.length)break}else{var d;(d=e.context.audioCtx.createBufferSource()).buffer=l.audioBuf,d.playbackRate.value=e.playbackRate,(l.audioBuf._loopStart||l.audioBuf._loopEnd)&&(d.loopStart=l.audioBuf._loopStart,d.loopEnd=l.audioBuf._loopEnd);var u=0;4136===e.type&&e.looping?(u=Number.POSITIVE_INFINITY,d.loop=!0,l.audioBuf._loopStart&&(d.loopStart=l.audioBuf._loopStart),l.audioBuf._loopEnd&&(d.loopEnd=l.audioBuf._loopEnd)):u=(l.audioBuf.duration-s)/e.playbackRate,d._startOffset=s,d._duration=u,d._skipCount=c,c=0,d.connect(e.gain),void 0!==d.start?(i=Math.max(i,e.context.audioCtx.currentTime),d.start(i,s)):void 0!==d.noteOn&&(i=Math.max(i,e.context.audioCtx.currentTime),d.noteOn(i)),d._startTime=i,e.audioQueue.push(d),i+=u}s=0,o++}}},updateSourceTime:function(e){var t=e.context.audioCtx.currentTime;if(4114!==e.state)return t;isFinite(e.bufStartTime)||(e.bufStartTime=t-e.bufOffset/e.playbackRate,e.bufOffset=0);for(var n=0;e.audioQueue.length;){var i=e.audioQueue[0];if(e.bufsProcessed+=i._skipCount,t<(n=i._startTime+i._duration))break;e.audioQueue.shift(),e.bufStartTime=n,e.bufOffset=0,e.bufsProcessed++}if(e.bufsProcessed>=e.bufQueue.length&&!e.looping)jt.setSourceState(e,4116);else if(4136===e.type&&e.looping)if(0===(l=e.bufQueue[0]).length)e.bufOffset=0;else{var s=(t-e.bufStartTime)*e.playbackRate,o=l.audioBuf._loopStart||0,r=l.audioBuf._loopEnd||l.audioBuf.duration;r<=o&&(r=l.audioBuf.duration),e.bufOffset=s<r?s:o+(s-o)%(r-o)}else if(e.audioQueue[0])e.bufOffset=(t-e.audioQueue[0]._startTime)*e.playbackRate;else{if(4136!==e.type&&e.looping){var a=jt.sourceDuration(e)/e.playbackRate;a>0&&(e.bufStartTime+=Math.floor((t-e.bufStartTime)/a)*a)}for(var c=0;c<e.bufQueue.length;c++){if(e.bufsProcessed>=e.bufQueue.length){if(!e.looping){jt.setSourceState(e,4116);break}e.bufsProcessed%=e.bufQueue.length}var l;if((l=e.bufQueue[e.bufsProcessed]).length>0){if(t<(n=e.bufStartTime+l.audioBuf.duration/e.playbackRate)){e.bufOffset=(t-e.bufStartTime)*e.playbackRate;break}e.bufStartTime=n}e.bufOffset=0,e.bufsProcessed++}}return t},cancelPendingSourceAudio:function(e){jt.updateSourceTime(e);for(var t=1;t<e.audioQueue.length;t++)e.audioQueue[t].stop();e.audioQueue.length>1&&(e.audioQueue.length=1)},stopSourceAudio:function(e){for(var t=0;t<e.audioQueue.length;t++)e.audioQueue[t].stop();e.audioQueue.length=0},setSourceState:function(e,t){4114===t?((4114===e.state||4116==e.state)&&(e.bufsProcessed=0,e.bufOffset=0),jt.stopSourceAudio(e),e.state=4114,e.bufStartTime=Number.NEGATIVE_INFINITY,jt.scheduleSourceAudio(e)):4115===t?4114===e.state&&(jt.updateSourceTime(e),jt.stopSourceAudio(e),e.state=4115):4116===t?4113!==e.state&&(e.state=4116,e.bufsProcessed=e.bufQueue.length,e.bufStartTime=Number.NEGATIVE_INFINITY,e.bufOffset=0,jt.stopSourceAudio(e)):4113===t&&4113!==e.state&&(e.state=4113,e.bufsProcessed=0,e.bufStartTime=Number.NEGATIVE_INFINITY,e.bufOffset=0,jt.stopSourceAudio(e))},initSourcePanner:function(e){if(4144!==e.type){for(var t=jt.buffers[0],n=0;n<e.bufQueue.length;n++)if(0!==e.bufQueue[n].id){t=e.bufQueue[n];break}if(1===e.spatialize||2===e.spatialize&&1===t.channels){if(e.panner)return;e.panner=e.context.audioCtx.createPanner(),jt.updateSourceGlobal(e),jt.updateSourceSpace(e),e.panner.connect(e.context.gain),e.gain.disconnect(),e.gain.connect(e.panner)}else{if(!e.panner)return;e.panner.disconnect(),e.gain.disconnect(),e.gain.connect(e.context.gain),e.panner=null}}},updateContextGlobal:function(e){for(var t in e.sources)jt.updateSourceGlobal(e.sources[t])},updateSourceGlobal:function(e){var t=e.panner;if(t)switch(t.refDistance=e.refDistance,t.maxDistance=e.maxDistance,t.rolloffFactor=e.rolloffFactor,t.panningModel=e.context.hrtf?"HRTF":"equalpower",e.context.sourceDistanceModel?e.distanceModel:e.context.distanceModel){case 0:t.distanceModel="inverse",t.refDistance=340282e33;break;case 53249:case 53250:t.distanceModel="inverse";break;case 53251:case 53252:t.distanceModel="linear";break;case 53253:case 53254:t.distanceModel="exponential"}},updateListenerSpace:function(e){var t=e.audioCtx.listener;for(var n in t.positionX?(t.positionX.value=e.listener.position[0],t.positionY.value=e.listener.position[1],t.positionZ.value=e.listener.position[2]):t.setPosition(e.listener.position[0],e.listener.position[1],e.listener.position[2]),t.forwardX?(t.forwardX.value=e.listener.direction[0],t.forwardY.value=e.listener.direction[1],t.forwardZ.value=e.listener.direction[2],t.upX.value=e.listener.up[0],t.upY.value=e.listener.up[1],t.upZ.value=e.listener.up[2]):t.setOrientation(e.listener.direction[0],e.listener.direction[1],e.listener.direction[2],e.listener.up[0],e.listener.up[1],e.listener.up[2]),e.sources)jt.updateSourceSpace(e.sources[n])},updateSourceSpace:function(e){if(e.panner){var t=e.panner,n=e.position[0],i=e.position[1],s=e.position[2],o=e.direction[0],r=e.direction[1],a=e.direction[2],c=e.context.listener,l=c.position[0],d=c.position[1],u=c.position[2];if(e.relative){var h=-c.direction[0],p=-c.direction[1],m=-c.direction[2],w=c.up[0],g=c.up[1],f=c.up[2],v=function(e,t,n){var i=Math.sqrt(e*e+t*t+n*n);return i<Number.EPSILON?0:1/i},b=v(h,p,m);h*=b,p*=b,m*=b;var _=(g*=b=v(w,g,f))*m-(f*=b)*p,y=f*h-(w*=b)*m,C=w*p-g*h,S=o,E=r,x=a;o=S*(_*=b=v(_,y,C))+E*(w=p*(C*=b)-m*(y*=b))+x*h,r=S*y+E*(g=m*_-h*C)+x*p,a=S*C+E*(f=h*y-p*_)+x*m,n=(S=n)*_+(E=i)*w+(x=s)*h,i=S*y+E*g+x*p,s=S*C+E*f+x*m,n+=l,i+=d,s+=u}t.positionX?(n!=t.positionX.value&&(t.positionX.value=n),i!=t.positionY.value&&(t.positionY.value=i),s!=t.positionZ.value&&(t.positionZ.value=s)):t.setPosition(n,i,s),t.orientationX?(o!=t.orientationX.value&&(t.orientationX.value=o),r!=t.orientationY.value&&(t.orientationY.value=r),a!=t.orientationZ.value&&(t.orientationZ.value=a)):t.setOrientation(o,r,a);var k=e.dopplerShift,M=e.velocity[0],T=e.velocity[1],I=e.velocity[2],R=c.velocity[0],A=c.velocity[1],$=c.velocity[2];if(n===l&&i===d&&s===u||M===R&&T===A&&I===$)e.dopplerShift=1;else{var L=e.context.speedOfSound,P=e.context.dopplerFactor,D=l-n,N=d-i,O=u-s,B=Math.sqrt(D*D+N*N+O*O),F=(D*R+N*A+O*$)/B,U=(D*M+N*T+O*I)/B;F=Math.min(F,L/P),U=Math.min(U,L/P),e.dopplerShift=(L-P*F)/(L-P*U)}e.dopplerShift!==k&&jt.updateSourceRate(e)}},updateSourceRate:function(e){if(4114===e.state){jt.cancelPendingSourceAudio(e);var t,n=e.audioQueue[0];if(!n)return;t=4136===e.type&&e.looping?Number.POSITIVE_INFINITY:(n.buffer.duration-n._startOffset)/e.playbackRate,n._duration=t,n.playbackRate.value=e.playbackRate,jt.scheduleSourceAudio(e)}},sourceDuration:function(e){for(var t=0,n=0;n<e.bufQueue.length;n++){var i=e.bufQueue[n].audioBuf;t+=i?i.duration:0}return t},sourceTell:function(e){jt.updateSourceTime(e);for(var t=0,n=0;n<e.bufsProcessed;n++)e.bufQueue[n].audioBuf&&(t+=e.bufQueue[n].audioBuf.duration);return t+e.bufOffset},sourceSeek:function(e,t){var n=4114==e.state;if(n&&jt.setSourceState(e,4113),null!==e.bufQueue[e.bufsProcessed].audioBuf){for(e.bufsProcessed=0;t>e.bufQueue[e.bufsProcessed].audioBuf.duration;)t-=e.bufQueue[e.bufsProcessed].audiobuf.duration,e.bufsProcessed++;e.bufOffset=t}n&&jt.setSourceState(e,4114)},getGlobalParam:function(e,t){if(!jt.currentCtx)return null;switch(t){case 49152:return jt.currentCtx.dopplerFactor;case 49155:return jt.currentCtx.speedOfSound;case 53248:return jt.currentCtx.distanceModel;default:return jt.currentCtx.err=40962,null}},setGlobalParam:function(e,t,n){if(jt.currentCtx)switch(t){case 49152:if(!Number.isFinite(n)||n<0)return void(jt.currentCtx.err=40963);jt.currentCtx.dopplerFactor=n,jt.updateListenerSpace(jt.currentCtx);break;case 49155:if(!Number.isFinite(n)||n<=0)return void(jt.currentCtx.err=40963);jt.currentCtx.speedOfSound=n,jt.updateListenerSpace(jt.currentCtx);break;case 53248:switch(n){case 0:case 53249:case 53250:case 53251:case 53252:case 53253:case 53254:jt.currentCtx.distanceModel=n,jt.updateContextGlobal(jt.currentCtx);break;default:return void(jt.currentCtx.err=40963)}break;default:return void(jt.currentCtx.err=40962)}},getListenerParam:function(e,t){if(!jt.currentCtx)return null;switch(t){case 4100:return jt.currentCtx.listener.position;case 4102:return jt.currentCtx.listener.velocity;case 4111:return jt.currentCtx.listener.direction.concat(jt.currentCtx.listener.up);case 4106:return jt.currentCtx.gain.gain.value;default:return jt.currentCtx.err=40962,null}},setListenerParam:function(e,t,n){if(jt.currentCtx){if(null===n)return void(jt.currentCtx.err=40962);var i=jt.currentCtx.listener;switch(t){case 4100:if(!Number.isFinite(n[0])||!Number.isFinite(n[1])||!Number.isFinite(n[2]))return void(jt.currentCtx.err=40963);i.position[0]=n[0],i.position[1]=n[1],i.position[2]=n[2],jt.updateListenerSpace(jt.currentCtx);break;case 4102:if(!Number.isFinite(n[0])||!Number.isFinite(n[1])||!Number.isFinite(n[2]))return void(jt.currentCtx.err=40963);i.velocity[0]=n[0],i.velocity[1]=n[1],i.velocity[2]=n[2],jt.updateListenerSpace(jt.currentCtx);break;case 4106:if(!Number.isFinite(n)||n<0)return void(jt.currentCtx.err=40963);jt.currentCtx.gain.gain.value=n;break;case 4111:if(!(Number.isFinite(n[0])&&Number.isFinite(n[1])&&Number.isFinite(n[2])&&Number.isFinite(n[3])&&Number.isFinite(n[4])&&Number.isFinite(n[5])))return void(jt.currentCtx.err=40963);i.direction[0]=n[0],i.direction[1]=n[1],i.direction[2]=n[2],i.up[0]=n[3],i.up[1]=n[4],i.up[2]=n[5],jt.updateListenerSpace(jt.currentCtx);break;default:return void(jt.currentCtx.err=40962)}}},getBufferParam:function(e,t,n){if(jt.currentCtx){var i=jt.buffers[t];if(!i||0===t)return void(jt.currentCtx.err=40961);switch(n){case 8193:return i.frequency;case 8194:return 8*i.bytesPerSample;case 8195:return i.channels;case 8196:return i.length*i.bytesPerSample*i.channels;case 8213:return 0===i.length?[0,0]:[(i.audioBuf._loopStart||0)*i.frequency,(i.audioBuf._loopEnd||i.length)*i.frequency];default:return jt.currentCtx.err=40962,null}}},setBufferParam:function(e,t,n,i){if(jt.currentCtx){var s=jt.buffers[t];if(!s||0===t)return void(jt.currentCtx.err=40961);if(null===i)return void(jt.currentCtx.err=40962);switch(n){case 8196:if(0!==i)return void(jt.currentCtx.err=40963);break;case 8213:if(i[0]<0||i[0]>s.length||i[1]<0||i[1]>s.Length||i[0]>=i[1])return void(jt.currentCtx.err=40963);if(s.refCount>0)return void(jt.currentCtx.err=40964);s.audioBuf&&(s.audioBuf._loopStart=i[0]/s.frequency,s.audioBuf._loopEnd=i[1]/s.frequency);break;default:return void(jt.currentCtx.err=40962)}}},getSourceParam:function(e,t,n){if(!jt.currentCtx)return null;var i=jt.currentCtx.sources[t];if(!i)return jt.currentCtx.err=40961,null;switch(n){case 514:return i.relative;case 4097:return i.coneInnerAngle;case 4098:return i.coneOuterAngle;case 4099:return i.pitch;case 4100:return i.position;case 4101:return i.direction;case 4102:return i.velocity;case 4103:return i.looping;case 4105:return 4136===i.type?i.bufQueue[0].id:0;case 4106:return i.gain.gain.value;case 4109:return i.minGain;case 4110:return i.maxGain;case 4112:return i.state;case 4117:return 1===i.bufQueue.length&&0===i.bufQueue[0].id?0:i.bufQueue.length;case 4118:return 1===i.bufQueue.length&&0===i.bufQueue[0].id||i.looping?0:i.bufsProcessed;case 4128:return i.refDistance;case 4129:return i.rolloffFactor;case 4130:return i.coneOuterGain;case 4131:return i.maxDistance;case 4132:return jt.sourceTell(i);case 4133:return(s=jt.sourceTell(i))>0&&(s*=i.bufQueue[0].frequency),s;case 4134:var s;return(s=jt.sourceTell(i))>0&&(s*=i.bufQueue[0].frequency*i.bufQueue[0].bytesPerSample),s;case 4135:return i.type;case 4628:return i.spatialize;case 8201:for(var o=0,r=0,a=0;a<i.bufQueue.length;a++)o+=i.bufQueue[a].length,0!==i.bufQueue[a].id&&(r=i.bufQueue[a].bytesPerSample*i.bufQueue[a].channels);return o*r;case 8202:for(o=0,a=0;a<i.bufQueue.length;a++)o+=i.bufQueue[a].length;return o;case 8203:return jt.sourceDuration(i);case 53248:return i.distanceModel;default:return jt.currentCtx.err=40962,null}},setSourceParam:function(e,t,n,i){if(jt.currentCtx){var s=jt.currentCtx.sources[t];if(!s)return void(jt.currentCtx.err=40961);if(null===i)return void(jt.currentCtx.err=40962);switch(n){case 514:if(1===i)s.relative=!0,jt.updateSourceSpace(s);else{if(0!==i)return void(jt.currentCtx.err=40963);s.relative=!1,jt.updateSourceSpace(s)}break;case 4097:if(!Number.isFinite(i))return void(jt.currentCtx.err=40963);s.coneInnerAngle=i,s.panner&&(s.panner.coneInnerAngle=i%360);break;case 4098:if(!Number.isFinite(i))return void(jt.currentCtx.err=40963);s.coneOuterAngle=i,s.panner&&(s.panner.coneOuterAngle=i%360);break;case 4099:if(!Number.isFinite(i)||i<=0)return void(jt.currentCtx.err=40963);if(s.pitch===i)break;s.pitch=i,jt.updateSourceRate(s);break;case 4100:if(!Number.isFinite(i[0])||!Number.isFinite(i[1])||!Number.isFinite(i[2]))return void(jt.currentCtx.err=40963);s.position[0]=i[0],s.position[1]=i[1],s.position[2]=i[2],jt.updateSourceSpace(s);break;case 4101:if(!Number.isFinite(i[0])||!Number.isFinite(i[1])||!Number.isFinite(i[2]))return void(jt.currentCtx.err=40963);s.direction[0]=i[0],s.direction[1]=i[1],s.direction[2]=i[2],jt.updateSourceSpace(s);break;case 4102:if(!Number.isFinite(i[0])||!Number.isFinite(i[1])||!Number.isFinite(i[2]))return void(jt.currentCtx.err=40963);s.velocity[0]=i[0],s.velocity[1]=i[1],s.velocity[2]=i[2],jt.updateSourceSpace(s);break;case 4103:if(1===i)s.looping=!0,jt.updateSourceTime(s),4136===s.type&&s.audioQueue.length>0&&((o=s.audioQueue[0]).loop=!0,o._duration=Number.POSITIVE_INFINITY);else{if(0!==i)return void(jt.currentCtx.err=40963);s.looping=!1;var o,r=jt.updateSourceTime(s);4136===s.type&&s.audioQueue.length>0&&((o=s.audioQueue[0]).loop=!1,o._duration=s.bufQueue[0].audioBuf.duration/s.playbackRate,o._startTime=r-s.bufOffset/s.playbackRate)}break;case 4105:if(4114===s.state||4115===s.state)return void(jt.currentCtx.err=40964);if(0===i){for(var a in s.bufQueue)s.bufQueue[a].refCount--;s.bufQueue.length=1,s.bufQueue[0]=jt.buffers[0],s.bufsProcessed=0,s.type=4144}else{if(!(h=jt.buffers[i]))return void(jt.currentCtx.err=40963);for(var a in s.bufQueue)s.bufQueue[a].refCount--;s.bufQueue.length=0,h.refCount++,s.bufQueue=[h],s.bufsProcessed=0,s.type=4136}jt.initSourcePanner(s),jt.scheduleSourceAudio(s);break;case 4106:if(!Number.isFinite(i)||i<0)return void(jt.currentCtx.err=40963);s.gain.gain.value=i;break;case 4109:if(!Number.isFinite(i)||i<0||i>Math.min(s.maxGain,1))return void(jt.currentCtx.err=40963);s.minGain=i;break;case 4110:if(!Number.isFinite(i)||i<Math.max(0,s.minGain)||i>1)return void(jt.currentCtx.err=40963);s.maxGain=i;break;case 4128:if(!Number.isFinite(i)||i<0)return void(jt.currentCtx.err=40963);s.refDistance=i,s.panner&&(s.panner.refDistance=i);break;case 4129:if(!Number.isFinite(i)||i<0)return void(jt.currentCtx.err=40963);s.rolloffFactor=i,s.panner&&(s.panner.rolloffFactor=i);break;case 4130:if(!Number.isFinite(i)||i<0||i>1)return void(jt.currentCtx.err=40963);s.coneOuterGain=i,s.panner&&(s.panner.coneOuterGain=i);break;case 4131:if(!Number.isFinite(i)||i<0)return void(jt.currentCtx.err=40963);s.maxDistance=i,s.panner&&(s.panner.maxDistance=i);break;case 4132:if(i<0||i>jt.sourceDuration(s))return void(jt.currentCtx.err=40963);jt.sourceSeek(s,i);break;case 4133:if((d=jt.sourceDuration(s))>0){var c;for(var l in s.bufQueue)if(l){c=s.bufQueue[l].frequency;break}i/=c}if(i<0||i>d)return void(jt.currentCtx.err=40963);jt.sourceSeek(s,i);break;case 4134:var d;if((d=jt.sourceDuration(s))>0){var u;for(var l in s.bufQueue)if(l){var h;u=(h=s.bufQueue[l]).frequency*h.bytesPerSample*h.channels;break}i/=u}if(i<0||i>d)return void(jt.currentCtx.err=40963);jt.sourceSeek(s,i);break;case 4628:if(0!==i&&1!==i&&2!==i)return void(jt.currentCtx.err=40963);s.spatialize=i,jt.initSourcePanner(s);break;case 8201:case 8202:case 8203:jt.currentCtx.err=40964;break;case 53248:switch(i){case 0:case 53249:case 53250:case 53251:case 53252:case 53253:case 53254:s.distanceModel=i,jt.currentCtx.sourceDistanceModel&&jt.updateContextGlobal(jt.currentCtx);break;default:return void(jt.currentCtx.err=40963)}break;default:return void(jt.currentCtx.err=40962)}}},captures:{},sharedCaptureAudioCtx:null,requireValidCaptureDevice:function(e,t){if(0===e)return jt.alcErr=40961,null;var n=jt.captures[e];return n?n.mediaStreamError?(jt.alcErr=40961,null):n:(jt.alcErr=40961,null)}};function Vt(e,t,n){switch(t){case 514:case 4097:case 4098:case 4103:case 4105:case 4128:case 4129:case 4131:case 4132:case 4133:case 4134:case 4628:case 8201:case 8202:case 53248:jt.setSourceParam("alSourcei",e,t,n);break;default:jt.setSourceParam("alSourcei",e,t,null)}}function Gt(e,t){t||(t=[document,document.getElementById("canvas")]),["keydown","mousedown","touchstart"].forEach((function(n){t.forEach((function(t){t&&function(e,t,n){e.addEventListener(t,n,{once:!0})}(t,n,(()=>{"suspended"===e.state&&e.resume()}))}))}))}function qt(e){try{return p.grow(e-f.byteLength+65535>>>16),$(p.buffer),1}catch{}}var Ht={};function zt(){if(!zt.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:r||"./this.program"};for(var t in Ht)void 0===Ht[t]?delete e[t]:e[t]=Ht[t];var n=[];for(var t in e)n.push(t+"="+e[t]);zt.strings=n}return zt.strings}function Wt(e){for(var t=e.split("."),n=0;n<4;n++){var i=Number(t[n]);if(isNaN(i))return null;t[n]=i}return(t[0]|t[1]<<8|t[2]<<16|t[3]<<24)>>>0}function Jt(e){return parseInt(e)}function Yt(e){var t,n,i,s,o=[];if(!/^((?=.*::)(?!.*::.+::)(::)?([\dA-F]{1,4}:(:|\b)|){5}|([\dA-F]{1,4}:){6})((([\dA-F]{1,4}((?!\3)::|:\b|$))|(?!\2\3)){2}|(((2[0-4]|1\d|[1-9])?\d|25[0-5])\.?\b){4})$/i.test(e))return null;if("::"===e)return[0,0,0,0,0,0,0,0];for((e=e.startsWith("::")?e.replace("::","Z:"):e.replace("::",":Z:")).indexOf(".")>0?((t=(e=e.replace(new RegExp("[.]","g"),":")).split(":"))[t.length-4]=Jt(t[t.length-4])+256*Jt(t[t.length-3]),t[t.length-3]=Jt(t[t.length-2])+256*Jt(t[t.length-1]),t=t.slice(0,t.length-2)):t=e.split(":"),i=0,s=0,n=0;n<t.length;n++)if("string"==typeof t[n])if("Z"===t[n]){for(s=0;s<8-t.length+1;s++)o[n+s]=0;i=s-1}else o[n+i]=En(parseInt(t[n],16));else o[n+i]=t[n];return[o[1]<<16|o[0],o[3]<<16|o[2],o[5]<<16|o[4],o[7]<<16|o[6]]}var Kt={address_map:{id:1,addrs:{},names:{}},lookup_name:function(e){var t,n=Wt(e);if(null!==n||null!==(n=Yt(e)))return e;if(Kt.address_map.addrs[e])t=Kt.address_map.addrs[e];else{var i=Kt.address_map.id++;g(i<65535,"exceeded max address mappings of 65535"),t="172.29."+(255&i)+"."+(65280&i),Kt.address_map.names[t]=e,Kt.address_map.addrs[e]=t}return t},lookup_addr:function(e){return Kt.address_map.names[e]?Kt.address_map.names[e]:null}};function Xt(e){return(255&e)+"."+(e>>8&255)+"."+(e>>16&255)+"."+(e>>24&255)}var Zt={counter:1,buffers:[],programs:[],framebuffers:[],renderbuffers:[],textures:[],shaders:[],vaos:[],contexts:[],offscreenCanvases:{},queries:[],samplers:[],transformFeedbacks:[],syncs:[],stringCache:{},stringiCache:{},unpackAlignment:4,recordError:function(e){Zt.lastError||(Zt.lastError=e)},getNewId:function(e){for(var t=Zt.counter++,n=e.length;n<t;n++)e[n]=null;return t},getSource:function(e,t,n,i){for(var s="",o=0;o<t;++o){var r=i?C[i+4*o>>2]:-1;s+=T(C[n+4*o>>2],r<0?void 0:r)}return s},createContext:function(e,t){if(!e.getContextSafariWebGL2Fixed){let t=function(t,n){var i=e.getContextSafariWebGL2Fixed(t,n);return"webgl"==t==i instanceof WebGLRenderingContext?i:null};e.getContextSafariWebGL2Fixed=e.getContext,e.getContext=t}var n=t.majorVersion>1?e.getContext("webgl2",t):e.getContext("webgl",t);return n?Zt.registerContext(n,t):0},registerContext:function(e,t){var n=Zt.getNewId(Zt.contexts),i={handle:n,attributes:t,version:t.majorVersion,GLctx:e};return e.canvas&&(e.canvas.GLctxObject=i),Zt.contexts[n]=i,(void 0===t.enableExtensionsByDefault||t.enableExtensionsByDefault)&&Zt.initExtensions(i),n},makeContextCurrent:function(t){return Zt.currentContext=Zt.contexts[t],e.ctx=mn=Zt.currentContext&&Zt.currentContext.GLctx,!(t&&!mn)},getContext:function(e){return Zt.contexts[e]},deleteContext:function(e){Zt.currentContext===Zt.contexts[e]&&(Zt.currentContext=null),"object"==typeof JSEvents&&JSEvents.removeAllHandlersOnTarget(Zt.contexts[e].GLctx.canvas),Zt.contexts[e]&&Zt.contexts[e].GLctx.canvas&&(Zt.contexts[e].GLctx.canvas.GLctxObject=void 0),Zt.contexts[e]=null},initExtensions:function(e){if(e||(e=Zt.currentContext),!e.initExtensionsDone){e.initExtensionsDone=!0;var t=e.GLctx;(function(e){var t=e.getExtension("ANGLE_instanced_arrays");t&&(e.vertexAttribDivisor=function(e,n){t.vertexAttribDivisorANGLE(e,n)},e.drawArraysInstanced=function(e,n,i,s){t.drawArraysInstancedANGLE(e,n,i,s)},e.drawElementsInstanced=function(e,n,i,s,o){t.drawElementsInstancedANGLE(e,n,i,s,o)})})(t),function(e){var t=e.getExtension("OES_vertex_array_object");t&&(e.createVertexArray=function(){return t.createVertexArrayOES()},e.deleteVertexArray=function(e){t.deleteVertexArrayOES(e)},e.bindVertexArray=function(e){t.bindVertexArrayOES(e)},e.isVertexArray=function(e){return t.isVertexArrayOES(e)})}(t),function(e){var t=e.getExtension("WEBGL_draw_buffers");t&&(e.drawBuffers=function(e,n){t.drawBuffersWEBGL(e,n)})}(t),function(e){e.dibvbi=e.getExtension("WEBGL_draw_instanced_base_vertex_base_instance")}(t),function(e){e.mdibvbi=e.getExtension("WEBGL_multi_draw_instanced_base_vertex_base_instance")}(t),e.version>=2&&(t.disjointTimerQueryExt=t.getExtension("EXT_disjoint_timer_query_webgl2")),(e.version<2||!t.disjointTimerQueryExt)&&(t.disjointTimerQueryExt=t.getExtension("EXT_disjoint_timer_query")),function(e){e.multiDrawWebgl=e.getExtension("WEBGL_multi_draw")}(t),(t.getSupportedExtensions()||[]).forEach((function(e){!e.includes("lose_context")&&!e.includes("debug")&&t.getExtension(e)}))}}},Qt=[];function en(e,t,n,i){for(var s=0;s<e;s++){var o=mn[n](),r=o&&Zt.getNewId(i);o?(o.name=r,i[r]=o):Zt.recordError(1282),C[t+4*s>>2]=r}}function tn(e){return"]"==e.slice(-1)&&e.lastIndexOf("[")}function nn(e){return 0==(e-=5120)?v:1==e?b:2==e?_:4==e?C:6==e?E:5==e||28922==e||28520==e||30779==e||30782==e?S:y}function sn(e){return 31-Math.clz32(e.BYTES_PER_ELEMENT)}function on(e,t,n,i,s,o){var r=nn(e),a=sn(r),c=1<<a,l=function(e){return{5:3,6:4,8:2,29502:3,29504:4,26917:2,26918:2,29846:3,29847:4}[e-6402]||1}(t)*c,d=function(e,t,n,i){var s=function(e,t){return e+t-1&-t}(e*n,i);return t*s}(n,i,l,Zt.unpackAlignment);return r.subarray(s>>a,s+d>>a)}function rn(e){var t=mn.currentProgram;if(t){var n=t.uniformLocsById[e];return"number"==typeof n&&(t.uniformLocsById[e]=n=mn.getUniformLocation(t,t.uniformArrayNamesById[e]+(n>0?"["+n+"]":""))),n}Zt.recordError(1282)}var an=[],cn=[31,29,31,30,31,30,31,31,30,31,30,31],ln=[31,28,31,30,31,30,31,31,30,31,30,31];function dn(e,t,n,i){var s=C[i+40>>2],o={tm_sec:C[i>>2],tm_min:C[i+4>>2],tm_hour:C[i+8>>2],tm_mday:C[i+12>>2],tm_mon:C[i+16>>2],tm_year:C[i+20>>2],tm_wday:C[i+24>>2],tm_yday:C[i+28>>2],tm_isdst:C[i+32>>2],tm_gmtoff:C[i+36>>2],tm_zone:s?T(s):""},r=T(n),a={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var c in a)r=r.replace(new RegExp(c,"g"),a[c]);var l=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],d=["January","February","March","April","May","June","July","August","September","October","November","December"];function u(e,t,n){for(var i="number"==typeof e?e.toString():e||"";i.length<t;)i=n[0]+i;return i}function h(e,t){return u(e,t,"0")}function p(e,t){function n(e){return e<0?-1:e>0?1:0}var i;return 0===(i=n(e.getFullYear()-t.getFullYear()))&&0===(i=n(e.getMonth()-t.getMonth()))&&(i=n(e.getDate()-t.getDate())),i}function m(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function w(e){var t=function(e,t){for(var n=new Date(e.getTime());t>0;){var i=Rt(n.getFullYear()),s=n.getMonth(),o=(i?cn:ln)[s];if(!(t>o-n.getDate()))return n.setDate(n.getDate()+t),n;t-=o-n.getDate()+1,n.setDate(1),s<11?n.setMonth(s+1):(n.setMonth(0),n.setFullYear(n.getFullYear()+1))}return n}(new Date(e.tm_year+1900,0,1),e.tm_yday),n=new Date(t.getFullYear(),0,4),i=new Date(t.getFullYear()+1,0,4),s=m(n),o=m(i);return p(s,t)<=0?p(o,t)<=0?t.getFullYear()+1:t.getFullYear():t.getFullYear()-1}var g={"%a":function(e){return l[e.tm_wday].substring(0,3)},"%A":function(e){return l[e.tm_wday]},"%b":function(e){return d[e.tm_mon].substring(0,3)},"%B":function(e){return d[e.tm_mon]},"%C":function(e){return h((e.tm_year+1900)/100|0,2)},"%d":function(e){return h(e.tm_mday,2)},"%e":function(e){return u(e.tm_mday,2," ")},"%g":function(e){return w(e).toString().substring(2)},"%G":function(e){return w(e)},"%H":function(e){return h(e.tm_hour,2)},"%I":function(e){var t=e.tm_hour;return 0==t?t=12:t>12&&(t-=12),h(t,2)},"%j":function(e){return h(e.tm_mday+function(e,t){for(var n=0,i=0;i<=t;n+=e[i++]);return n}(Rt(e.tm_year+1900)?cn:ln,e.tm_mon-1),3)},"%m":function(e){return h(e.tm_mon+1,2)},"%M":function(e){return h(e.tm_min,2)},"%n":function(){return"\n"},"%p":function(e){return e.tm_hour>=0&&e.tm_hour<12?"AM":"PM"},"%S":function(e){return h(e.tm_sec,2)},"%t":function(){return"\t"},"%u":function(e){return e.tm_wday||7},"%U":function(e){var t=e.tm_yday+7-e.tm_wday;return h(Math.floor(t/7),2)},"%V":function(e){var t=Math.floor((e.tm_yday+7-(e.tm_wday+6)%7)/7);if((e.tm_wday+371-e.tm_yday-2)%7<=2&&t++,t){if(53==t){var n=(e.tm_wday+371-e.tm_yday)%7;4!=n&&(3!=n||!Rt(e.tm_year))&&(t=1)}}else{t=52;var i=(e.tm_wday+7-e.tm_yday-1)%7;(4==i||5==i&&Rt(e.tm_year%400-1))&&t++}return h(t,2)},"%w":function(e){return e.tm_wday},"%W":function(e){var t=e.tm_yday+7-(e.tm_wday+6)%7;return h(Math.floor(t/7),2)},"%y":function(e){return(e.tm_year+1900).toString().substring(2)},"%Y":function(e){return e.tm_year+1900},"%z":function(e){var t=e.tm_gmtoff,n=t>=0;return t=(t=Math.abs(t)/60)/60*100+t%60,(n?"+":"-")+String("0000"+t).slice(-4)},"%Z":function(e){return e.tm_zone},"%%":function(){return"%"}};for(var c in r=r.replace(/%%/g,"\0\0"),g)r.includes(c)&&(r=r.replace(new RegExp(c,"g"),g[c](o)));var f=te(r=r.replace(/\0\0/g,"%"),!1);return f.length>t?0:(function(e,t){v.set(e,t)}(f,e),f.length-1)}var un=function(e,t,n,i){e||(e=this),this.parent=e,this.mount=e.mount,this.mounted=null,this.id=re.nextInode++,this.name=t,this.mode=n,this.node_ops={},this.stream_ops={},this.rdev=i},hn=365,pn=146;Object.defineProperties(un.prototype,{read:{get:function(){return(this.mode&hn)===hn},set:function(e){e?this.mode|=hn:this.mode&=~hn}},write:{get:function(){return(this.mode&pn)===pn},set:function(e){e?this.mode|=pn:this.mode&=~pn}},isFolder:{get:function(){return re.isDir(this.mode)}},isDevice:{get:function(){return re.isChrdev(this.mode)}}}),re.FSNode=un,re.staticInit(),e.FS_createPath=re.createPath,e.FS_createDataFile=re.createDataFile,e.FS_createPreloadedFile=re.createPreloadedFile,e.FS_unlink=re.unlink,e.FS_createLazyFile=re.createLazyFile,e.FS_createDevice=re.createDevice,function(){for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);ue=e}(),ye=e.BindingError=_e(Error,"BindingError"),Se=e.InternalError=_e(Error,"InternalError"),Ue.prototype.isAliasOf=function(e){if(!(this instanceof Ue&&e instanceof Ue))return!1;for(var t=this.$$.ptrType.registeredClass,n=this.$$.ptr,i=e.$$.ptrType.registeredClass,s=e.$$.ptr;t.baseClass;)n=t.upcast(n),t=t.baseClass;for(;i.baseClass;)s=i.upcast(s),i=i.baseClass;return t===i&&n===s},Ue.prototype.clone=function(){if(this.$$.ptr||Te(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var e=Fe(Object.create(Object.getPrototypeOf(this),{$$:{value:Me(this.$$)}}));return e.$$.count.value+=1,e.$$.deleteScheduled=!1,e},Ue.prototype.delete=function(){this.$$.ptr||Te(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Ce("Object already scheduled for deletion"),Re(this),Ae(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},Ue.prototype.isDeleted=function(){return!this.$$.ptr},Ue.prototype.deleteLater=function(){return this.$$.ptr||Te(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Ce("Object already scheduled for deletion"),Pe.push(this),1===Pe.length&&Ne&&Ne(De),this.$$.deleteScheduled=!0,this},e.getInheritedInstanceCount=function(){return Object.keys(Oe).length},e.getLiveInheritedInstances=function(){var e=[];for(var t in Oe)Oe.hasOwnProperty(t)&&e.push(Oe[t]);return e},e.flushPendingDeletes=De,e.setDelayFunction=function(e){Ne=e,Pe.length&&Ne&&Ne(De)},Ye.prototype.getPointee=function(e){return this.rawGetPointee&&(e=this.rawGetPointee(e)),e},Ye.prototype.destructor=function(e){this.rawDestructor&&this.rawDestructor(e)},Ye.prototype.argPackAdvance=8,Ye.prototype.readValueFromPointer=Je,Ye.prototype.deleteObject=function(e){null!==e&&e.delete()},Ye.prototype.fromWireType=function(e){var t=this.getPointee(e);if(!t)return this.destructor(e),null;var n=function(e,t){return t=function(e,t){for(void 0===t&&Ce("ptr should not be undefined");e.baseClass;)t=e.upcast(t),e=e.baseClass;return t}(e,t),Oe[t]}(this.registeredClass,t);if(void 0!==n){if(0===n.$$.count.value)return n.$$.ptr=t,n.$$.smartPtr=e,n.clone();var i=n.clone();return this.destructor(e),i}function s(){return this.isSmartPointer?Be(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:t,smartPtrType:this,smartPtr:e}):Be(this.registeredClass.instancePrototype,{ptrType:this,ptr:e})}var o,r=this.registeredClass.getActualType(t),a=Le[r];if(!a)return s.call(this);o=this.isConst?a.constPointerType:a.pointerType;var c=$e(t,this.registeredClass,o.registeredClass);return null===c?s.call(this):this.isSmartPointer?Be(o.registeredClass.instancePrototype,{ptrType:o,ptr:c,smartPtrType:this,smartPtr:e}):Be(o.registeredClass.instancePrototype,{ptrType:o,ptr:c})},et=e.UnboundTypeError=_e(Error,"UnboundTypeError"),e.count_emval_handles=function(){for(var e=0,t=5;t<lt.length;++t)void 0!==lt[t]&&++e;return e},e.get_first_emval=function(){for(var e=5;e<lt.length;++e)if(void 0!==lt[e])return lt[e];return null},e.requestFullscreen=function(e,t){Ut.requestFullscreen(e,t)},e.requestAnimationFrame=function(e){Ut.requestAnimationFrame(e)},e.setCanvasSize=function(e,t,n){Ut.setCanvasSize(e,t,n)},e.pauseMainLoop=function(){Ut.mainLoop.pause()},e.resumeMainLoop=function(){Ut.mainLoop.resume()},e.getUserMedia=function(){Ut.getUserMedia()},e.createContext=function(e,t,n,i){return Ut.createContext(e,t,n,i)};for(var mn,wn=0;wn<32;++wn)Qt.push(new Array(wn));var gn=new Float32Array(288);for(wn=0;wn<288;++wn)an[wn]=gn.subarray(0,wn+1);var fn={__cxa_allocate_exception:function(e){return vn(e+24)+24},__cxa_throw:function(e,t,n){throw new X(e).init(t,n),e},__syscall_chmod:function(e,t){try{return e=ae.getStr(e),re.chmod(e,t),0}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return-e.errno}},__syscall_fchmod:function(e,t){try{return re.fchmod(e,t),0}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return-e.errno}},__syscall_fcntl64:function(e,t,n){ae.varargs=n;try{var i=ae.getStreamFromFD(e);switch(t){case 0:return(s=ae.get())<0?-28:re.createStream(i,s).fd;case 1:case 2:case 6:case 7:return 0;case 3:return i.flags;case 4:var s=ae.get();return i.flags|=s,0;case 5:return s=ae.get(),_[s+0>>1]=2,0;case 16:case 8:default:return-28;case 9:return C[bn()>>2]=28,-1}}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return-e.errno}},__syscall_fstat64:function(e,t){try{var n=ae.getStreamFromFD(e);return ae.doStat(re.stat,n.path,t)}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return-e.errno}},__syscall_ftruncate64:function(e,t,n){try{var i=ce(t,n);return isNaN(i)?-61:(re.ftruncate(e,i),0)}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return-e.errno}},__syscall_getcwd:function(e,t){try{if(0===t)return-28;var n=re.cwd(),i=A(n)+1;return t<i?-68:(R(n,e,t),i)}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return-e.errno}},__syscall_getdents64:function(e,t,n){try{var i=ae.getStreamFromFD(e);i.getdents||(i.getdents=re.readdir(i.path));for(var s=280,o=0,r=re.llseek(i,0,1),a=Math.floor(r/s);a<i.getdents.length&&o+s<=n;){var c,l,d=i.getdents[a];if("."===d)c=i.node.id,l=4;else if(".."===d)c=re.lookupPath(i.path,{parent:!0}).node.id,l=4;else{var u=re.lookupNode(i.node,d);c=u.id,l=re.isChrdev(u.mode)?2:re.isDir(u.mode)?4:re.isLink(u.mode)?10:8}z=[c>>>0,(H=c,+Math.abs(H)>=1?H>0?(0|Math.min(+Math.floor(H/4294967296),4294967295))>>>0:~~+Math.ceil((H-+(~~H>>>0))/4294967296)>>>0:0)],C[t+o>>2]=z[0],C[t+o+4>>2]=z[1],z=[(a+1)*s>>>0,(H=(a+1)*s,+Math.abs(H)>=1?H>0?(0|Math.min(+Math.floor(H/4294967296),4294967295))>>>0:~~+Math.ceil((H-+(~~H>>>0))/4294967296)>>>0:0)],C[t+o+8>>2]=z[0],C[t+o+12>>2]=z[1],_[t+o+16>>1]=280,v[t+o+18>>0]=l,R(d,t+o+19,256),o+=s,a+=1}return re.llseek(i,a*s,0),o}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return-e.errno}},__syscall_ioctl:function(e,t,n){ae.varargs=n;try{var i=ae.getStreamFromFD(e);switch(t){case 21509:case 21505:case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:case 21523:case 21524:return i.tty?0:-59;case 21519:if(!i.tty)return-59;var s=ae.get();return C[s>>2]=0,0;case 21520:return i.tty?-28:-59;case 21531:return s=ae.get(),re.ioctl(i,t,s);default:return-28}}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return-e.errno}},__syscall_lstat64:function(e,t){try{return e=ae.getStr(e),ae.doStat(re.lstat,e,t)}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return-e.errno}},__syscall_mkdirat:function(e,t,n){try{return t=ae.getStr(t),t=ae.calculateAt(e,t),"/"===(t=Z.normalize(t))[t.length-1]&&(t=t.substr(0,t.length-1)),re.mkdir(t,n,0),0}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return-e.errno}},__syscall_newfstatat:function(e,t,n,i){try{t=ae.getStr(t);var s=256&i,o=4096&i;return i&=-4353,t=ae.calculateAt(e,t,o),ae.doStat(s?re.lstat:re.stat,t,n)}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return-e.errno}},__syscall_openat:function(e,t,n,i){ae.varargs=i;try{t=ae.getStr(t),t=ae.calculateAt(e,t);var s=i?ae.get():0;return re.open(t,n,s).fd}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return-e.errno}},__syscall_readlinkat:function(e,t,n,i){try{if(t=ae.getStr(t),t=ae.calculateAt(e,t),i<=0)return-28;var s=re.readlink(t),o=Math.min(i,A(s)),r=v[n+o];return R(s,n,i+1),v[n+o]=r,o}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return-e.errno}},__syscall_renameat:function(e,t,n,i){try{return t=ae.getStr(t),i=ae.getStr(i),t=ae.calculateAt(e,t),i=ae.calculateAt(n,i),re.rename(t,i),0}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return-e.errno}},__syscall_stat64:function(e,t){try{return e=ae.getStr(e),ae.doStat(re.stat,e,t)}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return-e.errno}},__syscall_symlink:function(e,t){try{return e=ae.getStr(e),t=ae.getStr(t),re.symlink(e,t),0}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return-e.errno}},__syscall_unlinkat:function(e,t,n){try{return t=ae.getStr(t),t=ae.calculateAt(e,t),0===n?re.unlink(t):512===n?re.rmdir(t):G("Invalid flags passed to unlinkat"),0}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return-e.errno}},_dlinit:function(e){},_dlopen_js:function(e,t){G(le)},_dlsym_js:function(e,t){G(le)},_embind_register_bigint:function(e,t,n,i,s){},_embind_register_bool:function(e,t,n,i,s){var o=de(n);ke(e,{name:t=he(t),fromWireType:function(e){return!!e},toWireType:function(e,t){return t?i:s},argPackAdvance:8,readValueFromPointer:function(e){var i;if(1===n)i=v;else if(2===n)i=_;else{if(4!==n)throw new TypeError("Unknown boolean type size: "+t);i=C}return this.fromWireType(i[e>>o])},destructorFunction:null})},_embind_register_class:function(e,t,n,i,s,o,r,a,c,l,d,u,h){d=he(d),o=Qe(s,o),a&&(a=Qe(r,a)),l&&(l=Qe(c,l)),h=Qe(u,h);var p=ve(d);Ve(p,(function(){nt("Cannot construct "+d+" due to unbound types",[i])})),xe([e,t,n],i?[i]:[],(function(t){var n,s;t=t[0],s=i?(n=t.registeredClass).instancePrototype:Ue.prototype;var r=be(p,(function(){if(Object.getPrototypeOf(this)!==c)throw new ye("Use 'new' to construct "+d);if(void 0===u.constructor_body)throw new ye(d+" has no accessible constructor");var e=u.constructor_body[arguments.length];if(void 0===e)throw new ye("Tried to invoke ctor of "+d+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(u.constructor_body).toString()+") parameters instead!");return e.apply(this,arguments)})),c=Object.create(s,{constructor:{value:r}});r.prototype=c;var u=new Ge(d,r,c,h,n,o,a,l),m=new Ye(d,u,!0,!1,!1),w=new Ye(d+"*",u,!1,!1,!1),g=new Ye(d+" const*",u,!1,!0,!1);return Le[e]={pointerType:w,constPointerType:g},Ke(p,r),[m,w,g]}))},_embind_register_class_class_function:function(e,t,n,i,s,o,r){var a=rt(n,i);t=he(t),o=Qe(s,o),xe([],[e],(function(e){var i=(e=e[0]).name+"."+t;function s(){nt("Cannot call "+i+" due to unbound types",a)}t.startsWith("@@")&&(t=Symbol[t.substring(2)]);var c=e.registeredClass.constructor;return void 0===c[t]?(s.argCount=n-1,c[t]=s):(je(c,t,i),c[t].overloadTable[n-1]=s),xe([],a,(function(e){var s=[e[0],null].concat(e.slice(1)),a=ot(i,s,null,o,r);return void 0===c[t].overloadTable?(a.argCount=n-1,c[t]=a):c[t].overloadTable[n-1]=a,[]})),[]}))},_embind_register_class_constructor:function(e,t,n,i,s,o){g(t>0);var r=rt(t,n);s=Qe(i,s),xe([],[e],(function(e){var n="constructor "+(e=e[0]).name;if(void 0===e.registeredClass.constructor_body&&(e.registeredClass.constructor_body=[]),void 0!==e.registeredClass.constructor_body[t-1])throw new ye("Cannot register multiple constructors with identical number of parameters ("+(t-1)+") for class '"+e.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return e.registeredClass.constructor_body[t-1]=()=>{nt("Cannot construct "+e.name+" due to unbound types",r)},xe([],r,(function(i){return i.splice(1,0,null),e.registeredClass.constructor_body[t-1]=ot(n,i,null,s,o),[]})),[]}))},_embind_register_class_function:function(e,t,n,i,s,o,r,a){var c=rt(n,i);t=he(t),o=Qe(s,o),xe([],[e],(function(e){var i=(e=e[0]).name+"."+t;function s(){nt("Cannot call "+i+" due to unbound types",c)}t.startsWith("@@")&&(t=Symbol[t.substring(2)]),a&&e.registeredClass.pureVirtualFunctions.push(t);var l=e.registeredClass.instancePrototype,d=l[t];return void 0===d||void 0===d.overloadTable&&d.className!==e.name&&d.argCount===n-2?(s.argCount=n-2,s.className=e.name,l[t]=s):(je(l,t,i),l[t].overloadTable[n-2]=s),xe([],c,(function(s){var a=ot(i,s,e,o,r);return void 0===l[t].overloadTable?(a.argCount=n-2,l[t]=a):l[t].overloadTable[n-2]=a,[]})),[]}))},_embind_register_class_property:function(e,t,n,i,s,o,r,a,c,l){t=he(t),s=Qe(i,s),xe([],[e],(function(e){var i=(e=e[0]).name+"."+t,d={get:function(){nt("Cannot access "+i+" due to unbound types",[n,r])},enumerable:!0,configurable:!0};return d.set=c?()=>{nt("Cannot access "+i+" due to unbound types",[n,r])}:e=>{Ce(i+" is a read-only property")},Object.defineProperty(e.registeredClass.instancePrototype,t,d),xe([],c?[n,r]:[n],(function(n){var r=n[0],d={get:function(){var t=at(this,e,i+" getter");return r.fromWireType(s(o,t))},enumerable:!0};if(c){c=Qe(a,c);var u=n[1];d.set=function(t){var n=at(this,e,i+" setter"),s=[];c(l,n,u.toWireType(s,t)),st(s)}}return Object.defineProperty(e.registeredClass.instancePrototype,t,d),[]})),[]}))},_embind_register_emval:function(e,t){ke(e,{name:t=he(t),fromWireType:function(e){var t=ut.toValue(e);return dt(e),t},toWireType:function(e,t){return ut.toHandle(t)},argPackAdvance:8,readValueFromPointer:Je,destructorFunction:null})},_embind_register_enum:function(e,t,n,i){var s=de(n);function o(){}t=he(t),o.values={},ke(e,{name:t,constructor:o,fromWireType:function(e){return this.constructor.values[e]},toWireType:function(e,t){return t.value},argPackAdvance:8,readValueFromPointer:ht(t,s,i),destructorFunction:null}),Ve(t,o)},_embind_register_enum_value:function(e,t,n){var i=pt(e,"enum");t=he(t);var s=i.constructor,o=Object.create(i.constructor.prototype,{value:{value:n},constructor:{value:be(i.name+"_"+t,(function(){}))}});s.values[n]=o,s[t]=o},_embind_register_float:function(e,t,n){var i=de(n);ke(e,{name:t=he(t),fromWireType:function(e){return e},toWireType:function(e,t){return t},argPackAdvance:8,readValueFromPointer:wt(t,i),destructorFunction:null})},_embind_register_function:function(e,t,n,i,s,o){var r=rt(t,n);e=he(e),s=Qe(i,s),Ve(e,(function(){nt("Cannot call "+e+" due to unbound types",r)}),t-1),xe([],r,(function(n){var i=[n[0],null].concat(n.slice(1));return Ke(e,ot(e,i,null,s,o),t-1),[]}))},_embind_register_integer:function(e,t,n,i,s){t=he(t);var o,r=de(n),a=e=>e;if(0===i){var c=32-8*n;a=e=>e<<c>>>c}o=t.includes("unsigned")?function(e,t){return t>>>0}:function(e,t){return t},ke(e,{name:t,fromWireType:a,toWireType:o,argPackAdvance:8,readValueFromPointer:gt(t,r,0!==i),destructorFunction:null})},_embind_register_memory_view:function(e,t,n){var i=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][t];function s(e){var t=S,n=t[e>>=2],s=t[e+1];return new i(f,s,n)}ke(e,{name:n=he(n),fromWireType:s,argPackAdvance:8,readValueFromPointer:s},{ignoreDuplicateRegistrations:!0})},_embind_register_smart_ptr:function(e,t,n,i,s,o,r,a,c,l,d,u){n=he(n),o=Qe(s,o),a=Qe(r,a),l=Qe(c,l),u=Qe(d,u),xe([e],[t],(function(e){return e=e[0],[new Ye(n,e.registeredClass,!1,!1,!0,e,i,o,a,l,u)]}))},_embind_register_std_string:function(e,t){var n="std::string"===(t=he(t));ke(e,{name:t,fromWireType:function(e){var t,i=S[e>>2],s=e+4;if(n)for(var o=s,r=0;r<=i;++r){var a=s+r;if(r==i||0==b[a]){var c=T(o,a-o);void 0===t?t=c:(t+=String.fromCharCode(0),t+=c),o=a+1}}else{var l=new Array(i);for(r=0;r<i;++r)l[r]=String.fromCharCode(b[s+r]);t=l.join("")}return _n(e),t},toWireType:function(e,t){t instanceof ArrayBuffer&&(t=new Uint8Array(t));var i,s="string"==typeof t;s||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int8Array||Ce("Cannot pass non-string to std::string"),i=n&&s?A(t):t.length;var o=vn(4+i+1),r=o+4;if(S[o>>2]=i,n&&s)R(t,r,i+1);else if(s)for(var a=0;a<i;++a){var c=t.charCodeAt(a);c>255&&(_n(r),Ce("String has UTF-16 code units that do not fit in 8 bits")),b[r+a]=c}else for(a=0;a<i;++a)b[r+a]=t[a];return null!==e&&e.push(_n,o),o},argPackAdvance:8,readValueFromPointer:Je,destructorFunction:function(e){_n(e)}})},_embind_register_std_wstring:function(e,t,n){var i,s,o,r,a;n=he(n),2===t?(i=vt,s=bt,r=_t,o=()=>y,a=1):4===t&&(i=yt,s=Ct,r=St,o=()=>S,a=2),ke(e,{name:n,fromWireType:function(e){for(var n,s=S[e>>2],r=o(),c=e+4,l=0;l<=s;++l){var d=e+4+l*t;if(l==s||0==r[d>>a]){var u=i(c,d-c);void 0===n?n=u:(n+=String.fromCharCode(0),n+=u),c=d+t}}return _n(e),n},toWireType:function(e,i){"string"!=typeof i&&Ce("Cannot pass non-string to C++ string type "+n);var o=r(i),c=vn(4+o+t);return S[c>>2]=o>>a,s(i,c+4,o+t),null!==e&&e.push(_n,c),c},argPackAdvance:8,readValueFromPointer:Je,destructorFunction:function(e){_n(e)}})},_embind_register_void:function(e,t){ke(e,{isVoid:!0,name:t=he(t),argPackAdvance:0,fromWireType:function(){},toWireType:function(e,t){}})},_emscripten_get_now_is_monotonic:function(){return!0},_emval_as:function(e,t,n){e=ut.toValue(e),t=pt(t,"emval::as");var i=[],s=ut.toHandle(i);return S[n>>2]=s,t.toWireType(i,e)},_emval_call:function(e,t,n,i){e=ut.toValue(e);for(var s=Et(t,n),o=new Array(t),r=0;r<t;++r){var a=s[r];o[r]=a.readValueFromPointer(i),i+=a.argPackAdvance}var c=e.apply(void 0,o);return ut.toHandle(c)},_emval_call_void_method:function(e,t,n,i){(e=Mt[e])(t=ut.toValue(t),n=kt(n),null,i)},_emval_decref:dt,_emval_get_method_caller:function(e,t){var n=Et(e,t),i=n[0],s=i.name+"_$"+n.slice(1).map((function(e){return e.name})).join("_")+"$",o=Tt[s];if(void 0!==o)return o;for(var r=["retType"],a=[i],c="",l=0;l<e-1;++l)c+=(0!==l?", ":"")+"arg"+l,r.push("argType"+l),a.push(n[1+l]);var d="return function "+ve("methodCaller_"+s)+"(handle, name, destructors, args) {\n",u=0;for(l=0;l<e-1;++l)d+="    var arg"+l+" = argType"+l+".readValueFromPointer(args"+(u?"+"+u:"")+");\n",u+=n[l+1].argPackAdvance;for(d+="    var rv = handle[name]("+c+");\n",l=0;l<e-1;++l)n[l+1].deleteObject&&(d+="    argType"+l+".deleteObject(arg"+l+");\n");return i.isVoid||(d+="    return retType.toWireType(destructors, rv);\n"),d+="};\n",r.push(d),o=function(e){var t=Mt.length;return Mt.push(e),t}(it(Function,r).apply(null,a)),Tt[s]=o,o},_emval_get_module_property:function(t){return t=kt(t),ut.toHandle(e[t])},_emval_get_property:function(e,t){return e=ut.toValue(e),t=ut.toValue(t),ut.toHandle(e[t])},_emval_incref:function(e){e>4&&(lt[e].refcount+=1)},_emval_is_number:function(e){return"number"==typeof(e=ut.toValue(e))},_emval_new_cstring:function(e){return ut.toHandle(kt(e))},_emval_run_destructors:function(e){st(ut.toValue(e)),dt(e)},_emval_set_property:function(e,t,n){e=ut.toValue(e),t=ut.toValue(t),n=ut.toValue(n),e[t]=n},_emval_take_value:function(e,t){var n=(e=pt(e,"_emval_take_value")).readValueFromPointer(t);return ut.toHandle(n)},_gmtime_js:function(e,t){var n=new Date(1e3*It(e));C[t>>2]=n.getUTCSeconds(),C[t+4>>2]=n.getUTCMinutes(),C[t+8>>2]=n.getUTCHours(),C[t+12>>2]=n.getUTCDate(),C[t+16>>2]=n.getUTCMonth(),C[t+20>>2]=n.getUTCFullYear()-1900,C[t+24>>2]=n.getUTCDay();var i=Date.UTC(n.getUTCFullYear(),0,1,0,0,0,0),s=(n.getTime()-i)/864e5|0;C[t+28>>2]=s},_localtime_js:function(e,t){var n=new Date(1e3*It(e));C[t>>2]=n.getSeconds(),C[t+4>>2]=n.getMinutes(),C[t+8>>2]=n.getHours(),C[t+12>>2]=n.getDate(),C[t+16>>2]=n.getMonth(),C[t+20>>2]=n.getFullYear()-1900,C[t+24>>2]=n.getDay();var i=0|Pt(n);C[t+28>>2]=i,C[t+36>>2]=-60*n.getTimezoneOffset();var s=new Date(n.getFullYear(),0,1),o=new Date(n.getFullYear(),6,1).getTimezoneOffset(),r=s.getTimezoneOffset(),a=0|(o!=r&&n.getTimezoneOffset()==Math.min(r,o));C[t+32>>2]=a},_mktime_js:function(e){var t=new Date(C[e+20>>2]+1900,C[e+16>>2],C[e+12>>2],C[e+8>>2],C[e+4>>2],C[e>>2],0),n=C[e+32>>2],i=t.getTimezoneOffset(),s=new Date(t.getFullYear(),0,1),o=new Date(t.getFullYear(),6,1).getTimezoneOffset(),r=s.getTimezoneOffset(),a=Math.min(r,o);if(n<0)C[e+32>>2]=Number(o!=r&&a==i);else if(n>0!=(a==i)){var c=Math.max(r,o),l=n>0?a:c;t.setTime(t.getTime()+6e4*(l-i))}C[e+24>>2]=t.getDay();var d=0|Pt(t);return C[e+28>>2]=d,C[e>>2]=t.getSeconds(),C[e+4>>2]=t.getMinutes(),C[e+8>>2]=t.getHours(),C[e+12>>2]=t.getDate(),C[e+16>>2]=t.getMonth(),C[e+20>>2]=t.getYear(),t.getTime()/1e3|0},_mmap_js:function(e,t,n,i,s,o,r){try{var a=ae.getStreamFromFD(i),c=re.mmap(a,e,s,t,n),l=c.ptr;return C[o>>2]=c.allocated,S[r>>2]=l,0}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return-e.errno}},_munmap_js:function(e,t,n,i,s,o){try{var r=ae.getStreamFromFD(s);2&n&&ae.doMsync(e,r,t,i,o),re.munmap(r)}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return-e.errno}},_tzset_js:function(e,t,n){var i=(new Date).getFullYear(),s=new Date(i,0,1),o=new Date(i,6,1),r=s.getTimezoneOffset(),a=o.getTimezoneOffset(),c=Math.max(r,a);function l(e){var t=e.toTimeString().match(/\(([A-Za-z ]+)\)$/);return t?t[1]:"GMT"}S[e>>2]=60*c,C[t>>2]=Number(r!=a);var d=l(s),u=l(o),h=Dt(d),p=Dt(u);a<r?(S[n>>2]=h,S[n+4>>2]=p):(S[n>>2]=p,S[n+4>>2]=h)},abort:function(){G("")},alBufferData:function(e,t,n,i,s){if(jt.currentCtx){var o=jt.buffers[e];if(!o)return void(jt.currentCtx.err=40963);if(s<=0)return void(jt.currentCtx.err=40963);var r=null;try{switch(t){case 4352:if(i>0)for(var a=(r=jt.currentCtx.audioCtx.createBuffer(1,i,s)).getChannelData(0),c=0;c<i;++c)a[c]=.0078125*b[n++]-1;o.bytesPerSample=1,o.channels=1,o.length=i;break;case 4353:if(i>0)for(a=(r=jt.currentCtx.audioCtx.createBuffer(1,i>>1,s)).getChannelData(0),n>>=1,c=0;c<i>>1;++c)a[c]=30517578125e-15*_[n++];o.bytesPerSample=2,o.channels=1,o.length=i>>1;break;case 4354:if(i>0){a=(r=jt.currentCtx.audioCtx.createBuffer(2,i>>1,s)).getChannelData(0);var l=r.getChannelData(1);for(c=0;c<i>>1;++c)a[c]=.0078125*b[n++]-1,l[c]=.0078125*b[n++]-1}o.bytesPerSample=1,o.channels=2,o.length=i>>1;break;case 4355:if(i>0)for(a=(r=jt.currentCtx.audioCtx.createBuffer(2,i>>2,s)).getChannelData(0),l=r.getChannelData(1),n>>=1,c=0;c<i>>2;++c)a[c]=30517578125e-15*_[n++],l[c]=30517578125e-15*_[n++];o.bytesPerSample=2,o.channels=2,o.length=i>>2;break;case 65552:if(i>0)for(a=(r=jt.currentCtx.audioCtx.createBuffer(1,i>>2,s)).getChannelData(0),n>>=2,c=0;c<i>>2;++c)a[c]=E[n++];o.bytesPerSample=4,o.channels=1,o.length=i>>2;break;case 65553:if(i>0)for(a=(r=jt.currentCtx.audioCtx.createBuffer(2,i>>3,s)).getChannelData(0),l=r.getChannelData(1),n>>=2,c=0;c<i>>3;++c)a[c]=E[n++],l[c]=E[n++];o.bytesPerSample=4,o.channels=2,o.length=i>>3;break;default:return void(jt.currentCtx.err=40963)}o.frequency=s,o.audioBuf=r}catch{return void(jt.currentCtx.err=40963)}}},alDeleteBuffers:function(e,t){if(jt.currentCtx){for(var n=0;n<e;++n)if(0!==(i=C[t+4*n>>2])){if(!jt.buffers[i])return void(jt.currentCtx.err=40961);if(jt.buffers[i].refCount)return void(jt.currentCtx.err=40964)}for(n=0;n<e;++n){var i;0!==(i=C[t+4*n>>2])&&(jt.deviceRefCounts[jt.buffers[i].deviceId]--,delete jt.buffers[i],jt.freeIds.push(i))}}},alDeleteSources:function(e,t){if(jt.currentCtx){for(var n=0;n<e;++n){var i=C[t+4*n>>2];if(!jt.currentCtx.sources[i])return void(jt.currentCtx.err=40961)}for(n=0;n<e;++n)i=C[t+4*n>>2],jt.setSourceState(jt.currentCtx.sources[i],4116),Vt(i,4105,0),delete jt.currentCtx.sources[i],jt.freeIds.push(i)}},alGenBuffers:function(e,t){if(jt.currentCtx)for(var n=0;n<e;++n){var i={deviceId:jt.currentCtx.deviceId,id:jt.newId(),refCount:0,audioBuf:null,frequency:0,bytesPerSample:2,channels:1,length:0};jt.deviceRefCounts[i.deviceId]++,jt.buffers[i.id]=i,C[t+4*n>>2]=i.id}},alGenSources:function(e,t){if(jt.currentCtx)for(var n=0;n<e;++n){var i=jt.currentCtx.audioCtx.createGain();i.connect(jt.currentCtx.gain);var s={context:jt.currentCtx,id:jt.newId(),type:4144,state:4113,bufQueue:[jt.buffers[0]],audioQueue:[],looping:!1,pitch:1,dopplerShift:1,gain:i,minGain:0,maxGain:1,panner:null,bufsProcessed:0,bufStartTime:Number.NEGATIVE_INFINITY,bufOffset:0,relative:!1,refDistance:1,maxDistance:340282e33,rolloffFactor:1,position:[0,0,0],velocity:[0,0,0],direction:[0,0,0],coneOuterGain:0,coneInnerAngle:360,coneOuterAngle:360,distanceModel:53250,spatialize:2,get playbackRate(){return this.pitch*this.dopplerShift}};jt.currentCtx.sources[s.id]=s,C[t+4*n>>2]=s.id}},alGetError:function(){if(!jt.currentCtx)return 40964;var e=jt.currentCtx.err;return jt.currentCtx.err=0,e},alGetSourcei:function(e,t,n){var i=jt.getSourceParam("alGetSourcei",e,t);if(null!==i){if(!n)return void(jt.currentCtx.err=40963);switch(t){case 514:case 4097:case 4098:case 4103:case 4105:case 4112:case 4117:case 4118:case 4128:case 4129:case 4131:case 4132:case 4133:case 4134:case 4135:case 4628:case 8201:case 8202:case 53248:C[n>>2]=i;break;default:return void(jt.currentCtx.err=40962)}}},alGetString:function(e){if(jt.stringCache[e])return jt.stringCache[e];var t;switch(e){case 0:t="No Error";break;case 40961:t="Invalid Name";break;case 40962:t="Invalid Enum";break;case 40963:t="Invalid Value";break;case 40964:t="Invalid Operation";break;case 40965:t="Out of Memory";break;case 45057:t="Emscripten";break;case 45058:t="1.1";break;case 45059:t="WebAudio";break;case 45060:for(var n in t="",jt.AL_EXTENSIONS)t=(t=t.concat(n)).concat(" ");t=t.trim();break;default:return jt.currentCtx&&(jt.currentCtx.err=40962),0}return t=Dt(t),jt.stringCache[e]=t,t},alSourcePause:function(e){if(jt.currentCtx){var t=jt.currentCtx.sources[e];if(!t)return void(jt.currentCtx.err=40961);jt.setSourceState(t,4115)}},alSourcePlay:function(e){if(jt.currentCtx){var t=jt.currentCtx.sources[e];if(!t)return void(jt.currentCtx.err=40961);jt.setSourceState(t,4114)}},alSourceStop:function(e){if(jt.currentCtx){var t=jt.currentCtx.sources[e];if(!t)return void(jt.currentCtx.err=40961);jt.setSourceState(t,4116)}},alSourcef:function(e,t,n){switch(t){case 4097:case 4098:case 4099:case 4106:case 4109:case 4110:case 4128:case 4129:case 4130:case 4131:case 4132:case 4133:case 4134:case 8203:jt.setSourceParam("alSourcef",e,t,n);break;default:jt.setSourceParam("alSourcef",e,t,null)}},alSourcei:Vt,alcCloseDevice:function(e){return!(e in jt.deviceRefCounts)||jt.deviceRefCounts[e]>0?0:(delete jt.deviceRefCounts[e],jt.freeIds.push(e),1)},alcCreateContext:function(e,t){if(!(e in jt.deviceRefCounts))return jt.alcErr=40961,0;var n=null,i=[],s=null;if(t>>=2)for(var o=0,r=0;o=C[t++],i.push(o),0!==o;)switch(r=C[t++],i.push(r),o){case 4103:n||(n={}),n.sampleRate=r;break;case 4112:case 4113:break;case 6546:switch(r){case 0:s=!1;break;case 1:s=!0;break;case 2:break;default:return jt.alcErr=40964,0}break;case 6550:if(0!==r)return jt.alcErr=40964,0;break;default:return jt.alcErr=40964,0}var a=window.AudioContext||window.webkitAudioContext,c=null;try{c=n?new a(n):new a}catch(e){return"NotSupportedError"===e.name?jt.alcErr=40964:jt.alcErr=40961,0}Gt(c),void 0===c.createGain&&(c.createGain=c.createGainNode);var l=c.createGain();l.connect(c.destination);var d={deviceId:e,id:jt.newId(),attrs:i,audioCtx:c,listener:{position:[0,0,0],velocity:[0,0,0],direction:[0,0,0],up:[0,0,0]},sources:[],interval:setInterval((function(){jt.scheduleContextAudio(d)}),jt.QUEUE_INTERVAL),gain:l,distanceModel:53250,speedOfSound:343.3,dopplerFactor:1,sourceDistanceModel:!1,hrtf:s||!1,_err:0,get err(){return this._err},set err(e){(0===this._err||0===e)&&(this._err=e)}};if(jt.deviceRefCounts[e]++,jt.contexts[d.id]=d,null!==s)for(var u in jt.contexts){var h=jt.contexts[u];h.deviceId===e&&(h.hrtf=s,jt.updateContextGlobal(h))}return d.id},alcDestroyContext:function(e){var t=jt.contexts[e];jt.currentCtx!==t?(jt.contexts[e].interval&&clearInterval(jt.contexts[e].interval),jt.deviceRefCounts[t.deviceId]--,delete jt.contexts[e],jt.freeIds.push(e)):jt.alcErr=40962},alcGetError:function(e){var t=jt.alcErr;return jt.alcErr=0,t},alcGetString:function(e,t){if(jt.alcStringCache[t])return jt.alcStringCache[t];var n;switch(t){case 0:n="No Error";break;case 40961:n="Invalid Device";break;case 40962:n="Invalid Context";break;case 40963:n="Invalid Enum";break;case 40964:n="Invalid Value";break;case 40965:n="Out of Memory";break;case 4100:if("undefined"==typeof AudioContext&&"undefined"==typeof webkitAudioContext)return 0;n=jt.DEVICE_NAME;break;case 4101:n="undefined"!=typeof AudioContext||"undefined"!=typeof webkitAudioContext?jt.DEVICE_NAME.concat("\0"):"\0";break;case 785:n=jt.CAPTURE_DEVICE_NAME;break;case 784:if(0===e)n=jt.CAPTURE_DEVICE_NAME.concat("\0");else{var i=jt.requireValidCaptureDevice(e,"alcGetString");if(!i)return 0;n=i.deviceName}break;case 4102:if(!e)return jt.alcErr=40961,0;for(var s in n="",jt.ALC_EXTENSIONS)n=(n=n.concat(s)).concat(" ");n=n.trim();break;default:return jt.alcErr=40963,0}return n=Dt(n),jt.alcStringCache[t]=n,n},alcMakeContextCurrent:function(e){return jt.currentCtx=0===e?null:jt.contexts[e],1},alcOpenDevice:function(e){if(e&&T(e)!==jt.DEVICE_NAME)return 0;if("undefined"!=typeof AudioContext||"undefined"!=typeof webkitAudioContext){var t=jt.newId();return jt.deviceRefCounts[t]=0,t}return 0},create_video:function(t){const n=T(t),i=re.readFile(n),s=document.createElement("video"),o=URL.createObjectURL(new Blob([i],{type:"video/mp4"})),r=e.proxyVideoRequestsTo;return s.muted=!0,s.autoplay=!1,s.controls=!1,s.playsInline=!0,s.src=r?r+encodeURIComponent(o):o,ut.toHandle(s)},delete_video:function(e){const t=ut.toValue(e);URL.revokeObjectURL(t.src),t.src=""},emscripten_date_now:function(){return Date.now()},emscripten_get_heap_max:function(){return 2147483648},emscripten_get_now:At,emscripten_memcpy_big:function(e,t,n){b.copyWithin(e,t,t+n)},emscripten_resize_heap:function(e){var t=b.length,n=2147483648;if((e>>>=0)>n)return!1;for(var i=1;i<=4;i*=2){var s=t*(1+.2/i);if(s=Math.min(s,e+100663296),qt(Math.min(n,(o=Math.max(e,s))+((r=65536)-o%r)%r)))return!0}var o,r;return!1},environ_get:function(e,t){var n=0;return zt().forEach((function(i,s){var o=t+n;S[e+4*s>>2]=o,function(e,t,n){for(var i=0;i<e.length;++i)v[t++>>0]=e.charCodeAt(i);v[t>>0]=0}(i,o),n+=i.length+1})),0},environ_sizes_get:function(e,t){var n=zt();S[e>>2]=n.length;var i=0;return n.forEach((function(e){i+=e.length+1})),S[t>>2]=i,0},exit:function(t,n){m=t,function(t){m=t,h||(e.onExit&&e.onExit(t),w=!0),a(t,new Y(t))}(t)},fd_close:function(e){try{var t=ae.getStreamFromFD(e);return re.close(t),0}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return e.errno}},fd_fdstat_get:function(e,t){try{var n=ae.getStreamFromFD(e),i=n.tty?2:re.isDir(n.mode)?3:re.isLink(n.mode)?7:4;return v[t>>0]=i,0}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return e.errno}},fd_read:function(e,t,n,i){try{var s=function(e,t,n,i){for(var s=0,o=0;o<n;o++){var r=S[t>>2],a=S[t+4>>2];t+=8;var c=re.read(e,v,r,a,undefined);if(c<0)return-1;if(s+=c,c<a)break}return s}(ae.getStreamFromFD(e),t,n);return S[i>>2]=s,0}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return e.errno}},fd_seek:function(e,t,n,i,s){try{var o=ce(t,n);if(isNaN(o))return 61;var r=ae.getStreamFromFD(e);return re.llseek(r,o,i),z=[r.position>>>0,(H=r.position,+Math.abs(H)>=1?H>0?(0|Math.min(+Math.floor(H/4294967296),4294967295))>>>0:~~+Math.ceil((H-+(~~H>>>0))/4294967296)>>>0:0)],C[s>>2]=z[0],C[s+4>>2]=z[1],r.getdents&&0===o&&0===i&&(r.getdents=null),0}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return e.errno}},fd_sync:function(e){try{var t=ae.getStreamFromFD(e);return t.stream_ops&&t.stream_ops.fsync?t.stream_ops.fsync(t):0}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return e.errno}},fd_write:function(e,t,n,i){try{var s=function(e,t,n,i){for(var s=0,o=0;o<n;o++){var r=S[t>>2],a=S[t+4>>2];t+=8;var c=re.write(e,v,r,a,undefined);if(c<0)return-1;s+=c}return s}(ae.getStreamFromFD(e),t,n);return S[i>>2]=s,0}catch(e){if(void 0===re||!(e instanceof re.ErrnoError))throw e;return e.errno}},get_camera_texture:function(){return e.useCamTexture&&e.texture?(e.camTextureId||(e.camTextureId=Zt.getNewId(Zt.textures),e.texture.name=e.camTextureId,Zt.textures[e.camTextureId]=e.texture),e.camTextureId):0},get_current_hostname:function(){var e=[self.location.href].concat(Array.from("ancestorOrigins"in self.location?self.location.ancestorOrigins:function(){var e=self.top,t=self.parent,n=[];do{try{n.push(t.location.href)}catch{}t=t.parent}while(t!==e);return n}())).map((function(e){return new URL(e.replace(/^blob:/,"")).hostname})).find((function(e){return Boolean(e)})),t=A(e)+1,n=vn(t);return R(e,n,t),n},getaddrinfo:function(e,t,n,i){var s,o=0,r=0,a=0,c=0,l=0,d=0;function u(e,t,n,i,s,o){var r,a,c,l;return a=10===e?28:16,s=10===e?function(e){var t="",n=0,i=0,s=0,o=0,r=0,a=0,c=[65535&e[0],e[0]>>16,65535&e[1],e[1]>>16,65535&e[2],e[2]>>16,65535&e[3],e[3]>>16],l=!0,d="";for(a=0;a<5;a++)if(0!==c[a]){l=!1;break}if(l){if(d=Xt(c[6]|c[7]<<16),-1===c[5])return(t="::ffff:")+d;if(0===c[5])return"0.0.0.0"===d&&(d=""),"0.0.0.1"===d&&(d="1"),(t="::")+d}for(n=0;n<8;n++)0===c[n]&&(n-s>1&&(r=0),s=n,r++),r>i&&(o=n-(i=r)+1);for(n=0;n<8;n++)i>1&&0===c[n]&&n>=o&&n<o+i?n===o&&(t+=":",0===o&&(t+=":")):(t+=Number(kn(65535&c[n])).toString(16),t+=n<7?":":"");return t}(s):Xt(s),l=function(e,t,n,i,s){switch(t){case 2:n=Wt(n),ie(e,16),_[e>>1]=t,C[e+4>>2]=n,_[e+2>>1]=En(i);break;case 10:n=Yt(n),ie(e,28),C[e>>2]=t,C[e+8>>2]=n[0],C[e+12>>2]=n[1],C[e+16>>2]=n[2],C[e+20>>2]=n[3],_[e+2>>1]=En(i);break;default:return 5}return 0}(r=vn(a),e,s,o),g(!l),c=vn(32),C[c+4>>2]=e,C[c+8>>2]=t,C[c+12>>2]=n,C[c+24>>2]=i,S[c+20>>2]=r,C[c+16>>2]=10===e?28:16,C[c+28>>2]=0,c}if(n&&(a=C[n>>2],c=C[n+4>>2],l=C[n+8>>2],d=C[n+12>>2]),l&&!d&&(d=2===l?17:6),!l&&d&&(l=17===d?2:1),0===d&&(d=6),0===l&&(l=1),!e&&!t)return-2;if(-1088&a||0!==n&&2&C[n>>2]&&!e)return-1;if(32&a)return-2;if(0!==l&&1!==l&&2!==l)return-7;if(0!==c&&2!==c&&10!==c)return-6;if(t&&(t=T(t),r=parseInt(t,10),isNaN(r)))return 1024&a?-2:-8;if(!e)return 0===c&&(c=2),0==(1&a)&&(o=2===c?Sn(2130706433):[0,0,0,1]),s=u(c,l,d,null,o,r),S[i>>2]=s,0;if(null!==(o=Wt(e=T(e))))if(0===c||2===c)c=2;else{if(!(10===c&&8&a))return-2;o=[0,0,Sn(65535),o],c=10}else if(null!==(o=Yt(e))){if(0!==c&&10!==c)return-2;c=10}return null!=o?(s=u(c,l,d,e,o,r),S[i>>2]=s,0):4&a?-2:(o=Wt(e=Kt.lookup_name(e)),0===c?c=2:10===c&&(o=[0,0,Sn(65535),o]),s=u(c,l,d,null,o,r),S[i>>2]=s,0)},getentropy:function e(t,n){e.randomDevice||(e.randomDevice=Q());for(var i=0;i<n;i++)v[t+i>>0]=e.randomDevice();return 0},glActiveTexture:function(e){mn.activeTexture(e)},glAttachShader:function(e,t){mn.attachShader(Zt.programs[e],Zt.shaders[t])},glBindBuffer:function(e,t){35051==e?mn.currentPixelPackBufferBinding=t:35052==e&&(mn.currentPixelUnpackBufferBinding=t),mn.bindBuffer(e,Zt.buffers[t])},glBindBufferRange:function(e,t,n,i,s){mn.bindBufferRange(e,t,Zt.buffers[n],i,s)},glBindFramebuffer:function(e,t){mn.bindFramebuffer(e,Zt.framebuffers[t])},glBindRenderbuffer:function(e,t){mn.bindRenderbuffer(e,Zt.renderbuffers[t])},glBindTexture:function(e,t){mn.bindTexture(e,Zt.textures[t])},glBindVertexArray:function(e){mn.bindVertexArray(Zt.vaos[e])},glBlendEquation:function(e){mn.blendEquation(e)},glBlendFunc:function(e,t){mn.blendFunc(e,t)},glBlendFuncSeparate:function(e,t,n,i){mn.blendFuncSeparate(e,t,n,i)},glBlitFramebuffer:function(e,t,n,i,s,o,r,a,c,l){mn.blitFramebuffer(e,t,n,i,s,o,r,a,c,l)},glBufferData:function(e,t,n,i){Zt.currentContext.version>=2?n&&t?mn.bufferData(e,b,i,n,t):mn.bufferData(e,t,i):mn.bufferData(e,n?b.subarray(n,n+t):t,i)},glBufferSubData:function(e,t,n,i){Zt.currentContext.version>=2?n&&mn.bufferSubData(e,t,b,i,n):mn.bufferSubData(e,t,b.subarray(i,i+n))},glClearBufferfv:function(e,t,n){mn.clearBufferfv(e,t,E,n>>2)},glColorMask:function(e,t,n,i){mn.colorMask(!!e,!!t,!!n,!!i)},glCompileShader:function(e){mn.compileShader(Zt.shaders[e])},glCompressedTexImage2D:function(e,t,n,i,s,o,r,a){Zt.currentContext.version>=2?mn.currentPixelUnpackBufferBinding||!r?mn.compressedTexImage2D(e,t,n,i,s,o,r,a):mn.compressedTexImage2D(e,t,n,i,s,o,b,a,r):mn.compressedTexImage2D(e,t,n,i,s,o,a?b.subarray(a,a+r):null)},glCompressedTexImage3D:function(e,t,n,i,s,o,r,a,c){mn.currentPixelUnpackBufferBinding?mn.compressedTexImage3D(e,t,n,i,s,o,r,a,c):mn.compressedTexImage3D(e,t,n,i,s,o,r,b,c,a)},glCopyTexSubImage2D:function(e,t,n,i,s,o,r,a){mn.copyTexSubImage2D(e,t,n,i,s,o,r,a)},glCreateProgram:function(){var e=Zt.getNewId(Zt.programs),t=mn.createProgram();return t.name=e,t.maxUniformLength=t.maxAttributeLength=t.maxUniformBlockNameLength=0,t.uniformIdCounter=1,Zt.programs[e]=t,e},glCreateShader:function(e){var t=Zt.getNewId(Zt.shaders);return Zt.shaders[t]=mn.createShader(e),t},glDeleteBuffers:function(e,t){for(var n=0;n<e;n++){var i=C[t+4*n>>2],s=Zt.buffers[i];!s||(mn.deleteBuffer(s),s.name=0,Zt.buffers[i]=null,i==mn.currentPixelPackBufferBinding&&(mn.currentPixelPackBufferBinding=0),i==mn.currentPixelUnpackBufferBinding&&(mn.currentPixelUnpackBufferBinding=0))}},glDeleteFramebuffers:function(e,t){for(var n=0;n<e;++n){var i=C[t+4*n>>2],s=Zt.framebuffers[i];!s||(mn.deleteFramebuffer(s),s.name=0,Zt.framebuffers[i]=null)}},glDeleteProgram:function(e){if(e){var t=Zt.programs[e];if(!t)return void Zt.recordError(1281);mn.deleteProgram(t),t.name=0,Zt.programs[e]=null}},glDeleteRenderbuffers:function(e,t){for(var n=0;n<e;n++){var i=C[t+4*n>>2],s=Zt.renderbuffers[i];!s||(mn.deleteRenderbuffer(s),s.name=0,Zt.renderbuffers[i]=null)}},glDeleteShader:function(e){if(e){var t=Zt.shaders[e];if(!t)return void Zt.recordError(1281);mn.deleteShader(t),Zt.shaders[e]=null}},glDeleteTextures:function(e,t){for(var n=0;n<e;n++){var i=C[t+4*n>>2],s=Zt.textures[i];!s||(mn.deleteTexture(s),s.name=0,Zt.textures[i]=null)}},glDeleteVertexArrays:function(e,t){for(var n=0;n<e;n++){var i=C[t+4*n>>2];mn.deleteVertexArray(Zt.vaos[i]),Zt.vaos[i]=null}},glDepthFunc:function(e){mn.depthFunc(e)},glDepthMask:function(e){mn.depthMask(!!e)},glDisable:function(e){mn.disable(e)},glDrawArrays:function(e,t,n){mn.drawArrays(e,t,n)},glDrawArraysInstanced:function(e,t,n,i){mn.drawArraysInstanced(e,t,n,i)},glDrawBuffers:function(e,t){for(var n=Qt[e],i=0;i<e;i++)n[i]=C[t+4*i>>2];mn.drawBuffers(n)},glDrawElements:function(e,t,n,i){mn.drawElements(e,t,n,i)},glDrawElementsInstanced:function(e,t,n,i,s){mn.drawElementsInstanced(e,t,n,i,s)},glEnable:function(e){mn.enable(e)},glEnableVertexAttribArray:function(e){mn.enableVertexAttribArray(e)},glFramebufferRenderbuffer:function(e,t,n,i){mn.framebufferRenderbuffer(e,t,n,Zt.renderbuffers[i])},glFramebufferTexture2D:function(e,t,n,i,s){mn.framebufferTexture2D(e,t,n,Zt.textures[i],s)},glFrontFace:function(e){mn.frontFace(e)},glGenBuffers:function(e,t){en(e,t,"createBuffer",Zt.buffers)},glGenFramebuffers:function(e,t){en(e,t,"createFramebuffer",Zt.framebuffers)},glGenRenderbuffers:function(e,t){en(e,t,"createRenderbuffer",Zt.renderbuffers)},glGenTextures:function(e,t){en(e,t,"createTexture",Zt.textures)},glGenVertexArrays:function(e,t){en(e,t,"createVertexArray",Zt.vaos)},glGenerateMipmap:function(e){mn.generateMipmap(e)},glGetError:function(){var e=mn.getError()||Zt.lastError;return Zt.lastError=0,e},glGetIntegerv:function(e,t){!function(e,t,n){if(t){var i=void 0;switch(e){case 36346:i=1;break;case 36344:return void(0!=n&&1!=n&&Zt.recordError(1280));case 34814:case 36345:i=0;break;case 34466:var s=mn.getParameter(34467);i=s?s.length:0;break;case 33309:if(Zt.currentContext.version<2)return void Zt.recordError(1282);i=2*(mn.getSupportedExtensions()||[]).length;break;case 33307:case 33308:if(Zt.currentContext.version<2)return void Zt.recordError(1280);i=33307==e?3:0}if(void 0===i){var o=mn.getParameter(e);switch(typeof o){case"number":i=o;break;case"boolean":i=o?1:0;break;case"string":return void Zt.recordError(1280);case"object":if(null===o)switch(e){case 34964:case 35725:case 34965:case 36006:case 36007:case 32873:case 34229:case 36662:case 36663:case 35053:case 35055:case 36010:case 35097:case 35869:case 32874:case 36389:case 35983:case 35368:case 34068:i=0;break;default:return void Zt.recordError(1280)}else{if(o instanceof Float32Array||o instanceof Uint32Array||o instanceof Int32Array||o instanceof Array){for(var r=0;r<o.length;++r)switch(n){case 0:C[t+4*r>>2]=o[r];break;case 2:E[t+4*r>>2]=o[r];break;case 4:v[t+r>>0]=o[r]?1:0}return}try{i=0|o.name}catch(t){return Zt.recordError(1280),void d("GL_INVALID_ENUM in glGet"+n+"v: Unknown object returned from WebGL getParameter("+e+")! (error: "+t+")")}}break;default:return Zt.recordError(1280),void d("GL_INVALID_ENUM in glGet"+n+"v: Native code calling glGet"+n+"v("+e+") and it returns "+o+" of type "+typeof o+"!")}}switch(n){case 1:!function(e,t){S[e>>2]=t,S[e+4>>2]=(t-S[e>>2])/4294967296}(t,i);break;case 0:C[t>>2]=i;break;case 2:E[t>>2]=i;break;case 4:v[t>>0]=i?1:0}}else Zt.recordError(1281)}(e,t,0)},glGetProgramInfoLog:function(e,t,n,i){var s=mn.getProgramInfoLog(Zt.programs[e]);null===s&&(s="(unknown error)");var o=t>0&&i?R(s,i,t):0;n&&(C[n>>2]=o)},glGetProgramiv:function(e,t,n){if(n)if(e>=Zt.counter)Zt.recordError(1281);else if(e=Zt.programs[e],35716==t){var i=mn.getProgramInfoLog(e);null===i&&(i="(unknown error)"),C[n>>2]=i.length+1}else if(35719==t){if(!e.maxUniformLength)for(var s=0;s<mn.getProgramParameter(e,35718);++s)e.maxUniformLength=Math.max(e.maxUniformLength,mn.getActiveUniform(e,s).name.length+1);C[n>>2]=e.maxUniformLength}else if(35722==t){if(!e.maxAttributeLength)for(s=0;s<mn.getProgramParameter(e,35721);++s)e.maxAttributeLength=Math.max(e.maxAttributeLength,mn.getActiveAttrib(e,s).name.length+1);C[n>>2]=e.maxAttributeLength}else if(35381==t){if(!e.maxUniformBlockNameLength)for(s=0;s<mn.getProgramParameter(e,35382);++s)e.maxUniformBlockNameLength=Math.max(e.maxUniformBlockNameLength,mn.getActiveUniformBlockName(e,s).length+1);C[n>>2]=e.maxUniformBlockNameLength}else C[n>>2]=mn.getProgramParameter(e,t);else Zt.recordError(1281)},glGetShaderInfoLog:function(e,t,n,i){var s=mn.getShaderInfoLog(Zt.shaders[e]);null===s&&(s="(unknown error)");var o=t>0&&i?R(s,i,t):0;n&&(C[n>>2]=o)},glGetShaderiv:function(e,t,n){if(n)if(35716==t){var i=mn.getShaderInfoLog(Zt.shaders[e]);null===i&&(i="(unknown error)");var s=i?i.length+1:0;C[n>>2]=s}else if(35720==t){var o=mn.getShaderSource(Zt.shaders[e]),r=o?o.length+1:0;C[n>>2]=r}else C[n>>2]=mn.getShaderParameter(Zt.shaders[e],t);else Zt.recordError(1281)},glGetUniformLocation:function(e,t){if(t=T(t),e=Zt.programs[e]){!function(e){var t,n,i=e.uniformLocsById,s=e.uniformSizeAndIdsByName;if(!i)for(e.uniformLocsById=i={},e.uniformArrayNamesById={},t=0;t<mn.getProgramParameter(e,35718);++t){var o=mn.getActiveUniform(e,t),r=o.name,a=o.size,c=tn(r),l=c>0?r.slice(0,c):r,d=e.uniformIdCounter;for(e.uniformIdCounter+=a,s[l]=[a,d],n=0;n<a;++n)i[d]=n,e.uniformArrayNamesById[d++]=l}}(e);var n=e.uniformLocsById,i=0,s=t,o=tn(t);o>0&&(i=Jt(t.slice(o+1))>>>0,s=t.slice(0,o));var r=e.uniformSizeAndIdsByName[s];if(r&&i<r[0]&&(n[i+=r[1]]=n[i]||mn.getUniformLocation(e,t)))return i}else Zt.recordError(1281);return-1},glInvalidateFramebuffer:function(e,t,n){for(var i=Qt[t],s=0;s<t;s++)i[s]=C[n+4*s>>2];mn.invalidateFramebuffer(e,i)},glLinkProgram:function(e){e=Zt.programs[e],mn.linkProgram(e),e.uniformLocsById=0,e.uniformSizeAndIdsByName={}},glPixelStorei:function(e,t){3317==e&&(Zt.unpackAlignment=t),mn.pixelStorei(e,t)},glReadPixels:function(e,t,n,i,s,o,r){if(Zt.currentContext.version>=2)if(mn.currentPixelPackBufferBinding)mn.readPixels(e,t,n,i,s,o,r);else{var a=nn(o);mn.readPixels(e,t,n,i,s,o,a,r>>sn(a))}else{var c=on(o,s,n,i,r);c?mn.readPixels(e,t,n,i,s,o,c):Zt.recordError(1280)}},glRenderbufferStorage:function(e,t,n,i){mn.renderbufferStorage(e,t,n,i)},glRenderbufferStorageMultisample:function(e,t,n,i,s){mn.renderbufferStorageMultisample(e,t,n,i,s)},glShaderSource:function(e,t,n,i){var s=Zt.getSource(e,t,n,i);mn.shaderSource(Zt.shaders[e],s)},glTexImage2D:function(e,t,n,i,s,o,r,a,c){if(Zt.currentContext.version>=2)if(mn.currentPixelUnpackBufferBinding)mn.texImage2D(e,t,n,i,s,o,r,a,c);else if(c){var l=nn(a);mn.texImage2D(e,t,n,i,s,o,r,a,l,c>>sn(l))}else mn.texImage2D(e,t,n,i,s,o,r,a,null);else mn.texImage2D(e,t,n,i,s,o,r,a,c?on(a,r,i,s,c):null)},glTexImage3D:function(e,t,n,i,s,o,r,a,c,l){if(mn.currentPixelUnpackBufferBinding)mn.texImage3D(e,t,n,i,s,o,r,a,c,l);else if(l){var d=nn(c);mn.texImage3D(e,t,n,i,s,o,r,a,c,d,l>>sn(d))}else mn.texImage3D(e,t,n,i,s,o,r,a,c,null)},glTexParameteri:function(e,t,n){mn.texParameteri(e,t,n)},glTexStorage2D:function(e,t,n,i,s){mn.texStorage2D(e,t,n,i,s)},glTexStorage3D:function(e,t,n,i,s,o){mn.texStorage3D(e,t,n,i,s,o)},glTexSubImage2D:function(e,t,n,i,s,o,r,a,c){if(Zt.currentContext.version>=2)if(mn.currentPixelUnpackBufferBinding)mn.texSubImage2D(e,t,n,i,s,o,r,a,c);else if(c){var l=nn(a);mn.texSubImage2D(e,t,n,i,s,o,r,a,l,c>>sn(l))}else mn.texSubImage2D(e,t,n,i,s,o,r,a,null);else{var d=null;c&&(d=on(a,r,s,o,c)),mn.texSubImage2D(e,t,n,i,s,o,r,a,d)}},glTexSubImage3D:function(e,t,n,i,s,o,r,a,c,l,d){if(mn.currentPixelUnpackBufferBinding)mn.texSubImage3D(e,t,n,i,s,o,r,a,c,l,d);else if(d){var u=nn(l);mn.texSubImage3D(e,t,n,i,s,o,r,a,c,l,u,d>>sn(u))}else mn.texSubImage3D(e,t,n,i,s,o,r,a,c,l,null)},glUniform1f:function(e,t){mn.uniform1f(rn(e),t)},glUniform1i:function(e,t){mn.uniform1i(rn(e),t)},glUniform1ui:function(e,t){mn.uniform1ui(rn(e),t)},glUniform2f:function(e,t,n){mn.uniform2f(rn(e),t,n)},glUniform2fv:function(e,t,n){if(Zt.currentContext.version>=2)t&&mn.uniform2fv(rn(e),E,n>>2,2*t);else{if(t<=144)for(var i=an[2*t-1],s=0;s<2*t;s+=2)i[s]=E[n+4*s>>2],i[s+1]=E[n+(4*s+4)>>2];else i=E.subarray(n>>2,n+8*t>>2);mn.uniform2fv(rn(e),i)}},glUniform4fv:function(e,t,n){if(Zt.currentContext.version>=2)t&&mn.uniform4fv(rn(e),E,n>>2,4*t);else{if(t<=72){var i=an[4*t-1],s=E;n>>=2;for(var o=0;o<4*t;o+=4){var r=n+o;i[o]=s[r],i[o+1]=s[r+1],i[o+2]=s[r+2],i[o+3]=s[r+3]}}else i=E.subarray(n>>2,n+16*t>>2);mn.uniform4fv(rn(e),i)}},glUseProgram:function(e){e=Zt.programs[e],mn.useProgram(e),mn.currentProgram=e},glVertexAttribIPointer:function(e,t,n,i,s){mn.vertexAttribIPointer(e,t,n,i,s)},glVertexAttribPointer:function(e,t,n,i,s,o){mn.vertexAttribPointer(e,t,n,!!i,s,o)},glViewport:function(e,t,n,i){mn.viewport(e,t,n,i)},is_electron:function(){return/electron/i.test(navigator.userAgent)},strftime:dn,strftime_l:function(e,t,n,i,s){return dn(e,t,n,i)}};(function(){var t={env:fn,wasi_snapshot_preview1:fn};function i(t,n){var i=t.exports;e.asm=i,$((p=e.asm.memory).buffer),L=e.asm.__indirect_function_table,function(e){D.unshift(e)}(e.asm.__wasm_call_ctors),V()}function s(e){i(e.instance)}function o(e){return(u||"function"!=typeof fetch?Promise.resolve().then((function(){return J(q)})):fetch(q,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+q+"'";return e.arrayBuffer()})).catch((function(){return J(q)}))).then((function(e){return WebAssembly.instantiate(e,t)})).then((function(e){return e})).then(e,(function(e){d("failed to asynchronously prepare wasm: "+e),G(e)}))}if(j(),e.instantiateWasm)try{return e.instantiateWasm(t,i)}catch(e){d("Module.instantiateWasm callback failed with error: "+e),n(e)}(u||"function"!=typeof WebAssembly.instantiateStreaming||W(q)||"function"!=typeof fetch?o(s):fetch(q,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,t).then(s,(function(e){return d("wasm streaming compile failed: "+e),d("falling back to ArrayBuffer instantiation"),o(s)}))}))).catch(n)})(),e.___wasm_call_ctors=function(){return(e.___wasm_call_ctors=e.asm.__wasm_call_ctors).apply(null,arguments)};var vn=e._malloc=function(){return(vn=e._malloc=e.asm.malloc).apply(null,arguments)},bn=e.___errno_location=function(){return(bn=e.___errno_location=e.asm.__errno_location).apply(null,arguments)},_n=e._free=function(){return(_n=e._free=e.asm.free).apply(null,arguments)},yn=e.___getTypeName=function(){return(yn=e.___getTypeName=e.asm.__getTypeName).apply(null,arguments)};e.__embind_initialize_bindings=function(){return(e.__embind_initialize_bindings=e.asm._embind_initialize_bindings).apply(null,arguments)};var Cn,Sn=e._htonl=function(){return(Sn=e._htonl=e.asm.htonl).apply(null,arguments)},En=e._htons=function(){return(En=e._htons=e.asm.htons).apply(null,arguments)},xn=e._emscripten_builtin_memalign=function(){return(xn=e._emscripten_builtin_memalign=e.asm.emscripten_builtin_memalign).apply(null,arguments)},kn=e._ntohs=function(){return(kn=e._ntohs=e.asm.ntohs).apply(null,arguments)},Mn=e.___cxa_is_pointer_type=function(){return(Mn=e.___cxa_is_pointer_type=e.asm.__cxa_is_pointer_type).apply(null,arguments)};function Tn(n){function i(){Cn||(Cn=!0,e.calledRun=!0,!w&&(!e.noFSInit&&!re.init.initialized&&re.init(),re.ignorePermissions=!1,K(D),t(e),e.onRuntimeInitialized&&e.onRuntimeInitialized(),function(){if(e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;)B(e.postRun.shift());K(N)}()))}F>0||(function(){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;)O(e.preRun.shift());K(P)}(),F>0)||(e.setStatus?(e.setStatus("Running..."),setTimeout((function(){setTimeout((function(){e.setStatus("")}),1),i()}),1)):i())}if(e.dynCall_jii=function(){return(e.dynCall_jii=e.asm.dynCall_jii).apply(null,arguments)},e.dynCall_jiii=function(){return(e.dynCall_jiii=e.asm.dynCall_jiii).apply(null,arguments)},e.dynCall_viiij=function(){return(e.dynCall_viiij=e.asm.dynCall_viiij).apply(null,arguments)},e.dynCall_viijjiii=function(){return(e.dynCall_viijjiii=e.asm.dynCall_viijjiii).apply(null,arguments)},e.dynCall_iiiiji=function(){return(e.dynCall_iiiiji=e.asm.dynCall_iiiiji).apply(null,arguments)},e.dynCall_iiiijii=function(){return(e.dynCall_iiiijii=e.asm.dynCall_iiiijii).apply(null,arguments)},e.dynCall_iijjj=function(){return(e.dynCall_iijjj=e.asm.dynCall_iijjj).apply(null,arguments)},e.dynCall_viij=function(){return(e.dynCall_viij=e.asm.dynCall_viij).apply(null,arguments)},e.dynCall_ji=function(){return(e.dynCall_ji=e.asm.dynCall_ji).apply(null,arguments)},e.dynCall_iiffj=function(){return(e.dynCall_iiffj=e.asm.dynCall_iiffj).apply(null,arguments)},e.dynCall_vijjiii=function(){return(e.dynCall_vijjiii=e.asm.dynCall_vijjiii).apply(null,arguments)},e.dynCall_viiiji=function(){return(e.dynCall_viiiji=e.asm.dynCall_viiiji).apply(null,arguments)},e.dynCall_viiijii=function(){return(e.dynCall_viiijii=e.asm.dynCall_viiijii).apply(null,arguments)},e.dynCall_vij=function(){return(e.dynCall_vij=e.asm.dynCall_vij).apply(null,arguments)},e.dynCall_iiiiiij=function(){return(e.dynCall_iiiiiij=e.asm.dynCall_iiiiiij).apply(null,arguments)},e.dynCall_viijji=function(){return(e.dynCall_viijji=e.asm.dynCall_viijji).apply(null,arguments)},e.dynCall_viiiij=function(){return(e.dynCall_viiiij=e.asm.dynCall_viiiij).apply(null,arguments)},e.dynCall_viji=function(){return(e.dynCall_viji=e.asm.dynCall_viji).apply(null,arguments)},e.dynCall_viiiiji=function(){return(e.dynCall_viiiiji=e.asm.dynCall_viiiiji).apply(null,arguments)},e.dynCall_iiiji=function(){return(e.dynCall_iiiji=e.asm.dynCall_iiiji).apply(null,arguments)},e.dynCall_jijjiii=function(){return(e.dynCall_jijjiii=e.asm.dynCall_jijjiii).apply(null,arguments)},e.dynCall_jijiii=function(){return(e.dynCall_jijiii=e.asm.dynCall_jijiii).apply(null,arguments)},e.dynCall_jijiiii=function(){return(e.dynCall_jijiiii=e.asm.dynCall_jijiiii).apply(null,arguments)},e.dynCall_jijii=function(){return(e.dynCall_jijii=e.asm.dynCall_jijii).apply(null,arguments)},e.dynCall_jijiiiiii=function(){return(e.dynCall_jijiiiiii=e.asm.dynCall_jijiiiiii).apply(null,arguments)},e.dynCall_jijj=function(){return(e.dynCall_jijj=e.asm.dynCall_jijj).apply(null,arguments)},e.dynCall_iijijjji=function(){return(e.dynCall_iijijjji=e.asm.dynCall_iijijjji).apply(null,arguments)},e.dynCall_iiiij=function(){return(e.dynCall_iiiij=e.asm.dynCall_iiiij).apply(null,arguments)},e.dynCall_iiji=function(){return(e.dynCall_iiji=e.asm.dynCall_iiji).apply(null,arguments)},e.dynCall_jijij=function(){return(e.dynCall_jijij=e.asm.dynCall_jijij).apply(null,arguments)},e.dynCall_iijijji=function(){return(e.dynCall_iijijji=e.asm.dynCall_iijijji).apply(null,arguments)},e.dynCall_jij=function(){return(e.dynCall_jij=e.asm.dynCall_jij).apply(null,arguments)},e.dynCall_jiji=function(){return(e.dynCall_jiji=e.asm.dynCall_jiji).apply(null,arguments)},e.dynCall_viiijj=function(){return(e.dynCall_viiijj=e.asm.dynCall_viiijj).apply(null,arguments)},e.dynCall_iiij=function(){return(e.dynCall_iiij=e.asm.dynCall_iiij).apply(null,arguments)},e.dynCall_iijii=function(){return(e.dynCall_iijii=e.asm.dynCall_iijii).apply(null,arguments)},e.dynCall_iiijiji=function(){return(e.dynCall_iiijiji=e.asm.dynCall_iiijiji).apply(null,arguments)},e.dynCall_iiijiii=function(){return(e.dynCall_iiijiii=e.asm.dynCall_iiijiii).apply(null,arguments)},e.dynCall_viijii=function(){return(e.dynCall_viijii=e.asm.dynCall_viijii).apply(null,arguments)},e.dynCall_iiiiij=function(){return(e.dynCall_iiiiij=e.asm.dynCall_iiiiij).apply(null,arguments)},e.dynCall_iiiiijj=function(){return(e.dynCall_iiiiijj=e.asm.dynCall_iiiiijj).apply(null,arguments)},e.dynCall_iiiiiijj=function(){return(e.dynCall_iiiiiijj=e.asm.dynCall_iiiiiijj).apply(null,arguments)},e.dynCall_jjj=function(){return(e.dynCall_jjj=e.asm.dynCall_jjj).apply(null,arguments)},e.dynCall_iiiijj=function(){return(e.dynCall_iiiijj=e.asm.dynCall_iiiijj).apply(null,arguments)},e.dynCall_viijj=function(){return(e.dynCall_viijj=e.asm.dynCall_viijj).apply(null,arguments)},e.dynCall_viiijjjj=function(){return(e.dynCall_viiijjjj=e.asm.dynCall_viiijjjj).apply(null,arguments)},e.___start_em_js=1233164,e.___stop_em_js=1234783,e.addRunDependency=j,e.removeRunDependency=V,e.FS_createPath=re.createPath,e.FS_createDataFile=re.createDataFile,e.FS_createPreloadedFile=re.createPreloadedFile,e.FS_createLazyFile=re.createLazyFile,e.FS_createDevice=re.createDevice,e.FS_unlink=re.unlink,e.FS=re,e.GL=Zt,U=function e(){Cn||Tn(),Cn||(U=e)},e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return Tn(),Gt=function(){},e.ready});const js=Us,Vs=()=>{const e=document.createElement("canvas");return e.style.maxWidth="100%",e.style.objectFit="cover",e},Gs=(()=>{try{return new URL(".",self.location).toString()}catch{return""}})(),qs=async(e,t)=>(void 0===e&&(e=Gs),"string"==typeof e&&(e=(e=>(""!==e&&!e.endsWith("/")&&(e+="/"),t=>e+t))(e)),"object"==typeof e&&(e=(e=>t=>e[t])(e)),e=await(async(e,t={})=>{var n,i,s,o;if(!await(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])))())return null==(n=t.info)||n.call(t,'The platform does not support SIMD. Using "BanubaSDK.wasm"'),e;null==(i=t.info)||i.call(t,'The platform supports SIMD. Going to use "BanubaSDK.simd.wasm"');const r=e("BanubaSDK.simd.wasm");return r?await fetch(r,{method:"HEAD"}).then((e=>e.ok))?t=>{const[n,i]=t.split(".");if("wasm"!==i)return e(t);const s=[n,"simd",i].join(".");return e(s)}:(null==(o=t.warn)||o.call(t,`Unable to fetch "BanubaSDK.simd.wasm" from the "${r}". Using "BanubaSDK.wasm" as a fallback`),e):(null==(s=t.warn)||s.call(t,'"BanubaSDK.simd.wasm" is missing in the "locateFile" option. Using "BanubaSDK.wasm" as a fallback'),e)})(e,t),e);var Hs=(e=>(e.ERROR="error",e.WARNING="warn",e.INFO="info",e.DEBUG="debug",e))(Hs||{});const zs=(e,t)=>new Proxy(e,{apply(e,n,i){try{const s=e.apply(n,i);return Ls(s)?((e,t)=>new Proxy(e,{get(e,n){const i=e[n];return"function"==typeof i?zs(i,t):i}}))(s,t):s}catch(e){throw"number"==typeof e&&(e=new Error(t(e))),e}}}),Ws=(e,t)=>new Proxy(e,{construct(e,n){try{return new e(...n)}catch(e){throw"number"==typeof e&&(e=new Error(t(e))),e}},get(e,n){const i=e[n];return"function"==typeof i?zs(i,t):i}});function Js(){return Js=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Js.apply(null,arguments)}const Ys=new Map,Ks=e=>`webar::${e}:start`,Xs=e=>`webar::${e}:end`,Zs=e=>{performance.mark(Ks(e))},Qs=e=>{performance.mark(Xs(e));let t=performance.measure(e,Ks(e),Xs(e));t||(t=performance.getEntriesByName(e)[0]),performance.clearMarks(Ks(e)),performance.clearMarks(Xs(e)),performance.clearMeasures(e);const{duration:n}=t;let{averagedDuration:i=0}=Ys.get(e)||{};return i=((e,t,n)=>.95*e+.05*t)(i,n),Ys.set(e,{averagedDuration:i}),{instantDuration:n,averagedDuration:i}};var eo=Object.defineProperty,to=(e,t,n)=>(((e,t,n)=>{t in e?eo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const no=class extends Ss{constructor(e=1){super(),to(this,"_limit"),to(this,"_items",[]),this._limit=e}take(){return this._items.shift()}put(e){if(this._items.length>=this._limit){const e=this.take();this.dispatchEvent(new CustomEvent(no.DISCARDED_EVENT,{detail:e}))}this._items.push(e),this.dispatchEvent(new CustomEvent(no.EMERGED_EVENT,{detail:e}))}};let io=no;to(io,"EMERGED_EVENT","emerged"),to(io,"DISCARDED_EVENT","discarded");var so=Object.defineProperty,oo=(e,t,n)=>(((e,t,n)=>{t in e?so(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const ro=class extends Ss{constructor({allocator:e,releaser:t}){super(),oo(this,"_conveyer",new io),oo(this,"_allocator"),oo(this,"_releaser"),oo(this,"_frames",async function*(){}()),oo(this,"_state","paused"),oo(this,"_fps",30),this._allocator=e,this._releaser=t,this._conveyer.addEventListener(io.DISCARDED_EVENT,(({detail:e})=>this._releaser(e.data)))}get isRunning(){return"paused"!==this._state}put(e,t){this._frames=e[Symbol.asyncIterator]({allocate:this._allocator,...t}),this.dispatchEvent(new CustomEvent(ro.SOURCE_CHANGED_EVENT))}run({fps:e=this._fps}={}){this._fps=e,"running"!==this._state&&(this._state="running",(async()=>{for(;;){const e=this._frames;Zs(ro.FRAME_RECEIVED_EVENT);const{done:t,value:n}=await this._frames.next(this._fps),i=Qs(ro.FRAME_RECEIVED_EVENT);if(t)return this._state="paused",this.dispatchEvent(new CustomEvent(ro.ENDED_EVENT));if("paused"===this._state)return this._releaser(n.data);e===this._frames?(this._conveyer.put(n),this.dispatchEvent(new CustomEvent(ro.FRAME_RECEIVED_EVENT,{detail:i}))):this._releaser(n.data)}})())}pause(){this._state="paused"}take(){return this._conveyer.take()}};let ao=ro;oo(ao,"FRAME_RECEIVED_EVENT","framereceived"),oo(ao,"SOURCE_CHANGED_EVENT","sourcechanged"),oo(ao,"ENDED_EVENT","ended");var co=Object.defineProperty,lo=(e,t,n)=>(((e,t,n)=>{t in e?co(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const uo=class extends Ss{constructor(e){super(),lo(this,"_doProcess"),lo(this,"_conveyer",new io),this._doProcess=e,this._conveyer.addEventListener(io.DISCARDED_EVENT,(({detail:e})=>e.data.delete()))}put(e){Zs(uo.FRAME_PROCESSED_EVENT);const t=this._doProcess(e),n=Qs(uo.FRAME_PROCESSED_EVENT);this._conveyer.put(t),this.dispatchEvent(new CustomEvent(uo.FRAME_PROCESSED_EVENT,{detail:n}))}take(){return this._conveyer.take()}};let ho=uo;lo(ho,"FRAME_PROCESSED_EVENT","frameprocessed");var po=Object.defineProperty,mo=(e,t,n)=>(((e,t,n)=>{t in e?po(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const wo=class extends Ss{constructor(e){super(),mo(this,"_doDraw"),mo(this,"_conveyer",new io),mo(this,"_state","paused"),mo(this,"_fps",30),this._doDraw=e,this._conveyer.addEventListener(io.DISCARDED_EVENT,(({detail:e})=>e.data.delete()))}get isRunning(){return"paused"!==this._state}get isPausing(){return"pausing"===this._state}get isPaused(){return"paused"===this._state}put(e){this._conveyer.put(e)}take(){return this._conveyer.take()}run({fps:e=this._fps}={}){if(this._fps=e,"pausing"===this._state)this._state="running";else{if("running"===this._state)return;this._state="running"}(async()=>{let e=0;const t=n=>{const i=1e3/this._fps;n-e<i-.1*i?bs(t):(e=n,this.draw(),"pausing"===this._state&&(this._state="paused"),"paused"!==this._state&&bs(t))};bs(t)})()}async pause(){for(this._state="pausing";"pausing"===this._state;)await new Promise((e=>bs(e)));if("paused"!==this._state)throw new Error("The pause request was canceled")}draw(){const e=this._conveyer.take();if(!e)return;Zs(wo.FRAME_RENDERED_EVENT),this._doDraw(e);const t=Qs(wo.FRAME_RENDERED_EVENT);this._conveyer.put(e),this.dispatchEvent(new CustomEvent(wo.FRAME_RENDERED_EVENT,{detail:t}))}};let go=wo;function fo(){return fo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},fo.apply(null,arguments)}mo(go,"FRAME_RENDERED_EVENT","framerendered");var vo=Object.defineProperty,bo=(e,t,n)=>(((e,t,n)=>{t in e?vo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n),_o=Object.defineProperty,yo=Object.getOwnPropertyDescriptor;const Co={devicePixelRatio:"undefined"!=typeof devicePixelRatio?devicePixelRatio:1,cameraOrientation:0,maxFaces:1,logger:console};var So;const Eo=(So=class extends Ss{constructor(e,t={}){super(),bo(this,"_sdk"),bo(this,"_fs"),bo(this,"_preferences"),bo(this,"_frameSize"),bo(this,"_memory"),bo(this,"_releaser"),bo(this,"_effectPlayer"),bo(this,"_effectManager"),bo(this,"_camera"),bo(this,"_renderer"),this._sdk=e,this._fs=(({FS:e})=>({writeFile:(t,n)=>{const i=t.split("/");""===i[0]&&i.shift(),i.length>1&&i.reduce(((t,n)=>((t=>{try{return e.lstat(t),!0}catch(e){if(44===e.errno||"ENOENT"===e.code)return!1;throw e}})(t)||e.mkdir(t),`${t}/${n}`))),e.writeFile(t,n)}}))(this._sdk),this._preferences={...Co,fps:30,pauseOnEmpty:!0,...t},this._frameSize={width:e.canvas.width,height:e.canvas.height},this._memory=new Is(this._sdk,4),this._releaser=e=>this._memory.release(e),this._effectPlayer=this._sdk.EffectPlayer.create(this._sdk.EffectPlayerConfiguration.create(this._frameSize.width,this._frameSize.height)),this._effectPlayer.surfaceCreated(this._frameSize.width,this._frameSize.height),this._effectPlayer.setMaxFaces(this._preferences.maxFaces),this._effectPlayer.addFrameDataListener((e=>{this.dispatchEvent(new CustomEvent(Eo.FRAME_DATA_EVENT,{detail:new Os(e)}))})),this._effectManager=this._effectPlayer.effectManager(),this._effectManager.addEffectActivatedListener((()=>{const e=this._effectManager.current();this.dispatchEvent(new CustomEvent(Eo.EFFECT_ACTIVATED_EVENT,{detail:e}))}));const n=this._camera=new ao({allocator:e=>(this._memory.allocate(e)||new Ms(e)).data,releaser:e=>this._releaser(e.byteOffset)});let i=!1;const s=new ho((e=>{const{width:t,height:n,data:s,format:o,input:r="static"}=e,a="static"===r,c="static"===r?3:1,l=s instanceof this._sdk.FrameData?s:this._sdk.FrameData.makeFromBpc8(s.byteOffset,this._releaser,t,n,this._sdk.CameraOrientation[`DEG_${this._preferences.cameraOrientation}`],this._sdk.PixelFormat[o],!1,0);i||(this._effectPlayer.startVideoProcessing(t,n,this._sdk.CameraOrientation[`DEG_${this._preferences.cameraOrientation}`],!1,a),i=!0);const d=this._effectPlayer.processVideoFrameData(l,c);return l!==s&&l.delete(),{width:t,height:n,data:d}})),o=this._renderer=new go((({width:e,height:t,data:n})=>{var i,s,o,r;if(this._frameSize.width!==e||this._frameSize.height!==t){fo(this._frameSize,{width:e,height:t});const{width:n,height:i}=function(e,t,n){const i=Math.round(self.devicePixelRatio),[s,o]=[screen.width*i,screen.height*i],r=Math.max(1,s/e),a=Math.max(1,o/t),c=Math.max(r,a);return{width:e*(n=Math.min(n,c)),height:t*n}}(e,t,this._preferences.devicePixelRatio);this._sdk.setCanvasSize(n,i),this._effectManager.setEffectSize(n,i),this._effectPlayer.surfaceChanged(n,i)}try{this._effectPlayer.drawWithExternalFrameData(n);const e=this._sdk.ctx;e instanceof WebGLRenderingContext||e.bindFramebuffer(e.READ_FRAMEBUFFER,null)}catch(e){e instanceof WebAssembly.RuntimeError&&this.pause(),this.clearEffect(),null==(s=(i=this._preferences.logger).warn)||s.call(i,"The effect was force cleared due to the exception:"),null==(r=(o=this._preferences.logger).error)||r.call(o,e)}}));n.addEventListener(ao.FRAME_RECEIVED_EVENT,(({detail:e})=>this.dispatchEvent(new CustomEvent(Eo.FRAME_RECEIVED_EVENT,{detail:e})))),n.addEventListener(ao.FRAME_RECEIVED_EVENT,(function e(){const t=n.take();t&&_s((()=>s.put(t))),n.addEventListener(ao.FRAME_RECEIVED_EVENT,e,{once:!0})}),{once:!0}),n.addEventListener(ao.SOURCE_CHANGED_EVENT,(()=>{!i||(this._effectPlayer.stopVideoProcessing(!1),i=!1)})),n.addEventListener(ao.ENDED_EVENT,(()=>{this._preferences.pauseOnEmpty&&this.pause()})),s.addEventListener(ho.FRAME_PROCESSED_EVENT,(({detail:e})=>this.dispatchEvent(new CustomEvent(Eo.FRAME_PROCESSED_EVENT,{detail:e})))),s.addEventListener(ho.FRAME_PROCESSED_EVENT,(function e(){const t=s.take();t&&o.put(t),s.addEventListener(ho.FRAME_PROCESSED_EVENT,e,{once:!0})}),{once:!0}),o.addEventListener(go.FRAME_RENDERED_EVENT,(({detail:e})=>this.dispatchEvent(new CustomEvent(Eo.FRAME_RENDERED_EVENT,{detail:e})))),this._effectManager.addEffectEventListener((async e=>{if("recognizer_features_update"===e){if(await new Promise((e=>_s(e))),!n.isRunning){const e=s.take()||o.take();e&&s.put(e)}o.isRunning||this._renderer.draw()}})),this.setVolume(0)}static async create(e){return new this(await async function({clientToken:e,locateFile:t,canvas:n=Vs(),logger:i={warn:console.warn,error:console.error},...s}){var o;const r=await qs(t,i),{logLevel:a,print:c,printErr:l}=function(e){var t;const n=null!=(t=Object.keys(Hs).reverse().find((t=>"function"==typeof e[Hs[t]])))?t:"ERROR",i=t=>{for(const n in Hs)if(t.includes(n)){const i=e[Hs[n]];if("function"==typeof i)return void i.call(e,t)}const n=e.debug;"function"==typeof n&&n.call(e,t)};return{logLevel:n,print:i,printErr:i}}(i),d=await new Promise(((e,t)=>js({locateFile:r,print:c,printErr:l,onAbort:e=>{e instanceof WebAssembly.CompileError&&t(new Error(`Failed to compile "BanubaSDK.wasm": the file "${r("BanubaSDK.wasm")}" is invalid. This error is usually caused by misconfigured "locateFile" option, see https://docs.banuba.com/face-ar-sdk-v1/generated/typedoc/modules.html#SDKOptions. Original Error: `+e))},...s}).then(e,t)));return((e,t)=>{for(const[n,i]of Object.entries(e))$s(i)&&Object.defineProperty(e,n,{value:Ws(i,t)})})(d,(e=>d.getExceptionMessage(e))),d.UtilityManager.initialize(new d.VectorString,e),d.UtilityManager.setLogLevel(d.SeverityLevel[a]),d.setCanvasSize=(e,t)=>{Js(n,{width:e,height:t})},d.createContext(n,!0,!0,{alpha:!0,antialias:!1,depth:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!0,stencil:!1}),d.canvas=n,"undefined"==typeof WebGL2RenderingContext&&(["WEBGL_depth_texture","ANGLE_depth_texture","GL_ANGLE_depth_texture","OES_texture_half_float"].every((e=>{var t;return null==(t=d.canvas.getContext("webgl"))?void 0:t.getExtension(e)}))||null==(o=i.warn)||o.call(i,"Depth textures are not supported on the current device.")),d}(e),e)}get FS(){return this._fs}get canvas(){return this._sdk.canvas}get frameSize(){return this._frameSize}get preferences(){return this._preferences}get isPlaying(){return this._renderer.isRunning}use(e,t){this._camera.put(e,t),this._renderer.isRunning&&!this._renderer.isPausing&&this._camera.run()}async addModule(...e){await Promise.all(e.map((e=>e._bind({FS:this.FS}))))}async applyEffect(e){const t=this,n=e.name;return await e._bind({FS:this.FS,evalJs:this._evalJs.bind(this),callJsMethod:this._callJsMethod.bind(this)}),new Promise((i=>{var s,o,r,a;this.addEventListener(Eo.EFFECT_ACTIVATED_EVENT,c,{once:!0}),this.addEventListener(Eo.EFFECT_ACTIVATED_EVENT,l);try{this._effectManager.load(n)}catch(t){this.removeEventListener(Eo.EFFECT_ACTIVATED_EVENT,c),this.removeEventListener(Eo.EFFECT_ACTIVATED_EVENT,l),e._unbind(),this.clearEffect(),null==(o=(s=this._preferences.logger).warn)||o.call(s,"The effect was force cleared due to the exception:"),null==(a=(r=this._preferences.logger).error)||a.call(r,t)}function c({detail:e}){i(e)}function l({detail:i}){i.url()!==`/${n}`&&(t.removeEventListener(Eo.EFFECT_ACTIVATED_EVENT,l),e._unbind())}}))}async clearEffect(){return new Promise((e=>{this.addEventListener(Eo.EFFECT_ACTIVATED_EVENT,(()=>e()),{once:!0}),this._effectManager.load("")}))}callJsMethod(e,t=""){return this._callJsMethod(e,t)}setVolume(e){this._effectManager.setEffectVolume(e),this.dispatchEvent(new CustomEvent("volumechange",{detail:e}))}play({fps:e=this._preferences.fps,pauseOnEmpty:t=!0}={}){fo(this._preferences,{fps:e,pauseOnEmpty:t}),this._camera.run({fps:e}),this._renderer.run({fps:e})}async pause(){this._camera.pause();try{await this._renderer.pause()}catch(e){throw this._camera.run(),e}}async destroy(){await this.pause(),this.removeAllEventListeners(),await this.clearEffect(),this._effectPlayer.surfaceDestroyed(),this._memory.reset();for(const e in this)e.startsWith("_")&&Object.defineProperty(this,e,{get(){throw new Error("The player is destroyed.")},set(){throw new Error("The player is destroyed.")}})}async _evalJs(e){return new Promise((async t=>{t(this._effectManager.current().evalJsSync(e)),this._renderer.isRunning||this._renderer.draw()}))}async _callJsMethod(e,t=""){this._effectManager.current().callJsMethod(e,t),this._renderer.isRunning||this._renderer.draw()}},bo(So,"FRAME_RECEIVED_EVENT","framereceived"),bo(So,"FRAME_PROCESSED_EVENT","frameprocessed"),bo(So,"FRAME_RENDERED_EVENT","framerendered"),bo(So,"FRAME_DATA_EVENT","framedata"),bo(So,"EFFECT_ACTIVATED_EVENT","effectactivated"),So);let xo=Eo;((e,t,n,i)=>{for(var s,o=yo(t,n),r=e.length-1;r>=0;r--)(s=e[r])&&(o=s(t,n,o)||o);o&&_o(t,n,o)})([Yi("Please, use Effect.evalJs() instead.")],xo.prototype,"callJsMethod");const ko=(e=300,t=150)=>{let n;return"undefined"==typeof OffscreenCanvas?(n=document.createElement("canvas"),n.width=e,n.height=t):n=new OffscreenCanvas(e,t),n},Mo=(e,t,n)=>{const i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),i},To=e=>{const t=e.createRenderbuffer();return e.bindRenderbuffer(e.RENDERBUFFER,t),e.renderbufferStorage(e.RENDERBUFFER,e.RGB8,1,1),e.bindRenderbuffer(e.RENDERBUFFER,null),t},Io=async e=>{const t=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),await new Promise((n=>function i(){((e,t)=>{const n=e.clientWaitSync(t,0,0);if(n===e.WAIT_FAILED)throw new Error("GPU operations complete wait failed");return n===e.CONDITION_SATISFIED||n===e.ALREADY_SIGNALED})(e,t)?n():((e,t)=>{vs().setTimeout(e,t)})(i,2)}())),e.deleteSync(t)},Ro={alpha:!0,antialias:!1,depth:!1,desynchronized:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,stencil:!1},Ao=(e,t)=>{let n=((e,t={})=>{const n=e||ko(),i=n.getContext("webgl2",{...Ro,...t});if(null==i)return null;const s=Mo(i,i.VERTEX_SHADER,"#version 300 es\n#define GLSLIFY 1\n\nuniform vec2 u_scale;\nout vec2 v_tex_uv;\n\n// https://rauwendaal.net/2014/06/14/rendering-a-screen-covering-triangle-in-opengl/\nvoid main() {\n  float x = -1.0 + float((gl_VertexID & 1) << 2);\n  float y = -1.0 + float((gl_VertexID & 2) << 1);\n\n  v_tex_uv.x = (x + 1.0) * 0.5;\n  v_tex_uv.y = (y + 1.0) * 0.5;\n\n  gl_Position = vec4(x, y, 0, 1);\n  gl_Position.xy *= u_scale;\n}\n"),o=Mo(i,i.FRAGMENT_SHADER,"#version 300 es\n\nprecision mediump float;\n#define GLSLIFY 1\n\nin vec2 v_tex_uv;\nuniform sampler2D u_texture;\n\nlayout(location = 0) out vec4 fragColor0;\nlayout(location = 1) out vec4 fragColor1;\n\nvoid main () {\n  fragColor0 = texture(u_texture, vec2(v_tex_uv.x, 1. - v_tex_uv.y)); // flip Y for screen render\n  fragColor1 = texture(u_texture, v_tex_uv);  // keep upside down for read pixels\n}\n  "),r=((e,t,n)=>{const i=e.createProgram();return e.attachShader(i,t),e.attachShader(i,n),e.linkProgram(i),e.useProgram(i),i})(i,s,o),a=(e=>{const t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGB,1,1,0,e.RGB,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.bindTexture(e.TEXTURE_2D,null),t})(i),c=To(i),l=To(i),d=i.createFramebuffer();i.bindTexture(i.TEXTURE_2D,a),i.bindFramebuffer(i.FRAMEBUFFER,d),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,c),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT1,i.RENDERBUFFER,l),i.drawBuffers([i.COLOR_ATTACHMENT0,i.COLOR_ATTACHMENT1]);const u=i.createBuffer();i.bindBuffer(i.PIXEL_PACK_BUFFER,u),i.bufferData(i.PIXEL_PACK_BUFFER,0,i.STREAM_READ);const h=i.getUniformLocation(r,"u_scale");i.deleteProgram(r),i.deleteShader(o),i.deleteShader(s);const p=i.getParameter(i.IMPLEMENTATION_COLOR_READ_FORMAT),m=i.getParameter(i.IMPLEMENTATION_COLOR_READ_TYPE),w=p===i.RGB?"RGB":"RGBA",g=w.length;let f;return"RGB"===w&&i.pixelStorei(i.PACK_ALIGNMENT,1),{get width(){return i.drawingBufferWidth},get height(){return i.drawingBufferHeight},get format(){return w},async drawImage(e,t,s,o,r){i.texImage2D(i.TEXTURE_2D,0,p,p,m,e);const a=Math.sign(o),u=Math.sign(r);(h.x!==a||h.y!==u)&&i.uniform2fv(h,new Float32Array([h.x=a,h.y=u])),o<0&&(o=Math.abs(o)),r<0&&(r=Math.abs(r)),(n.width!==o||n.height!==r)&&(n.width=o,n.height=r,i.bindRenderbuffer(i.RENDERBUFFER,c),i.renderbufferStorage(i.RENDERBUFFER,i.RGB8,n.width,n.height),i.bindRenderbuffer(i.RENDERBUFFER,l),i.renderbufferStorage(i.RENDERBUFFER,i.RGB8,n.width,n.height),i.bindRenderbuffer(i.RENDERBUFFER,null),i.viewport(0,0,n.width,n.height)),i.drawArrays(i.TRIANGLES,0,3),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.blitFramebuffer(0,0,o,r,0,0,o,r,i.COLOR_BUFFER_BIT,i.NEAREST),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,d)},getImageData:async(e,t,n,s,o)=>(f!==n*s*g&&i.bufferData(i.PIXEL_PACK_BUFFER,f=n*s*g,i.STREAM_READ),i.readBuffer(i.COLOR_ATTACHMENT1),i.readPixels(e,t,n,s,p,m,0),i.readBuffer(i.COLOR_ATTACHMENT0),await Io(i),i.getBufferSubData(i.PIXEL_PACK_BUFFER,0,new DataView(o.buffer),o.byteOffset,f),{width:n,height:s,data:o,format:w}),createImageBitmap:async()=>await createImageBitmap(n),dispose(){i.deleteBuffer(u),i.deleteFramebuffer(d),i.deleteRenderbuffer(l),i.deleteRenderbuffer(c),i.deleteTexture(a)}}})(e,t);return null==n&&(n=((e,t={})=>{const n=e||ko(),i=n.getContext("2d",t);return{get width(){return n.width},get height(){return n.height},get format(){return"RGBA"},drawImage:async(e,t,s,o,r)=>{var a,c;n.width=null!=(a=e.videoWidth)?a:e.width,n.height=null!=(c=e.videoHeight)?c:e.height,i.save(),i.translate(t,s),i.scale(Math.sign(o),Math.sign(r)),e instanceof ImageData?i.putImageData(e,t,s):i.drawImage(e,0,0,Math.abs(o),Math.abs(r)),i.restore()},getImageData:async(e,t,n,s,o)=>{const{width:r,height:a,data:c}=i.getImageData(e,t,n,s);return o.set(c),{width:r,height:a,data:o,format:"RGBA"}},createImageBitmap:async()=>createImageBitmap(n),dispose:()=>{}}})(e,t)),n};function $o(){return $o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},$o.apply(null,arguments)}const Lo=Ao;var Po=Object.defineProperty;const Do="undefined"!=typeof MediaStream?MediaStream:class{constructor(){throw new Error("The environment does not support MediaStream API")}},No=class extends Do{constructor(e){(e=>{if(!e||!("canvas"in e))throw new Error(`The "player" must be a Player instance, but "${e}" is received. Make sure you haven't forgot to place "await" before Player.create() call.`)})(e),super();const t=No.cache.get(e);if(!t||!t.active){let t=e.canvas;if(((t.getContext("webgl2")||t.getContext("webgl")).getContextAttributes()||{}).alpha){const n=t,i=t=document.createElement("canvas"),s=Lo(i,{alpha:!1});e.addEventListener("framerendered",(()=>s.drawImage(n,0,0,n.width,n.height)))}t.captureStream().getTracks().forEach((e=>this.addTrack(e))),No.cache.set(e,this)}return No.cache.get(e)}getVideoTrack(e=0){return this.getVideoTracks()[e]}getAudioTrack(e=0){return this.getAudioTracks()[e]}stop(){this.getTracks().forEach((e=>e.stop()))}};let Oo=No;((e,t,n)=>{((e,t,n)=>{t in e?Po(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,t+"",new WeakMap)})(Oo,"cache");const Bo={horizontalFlip:!1,resize:(e,t)=>[e,t],crop:(e,t)=>[0,0,e,t]};var Fo,Uo=Object.defineProperty,jo=(e,t,n)=>(((e,t,n)=>{t in e?Uo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n),Vo=Object.defineProperty,Go=Object.getOwnPropertyDescriptor;const qo={loop:!1};class Ho{constructor(e,t){jo(this,"_video",null),jo(this,"_src"),jo(this,"_options"),this._src=e,this._options={...qo,...t}}async*[Fo=Symbol.asyncIterator](e){var t;const n=await(null!=(t=this._video)?t:this._video=(async(e,t={})=>new Promise((n=>{const i=document.createElement("video");if(i.muted=!0,i.controls=!1,i.playsInline=!0,$o(i,t),e instanceof globalThis.MediaStream)i.srcObject=e,i.addEventListener("ended",(()=>i.srcObject=null),{once:!0}),e.addEventListener("inactive",(()=>i.dispatchEvent(new CustomEvent("ended"))),{once:!0});else{if("string"!=typeof e){const t=e=URL.createObjectURL(e);i.addEventListener("emptied",(()=>URL.revokeObjectURL(t)),{once:!0})}i.crossOrigin="anonymous",i.src=e,i.addEventListener("ended",(()=>i.src=""),{once:!0})}i.style.position="fixed",i.style.zIndex="-9999999",i.style.opacity="0.0000000001",document.body.appendChild(i),i.addEventListener("emptied",(()=>i.remove()),{once:!0});const s=setInterval((()=>i.readyState),300);i.addEventListener("play",(()=>clearInterval(s)),{once:!0}),i.addEventListener("play",(()=>n(i)),{once:!0}),i.addEventListener("loadedmetadata",(()=>i.play()),{once:!0})})))(this._src,this._options)),i=Ao(),s=((e={})=>{const{resize:t,crop:n,horizontalFlip:i}={...Bo,...e};return{dxywh(e){var n,s;const o=null!=(n=e.videoWidth)?n:e.width,r=null!=(s=e.videoHeight)?s:e.height;let[a,c]=[0,0],[l,d]=t(o,r);return i&&([a,l]=[l,-l]),[a,c,l,d]},sxywh(e){var t,i;const s=null!=(t=e.videoWidth)?t:e.width,o=null!=(i=e.videoHeight)?i:e.height,[r,a,c,l]=n(s,o);return[r,a,c,l]}}})(e);n.addEventListener("ended",(()=>this.stop()),{once:!0}),n.addEventListener("emptied",(()=>this.stop()),{once:!0});const o=e&&e.allocate;for(;this._video;){i.drawImage(n,...s.dxywh(n));const e=s.sxywh(i);if(o){const t=o(e[2]*e[3]*i.format.length);yield{...await i.getImageData(...e,t),input:"live"}}else{const t=await i.createImageBitmap();yield{width:t.width,height:t.height,data:t,rect:e,input:"live"}}}}stop(){this._video&&this._video.then((e=>{e.srcObject=null,e.src=""})),this._video=null}}((e,t,n,i)=>{for(var s,o=Go(t,n),r=e.length-1;r>=0;r--)(s=e[r])&&(o=s(t,n,o)||o);o&&Vo(t,n,o)})([((e=-1)=>function(t,n,i){const s=i,o=s.value;return{...s,value:async function*(...t){const n=o.apply(this,t);let i=0,s=0;for(;;){const t=1e3/e,o=.1*t;for(;(s=performance.now())-i<t-o;)await new Promise((e=>bs(e)));i=s;const{done:r,value:a}=await n.next();if(r)return a;const c=yield a;void 0!==c&&(e=c)}}}})(30)],Ho.prototype,Fo);var zo=Object.defineProperty,Wo=(e,t,n)=>(((e,t,n)=>{t in e?zo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const Jo=class{constructor(e){if(Wo(this,"_video",null),Wo(this,"_stream",null),Jo.cache.has(e))return Jo.cache.get(e);Jo.cache.set(e,this),this._stream=e}async*[Symbol.asyncIterator](e){var t;const n=null!=(t=this._video)?t:this._video=new Ho(this._stream),i=e?n[Symbol.asyncIterator](e):n[Symbol.asyncIterator]();let s;for(;;){const{done:e,value:t}=await i.next(s);if(e)break;s=yield t}this.stop()}stop(){var e,t,n;const i=null!=(n=null==(t=null==(e=this._stream)?void 0:e.getVideoTracks)?void 0:t.call(e))?n:[];for(const e of i)e.stop();this._stream&&Jo.cache.delete(this._stream),this._stream=null,this._video=null}};let Yo=Jo;function Ko(e,t){return(e&t)==t}function Xo(e){return null!=e&&null!=e}function Zo(e){if(!e)return;let t=e.getVideoTracks();if(t.length>0){let n=t[0];e.removeTrack(n),n.stop()}}function Qo(e){if(!e)return;let t=e.getAudioTracks();if(t.length>0){let n=t[0];e.removeTrack(n),n.stop()}}Wo(Yo,"cache",new WeakMap);class er{static stopStream(e){!function(e){Zo(e),Qo(e)}(e)}static stopStreamVideo(e){Zo(e)}static stopStreamAudio(e){Qo(e)}static isEnded(e){return function(e){if(!e)return!0;let t=!0,n=e.getVideoTracks();for(let e=0;e<n.length;e++)"ended"!=n[e].readyState&&(t=!1);let i=e.getAudioTracks();for(let e=0;e<i.length;e++)"ended"!=i[e].readyState&&(t=!1);return t}(e)}}function tr(){return Math.round((new Date).getTime()/1e3)}function nr(e=10){let t="";for(let n=0;n<e;n++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".charAt(Math.floor(52*Math.random()));return t}function ir(e=10){let t=nr(e-5),n=`${Date.now()}`;return n=n.substring(n.length-5,n.length-1),t+n}function sr(e,t){return Math.floor(Math.random()*(t-e+1)+e)}class or{constructor(){this.mEffects=new Map,this.mModules=new Map}async loadModule(e){let t=this.mModules.get(e);return t||(t=await Ji.preload(e),this.mModules.set(e,t)),t}async loadEffect(e){let t=this.mEffects.get(e);return t||(t=await es.preload(e),this.mEffects.set(e,t)),t}async addModules(e){for(let t of this.mModules.values())await e.addModule(t)}}class rr{constructor(e,t,n){this.mOutStreamCB=e,this.mEffectActivatedCB=t,this.mToken=n,this.mPlayer=void 0,this.mWebAR=void 0,this.mEffects=new Map,this.mLoader=new or,this.mOutStream=void 0,this.mInStream=void 0,this.mStarted=!1}async loadModule(e){await this.mLoader.loadModule(e)}async stop(){Di.g.log(3,"BanubaCtrl : stop"),this.mWebAR&&(this.mWebAR.stop(),this.mWebAR=void 0),this.mPlayer&&(await this.mPlayer.destroy(),this.mPlayer=void 0),this.mInStream&&(er.stopStream(this.mInStream),this.mInStream=void 0),this.mOutStream&&(er.stopStream(this.mOutStream),this.mOutStream=void 0),this.mStarted=!1}async start(){this.mPlayer&&await this.stop(),this.mPlayer=await xo.create({clientToken:this.mToken,locateFile:{"BanubaSDK.data":"https://static.ip.tv/banuba/banuba-webar/dist/BanubaSDK.data","BanubaSDK.wasm":"https://static.ip.tv/banuba/banuba-webar/dist/BanubaSDK.wasm","BanubaSDK.simd.wasm":"https://static.ip.tv/banuba/banuba-webar/dist/BanubaSDK.simd.wasm"}}),this.mLoader.addModules(this.mPlayer),this.mWebAR=new Oo(this.mPlayer),this.mStarted=!0,this.mPlayer.addEventListener("effectactivated",(({detail:e})=>{Di.g.log(3,`BanubaCtrl : effectactivated : name:${e.scene().getName()}`),this.mEffectActivatedCB()}))}started(){return this.mStarted}async setEffect(e){if(this.mInStream)if(e){if(!this.mWebAR){Di.g.log(3,"BanubaCtrl : setEffect : starting engine..."),await this.start(),this.mPlayer.use(new Yo(this.mInStream)),this.mPlayer.play();const e=[this.mWebAR.getVideoTracks()[0]];this.mInStream.getAudioTracks().length>0?e.push(this.mInStream.getAudioTracks()[0]):Di.g.log(3,"BanubaCtrl : setEffect : no audio track"),this.mOutStream=new MediaStream(e),this.mOutStreamCB&&this.mOutStreamCB()}Di.g.log(3,`BanubaCtrl : setEffect : ${e}`);const t=await this.mLoader.loadEffect(e);await this.mPlayer.applyEffect(t)}else Di.g.log(3,"BanubaCtrl : setEffect : no effect selected, stopping..."),await this.stop(),this.mOutStreamCB&&this.mOutStreamCB();else Di.g.log(3,"BanubaCtrl : setEffect : no input stream...")}getInStream(){return this.mInStream}setInStream(e){return this.mInStream!=e&&(this.mPlayer&&this.mPlayer.use(new Yo(e)),this.mInStream&&er.stopStream(this.mInStream),this.mInStream=e,!0)}stream(){return this.mOutStream}}class ar{constructor(e,t,n,i,s,o="50%",r=""){this.icon=e,this.title=t,this.text=n,this.width=o,this.height=r,this.actionCB=i,this.cancelCB=s,l()("#dbdisplay_ok, #dbdisplay_confirm").unbind(),l()("#dbdisplay_ok, #dbdisplay_confirm").click((()=>{l()("#rpchnconfhide").click(),this.actionCB&&this.actionCB(),this.dismiss(),l()("#dbdisplay_ok, #dbdisplay_confirm").unbind()})),l()("#dbdisplay_cancel").unbind(),l()("#dbdisplay_cancel").click((()=>{this.cancelCB&&this.cancelCB(),this.dismiss(),l()("#dbdisplay_cancel").unbind()}))}present(){l()("#dbdisplay_size").css("height",this.height),l()("#dbdisplay_size").css("width",this.width),l()("#dbdisplay_icon").html(this.icon),l()("#dbdisplay_title").html(this.title),l()("#dbdisplay_text").html(this.text),l()("#dbdisplay").show(),l()("#dialog").show()}dismiss(){l()(".dialog").hide(),l()("#dialog").hide(),l()("#dbdisplay").hide(),l()("#dbdisplay_title").addClass("tc")}}class cr extends ar{constructor(e,t,n,i,s,o,r){super(e,t,n,i,s,o,r)}present(){l()("#dbdisplay_icon").addClass("tr"),l()("#dbdisplay_title").css("color","#FF0000"),l()(".dbdisplay_ok").show(),l()(".dbdisplay_confirm").hide(),super.present()}}class lr extends cr{constructor(e,t,n,i,s,o){super("&#xE000;",e,t,n,i,s,o)}}class dr extends cr{constructor(e,t,n,i,s,o){super("&#xE002;",e,t,n,i,s,o)}present(){l()("#dbdisplay").find(".pt.dx").hide(),super.present()}}class ur extends ar{textButtonAction;constructor(e,t,n,i,s,o,r,a){super(e,t,n,s,o,r,a),this.textButtonAction=i||"OK"}present(){l()("#dbdisplay_icon").addClass("tr"),l()("#dbdisplay_icon").off("click"),l()("#dbdisplay_ok").text(this.textButtonAction),l()("#dbdisplay_ok").css({background:"#1A3975",padding:"14px 24px",fontWeight:"500",fontSize:"16px",fontFamily:"inter, sans-serif",marginBottom:"10px"}),l()("#dbdisplay_ok").show(),l()(".dbdisplay_confirm").hide(),l()("#dbdisplay_title").removeClass("tc"),l()("#dbdisplay_text").css("text-align","center"),l()("#dbdisplay_title").css({color:"#58656F",height:"30px",fontSize:"16px",fontFamily:"inter, sans-serif",display:"flex","align-items":"center"}),l()("#dbdisplay_size .pt.dx").filter((function(){return"X"===l()(this).text()})).hide(),super.present()}}class hr extends ar{constructor(e,t,n,i,s,o){super("&#xE160;",e,t,n,i,s,o)}present(){l()("#dbdisplay .dx").hide(),l()("#dbdisplay_icon").removeClass("tr"),l()("#dbdisplay_title").css("color","#EC7F00"),l()(".dbdisplay_ok").hide(),l()(".dbdisplay_confirm").show(),super.present()}}class pr extends ar{constructor(e,t,n,i,s,o){super("&#xE160;",e,t,n,i,s,o)}present(){l()(".fr.pt5.pl5.pr10.pb5.w100").css("border","none"),l()("#dbdisplay .dx").hide(),l()("#dbdisplay_icon").removeClass("tr"),l()(".dbdisplay_ok").hide(),l()(".dbdisplay_confirm").show(),l()(".dbdisplay_confirm").css({display:"flex","text-align":"center","justify-content":"center",gap:"14px",padding:"8px",width:"258px"}),l()("#dbdisplay_confirm").css({cursor:"pointer",background:"#1A3975",border:"#1A3975 solid 1px","border-radius":"5px",width:"120px",height:"40px","align-content":"center",color:"#FEFEFE","font-weight":"500","font-size":"16px"}),l()("#dbdisplay_cancel").css({cursor:"pointer",background:"#FEFEFE",border:"#1A3975 solid 1px","border-radius":"5px",width:"120px",height:"40px","align-content":"center","font-weight":"500","font-size":"16px",color:"#1A3975"}),super.present()}}class mr extends ar{constructor(e,t,n,i,s,o){super("sms_failed",e,t,n,i,s,o)}present(){l()("#dbdisplay .dx").hide(),l()("#dbdisplay_icon").show(),l()("#dbdisplay_icon").removeClass("tr"),l()("#dbdisplay_title").removeClass("tc"),l()(".dbdisplay_ok").hide(),l()(".dbdisplay_confirm").show(),super.present()}}class wr extends ar{constructor(e,t,n,i,s,o){super("&#xE88E;",e,t,n,i,s,o)}present(){l()("#dbdisplay_icon").removeClass("tr"),l()("#dbdisplay_title").css("color","#EC7F00"),l()(".dbdisplay_ok").show(),l()(".dbdisplay_confirm").hide(),l()("#dbdisplay").find(".pt.dx").hide(),super.present()}}async function gr(e){const t=await window.devices.getAudioOutputDevices();let n;if(""===window.devices.getAudioOutputDevice()?(n=t[0],n&&window.devices.setAudioOutputDevice(n.deviceId)):n=window.devices.getAudioOutputDevice(),0===t.length)return l()(`#${e}`).hide(),!1;l()(`#${e}`).html(""),t.forEach((t=>{const i=t.label;t.deviceId===n?l()(`#${e}`).append(`<option value="${t.deviceId}" selected>${i}</option>`):l()(`#${e}`).append(`<option value="${t.deviceId}">${i}</option>`)}))}function fr(e){return window.devicesStream=e,window.camNotReadable=!1,!1}function vr(e){"NotReadableError"===e.name&&(window._channel.showTemporaryMessage(window.i18n.get("error-cam-not-ready"),"alert"),window.camNotReadable=!0)}async function br(){window.devicesStream&&window.devicesStream.getTracks().forEach((e=>{e.stop()}));const e=await window.devices.checkPermissions(),t=l()("#audio_input_select").val(),n=l()("#video_select").val(),i={};return e.audioAllowed&&(i.audio={deviceId:t?{exact:t}:void 0}),e.webcamAllowed&&(i.video={deviceId:n?{exact:n}:void 0}),await navigator.mediaDevices.getUserMedia(i).then(fr).catch(vr)}async function _r(e,t,n,i){const s=e;if(!s)return E("Request transmission needs 'target'"),!1;const o=t?"1":"0",r=n?"1":"0";return window.session&&window.session.isStarted()&&window._channel.isOperator(p.ENGINE_NICK)?(l()("#dbdev_cancel").hide(),l()(".dx").hide()):l()(".dx").show(),l()("#dbdev_confirm").attr("target",s),l()("#dbdev_confirm").attr("tx",o),l()("#dbdev_confirm").attr("mediavoice",r),i.audioAllowed?(window._channel.isAudioMuted()?(window._channel.muteAudio(),window.devices.muteAudioDevice(),l()("#dbdev-audio-input-toggle").removeClass("tb").addClass("tg"),l()("#dbdev-audio-input-toggle").html("toggle_off")):(window._channel.unmuteAudio(),window.devices.unmuteAudioDevice(),l()("#dbdev-audio-input-toggle").removeClass("tg").addClass("tb"),l()("#dbdev-audio-input-toggle").html("toggle_on")),l()("#audio_input_select").show()):(l()("#dbdev-audio-input-toggle").removeClass("tb").addClass("tg"),l()("#dbdev-audio-input-toggle").html("toggle_off"),l()("#audio_input_select").html(`<option value="">${window.i18n.get("disabled")}</option>`),l()("#video_select").show()),i.webcamAllowed?(window._channel.isVideoMuted()?(window._channel.muteVideo(),window.devices.muteVideoDevice(),l()("#banuba-area").hide(),l()("#dbdev-video-toggle").removeClass("tb").addClass("tg"),l()("#dbdev-video-toggle").html("toggle_off")):(window._channel.unmuteVideo(),window.devices.unmuteVideoDevice(),l()("#dbdev-video-toggle").removeClass("tg").addClass("tb"),l()("#dbdev-video-toggle").html("toggle_on"),p.CONFIG.banubaEffect&&l()("#banuba-area").show()),l()("#video_select").show()):(l()("#dbdev-video-toggle").removeClass("tb").addClass("tg"),l()("#dbdev-video-toggle").html("toggle_off"),l()("#video_select").html(`<option value="">${window.i18n.get("disabled")}</option>`),l()("#video_select").show(),l()("#banuba-area").hide()),await gr("audio_output_select"),navigator.mediaDevices.addEventListener("devicechange",window.devices.getDeviceChangeCB()),!l()("#channelBody").is(":visible")||l()("#channelList").is(":visible")||""===window._channel.getName()||(l()(".dbdev_confirm").show(),l()(".dialog").hide(),l()("#dbdev").show(),l()(".modal").show(),l()("#dialog").show(),window.resizeMedia.update()),!1}async function yr(e,t,n){if(p.IFRAME)return!1;if(window.metaverse?.started)return!1;window.devicesPermissions=await window.devices.checkPermissions();const i=window._channel.getModes().A;E(`[startDevicesDialog] target: ${e}, enableTx: ${t}, mediaVoice: ${n}, permissions: ${JSON.stringify(window.devicePermissions)}`);const s=l()("#input_devices").attr("from");if(i&&"config"!==s?l()("#dbdev_quit").show():(l()("#dbdev_quit").hide(),l()("#input_devices").attr("from","")),!window.devicesPermissions.webcamAllowed&&!window.devicesPermissions.audioAllowed){if("NotAllowedError"===window.devicesPermissions.webcamError||"NotAllowedError"===window.devicesPermissions.audioError){l()(".dialog").hide();const e=window.i18n.get("devices-blocked-title"),t=window.i18n.get("devices-blocked");return new dr(e,t,(()=>{l()(".dialog").hide()}),void 0,500).present(),!1}if("NotReadableError"===window.devicesPermissions.webcamError||"NotReadableError"===window.devicesPermissions.audioError){l()(".dialog").hide();const e=window.i18n.get("devices-blocked-title"),t=window.i18n.get("devices-used-by-others");return new dr(e,t,(()=>{l()(".dialog").hide()}),void 0,500).present(),!1}}if(!window.devicesPermissions.webcamAllowed&&window.devicesPermissions.hasVideoInput){l()(".dialog").hide();const i=window.i18n.get("devices-webcam-blocked-title"),s=window.i18n.get("devices-webcam-blocked");return new dr(i,s,(()=>{l()(".dialog").hide(),_r(e,t,n,window.devicesPermissions)}),void 0,500).present(),!1}if(!window.devicesPermissions.audioAllowed&&window.devicesPermissions.hasAudioInput){l()(".dialog").hide();const i=window.i18n.get("devices-microphone-blocked-title"),s=window.i18n.get("devices-microphone-blocked");return new dr(i,s,(async()=>{l()(".dialog").hide(),await _r(e,t,n,window.devicesPermissions)}),void 0,500).present(),!1}if(!window.devicesPermissions.hasVideoInput&&!window.devicesPermissions.hasAudioInput){l()(".dialog").hide();const e=window.i18n.get("devices-not-found-title"),t=window.i18n.get("devices-not-found");return new dr(e,t,(()=>{l()(".dialog").hide()}),void 0,500).present(),!1}if(!window.devicesPermissions.hasVideoInput){l()(".dialog").hide();const i=window.i18n.get("devices-camera-not-found-title"),s=window.i18n.get("devices-camera-not-found");return new wr(i,s,(async()=>{l()(".dialog").hide(),await _r(e,t,n,window.devicesPermissions)}),void 0,500).present(),!1}if(!window.devicesPermissions.hasAudioInput){l()(".dialog").hide();const i=window.i18n.get("devices-microphone-not-found-title"),s=window.i18n.get("devices-microphone-not-found");return new wr(i,s,(async()=>{l()(".dialog").hide(),await _r(e,t,n,window.devicesPermissions)}),void 0,500).present(),!1}return await _r(e,t,n,window.devicesPermissions),!1}class Cr{constructor(e,t,n,i){this.mSetupDevicesModalOpenCB=e,this.mSetupDevicesModalCloseCB=t,this.mSetupDevicesModalStartedCB=n,this.mSetupDevicesModalResetCB=i,this.mSelectSourceDiv=l()("#select_source"),this.mAudioSelect=l()("#audio_input_select"),this.mVideoSelect=l()("#video_select"),this.mInputSelectModal=l()("div.modal-content"),this.mLocalVideo=l()("#webcam_preview"),this.mVideoStartScanResolutionsBtn=l()("#video_start_scan_resolutions_btn"),this.mVideoStopScanResolutionsBtn=l()("#video_stop_scan_resolutions_btn"),this.mModal=l()("#input_devices_popup"),this.mVideoScanning=!1,this.mGumStream=null,this.mGumStreamCloneNoAudio=null,this.mAudioSource=null,this.mVideoSource=null,this.mDevicesListed=!1,this.mSupportedResolutions=[],this.mVideoStartScanResolutionsBtn.on("click",(()=>{this.scanResolutions()})),this.mVideoStopScanResolutionsBtn.on("click",(()=>{Ai.enableCtrl(this.mVideoStopScanResolutionsBtn,!1),this.mVideoScanning=!1}))}start(){if(navigator.mediaDevices){if(p.IFRAME)return!1;navigator.mediaDevices.enumerateDevices().then((e=>{this.mAudioSelect.empty(),this.mVideoSelect.empty(),this.setSources(e),this.mAudioSource=this.mAudioSelect.val(),this.mVideoSource=this.mVideoSelect.val(),Di.g.log(3,`PanelDevices : start : audio:${this.mAudioSource}, video:${this.mVideoSource}`),this.setupUserMedia()})).catch((e=>{Di.g.log(3,`${e.name}: ${e.message}`)})),Di.g.log(3,`PanelDevices : start : audio:${this.mAudioSource}, video:${this.mVideoSource}`)}else Di.g.log(3,"PanelDevices : start : getUserMedia not supported in this browser!")}setupUserMedia(){this.loadUserMedia((e=>{Di.g.log(3,"PanelDevices : setupUserMedia : Received local stream");const t=e.clone();Ri.stopStreamAudio(t),this.mGumStream=e,this.mGumStreamCloneNoAudio=t,this.setStreamSrc(),this.mSetupDevicesModalStartedCB()}))}setStreamSrc(e){this.mLocalVideo[0].srcObject=e||this.mGumStreamCloneNoAudio}stop(){Di.g.log(3,"PanelDevices : stop"),Ri.stopStream(this.mGumStream),Ri.stopStream(this.mGumStreamCloneNoAudio),this.mLocalVideo[0].srcObject=null,this.mGumStream=null,this.mGumStreamCloneNoAudio=null,this.mSupportedResolutions=[]}stream(){return this.mGumStream}setupDevicesModal(e){this.mAudioSelect.change((()=>{this.mAudioSource=this.mAudioSelect.val(),this.reset()})),this.mVideoSelect.change((()=>{this.mVideoSource=this.mVideoSelect.val(),this.reset()})),l()("#input_devices_popup");const t=l()("#input_devices"),n=l()("#dbdev_confirm");t.on("click",(()=>{this.mModal.css("display","block"),yr(window.engineNick,!0,!1),this.mDevicesListed||(this.mDevicesListed=!0,e()),setTimeout((()=>{"none"!==window._captureCtrl.getSelectedEffect()&&window._captureCtrl.updateBanubaEffect(window._captureCtrl.getSelectedEffect())}),2e3),this.mSetupDevicesModalOpenCB&&this.mSetupDevicesModalOpenCB()})),n.on("click",(()=>{this.close(!0)}))}close(e=!1){this.mModal.css("display","none"),this.mSetupDevicesModalCloseCB&&this.mSetupDevicesModalCloseCB(e)}setSources(e){this.mSelectSourceDiv.removeClass("hidden");let t=0,n=0,i=!1,s=!1;e.forEach((e=>{const o=l()("<option></option>");o.val(e.deviceId),o.text(e.label),Di.g.log(3,`PanelDevices : kind:${e.kind}, label:${e.label}, deviceId:${e.deviceId}`),"audioinput"===e.kind?(t+=1,""===o.text()&&o.text(`Audio ${t}`),o.appendTo(this.mAudioSelect),this.mAudioSource&&this.mAudioSource==e.deviceId&&(i=!0)):"videoinput"===e.kind&&(n+=1,""===o.text()&&o.text(`Video ${n}`),o.appendTo(this.mVideoSelect),this.mVideoSource&&this.mVideoSource==e.deviceId&&(s=!0))})),i?this.mAudioSelect.val(this.mAudioSource):this.mAudioSource=null,s?this.mVideoSelect.val(this.mVideoSource):this.mVideoSource=null}audioSource(){return this.mAudioSource}videoSource(){return this.mVideoSource}reset(){this.mSetupDevicesModalResetCB((()=>{this.stop(),this.start()}))}scanResolutions(e){this.mVideoScanning?Di.g.log(3,"PanelDevices : scanResolutions : already scanning"):(Ai.enableCtrl(this.mVideoStartScanResolutionsBtn,!1),Ai.enableCtrl(this.mVideoStopScanResolutionsBtn,!0),this.mVideoScanning=!0,videoScan(0,e))}supportedResolutions(){return this.mSupportedResolutions}videoScan(e,t){const n=[{width:3840,height:2160},{width:1920,height:1080},{width:1600,height:1200},{width:1280,height:720},{width:800,height:600},{width:640,height:480},{width:640,height:360},{width:352,height:288},{width:320,height:240},{width:176,height:144},{width:160,height:120}];if(e>=n.length&&(this.mVideoScanning=!1),!this.mVideoScanning)return Ai.enableCtrl(this.mVideoStartScanResolutionsBtn,!0),Ai.enableCtrl(this.mVideoStopScanResolutionsBtn,!1),void(t&&t(this.mSupportedResolutions));const i={audio:!1,video:{deviceId:this.mVideoSource,width:{exact:n[e].width},height:{exact:n[e].height}}};navigator.mediaDevices.getUserMedia(i).then((n=>{const i=this.mLocalVideo[0];i.srcObject=n,i.muted=!0,i.onloadedmetadata=()=>{this.mSupportedResolutions.push({w:this.videoWidth,h:this.videoHeight}),this.videoScan(e+1,t)}})).catch((n=>{this.videoScan(e+1,t)}))}loadUserMedia(e){const t={audio:{deviceId:this.mAudioSource?{exact:this.mAudioSource}:void 0},video:{deviceId:this.mVideoSource?{exact:this.mVideoSource}:void 0}};navigator.mediaDevices.getUserMedia(t).then((t=>{e(t)})).catch((e=>{Di.g.log(3,`PanelDevices : loadUserMedia : Error:${e.message}`)}))}}class Sr{constructor(e,t,n,i){this.mIsTxEnabledCB=e,this.mTxExtStreamCB=t,this.mUpdateTxEngineCB=n,this.mUserCloseCB=i,this.mEffectInputPreview=!1,this.mPanelDevices=new Cr((()=>{null==this.mPanelDevices.stream()&&this.mPanelDevices.start()}),(e=>{const t=!!e&&this.mUserCloseCB();this.updateTxEngine(),p.CONFIG&&p.CONFIG.banubaEffect&&(this.mTxExtStreamCB()||t||this.mEffectsCtrl.stop()),this.mPanelDevices.stop()}),(()=>{null===this.effectStream()?this.setEffectsPreviewInputStream():this.mPanelDevices.setStreamSrc(this.effectStream())}),(e=>{this.effectStream()&&this.mEffectInputPreview?this.mEffectsCtrl.stop().then((()=>{this.mEffectInputPreview=!1,e()})):e()})),this.mEffectsCtrl=new xr((()=>{this.updateTxEngine(),this.mPanelDevices.setStreamSrc(this.effectStream())}),(()=>{this.updateTxEngine()||this.setEffectsPreviewInputStream()})),this.mPanelDevices.setupDevicesModal((()=>{}))}updateTxEngine(){return!!this.mIsTxEnabledCB()&&(this.mEffectsCtrl.isEffectSelected()&&!this.mEffectsCtrl.isUnloaded()&&this.effectStream()==this.mTxExtStreamCB()||this.update((()=>{this.mUpdateTxEngineCB()})),!0)}setEffectsPreviewInputStream(){this.mEffectInputPreview=!0,window.streamClone=this.mPanelDevices.stream().clone(),this.mEffectsCtrl.setInputStream(window.streamClone)}init(e){this.mEffectsCtrl.init(e)}videoSource(){return this.mPanelDevices.videoSource()}audioSource(){return this.mPanelDevices.audioSource()}effectStream(){return this.mEffectsCtrl.stream()}update(e){this.mEffectsCtrl.isUnloaded()?this.mPanelDevices.loadUserMedia((t=>{this.mEffectInputPreview=!1,this.mEffectsCtrl.setInputStream(t).then((()=>{e&&e()}))})):e&&e()}async updateBanubaEffect(e){if(!p.CONFIG.banubaEffect)return!1;const t=e;await this.mEffectsCtrl.updateEffect(t)}async setInputStream(e){await this.mEffectsCtrl.setInputStream(e)}getSelectedEffect(){return this.mEffectsCtrl.getEffect()}setSelectedEffect(e){return this.mEffectsCtrl.setEffect(e)}async stopBanubaCtrl(){return await this.mEffectsCtrl.stop()}async stopDevices(){this.mPanelDevices.stop()}stop(){this.mEffectsCtrl.stop(),this.mPanelDevices.close(),this.mPanelDevices.stop()}}const Er="none";class xr{constructor(e,t){this.mInputStreamNeededCB=t,this.mCtrl=function(e,t,n=window.BanubaToken){const i=new rr(e,t,n);return{loadModule:e=>i.loadModule(e),stop:()=>i.stop(),setInStream:e=>i.setInStream(e),getInStream:()=>i.getInStream(),isUnloaded:()=>i.isUnloaded(),started:()=>i.started(),setEffect:e=>i.setEffect(e),stream:()=>i.stream()}}(e,(()=>{this.setWaitStatus(!1)})),this.mLoader=null;let n=[];const i=window.login.realmConfig;i&&i.config&&i.config.banubaEffect&&(n=["background","body","brows","correctors","eyes","face_tracker","hair","hands","lips","skin"]),this.mModules=n,this.mEffectStatus=l()("#effect_status"),this.mEffectSelect=l()("#banuba_effect"),this.selectedEffect="none",this.setWaitStatus(!0);let s=[];s="classtogether"===p.REALM?[Er,"Background_doc","BackgroundPicture","blur_bg","80s","Apartment","BG_Cafe_City","BG_Home_Day_02"]:"saladeaula"===p.CONFIG.realm?[Er,"BackgroundPicture","blur_bg","80s","Apartment","BG_Cafe_City","BG_Home_Day_02"]:[Er,"0003_cu_Spider1_v3_b1","ActionunitsGrout","Afro","Background_doc","BackgroundPicture","BigPinkGlasses","blur_bg","blur_bg_2","bokeh","BulldogHarlamov","BurningMan2018","CartoonOctopus","CubemapEverest","Glasses","glasses_Banuba","Hipster3","MonsterFactory","PineappleGlasses","PoliceMan","Rorschach","scene_4_faces","Skydiver","80s","Apartment","Beauty_4","BG_Cafe_City","BG_Home_Day_02","MorphHooligan","MorphNeandertalLow","ScoobyDoo","SpaceShip","UnluckyWitch","Lut_Alice","Lut_AutumnColors2","Lut_Badgirl","Lut_battona","Lut_BerlinSky","Lut_Brightsnow","Lut_BWC","Lut_California1","Lut_Canada","Lut_CinematicLook1","Lut_CinematicLook2","Lut_columbia","Lut_England","Lut_FilmLook1","Lut_Gold","Lut_Japan","Lut_LUX","Lut_Paladin","Lut_pirate","Lut_Polaroid690","Lut_PurpleDreams","Lut_shine","Lut_soap","Lut_spring","Lut_Yearning"];const o={Background_doc:"Background",BackgroundPicture:"Home Office",blur_bg:"Background Blur","80s":"Home 80s",Apartment:"Apartament",BG_Cafe_City:"Cafe City",BG_Home_Day_02:"Home Day"};s.forEach((e=>{let t=e;const n=l()("<option></option>");o[e]&&(t=o[e]),n.text(t),n.val(e),n.appendTo(this.mEffectSelect)}));const r=this;this.mEffectSelect.on("change",(async function(){await r.updateEffect(this.value)}))}setWaitStatus(e){Ai.enableCtrl(this.mEffectSelect,!e),this.mEffectStatus.text(e?"Please wait...":"")}init(e){this.load().then((()=>{this.setWaitStatus(!1),e()}))}async load(){for(let e=0;e<this.mModules.length;e++)await this.mCtrl.loadModule(this.modulePath(this.mModules[e]))}stop(){return this.mCtrl.stop()}setEffect(e){this.selectedEffect=e}getEffect(){return this.selectedEffect}async updateEffect(e){if(!e)return!1;if(this.setEffect(e),!this.mCtrl.getInStream())return Di.g.log("BanubaCapture : updateEffect : input stream, calling input stream needed callback..."),void this.mInputStreamNeededCB();Di.g.log(`BanubaCapture : updateEffect : ${e}`);const t=e!=Er?this.effectPath(e):null;t&&this.setWaitStatus(!0),await this.mCtrl.setEffect(t)}async setInputStream(e){this.mCtrl.setInStream(e)&&await this.updateEffect(this.effect)}isEffectSelected(){return this.mEffectSelect.val()!=Er}isUnloaded(){return this.isEffectSelected()&&!this.mCtrl.started()}stream(){return this.mCtrl.stream()}modulePath(e){return`https://static.ip.tv/banuba/banuba-webar/dist/modules/${e}.zip`}effectPath(e){return`https://static.ip.tv/banuba/${e}.zip`}}const kr=[{type:"recent",title:"Recentes",imageCode:"&#xE192;",data:[]},{type:"smiles_people",title:"Emojis & Pessoas",imageCode:"&#xE24E;",data:["ð","ð","ð","ð","ð","ð","ð","ð¤£","ð","âºï¸","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð¤","ð","ð","ð","ð","ð","ð","ð","ð","â¹ï¸","ð£","ð","ð«","ð©","ð¢","ð­","ð¤","ð ","ð¡","ð³","ð±","ð¨","ð°","ð¥","ð","ð¤","ð¤","ð¤¥","ð¶","ð","ð","ð¬","ð","ð¯","ð¦","ð§","ð®","ð²","ð´","ð¤¤","ðª","ðµ","ð¤","ð¤¢","ð¤§","ð·","ð¤","ð¤","ð¤","ð¤ ","ð","ð¿","ð¹","ðº","ð¤¡","ð©","ð»","ð","ð½","ð¾","ð¤","ð","ðº","ð¸","ð¹","ð»","ð¼","ð½","ð","ð¿","ð¾","ð","ð","ð","ð¤","ð","ð","ð","â","ð¤","ð¤","ð¤","ð¤","ð","ð","ð","ð","ð","â","ð¤","ð","ð","ð","ð¤","ðª","ð","âï¸","ð","ð","ð","ð","ð","ð","ð","ð","ð£","ð","ð","ð£","ð¤","ð¥","ð¶","ð§","ð¦","ð©","ð¨","ð±ââ","ð±ââ","ðµ","ð´","ð²","ð³ââ","ð³ââ","ð®ââ","ð®ââ","ð·ââ","ð·ââ","ðââ","ðââ","ðµââ","ðµââ","ð©ââ","ð¨ââ","ð©âð¾","ð¨âð¾","ð©âð³","ð¨âð³","ð©âð","ð¨âð","ð©âð¤","ð¨âð¤","ð©âð«","ð¨âð«","ð©âð­","ð¨âð­","ð©âð»","ð¨âð»","ð©âð¼","ð¨âð¼","ð©âð§","ð¨âð§","ð©âð¬","ð¨âð¬","ð©âð¨","ð¨âð¨","ð©âð","ð¨âð","ð©ââ","ð¨ââ","ð©âð","ð¨âð","ð©ââ","ð¨ââ","ð°","ð¤µ","ð¸","ð¤´","ð¤¶","ð","ð¼","ð¤°","ðââ","ðââ","ðââ","ðââ","ðââ","ðââ","ðââ","ðââ","ðââ","ðââ","ð¤¦ââ","ð¤¦ââ","ð¤·ââ","ð¤·ââ","ðââ","ðââ","ðââ","ðââ","ðââ","ðââ","ðââ","ðââ","ð","ð¤³","ð","ðº","ð¯ââ","ð¯ââ","ð´","ð¶ââ","ð¶ââ","ðââ","ðââ","ð«","ð­","ð¬","ð","ð©ââ¤âð©","ð¨ââ¤âð¨","ð","ð©ââ¤âðâð©","ð¨ââ¤âðâð¨","ðª","ð¨âð©âð§","ð¨âð©âð§âð¦","ð¨âð©âð¦âð¦","ð¨âð©âð§âð§","ð©âð©âð¦","ð©âð©âð§","ð©âð©âð§âð¦","ð©âð©âð¦âð¦","ð©âð©âð§âð§","ð¨âð¨âð¦","ð¨âð¨âð§","ð¨âð¨âð§âð¦","ð¨âð¨âð¦âð¦","ð¨âð¨âð§âð§","ð©âð¦","ð©âð§","ð©âð§âð¦","ð©âð¦âð¦","ð©âð§âð§","ð¨âð¦","ð¨âð§","ð¨âð§âð¦","ð¨âð¦âð¦","ð¨âð§âð§","ð","ð","ð","ð","ð","ð","ð","ð ","ð¡","ð¢","ð","ð","ð©","ð","ð","â","ð","ð","ð","ð","ð¼","ð","ð","ð¶","ð"]},{type:"animals_nature",title:"Animais & Natureza",imageCode:"&#xE91D",data:["ð¶","ð±","ð­","ð¹","ð°","ð¦","ð»","ð¼","ð¨","ð¯","ð¦","ð®","ð·","ð½","ð¸","ðµ","ð","ð","ð","ð","ð","ð§","ð¦","ð¤","ð£","ð¥","ð¦","ð¦","ð¦","ð¦","ðº","ð","ð´","ð¦","ð","ð","ð¦","ð","ð","ð","ð","ð·","ð¸","ð¦","ð¢","ð","ð¦","ð","ð¦","ð¦","ð¦","ð¡","ð ","ð","ð¬","ð³","ð","ð¦","ð","ð","ð","ð¦","ð","ð¦","ðª","ð«","ð","ð","ð","ð","ð","ð","ð","ð","ð¦","ð","ð©","ð","ð","ð¦","ð","ð","ð","ð","ð¿","ð¾","ð","ð²","ðµ","ð","ð²","ð³","ð´","ð±","ð¿","âï¸","ð","ð","ð","ð","ð","ð","ð","ð¾","ð","ð·","ð¹","ð¥","ðº","ð¸","ð¼","ð»","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð«","â­","ð","â¨","â¡ï¸","âï¸","ð¥","ð¥","ðª","ð","â","ð¤","â","ð¥","ð¦","ð§","â","ð©","ð¨","âï¸","âï¸","â","ð¬","ð¨","ð§","ð¦","âï¸","âï¸","ð","ð«"]},{type:"food_drink",title:"Comida & Bebida",imageCode:"&#xE540",data:["ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð¥","ð","ð","ð¥","ð¥","ð¶","ð½","ð¥","ð¥","ð ","ð¥","ð","ð¥","ð§","ð¥","ð³","ð¥","ð¥","ð","ð","ð­","ð","ð","ð","ð¥","ð®","ð¯","ð¥","ð¥","ð","ð","ð²","ð","ð£","ð±","ð¤","ð","ð","ð","ð¥","ð¢","ð¡","ð§","ð¨","ð¦","ð°","ð","ð®","ð­","ð¬","ð«","ð¿","ð©","ðª","ð°","ð¥","ð¯","ð¥","ð¼","ðµ","ð¶","ðº","ð»","ð¥","ð·","ð¥","ð¸","ð¹","ð¾","ð¥","ð´","ð½"]},{type:"activity",title:"Atividade",imageCode:"&#xE52F",data:["â½","ð","ð","â¾","ð¾","ð","ð","ð±","ð","ð¸","ð¥","ð","ð","ð","â³","ð¹","ð£","ð¥","ð¥","ð½","â¸","ð¿","â·","ð","ðââ","ðââ","ð¤¼ââ","ð¤¼ââ","ð¤¸ââ","ð¤¸ââ","â¹ââ","â¹ââ","ð¤º","ð¤¾ââ","ð¤¾ââ","ðââ","ðââ","ð","ðââ","ðââ","ðââ","ðââ","ð¤½ââ","ð¤½ââ","ð£ââ","ð£ââ","ðµââ","ðµââ","ð´ââ","ð´ââ","ð","ð¥","ð¥","ð¥","ð","ð","ðµ","ð","ð«","ð","ðª","ð¤¹ââ","ð¤¹ââ","ð­","ð¨","ð¬","ð¤","ð§","ð¼","ð¹","ð¥","ð·","ðº","ð¸","ð»","ð²","ð¯","ð³","ð®","ð°"]},{type:"travel_places",title:"Viagens & Locais",imageCode:"&#xE531",data:["ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð´","ð²","ðµ","ð","ð¨","ð","ð","ð","ð","ð¡","ð ","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","âï¸","ð«","ð¬","ð©","ðº","ð°","ð","ð","ð¶","âµ","ð¤","ð¥","ð³","â´","ð¢","âï¸","â½","ð§","ð¦","ð¥","ð","ðº","ð¿","ð½","ð¼","ð°","ð¯","ð","ð¡","ð¢","ð ","â²","â±","ð","ð","ð","ð","â°","ð","ð»","ð","âº","ð ","ð¡","ð","ð","ð","ð­","ð¢","ð¬","ð£","ð¤","ð¥","ð¦","ð¨","ðª","ð«","ð©","ð","ð","âª","ð","ð","ð","â©","ð¤","ð£","ð¾","ð","ð","ð","ð","ð ","ð","ð","ð","ð","ð","ð","ð","ð","ð"]},{type:"objects",title:"Objetos",imageCode:"&#xE334",data:["â","ð±","ð²","ð»","â¨ï¸","ð¥","ð¨","ð±","ð²","ð¹","ð","ð½","ð¾","ð¿","ð","ð¼","ð·","ð¸","ð¹","ð¥","ð½","ð","ð","âï¸","ð","ð ","ðº","ð»","ð","ð","ð","â±","â²","â°","ð°","â","â³","ð¡","ð","ð","ð¡","ð¦","ð¯","ð","ð¢","ð¸","ðµ","ð´","ð¶","ð·","ð°","ð³","ð","ð§","ð¨","â","ð ","â","ð©","âï¸","â","ð«","ð£","ðª","ð¡","âï¸","ð¡","ð¬","â°ï¸","â±ï¸","ðº","ð®","ð¿","ð","âï¸","ð­","ð¬","ð³","ð","ð","ð¡","ð½","ð°","ð¿","ð","ð","ð","ð","ð","ðª","ð","ð","ð","ð¼","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð®","ð","ð©","ð¨","ð§","ð","ð¥","ð¤","ð¦","ð·","ðª","ð«","ð¬","ð­","ð®","ð¯","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð³","ð","ð","ð","ð","ð","ð","ð°","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","âï¸","ð","ð","ð","âï¸","ð","ð","ð","ð","ð","ð"]},{type:"simbols",title:"SÃ­mbolos",imageCode:"&#xE021",data:["â¤ï¸","ð","ð","ð","ð","ð¤","ð","â£ï¸","ð","ð","ð","ð","ð","ð","ð","ð","â®ï¸","âï¸","âªï¸","ð","â¸ï¸","â¡ï¸","ð¯","ð","â¯ï¸","â¦ï¸","ð","â","âï¸","âï¸","âï¸","âï¸","âï¸","âï¸","âï¸","âï¸","âï¸","âï¸","âï¸","âï¸","ð","âï¸","ð","â¢ï¸","â£ï¸","ð´","ð³","ð¶","ð","ð¸","ðº","ð·ï¸","â´ï¸","ð","ð®","ð","ãï¸","ãï¸","ð´","ðµ","ð¹","ð²","ð°ï¸","ð±ï¸","ð","ð","ð¾ï¸","ð","â","â­","ð","â","ð","ð«","ð¯","ð¢","â¨ï¸","ð·","ð¯","ð³","ð±","ð","ðµ","ð­","â","â","â","â","â¼ï¸","âï¸","ð","ð","ã½ï¸","â ï¸","ð¸","ð±","âï¸","ð°","â»ï¸","â","ð¯","ð¹","âï¸","â³ï¸","â","ð","ð ","âï¸","ð","ð¤","ð§","ð¾","â¿ï¸","ð¿ï¸","ð³","ðï¸","ð","ð","ð","ð","ð¹","ðº","ð¼","ð»","ð®","ð¦","ð¶","ð","ð£","â¹ï¸","ð¤","ð¡","ð ","ð","ð","ð","ð","ð","ð","0ï¸â£","1ï¸â£","2ï¸â£","3ï¸â£","4ï¸â£","5ï¸â£","6ï¸â£","7ï¸â£","8ï¸â£","9ï¸â£","ð","ð¢","#ï¸â£","*ï¸â£","â¶ï¸","â¸","â¯","â¹","âº","â­","â®","â©","âª","â«","â¬","âï¸","ð¼","ð½","â¡ï¸","â¬ï¸","â¬ï¸","â¬ï¸","âï¸","âï¸","âï¸","âï¸","âï¸","âï¸","âªï¸","â©ï¸","â¤´ï¸","â¤µï¸","ð","ð","ð","ð","ð","ðµ","ð¶","â","â","â","âï¸","ð²","ð±","â¢ï¸","Â©ï¸","Â®ï¸","ã°ï¸","â°","â¿","ð","ð","ð","ð","ð","âï¸","âï¸","ð","âª","â«","ð´","ðµ","ðº","ð»","ð¸","ð¹","ð¶","ð·","ð³","ð²","âªï¸","â«ï¸","â¾ï¸","â½ï¸","â¼ï¸","â»ï¸","â¬","â¬ï¸","ð","ð","ð","ð","ð","ð","ð£","ð¢","ðâð¨","ð¬","ð­","ð¯","â ï¸","â£ï¸","â¥ï¸","â¦ï¸","ð","ð´","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð","ð ","ð¡","ð¢","ð£","ð¤","ð¥","ð¦","ð§"]},{type:"flags",title:"Bandeiras",imageCode:"&#xE153",data:["ð³","ð´","ð","ð©","ð³âð","ð¦ð«","ð¦ð½","ð¦ð±","ð©ð¿","ð¦ð¸","ð¦ð©","ð¦ð´","ð¦ð®","ð¦ð¶","ð¦ð¬","ð¦ð·","ð¦ð²","ð¦ð¼","ð¦ðº","ð¦ð¹","ð¦ð¿","ð§ð¸","ð§ð­","ð§ð©","ð§ð§","ð§ð¾","ð§ðª","ð§ð¿","ð§ð¯","ð§ð²","ð§ð¹","ð§ð´","ð§ð¦","ð§ð¼","ð§ð·","ð®ð´","ð»ð¬","ð§ð³","ð§ð¬","ð§ð«","ð§ð®","ð°ð­","ð¨ð²","ð¨ð¦","ð®ð¨","ð¨ð»","ð§ð¶","ð°ð¾","ð¨ð«","ð¹ð©","ð¨ð±","ð¨ð³","ð¨ð½","ð¨ð¨","ð¨ð´","ð°ð²","ð¨ð¬","ð¨ð©","ð¨ð°","ð¨ð·","ð¨ð®","ð­ð·","ð¨ðº","ð¨ð¼","ð¨ð¾","ð¨ð¿","ð©ð°","ð©ð¯","ð©ð²","ð©ð´","ðªð¨","ðªð¬","ð¸ð»","ð¬ð¶","ðªð·","ðªðª","ðªð¹","ðªðº","ð«ð°","ð«ð´","ð«ð¯","ð«ð®","ð«ð·","ð¬ð«","ðµð«","ð¹ð«","ð¬ð¦","ð¬ð²","ð¬ðª","ð©ðª","ð¬ð­","ð¬ð®","ð¬ð·","ð¬ð±","ð¬ð©","ð¬ðµ","ð¬ðº","ð¬ð¹","ð¬ð¬","ð¬ð³","ð¬ð¼","ð¬ð¾","ð­ð¹","ð­ð³","ð­ð°","ð­ðº","ð®ð¸","ð®ð³","ð®ð©","ð®ð·","ð®ð¶","ð®ðª","ð®ð²","ð®ð±","ð®ð¹","ð¯ð²","ð¯ðµ","ð","ð¯ðª","ð¯ð´","ð°ð¿","ð°ðª","ð°ð®","ð½ð°","ð°ð¼","ð°ð¬","ð±ð¦","ð±ð»","ð±ð§","ð±ð¸","ð±ð·","ð±ð¾","ð±ð®","ð±ð¹","ð±ðº","ð²ð´","ð²ð°","ð²ð¬","ð²ð¼","ð²ð¾","ð²ð»","ð²ð±","ð²ð¹","ð²ð­","ð²ð¶","ð²ð·","ð²ðº","ð¾ð¹","ð²ð½","ð«ð²","ð²ð©","ð²ð¨","ð²ð³","ð²ðª","ð²ð¸","ð²ð¦","ð²ð¿","ð²ð²","ð³ð¦","ð³ð·","ð³ðµ","ð³ð±","ð³ð¨","ð³ð¿","ð³ð®","ð³ðª","ð³ð¬","ð³ðº","ð³ð«","ð°ðµ","ð²ðµ","ð³ð´","ð´ð²","ðµð°","ðµð¼","ðµð¸","ðµð¦","ðµð¬","ðµð¾","ðµðª","ðµð­","ðµð³","ðµð±","ðµð¹","ðµð·","ð¶ð¦","ð·ðª","ð·ð´","ð·ðº","ð·ð¼","ð¼ð¸","ð¸ð²","ð¸ð¹","ð¸ð¦","ð¸ð³","ð·ð¸","ð¸ð¨","ð¸ð±","ð¸ð¬","ð¸ð½","ð¸ð°","ð¸ð®","ð¬ð¸","ð¸ð§","ð¸ð´","ð¿ð¦","ð°ð·","ð¸ð¸","ðªð¸","ð±ð°","ð§ð±","ð¸ð­","ð°ð³","ð±ð¨","ðµð²","ð»ð¨","ð¸ð©","ð¸ð·","ð¸ð¿","ð¸ðª","ð¨ð­","ð¸ð¾","ð¹ð¼","ð¹ð¯","ð¹ð¿","ð¹ð­","ð¹ð±","ð¹ð¬","ð¹ð°","ð¹ð´","ð¹ð¹","ð¹ð³","ð¹ð·","ð¹ð²","ð¹ð¨","ð¹ð»","ð»ð®","ðºð¬","ðºð¦","ð¦ðª","ð¬ð§","ó §ó ¢ó ·ó ¬ó ³ó ¿ðºð¸","ðºð¾","ðºð¿","ð»ðº","ð»ð¦","ð»ðª","ð»ð³","ð¼ð«","ðªð­","ð¾ðª","ð¿ð²","ð¿ð¼"]}],Mr=["#C5C5C5","#00FFFF","#078E2E","#FE0000","#FF07FE","#FF5A00","#FF8EC4","#9A7F4F","#2C5C8E","#00C5FF","#8EC5C6","#2D5B5C","#5BFEC4","#8FC52D","#FF5A2E","#994B74","#C27496","#FF8F5B","#FFC48E","#FF5B5B","#FF005B","#8E5BC4","#C47146","#914807","#AF9413","#E7BE2E"],Tr=/\w+/i,Ir=/(^|\s|\n|\n\n)(@)([a-z\d-\_]+)/gi,Rr=/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?)*/,Ar=new RegExp(`^${String.fromCharCode(2)}(.*)${String.fromCharCode(2)}`),$r=/(^|\s)(#)([a-z\d-]+)/gi,Lr=/(\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*)/,Pr=/((?:(http|https|Http|Https|rtsp|Rtsp):\/\/(?:(?:[a-zA-Z0-9\$\-\_\.\+\!\*\'\(\)\,\;\?\&\=]|(?:\%[a-fA-F0-9]{2})){1,64}(?:\:(?:[a-zA-Z0-9\$\-\_\.\+\!\*\'\(\)\,\;\?\&\=]|(?:\%[a-fA-F0-9]{2})){1,25})?\@)?)?((?:(?:[a-zA-Z0-9][a-zA-Z0-9\-\@]{0,64}\.)+(?:(?:aero|arpa|asia|a[cdefgilmnoqrstuwxz])|(?:biz|b[abdefghijmnorstvwyz])|(?:cat|com|coop|c[acdfghiklmnoruvxyz])|d[ejkmoz]|(?:edu|e[cegrstu])|f[ijkmor]|(?:gov|g[abdefghilmnpqrstuwy])|h[kmnrtu]|(?:info|int|i[delmnoqrst])|(?:jobs|j[emop])|k[eghimnrwyz]|l[abcikrstuvy]|(?:mil|mobi|museum|m[acdghklmnopqrstuvwxyz])|(?:name|net|n[acefgilopruz])|(?:org|om)|(?:pro|p[aefghklmnrstwy])|qa|r[eouw]|s[abcdeghijklmnortuvyz]|(?:tel|travel|t[cdfghjklmnoprtvwz])|u[agkmsyz]|v[aceginu]|w[fs]|y[etu]|z[amw]))|(?:(?:25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[1-9])\.(?:25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[1-9]|0)\.(?:25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[1-9]|0)\.(?:25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[0-9])))(?:\:\d{1,5})?)(\/(?:(?:[a-zA-Z0-9\;\/\?\:\@\&\=\#\~\-\.\+\!\*\'\(\)\,\_])|(?:\%[a-fA-F0-9]{2}))*)?(?:\b|$)/gi,Dr=(e,t=null,n=null)=>{try{return{data:JSON.parse(e),error:null}}catch(e){return"function"==typeof n&&n(e),console.error("Error parsing JSON:",e),{data:t,error:e}}},Nr=e=>{try{const t=localStorage.getItem(e),n=Dr(t);return n?n.data:null}catch(t){return void console.error(`Error getting storage for key "${e}":`,t)}},Or=(e,t)=>{try{return localStorage.setItem(e,JSON.stringify(t)),!0}catch(t){return console.error(`Error setting storage for key "${e}":`,t),!1}},Br="0.1.14.56";async function Fr(){Nr("persistentConfigs")||Or("persistentConfigs",{}),p.ANY_CHAR_REGEX=Tr,p.AT_REGEX=Ir,p.EMOTICONS=kr,p.EMOTICON_REGEX=Rr,p.GET_COMMENT_REGEX=Ar,p.GROUP_COLOR=Mr,p.HASHTAG_REGEX=$r,p.MAIL_REGEX=Lr,p.NAVIGATOR_DATA=function(){const e=window.navigator,t=e.userAgent;let n="";const i=t.split(")")[0].split("(")[1].toLowerCase().trim().replaceAll("_",".");let s=i.match(/\s(\d\.*)+/);s=null===s?"0":s[0].trim();let o="";i.includes("macintosh")||i.includes("powerpc")?o=`macos.${s}`:i.includes("win16")?o="win.3.11":i.includes("windows 95")||i.includes("win95")||i.includes("windows_95")?o="win.95":i.includes("windows 98")||i.includes("win98")?o="win.98":i.includes("windows nt 5.0")||i.includes("windows 2000")?o="win.2000":i.includes("windows nt 5.1")||i.includes("windows xp")?o="win.xp":i.includes("windows nt 5.2")?o="win.2003":i.includes("windows nt 6.0")?o="win.vista":i.includes("windows nt 6.1")?o="win.7":i.includes("windows nt 6.2")||i.includes("wow64")?o="win.8":i.includes("windows 10.0")||i.includes("windows nt 10.0")?o="win.10":i.includes("windows nt 4.0")||i.includes("winnt4.0")||i.includes("winnt")||i.includes("windows nt")?o="win.nt.4":i.includes("windows me")?o="win.me":i.includes("windows")?o=`win.${s}`:i.includes("openbsd")?o=`openbsd.${s}`:i.includes("sunos")?o=`sunos.${s}`:i.includes("qnx")?o=`qnx.${s}`:i.includes("beos")?o=`beos.${s}`:i.includes("os/2")?o=`os2.${s}`:i.includes("linux")||i.includes("x11")?o=`linux.${s}`:i.includes("android")?o=`android.${s}`:i.includes("ios")?o=`ios.${s}`:(o=i.split(" ")[0].replace(";",""),o=0!==o.length?`${o}.${s}`:`unknow.${s}`);const r=t.match(/OPR\/(\d\.*)*/),a=t.match(/Edg\/(\d\.*)*/),c=t.match(/Firefox\/(\d\.*)*/),l=t.match(/Safari\/(\d\.*)*/),d=t.match(/Version\/(\d\.*)*/),u=t.match(/Chrome\/(\d\.*)*/),h=t.match(/\w+\/(\d\.*)*$/);if(null!==r)n=r[0].replace("OPR/","opera.").toLowerCase();else if(null!==a)n=a[0].replace("/",".").toLowerCase();else if(null!==c)n=c[0].replace("/",".").toLowerCase();else if(null!==l&&null!==d){let e=d;e?(e=d[0].replace("Version/",""),n=`safari.${e}`):n=l[0].replace("/",".").toLowerCase()}else n=null!==u?u[0].replace("/",".").toLowerCase():null!==h?h.includes("OPR")||h.includes("Edge")||h.includes("Safari")||h.includes("Chrome")?"unknow.0.0":h[0].replace("/",".").toLowerCase():"unknow.0.0";const p={};return p.language=e.language,p.os=o,p.browser=n,p}(),p.URL_REGEX=Pr,p.VERSION=Br,p.METAVERSE_IDLE_TIMEOUT=36e5;const e=(t=navigator.userAgent||navigator.vendor||window.opera,/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)));var t;p.MOBILE=e;const n=sessionStorage.tabID?sessionStorage.tabID:sessionStorage.tabID=(new Date).getTime();document.cookie="session=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/w; SameSite=None; Secure";const i=function(e){const t="tabId=",n=document.cookie.split(";");for(let e=0;e<n.length;e+=1){let i=n[e];for(;" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(t))return i.substring(6,i.length)}return""}();let s,o=!1;parseInt(i),parseInt(n);try{s=JSON.parse(localStorage.getItem("data")),(null===s||s.guest)&&(s=!1)}catch(e){console.log("Error:",e),window._app.logout()}await window.login.getIFrame()&&(s=await window.login.authenticateGuest()),await window.login.getInvite();let r=localStorage.getItem("invite");try{r=JSON.parse(r);const e=localStorage.getItem("selectedRealm");r&&r.realm!==e&&localStorage.removeItem("selectedRealm")}catch(e){console.log("Error:",e),r=!1}if(r&&!s){const e=await window.login.authenticateGuest();localStorage.setItem("data",JSON.stringify(e)),s=JSON.parse(localStorage.getItem("data"))}r&&(localStorage.removeItem("realmConfig"),window.login.loadRealmsConfig()),localStorage.removeItem("invite"),s||window._app.logout();let a={};if(s){a=s;const e=window.login.realmConfig;a.apiServer=e.apiServer,a.assets=e.assets,a.config=e.config,r&&(a.invite="",a.token=r.token,a.type="invite")}const c=window.login.getRealmConfig2(),d=window.login.deviceData;p.ACS_SERVER=a.acs_server,p.ANALYTIC_ID=`s${(new Date).getTime()}`,p.API=a.api||"",p.API_SERVER=a.apiServer,p.ASSETS=a.assets||c.assets,p.AUDIO_TIME_IS_RUNNING_OUT=new Audio(`${p.ASSETS}/common/audio/time_is_running_out.mp3`),p.AUDIO_REQUEST_COLLABORATION=new Audio(`${p.ASSETS}/common/audio/request_collaboration.mp3`),p.AUDIO_SESSION_ERROR=new Audio(`${p.ASSETS}/common/audio/session_error.mp3`),p.AUTH_TOKEN=a.auth_token,p.CHANNEL=a.channel||"",p.CLIENT_TYPE=a.type||"",p.CONFIG=a.config||{},p.CSM_CHANNEL_ENABLE=a.csm_channel_enable,p.CSM_ROOM_ENABLE=a.csm_room_enable,p.CSM_SPA=a.csm_spa,p.DEVICE_ID=a.device_id||d.device_id,p.EMAIL=a.email||"",p.EPHEMERAL_CONFERENCE_SERVERS=[];try{if(a.ephemeral_conference_servers){p.EPHEMERAL_CONFERENCE_SERVERS=a.ephemeral_conference_servers,window.ephemeralConferenceServers=[];for(let e=0;e<p.EPHEMERAL_CONFERENCE_SERVERS.length;e+=1){const t=p.EPHEMERAL_CONFERENCE_SERVERS[e].split(":"),n=t[0],i=parseInt(t[1]),s=t[2]?parseInt(t[2]):i;for(let e=i;e<=s;e+=1)window.ephemeralConferenceServers.push(`${n}:${e}`)}}}catch(e){console.log(e)}p.ENGINE_NICK=a.nick?`${a.nick}-web`:`${d.nick}-web`,p.FEED_SPA=a.feed_spa,p.FILES_BASE_URL=a.files_base_url?`${a.files_base_url}/`:`https://${a.realm}-static.ip.tv/`,p.FULLNAME=a.name||a.nick,p.GOOGLE_SIGIN="true"===a.google_signin,p.GUEST=a.guest||!1,p.JANUS_SERVER=p.CONFIG?.janusServer||c.config.janusServer,p.INVITE=a.invite,p.IP=a.ip,p.IRM_SERVERS=a.irmServers,p.LIVES=a.lifes,p.MAS_HTTP_URL=a.mas_http_url||"",p.MAS_URL=a.mas_url||"",p.METAVERSE_CHANNEL_ENABLE="true"===a.metaverse_channel_enable,p.METAVERSE_FIXED=a.metaverse_fixed||[],p.METAVERSE_MAX_ROOMS=Number.isNaN(parseInt(a.metaverse_max_rooms))?-1:parseInt(a.metaverse_max_rooms);try{p.METAVERSE_ROOMS=a.metaverse_rooms||[]}catch(e){console.log("[Initial Constants] Failed to parse metaverse_rooms!"),console.log(e),p.METAVERSE_ROOMS=[]}p.METAVERSE_EPHEMERAL_ENABLE="true"===a.metaverse_ephemeral_enable,p.METAVERSE_ROOM_ENABLE="true"===a.metaverse_room_enable,p.ROLE=a.role||c.role,p.ROOM_ENABLE_NESTING="true"===a.room_enable_nesting,p.MSG_DROP_RATE=a.msg_drop_rate?parseInt(a.msg_drop_rate):0,p.MSG_PER_DAY=a.msg_per_day?parseInt(a.msg_per_day):-1,p.MULT_REALM=p.CONFIG.multiRealm,p.NICK=a.nick,p.NAME=a.name||"",""===p.NAME&&(p.NAME=p.NICK.split("-")[0]),p.PASSWORD=a.password||d.password,window.apiServer=p.API_SERVER,window.auth_token=p.AUTH_TOKEN;const u=await window.login.getPermissions(a.role);if(p.PERMISSIONS=u||{},p.PLATFORMS=a.platforms,p.PPCS_SERVER=a.ppcs_server,p.REALM=a.realm||d.realm,p.REALM_FAVICON=a.realmFavicon,p.REALM_LOGO=a.realmLogo,p.REALM_NAME=a.realmName||d.realm,p.ROLE=a.role||d.role,p.ROOM_SERVER=a.room_server,p.SELECTED_REALM=a.selectedRealm,p.SESSION=a.session,p.TITLE=a.title,p.TMS_SPA=a.tms_spa,p.TOKEN=a.token||"",p.TS=a.server_ts,p.TS_DIFF=p.TS-(new Date).getTime(),p.USER_DATA=`iptv-web.${window.version} ${p.REALM} ${p.ROLE} ${p.NAVIGATOR_DATA.os} ${p.NAVIGATOR_DATA.browser}`,p.WEBSOCKET_URL=a.websocket_url||"",p.WEBVIEW_URL=a.webview_url,p.CONFIG.supressRoomAreaBackground?l()("#roomList").css("background","rgb(243,243,243"):l()("#roomList").css("background",""),window._captureCtrl=function(e,t,n,i){const s=new Sr((()=>window._engine.isTxEnabled()),(()=>window._engine.txInfoAvconf().extStream),(()=>{window._channelCtrl.updateEngineCaptureSource()}),(()=>"config"===l()("#input_devices").attr("from")?(l()("#input_devices").attr("from",""),!1):!(!window._engine.currentChannel()||window._engine.isTxEnabled()||(window._engine.requestTransmission(p.ENGINE_NICK,!0,!1),0))));return{init:e=>{s.init(e)},videoSource:()=>s.videoSource(),audioSource:()=>s.audioSource(),effectStream:()=>s.effectStream(),update:e=>{s.update(e)},stop:()=>{s.stop()},updateBanubaEffect:e=>{s.updateBanubaEffect(e)},setInputStream:e=>{s.setInputStream(e)},setSelectedEffect:e=>s.setSelectedEffect(e),getSelectedEffect:()=>s.getSelectedEffect(),stopBanubaCtrl:()=>s.stopBanubaCtrl(),updateTxEngine:()=>s.updateTxEngine(),stopDevices:()=>s.stopDevices()}}(),window._captureCtrl.init((()=>{})),window.time.setServerTs(a.ts),window.csm_channel_enable=a.csm_channel_enable,window.csm_room_enable=a.csm_room_enable,window.acs_server=p.ACS_SERVER,window.analytic_id=p.ANALYTIC_ID,window.api=p.API,window.apiServer=p.API_SERVER,window.assets=p.ASSETS,window.audioTimeIsRunningOut=p.AUDIO_TIME_IS_RUNNING_OUT,window.audioRequestCollaboration=p.AUDIO_REQUEST_COLLABORATION,window.auth_token=p.AUTH_TOKEN,window.clientType=p.CLIENT_TYPE,window.csm_channel_enable=p.CSM_CHANNEL_ENABLE,window.csm_room_enable=p.CSM_ROOM_ENABLE,window.csm_spa=p.CSM_SPA,window.config=p.CONFIG,window.device_id=p.DEVICE_ID,window.engineNick=p.ENGINE_NICK,window.engineUrl=p.JANUS_SERVER,window.feed_spa=p.FEED_SPA,window.files_base_url=p.FILES_BASE_URL,window.fullName=p.FULLNAME,window.guest=p.GUEST,window.invite=p.invite?JSON.parse(p.invite):void 0,window.invite){const e=3,t=window.invite.cf.toString(2).padStart(e,"0");window.invite.anonymous="1"===t.substr(-3,1),window.invite.allowChat="1"===t.substr(-2,1),window.invite.allowMedia="1"===t.substr(-1,1)}else window.invite={},window.invite.anonymous=!0,window.invite.allowChat=!0,window.invite.allowMedia=!0;window.ip=p.IP,window.lifes=p.LIVES,window.mas_http_url=p.MAS_HTTP_URL,window.mas_url=p.MAS_URL,window.permissions=p.PERMISSIONS;const h={};h.channelEnabled=p.METAVERSE_CHANNEL_ENABLE,h.roomEnabled=p.METAVERSE_ROOM_ENABLE,h.maxRooms=p.METAVERSE_MAX_ROOMS,h.rooms=p.METAVERSE_ROOMS,window.metaverse.config=h;const m={};return m.roomCreate=window.permissions.mas_metaverse_room_create,m.roomEdit=window.permissions.mas_metaverse_room_edit,m.roomStart=window.permissions.mas_metaverse_room_start,window.metaverse.permissions=m,window.mobile=p.MOBILE,window.msg_drop_rate=p.MSG_DROP_RATE,window.navigatorData=p.NAVIGATOR_DATA,window.nick=p.NICK,window.ppcs_server=p.PPCS_SERVER,window.realm=p.REALM,window.realmTitle=p.REALM_NAME||p.REALM_TITLE,window.role=p.ROLE,window.room_server=p.ROOM_SERVER,window.tms_spa=p.TMS_SPA,window.token=p.TOKEN,window.tsDiff=p.TS_DIFF,window.userData=p.USER_DATA,window.version=p.VERSION,window.websocket_url=p.WEBSOCKET_URL,window.webview_url=p.WEBVIEW_URL,!1}function Ur(){let e={};async function t(){return window.time.now()}async function n(n){window.Events.dispatch("session/timer-control",{event:"stopTimer",timer:n});const i=await t();return e[n]?.started&&e[n]&&(e[n].started=!1,e[n].totalTs+=i-e[n].lastTs),e[n]}async function i(n){window.Events.dispatch("session/timer-control",{event:"getTimer",timer:n});const i={};if(e[n]){const s=await t();return i.name=n,e[n]?.started?(i.ts=e[n].totalTs+s-e[n].lastTs,i.started=e[n].started,i):!!e[n]&&(i.ts=e[n].totalTs,i.started=e[n].started,i)}return!1}return{reset:function(){window.Events.dispatch("session/timer-control","reset"),e={}},now:t,startTimer:async function(n,i){const s=i||0,o=await t();return e[n]||(e[n]={totalTs:s,lastTs:o,started:!0}),e[n].started||(e[n].lastTs=o-s,e[n].started=!0),e[n]},stopTimer:n,removeTimer:async function(t){return!!e[t]&&(delete e[t],!0)},stopTimers:async function(){return window.Events.dispatch("session/timer-control","stopTimers"),Object.keys(e).forEach((async e=>{await n(e)})),e},getTimer:i,getTimers:async function(){return window.Events.dispatch("session/timer-control","getTimers"),await new Promise((t=>{const n={};Object.keys(e).forEach((async e=>{const t=await i(e);n[e]=t.ts})),t(n)}))}}}function jr(e){const t=new Date(e);return`${t.getUTCFullYear()}-${t.getUTCMonth()<9?`0${t.getUTCMonth()+1}`:`${t.getUTCMonth()+1}`}-${t.getUTCDate()<10?`0${t.getUTCDate()}`:`${t.getUTCDate()}`} ${t.getUTCHours()<10?`0${t.getUTCHours()}`:`${t.getUTCHours()}`}:${t.getUTCMinutes()<10?`0${t.getUTCMinutes()}`:`${t.getUTCMinutes()}`}:${t.getUTCSeconds()<10?`0${t.getUTCSeconds()}`:`${t.getUTCSeconds()}`}`}window.version=Br;const Vr=function(){const e={},t={};let n,i=[];const s={};let o,r={};const a=new Ur;function c(){return r}function l(t){return e[t]}async function d(n){if(E(`[Analytics] Stoping fact '${n}'`),a.getTimer(n)){const t=await a.getTimer(n);if(!t)return!1;let i=t.ts;i/=1e3;const s=e[n].start_time,o=e[n].channel;window.database.update(n,{id:s,value:i,channel:o,session_id:window.analytic_id,finished:!0}),a.removeTimer(n)}return!(!t[n]&&0!==t[n]||(delete t[n],0))}async function u(t){E(`[Analytics] Updating fact '${t}'`);const n=await async function(){return window.time.now()}(),i=(e[t].collect_interval,1e3*e[t].bucket_interval);let o,r,c="";if(("channel_joined"===t||"media_transmitted"===t)&&(c=window._channel.getName(),""===c))return!1;if(e[t].dimensions.includes("bucket_time")){o=new Date(n-n%i),r=jr(o.getTime()),s[r]||(s[r]={});let l=await a.getTimer(t);e[t].bucketTime===r||(l.ts&&(s[r][t]=l.ts/1e3,s[r][t]>i/1e3-10&&(s[r][t]=i/1e3),window.database.update(t,{id:e[t].bucketTime,value:s[r][t],channel:c,session_id:window.analytic_id,finished:!0})),await a.removeTimer(t),e[t].bucketTime=r,e[t].channel=c,await a.startTimer(t),l=await a.getTimer(t)),s[r][t]=l.ts/1e3}else{let i=(await a.getTimer(t)).ts;i?(r=e[t].start_time,i/=1e3):(o=new Date(n),r=jr(o.getTime()),e[t].start_time=r,e[t].channel=c,await a.startTimer(t),i=0),s[r]||(s[r]={}),s[r][t]=i}if(!window.database||!s[r][t])return!1;window.database.update(t,{id:r,value:s[r][t],channel:c,session_id:window.analytic_id,finished:!1})}async function h(){let e="";const n=[],i=Object.entries(c());for(const[s,o]of i){(t[s]||0===t[s])&&await u(s);const i=new Promise((e=>{m(s,((t,n,i)=>{e({fact:t,dbData:n,ldJson:i})}))})),o=await i;e+=o.ldJson,n.push([o.fact,o.dbData])}return{dbData:n,json:e}}function m(t,n){window.database.readAll(t,(i=>{let s="";for(let n=0;n<i.length;n+=1){const o={};o.fact=t,o.session_id=i[n].session_id||window.analytic_id,"channel_joined"===t||"media_transmitted"===t?(o.start_time=i[n].id,o.channel=i[n].channel):o.bucket_time=i[n].id;for(const[n,i]of Object.entries(e[t].dimension))"channel"!==n&&(o[n]=i);o.duration=i[n].value,s+=`${JSON.stringify(o)}\n`}n(t,i,s)}))}function w(e){return!(!t[e]&&0!==t[e])}return setInterval((()=>{Object.entries(t).forEach((([e,n])=>{const i=n,s=l(e);i<parseInt(s.collect_interval)-1?t[e]+=1:(t[e]=1,u(e))}))}),1e3),{start:async function(){const e={};let t;e.nick=window.nick.replace("-web",""),e.role=window.role,e.realm=window.realm,e.platform="web",e.platform_version=window.version,window.navigatorData.os&&(window.navigatorData.os.split(".").length>0?(e.os=window.navigatorData.os.split(".")[0],window.navigatorData.os.split(`${e.os}.`).length>1?e.os_version=window.navigatorData.os.split(`${e.os}.`)[1]:e.os_version="unknown"):(e.os="unknown",e.os_version="unknown")),e.device=window.navigatorData.browser,e.bucketTime="",r={};try{t=await async function(){const e=X(),t=`${window.apiServer}/ingestion/config`;let n;try{n=await fetch(t,e).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>{if(e.errors)return E(`getAnalyticsConfig error: ${JSON.stringify(e.errors)}`),[];let t=JSON.parse(localStorage.getItem("data"));t.server_ts=e.server_ts?e.server_ts:t.server_ts,localStorage.setItem("data",JSON.stringify(t)),p.TS=e.server_ts,p.TS_DIFF=p.TS-(new Date).getTime();const n=e.server_ts-(new Date).getTime();return window.tsDiff=n,e})).catch((e=>{E(e)}))}catch(e){}return n}()}catch(e){return E("[Analytics] Error getting analytics config!"),!1}if(t){o=t.server_ts||(new Date).getTime()-window.tsDiff,window.time.setServerTs(t.server_ts),n=o-(new Date).getTime();const i=t.collect_interval,s=t.facts;return window.flushInterval=t.flush_interval,s.forEach((t=>{r[t.fact]=t,window.analytics.setFact(t.fact,i,t.bucket_interval,t.expires,t.version,t.dimensions),t.dimensions.forEach((n=>{e[n]&&window.analytics.setFactDimension(t.fact,n,e[n])}))})),setTimeout((async()=>{const e=await h(),t=e.dbData,n=await ti(e.json);if(E(`[Analytics] Ingestion result: ${JSON.stringify(n)}`),0===n.invalid_count)for(let e=0;e<t.length;e+=1){const n=t[e][0],i=t[e][1];for(let e=0;e<i.length;e+=1){const t=i[e];(t.finished||e<i.length-2)&&window.database.remove(n,t.id)}}}),5e3),window.analyticsFlush=setInterval((async()=>{const e=await h(),t=e.dbData,n=await ti(e.json);if(E(`[Analytics] Ingestion result: ${JSON.stringify(n)}`),0===n.invalid_count)for(let e=0;e<t.length;e+=1){const n=t[e][0],i=t[e][1];for(let e=0;e<i.length;e+=1){const t=i[e];(t.finished||e<i.length-2)&&window.database.remove(n,t.id)}}else for(let e=0;e<t.length;e+=1){const n=t[e][0],i=t[e][1];for(let e=0;e<i.length;e+=1){const t=i[e];(t.finished||e<i.length-2)&&window.database.remove(n,t.id)}}}),1e3*window.flushInterval),!0}return!1},getServerFacts:c,getAnalyticsFacts:ni,setAnalyticsFacts:ti,setFact:function(t,n,s,o,r,a){const c=o||-1;if(i.includes(t))throw new Error(`[Analytics] Fact "${t}" is already defined!`);return i.push(t),e[t]={name:t,collect_interval:n,bucket_interval:s,expires:c,version:r,dimensions:a},e[t]},unsetFact:function(t){return i=i.filter((e=>e!==t)),delete e[t],d(t),!0},setFactDimension:function(t,n,s){if(!i.includes(t))throw new Error(`[Analytics] Can not set dimension "${n}" for fact "${t}"!`);return e[t].dimension||(e[t].dimension={}),e[t].dimension[n]=s,e[t].dimension[n]},getFact:l,startFact:async function(e){if(!i.includes(e))throw new Error(`[Analytics] Fact "${e}" is not defined!`);return w("app_opened")||"app_opened"===e||(t.app_opened=0,await u("app_opened")),await u(e),void 0===t[e]&&(t[e]=0,e)},stopFact:d,setJson:u,getData:h,getDbJson:m,isFactStarted:w,getStartedFacts:function(){return t}}};function Gr(e,t){const n=t;if(!window.indexedDB)return console.log("Database error: Your browser doesn't support a stable version of IndexedDB."),!1;if(!e)return console.log("Dababase error: you need a valid config object parameter to create database!"),!1;const i=e;let s,o=1;const r=[],a={};if(!i.database)return console.log('Database error: config needs "database" attribute!'),!1;const c=i.database;if(i.version&&(o=parseInt(i.version)),!i.tables)return console.log('Database error: config needs "tables" attribute!'),!1;if(0===i.tables.length)return console.log('Database error: config "tables" has no elements!'),!1;for(let e=0;e<i.tables.length;e+=1){const t=i.tables[e];if(!t.name)return console.log('Database error: config "tables" needs "name" attribute!'),!1;r.push(t)}const l=window.indexedDB.open(c,o);return l.onerror=function(e){console.log("Database error: could not start!")},l.onsuccess=function(e){s=e.target.result,n&&n(),s.onerror=function(e){E(`Database error: ${e.target.errorCode}`)}},l.onupgradeneeded=function(e){s=e.target.result;for(let e=0;e<r.length;e+=1){const t=r[e].name,n=r[e].indexes;let i={autoIncrement:!0};r[e].keyPath&&(i={keyPath:r[e].keyPath});try{s.deleteObjectStore(t)}catch(e){E("Database create!")}if(a[t]=s.createObjectStore(t,i),n)for(let e=0;e<n.length;e+=1){const i=n[e].name,s=n[e].unique?{unique:!0}:{unique:!1};a[t].createIndex(i,i,s)}}},{insert:function(e,t){const n=s.transaction([e],"readwrite").objectStore([e]).add(t);n.onsuccess=n=>{E(`Database add (table: ${e}): ${JSON.stringify(t)}`)},n.onerror=n=>{E(`Database add error (table: ${e}): ${JSON.stringify(t)}`)}},read:function(e,t,n,i){let o,r=i;if("string"==typeof n)try{o=s.transaction([e]).objectStore([e]).index(n).get(t)}catch(e){return E(`Database error: ${e}`),!1}else o=s.transaction([e]).objectStore([e]).get(t),r=n;return o.onsuccess=e=>(E(`Database read: ${JSON.stringify(e.target.result)}`),!!r&&(r(e.target.result),!0)),o.onerror=e=>{E("Error getting data")},!1},readAll:function(e,t,n){let i,o=n;if("string"==typeof t)try{i=s.transaction([e]).objectStore([e]).index(t).getAll()}catch(e){return E(`Database error: ${e}`),!1}else i=s.transaction([e]).objectStore([e]).getAll(),o=t;return i.onsuccess=e=>!!o&&(o(e.target.result),!0),i.onerror=e=>{E("Database error readAll: Error getting data")},!1},update:function(e,t){const n=s.transaction([e],"readwrite").objectStore(e).put(t);n.onsuccess=e=>{},n.onerror=n=>{E(`Database update error (table: ${e}): ${JSON.stringify(t)}`)}},remove:function(e,t){const n=s.transaction([e],"readwrite").objectStore(e).delete(t);n.onsuccess=n=>{E(`Database remove (table: ${e}): ${t}`)},n.onerror=n=>{E(`Database update remove (table: ${e}): ${t}`)}}}}window.IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction||{READ_WRITE:"readwrite"},window.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange;const qr={"analytics/start":async function(){window.analytics=new Vr;let e=!1,t=!1;try{t=await window.analytics.start(),t||E("[Analytics] Not Started!")}catch(t){E("[Analytics] Start Error!"),e=!0}if(e||!t)return!1;const n=new Promise((e=>{const t={database:"db",version:4,tables:[]},n=Object.entries(window.analytics.getServerFacts());for(const[e]of n)t.tables.push({name:e,keyPath:"id"});e(t)})),i=await n;return window.database=new Gr(i,(async()=>{await window.analytics.startFact("app_opened")})),!0}};l()("#chni").on("click",(function(){window.Events.dispatch("main/channels-icon-click")})),l()("#chng").on("click",(function(){window.Events.dispatch("main/rooms-icon-click")})),l()("#chng").hover((function(){l()(".ic_group").addClass("ic_group_ON")}),(function(){"selected"!==l()(".ic_group").attr("selected")&&l()(".ic_group").removeClass("ic_group_ON")})),l()("#oti").on("click",(function(){window.Events.dispatch("main/others-icon-click")})),l()("#main-user-hello").on("click",(function(){window.Events.dispatch("main/user-welcome-click")})),l()("#logout").on("click",(function(){window.Events.dispatch("main/logout")}));const Hr={MAX_MESSAGE_SIZE:350,MAX_CHUNK_SIZE:300,PAYLOAD_SIZE:500,COMAND_SIZE:130,SENDING_TIME:250};function zr(e){if(!navigator.onLine)return window.Events.dispatch("main/modal-connection-failure-show"),!1;window.activity.check(),window.activity.update(`[Channel] Click enter: ${JSON.stringify(e)}`),window.session&&window.session.reset(),window.lastDate=void 0,window._engine.stop(),window._groupEngine.isStarted()&&(window._groupEngine.requestLeaveChannel(),window._groupEngine.stop()),window.channelEnter=e,l()("#session-recording").hide(),l()(".channelExpandRP").hide(),l()("#rpchngroupchat").hide(),l()("#chn-session-stop-btn").hide(),window._engine.currentChannel()&&window._engine.stop();const t=e.password?e.password:"";window._channel.setTopic(e.name),window._channel.setName(e.channel),window._channel.setPassword(t),window._channel.setUsersCount(e.users),window._channel.setUsername(p.ENGINE_NICK),window._channel.setImgSource(e.imgSrc),l()("#roomList").hide(),l()("#roomDetailArea").hide(),window._engine.callbacks().connectCB((function(){window.Events.dispatch("myheart/connect-cb")})),window._engine.callbacks().startedCB((async function(n,i,s,o,r){return E(`app -> startedCB: ${p.NICK} SIGNED IN : srvClientId:${n}, server:${i}, acsNick:${s}, ppcsNick:${o}`),window.Events.dispatch("myheart/started-cb",{srvClientId:n,serverName:i,acsNick:s,ppcsNick:o,prevchannel:r}),window.metaverseFixedId=await window._channel.isMetaverseFixed(e.channel),"0"!==window.metaverseFixedId&&(E(`[METAVERSE FIXED] Id: ${window.metaverseFixedId}`),await window.metaverse.join(e.channel,window.metaverseFixedId)),window.irmServer=i,window._channel.resetChannelMedias(),"-l"===e.channel?(window._engine.stop(),!1):(window._groupEngine.isStarted()&&(window._groupEngine.requestLeaveChannel(),window._groupEngine.stop()),window._engine.requestEnterChannel(e.channel,t),!1)}));const n=p.IRM_SERVERS||p.JANUS_SERVER;let i="",s=443;if("string"!=typeof n){const e=n.length;if(-1===window.lastJanusServerIndex){const t=(new Date).getTime();window.lastJanusServerIndex=t%e}else window.lastJanusServerIndex<e-1?window.lastJanusServerIndex+=1:window.lastJanusServerIndex=0;i=`wss://${n[window.lastJanusServerIndex].split(":")[0]}`,n[window.lastJanusServerIndex].split(":").length>1&&(s=parseInt(n[window.lastJanusServerIndex].split(":")[1])-14557)}let o=p.JANUS_SERVER[window.lastJanusServerIndex];return p.IRM_SERVERS&&(o=`${i}:${s}`),window._app.startJanus(o),!1}function Wr(e){if(!navigator.onLine)return window.Events.dispatch("main/modal-connection-failure-show"),!1;let t;window.activity.check(),window.activity.update(`[Room] Click enter: ${JSON.stringify(e)}`),window.session&&window.session.reset(),l()("#roomDetailArea").hide(),l()("#roomListDetailMenu").hide(),l()("#session-recording").hide(),l()(".channelExpandRP").show(),l()("#rpchngroupchat").hide(),l()("#rpchnhi").hide(),l()("#chn-session-stop-btn").hide(),window._engine.stop(),window._groupEngine.isStarted()&&(window._groupEngine.requestLeaveChannel(),window._groupEngine.stop()),window._engine.callbacks().connectCB((function(){window.Events.dispatch("myheart/connect-cb")})),window._engine.callbacks().startedCB((async function(t,n,i,s,o){if(E(`app -> startedCB: ${p.NICK} SIGNED IN : srvClientId:${t}, server:${n}, acsNick:${i}, ppcsNick:${s}`),window.Events.dispatch("myheart/started-cb",{srvClientId:t,serverName:n,acsNick:i,ppcsNick:s,prevchannel:o}),window.metaverseFixedId=await window._channel.isMetaverseFixed(e.channel),"0"!==window.metaverseFixedId){E(`[METAVERSE FIXED] Id: ${window.metaverseFixedId}`);const t=(await window.metaverse.join(e.channel,window.metaverseFixedId)).metaverse_url;t?(window.metaverse.setIdleTimeout((function(){window.Events.dispatch("metaverse/idle-timeout")}),p.METAVERSE_IDLE_TIMEOUT),l()("#chn-session-start-btn").hide(),l()("#rpchnhi").hide(),l()("#featuredImg").hide(),l()("#medias").html(""),l()("#medias").hide(),l()("#metaverse-area").html(`<iframe src="${t}&auth_token=${p.AUTH_TOKEN}&api_domain=${p.API_SERVER}&nick=${p.ENGINE_NICK.replace("-web","")}" class="w100 h100" allowvr="yes" allow="camera;microphone;display-capture;vr;speaker;"></iframe>`),l()("#rpchnyt").hide(),l()("#rpchnmetaverse").hide(),l()("#rpchnscreensaving").hide(),l()("#metaverse-area").show(),l()("#media-cc").hide(),window._recorderCtrl.isStarted()&&1!==window._channel.getType()&&l()("#record-option-stop").click(),window.metaverse.started=!0,window.metaverse.hideDevices(),l()(".channelAdmChat").hide(),l()(".channelCsmVideosIcon").hide(),l()(".channelAdmGroup").hide(),l()(".channelOtherIcon").hide(),l()("#channel_rp").hide(),l()("#channel_lp").css("width","100%"),l()("#channelChatHide").hide()):console.log("[METAVERSE] Error getting fixed URL!")}window.irmServer=n;const r=e.password?e.password:"";window._channel.setType(1),window._channel.setTopic(e.name),window._channel.setName(e.channel),window._channel.setPassword(r),window._channel.setUsersCount(e.users),window._channel.setImgSource(e.imgSrc),window._channel.hideTemporaryMessage();let a=[];p.ROOM[e.channel]&&(a=p.ROOM[e.channel].oper),window.enableCsm=window.csm[e.channel];try{JSON.parse(localStorage.getItem(`room_${e.channel}`)).enableCsm&&(window.enableCsm=!0)}catch(e){E("Failed to get enable_csm from localstorage!")}if(window._channel.resetChannelMedias(),window._channel.unmuteVideo(),window.devices.unmuteVideoDevice(),window._channel.unmuteAudio(),window.devices.unmuteAudioDevice(),0!==a.length)for(let t=0;t<a.length;t+=1)window._channel.setOperator(a[t]),t===a.length-1&&window._engine.requestEnterChannel(e.channel,r);else window._engine.requestEnterChannel(e.channel,r)}));let n,i,s,o,r=window.roomsServers;"-n"===e.channel.slice(-2)?(t=window.breakoutRoom.main.slice(0,-2),window.ephemeralConferenceServers&&window.ephemeralConferenceServers.length>0&&(r=window.ephemeralConferenceServers)):"-l"===e.channel.slice(-2)||"-m"===e.channel.slice(-2)?(t=e.channel.slice(0,-2),"-m"===e.channel.slice(-2)&&window.ephemeralConferenceServers&&window.ephemeralConferenceServers.length>0&&(r=window.ephemeralConferenceServers)):t=e.channel,1===t.length?(n=t.slice(0,1).charCodeAt(0),i=0,s=t.slice(0,1).charCodeAt(0),o=0):(n=t.slice(0,1).charCodeAt(0),i=t.slice(1,2).charCodeAt(0),s=t.slice(-1).charCodeAt(0),o=t.slice(t.length-2,t.length-1).charCodeAt(0));const a=(n+3*i+7*s+11*o)%r.length;if(r[a]){let e=parseInt(r[a].split(":")[1]-14557);445===e&&(e=451);const t=`${r[a].split(":")[0]}:${e}`;E(`roomServer: ${t}`),window._app.startJanus(`wss://${t}`)}else E("Unable to join: undefined room server! Trying a default room server..."),window._app.startJanus(`wss://${window.realm}-class.ip.tv:443`);return!1}function Jr(e){if(E("[Channel] Close function called!"),p.CONFIG.allowNewScreenDisplay&&window._medias.clearNewMedias(),window._mediaWndsMaps&&window._mediaWndsMap.clear(),l()("#alert-session-do-not-leave").hide(),window.session.isStarted()){if(navigator.onLine&&"disconnect"!==e)return l()("#alert-time-remaining").hide(),1===window._channel.getType()?l()(".i18n-session-do-not-leave").html(window.i18n.get("session-do-not-leave")):l()(".i18n-session-do-not-leave").html(window.i18n.get("session-do-not-leave-channel")),l()("#alert-session-do-not-leave").show(),setTimeout((()=>{l()("#alert-session-do-not-leave").hide()}),3e3),!1;window.session.reset(),window.countdown.stop(),window.softCountdown&&window.softCountdown.stop(),window.session.hideTimer()}l()("#medias").html(""),window.breakoutRoom.reset(),window.Events.dispatch("breakout-rooms/create-channels-dialog-hide"),window.metaverseFixedId="0",window.showLog=!0;const t=window._channel.getMyMedia();if(t){const e=t[0].metadata;e&&(0===e.mediaVoice?window._engine.requestTransmission(p.ENGINE_NICK,!1,!1):window._engine.requestTransmission(p.ENGINE_NICK,!1,!0))}if(window.showLog=!1,1===window._channel.getType()&&(p.CONFIG.showRoomDetailPage?(l()("#roomList").hide(),l()("#roomDetailArea").show()):l()("#roomDetailArea").hide()),window.Events.dispatch("medias/display-config-options-icon-hide"),l()("#banuba_effect").val("none"),window._captureCtrl.setSelectedEffect("none"),"true"===window.guest||!0===window.guest){window._channel.stopTransmission(),window.devicesStream&&window.devicesStream.getTracks().forEach((e=>{e.stop()})),window._engine.currentChannel()&&window._engine.requestLeaveChannel(),window._groupEngine.isStarted()&&(window._groupEngine.requestLeaveChannel(),window._groupEngine.stop()),l()("#rpchngroupchat").hide(),l()("#selfMediaControl").hide(),l()("#mediaVoice").html(""),l()(".rpchnhcount").html(""),l()("#channelAdmGroup").removeClass("ic_group_ON"),l()("#hp__Channel__").html(""),l()("#channelAdmUserListCount").html(""),l()("#user-list").html(""),l()(".user-list").hide(),l()("#user-transmitting").html(""),l()(".user-transmitting").remove(),l()("#rpchnuserlist").remove(),l()("#boxesArea").remove(),l()("#channelBody").remove(),l()("#db_invite_logout").show(),l()("#db_inv_msg").html(`<div class="pt20 pb20 b" style="font-size:20px;margin-top:15px;">${window.i18n.get("session-finished")}</div>`),l()("#db_inv_area").height("200px"),l()("#db_inv_button").hide(),l()("#db_inv_input_area").hide();const e=function(){const e=document.cookie.split(";");for(let t=0;t<e.length;t++){const n=e[t],i=n.indexOf("="),s=i>-1?n.substr(0,i):n;document.cookie=`${s}=;expires=Thu, 01 Jan 1970 00:00:00 GMT`}};return window._engine.stop(),e(),!1}l()("#metaverse-area").html(""),l()("#metaverse-area").hide(),window.metaverse.started=!1,l()(".rpme").removeClass("toj"),l()("#channelEmoticon").hide(),l()("#chn-session-start-btn").hide(),l()("#rpchnconficon").removeClass("tb"),1!==window._channel.getType()&&window._channel.getChannelCategories(),window.activity.update(`[Channel] Leaved channel: ${window._channel.getName()}`),window.session.hideTimer(),l()("#hp__Group__").html(""),l()("#chn-session-is-active-btn").hide(),l()("#chn-session-continue-btn").hide(),l()("#control-more-area").hide(),l()("#control-display").css("background-color","#707070"),l()("#control-screensharing").css("background-color","#707070"),window.softCountdown&&(window.session.hideTimer(),window.session.setRunning(!1),window.softCountdown.stop()),l()("#dbint").hide(),window.analytics&&window.config.allowAnalytics&&"watch"!==window.clientType&&(window.analytics.getServerFacts().channel_joined&&window.analytics.stopFact("channel_joined"),window.analytics.getServerFacts().media_transmitted&&window.analytics.stopFact("media_transmitted")),window.lastDate=void 0,window._channel.unmuteVideo(),window.devices.unmuteVideoDevice(),window._channel.unmuteAudio(),window.devices.unmuteAudioDevice(),window.channelEnter="",window.channelEnterTry=0,window.channelAcsMessages=[],window.enableCsm=!1,window.webAudio&&window.webAudio.isStarted()&&window.webAudio.stop(),window._channel.stopTransmission(),window.devicesStream&&window.devicesStream.getTracks().forEach((e=>{e.stop()})),window.localStream&&window.localStream.getTracks().forEach((e=>{e.stop()})),setTimeout((()=>{null===window._engine.currentChannel()&&(window.devicesStream&&window.devicesStream.getTracks().forEach((e=>{e.stop()})),window.localStream&&window.localStream.getTracks().forEach((e=>{e.stop()})))}),5e3),l()("#user-media-cc").hide(),l()("#media-cc").hide(),window.webSpeech.stop(),window._channel.resetChannelMedias(),window._windowCtrl.stopMirrorScreen(),l()("#user-media-mic").css({"background-color":"#707070","border-color":"#707070"}),l()("#user-media-mic").html("&#xE029;"),l()("#user-media-cam").css({"background-color":"#707070","border-color":"#707070"}),l()("#user-media-cam").html("&#xE04B;"),l()("#pollArea").hide(),l()("#youtube-area").remove(),window._engine.isStarted()&&(window._engine.requestLeaveChannel(),window._engine.stop()),window._groupEngine.isStarted()&&(window._groupEngine.requestLeaveChannel(),window._groupEngine.stop()),l()("#rpchngroupchat").hide(),l()("#selfMediaControl").hide(),l()("#mediaVoice").html(""),l()(".rpchnhcount").html(""),l()("#channelAdmGroup").removeClass("ic_group_ON"),l()("#hp__Channel__").html(""),l()("#channelAdmUserListCount").html(""),l()("#user-list").html(""),l()(".user-list").hide(),l()("#user-transmitting").html(""),l()(".user-transmitting").hide(),l()("#rpchnuserlist").hide(),l()("#boxesArea").hide(),l()("#channelBody").hide(),l()("#top_menu").show(),window.config.showChannelCategoryList&&!p.CONFIG.newCategoriesListWithChannels?(l()("#chnCategoriesMenu").show(),l()("#channelCategories").show()):(l()("#chnCategoriesMenu").hide(),l()("#channelCategories").hide()),l()("#channelChatTabIcon").removeClass("tb"),1===window._channel.getType()?l()("#chng").click():p.CONFIG.newCategoriesListWithChannels?(l()("#channelList").show(),window._channel.showNewCategoriesWithChannels()):(window._channel.getChannelList("channel",window._channel.getLastCategory()),l()("#channelList").show(),l()("#chni").click()),window._channelCtrl.reset(),window._channel.reset(),l()(".us").removeClass("uss"),l()("#channel_rp").hide(),l()(".rpchnh").hide(),l()("#dbm").hide(),l()(".channelTaskList").hide(),l()("#channelTaskList").removeClass("tb"),l()("#rpchntasklist").hide(),l()("#channelCsmVideosIcon").removeClass("tb"),l()("#rpchncsmlist").hide(),l()("#rpchncsmlist iframe").remove(),l()("#rpchncsmlist").html(""),l()("#rpchnfeedlist iframe").remove(),l()("#rpchnfeedlist").html(""),l()("#rpchnfeedlist").hide(),window.callStarted=!1,null!==window._engine.currentChannel()&&(l()("#channelAdmChat").click(),"-c"===window._engine.currentChannel().slice(-2)&&window._engine.requestChannelClose(window._engine.currentChannel(),""),window._engine.requestLeaveChannel(window._engine.currentChannel(),""),l()(`[owner=${window.engineNick}]`).length&&window._engine.requestTransmission(window.engineNick,"false","false"),window._captureCtrl.stop()),window._captureCtrl.stop(),window._engine.stop(),window._channel.setName(""),l()("#rpchncloudlist").hide(),l()("#channelCloudVideosIcon").removeClass("tb"),l()("#session-recording").hide(),l()(".dx").show()}function Yr(e){const t=e;let n="";const i=t.nick.replace(/#/g,"__hash__");return n=`<div id="chnprivc_${i}" class="fc bgw bor brtl brtr sha " style="width:384px;text-align:center;margin-right:10px;display:none;" t="${i}" name="${t.name}">`,n+=`<div class="bglg brtl brtr fr w100 pl5 pr5 chnprivmaxmin pt" style="border:0px;height:60px;border-bottom:1px;border-style:solid;border-color:#F0F0F0;" t="${i}"><div class="fic pt" style="width:50px">`,t.avatar_id&&t.avatar_id?"true"===t.group?n+=`<img src="${window.files_base_url}avatars/group/${t.nick}/thumb.jpeg" class="cp rphi">`:n+=`<img src="${window.files_base_url}avatars/user/${t.nick}/thumb.jpeg" class="cp rphi" onerror="loadDefaultAvatar(this);">`:"true"===t.group?n+=`<img src="${window.assets}/common/img/avatarGroup.png" class="cp rphi">`:n+=`<img src="${window.assets}/common/img/avatarPerson.png" class="cp rphi">`,n+=`</div><div class="fc fig fic pt"><div class="sn pt toj pl5">${t.name}</div>`,"true"!==t.group&&(n+=`<div class="sxs pl5">${t.nick}</div>`),n+=`</div><div class="fic pt chnprivclose" style="width:15px" t="${t.nick}">X</div></div>`,n+=`<div id="chnprivb_${i}" class="fc w100 fig" style="height:300px;">`,n+=`<div id="chnprivh_${i}" class="rpb fig w100 chnprivc_${i}" style="overflow-y:auto;" target="${t.nick}"><div class="rpbw frm pt5"><span class="" target="${t.nick}"></span></div>`,n+=`<div class="scrolldown" t="${t.nick}" style="position:absolute;bottom:70px;right:10px;z-index:9;display:none;"><span class="material-icons p5 tg bor brr bgw sha">&#xE313;</span></div></div>`,n+=`<div class="w100 bglg fcm" style="height:60px;min-height:60px;" t="${t.nick}">`,n+=`<div class="fr w100"><div class="rpm bglg fr pr10"><span class="rpmap tdg bor sha" t="${t.nick}" group="${t.group}" style="text-align:left;"><div class="rpmaiiv"><span class="material-icons material-icons tb rpma">&#xE3F4;</span><span class="tl">Fotos e VÃ­deos</span></div><div class="rpmaid"><span class="material-icons material-icons tb rpma">&#xE24D;</span><span class="tl">${window.i18n.get("share-document")}</span></div><div class="rpmaia"><span class="material-icons material-icons tb rpma">&#xE050;</span><span class="tl">${window.i18n.get("share-audio")}</span></div><div class="rpmaic"><span class="material-icons material-icons tb rpma">&#xE0BA;</span><span class="tl">${window.i18n.get("share-contact")}</span></div></span><div class="fic"><span class="material-icons material-icons tg rpme" t="${t.nick}" privChat="privChat">&#xE24E;</span></div>`,n+=`<div class="fic fig rmc"><textarea id="privChat${i}" class="w100 br sn rm" style="position:absolute;left:0px;border-color:#CCC;height:30px;resize:none;" t="${t.nick}" type="privChat" onkeyup="inputKeyUp(event, this);" oninput="inputChange(event, this);"></textarea></div></div></div>`,l()("#chnprivchatsarea").append(n),l()(`#privChat${i}`).on("input",(function(){let e=l()(this).val();if(e.length>Hr.MAX_MESSAGE_SIZE){l()(this).val(e.substring(0,Hr.MAX_MESSAGE_SIZE));const t='<div class="limite-message" style="background: #FEFEFE; border-radius: 8px; border: solid #80808000 1px; position: absolute; width: 98%; display: flex; padding: 3%; box-shadow: 0 0 10px rgb(0 0 0 / 30%); transform: translate(1%, -50%); align-items: center; justify-content: space-around;"><div><span class="material-icons" style="color:#E25F00; font-size: 22px;">&#xe88f;</span></div><div style="width: 84%; line-height: 1.1;"><span style="color:#192229;">Limite mÃ¡ximo de caracteres atingido!</span></div>';l()(".limite-message")&&l()(`#privChat${i}`).after(t),setTimeout((function(){l()(".limite-message").remove()}),3e3)}})),l()("#chnprivchatsarea").is(":visible")||(l()("#chnprivchatsarea > .fc").hide(),l()(`#chnprivc_${i}`).show()),setTimeout((function(){l()(`#privChat${i}`).focus()}),500),!1}function Kr(e){let t=e.split(/[Â  ]/).filter((e=>/^[a-zA-ZÃ§ÃÃ¡Ã©Ã­Ã³ÃºÃ¢ÃªÃ®Ã´Ã»Ã£ÃµÃÃÃÃÃÃÃÃÃÃÃÃ-]+$/.test(e)));if(0===t.length){let t=e.replace(/[^a-zA-ZÃ§ÃÃ¡Ã©Ã­Ã³ÃºÃ¢ÃªÃ®Ã´Ã»Ã£ÃµÃÃÃÃÃÃÃÃÃÃÃÃ]/g,"");if(0===t.length)return"";let n=t.charAt(0),i=t.charAt(1)||n;return n.toUpperCase()+i.toUpperCase()}let n,i=t[0].charAt(0);if(1===t.length)n=t[0].charAt(1);else{let e=t[t.length-1].split("-");n=e[e.length-1].charAt(0)}return i.toUpperCase()+n.toUpperCase()}function Xr(e){const t=m[Math.abs(I(e))%m.length];let n,i=window._channel.getUser(e).fullname;return i?(i=i.replace(/\s+/," "),n=Kr(i)):(i="",n=Kr(e)),`<svg width="30%" height="30%" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid meet" style="width:30%;height:30%">\n          <foreignObject width="100%" height="100%" xmlns="http://www.w3.org/1999/xhtml" style="display:flex;align-items:center;border-radius:50%;height:100px;background-color:${t};opacity:0.7;justify-content:center">\n            <div style="display:flex;align-items:center;justify-content:center;width:100%;height:100%;font-size:50px;font-weight:500;color:#FFFFFF;background-color:${t};border-radius:50%">${n}</div>\n          </foreignObject>\n\n        </svg>`}function Zr(){const e=window._engine.txInfoAvconf(!0)?.mediaId;return window.webSpeech.isActive()&&window.webSpeech.stop(),window._channel.muteAudio(),window.devices.muteAudioDevice(),window._engine.muteAudio(e),window._channel.getClosedCaption()&&window.cc.stop(),l()("#user-media-mic").css({"background-color":"#F95252","border-color":"#F95252"}),l()("#user-media-mic").html("&#xE02B;"),l()("#audioOn").hide(),l()("#audioOff").show(),!1}function Qr(){const e=window._engine.txInfoAvconf(!0)?.mediaId;return window._channel.getClosedCaption()&&window._channelCtrl.speechRecognitionStart(),window._channel.unmuteAudio(),window.devices.unmuteAudioDevice(),window._engine.unmuteAudio(e),l()("#user-media-mic").css({"background-color":"#707070","border-color":"#707070"}),l()("#user-media-mic").html("&#xE029;"),l()("#audioOn").show(),l()("#audioOff").hide(),!1}l()("#channelArea").on("click",".chn",(function(){const e=l()(this).attr("channel"),t=window._channel.getChannel(e);if(t&&t.extras&&t.extras.youtube_url){const i=p.CONFIG.roomIcon,s=t.topic,o=t.extras.youtube_url;let r,a=(t.extras.description||"").replace(". ",".<br />");if(a=a.replace(/\n/g,"<br />"),a=a.replace(/\\n/g,"<br />"),a=`<span class="b sxl">${s}</span><br /><br /><span class="ss">${a}</span>`,o.includes("playlist"))r=o.replace("youtube.com/playlist?","youtube.com/embed/videoseries?");else{function c(e){const t=e.match(/(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/(?:[^\/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|\S*?[?&]v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/);if(t){const n=t[1],i=new URL(e);return{videoId:n,queryString:new URLSearchParams(i.search).toString()}}return null}const d=c(o);if(d){const{videoId:u,queryString:h}=d;r=`https://www.youtube.com/embed/${u}?autoplay=1${h?`&${h}`:""}`}else consoleLog(`Invalid YouTube URL: ${o}`)}return l()("#top_menu").hide(),l()("#channelArea").hide(),l()("#embedArea").attr("room",t.name),l()("#embed-area-body").css("position","relative"),l()("#embed-area-channel-icon").html(`<img src=${i} style="width:50px;height:50px; "/>`),l()("#embed-area-channel-topic").html(s),l()("#embed-area-body").append(`<div class="fr w100 h100" style="position:absolute;"><div class="w100 h100"><iframe src="${r}" allowfullscreen class="w100 h100" frameborder="0"></iframe></div><div class="w100 h100 p20" style="width:30%;max-width:400px;overflow:auto;background-color:#ffffff;">${a}</div></div>`),l()("#embedArea").show(),!1}const n={channel:e,name:l()(this).attr("name"),users:l()(this).attr("users"),imgSrc:l()(this).attr("imgsrc")};window.Events.dispatch("main/channel-click",n)})),l()("#channelCategories").on("mouseover",".lpchc",(function(){const e=l()(this);window.Events.dispatch("main/channel-category-icon-mouse-over",e)})),l()("#channelCategories").on("mouseleave",".lpchc",(function(){const e=l()(this);window.Events.dispatch("main/channel-category-icon-mouse-leave",e)})),l()("#lpchcb").on("click",".lpchc",(function(){const e=l()(this);window.Events.dispatch("main/channel-category-icon-click",e)})),l()("#channelArea").on("click",".room",(function(){const e=l()(this).attr("room"),t={channel:e,name:l()(this).attr("name"),imgSrc:p.CONFIG.roomIcon};p.CONFIG.showRoomDetailPage?window.Events.dispatch("main/room-detail-cards-show",e):window.Events.dispatch("main/room-click",t)})),l()("#roomDetailArea").on("click","#roomDetailConference",(function(){const e={channel:l()("#roomDetailArea").attr("room"),name:l()("#roomDetailArea").attr("name"),imgSrc:p.CONFIG.roomIcon};window.Events.dispatch("main/room-click",e)})),l()("#ncr").on("click",(function(){window.Events.dispatch("main/new-conference-room-icon-click")})),l()("#roomDetailArea").on("click",".room-card",(function(){const e={type:l()(this).attr("type"),url:l()(this).attr("url"),embeddable:"true"===l()(this).attr("embeddable"),name:l()(this).attr("name"),topic:l()(this).attr("topic"),label:l()(this).attr("label"),url_placeholders:l()(this).attr("url_placeholders")?JSON.parse(l()(this).attr("url_placeholders")):[]};window.Events.dispatch("main/room-card-click",e)})),l()("body").on("click",(function(e){const t=e.target;let n=null,i=null;t&&(n=t.id,i=t.className);const s={id:n,className:i};window.Events&&window.Events.dispatch("main/body-click",s)}));const ea={"main/channels-icon-click":function(){if(window._channel.getChannelCategories(),window.config.showChannelCategoryList?(l()("#chnCategoriesMenu").show(),l()("#channelCategories").show()):(l()("#chnCategoriesMenu").hide(),l()("#channelCategories").hide()),l()(".ic_group").removeClass("ic_group_ON"),l()(".ic_group").removeAttr("selected"),l()("#channelList").show(),l()("#roomList").hide(),l()("#fit").val(""),l()(".lpfr").hide(),l()(".lpfro").hide(),l()("#lpfb").attr("t","ch"),l()(".lpi").removeClass("lpis"),l()("#chni").addClass("lpis"),l()("#channelArea").show(),l()("#chatArea").hide(),l()("#otherArea").hide(),l()("#roomDetailArea").hide(),l()("#channelChatTab").hide(),null===window._engine.currentChannel()&&l()("#channelBody").hide(),l()("#iptv_channel").length&&window.iptv_first_access)window.iptv_first_access=0;else{if(null!==window._engine.currentChannel()&&("-c"===window._engine.currentChannel().slice(-2)?(window._captureCtrl.stop(),window._engine.requestLeaveChannel(window._engine.currentChannel(),""),window._engine.stop()):(window._captureCtrl.stop(),window._engine.requestLeaveChannel(window._engine.currentChannel(),""))),""===window._channel.getLastCategory()){const e=window.config.firstCategorySelected;l()(`.lpchc${e}`).click(),l()(`.lpchc${e}`).trigger("mouseenter"),window._channel.setLastCategory(window.config.firstCategorySelected)}else window._channel.getChannelList("channel",window._channel.getLastCategory()),l()(`.lpchc${window._channel.getLastCategory()}`).click(),l()(`.lpchc${window._channel.getLastCategory()}`).trigger("mouseenter");l()("#fit").val(""),l()("#lpfr").html(""),l()("#lpfb").attr("t","ch"),l()("#lpfb").show(),l()("#lpchb").show(),l()("#lpchu").html(""),l()("#lpchm").hide(),l()("#lpcb").hide(),l()("#lppb").hide(),l()("#fi").removeClass("tb"),l()(".rpme").removeClass("toj"),l()("#rpEmoticon").hide()}},"main/rooms-icon-click":function(){l()("#channelCategories").hide(),l()("#channelList").hide(),l()("#roomListDetailMenu").hide(),l()("#channelArea").show(),l()("#chatArea").hide(),l()("#otherArea").hide(),l()(".lpi").removeClass("lpis"),l()(".ic_group").addClass("ic_group_ON"),l()(".ic_group").attr("selected","selected"),l()("#chng").addClass("lpis"),l()("#roomDetailArea").is(":visible")?l()("#roomList").hide():(window._channel.getRoomsList(),l()("#roomList").show())},"main/others-icon-click":function(){console.log("othersIconClicked!"),l()(".lpi").removeClass("lpis"),l()(".ic_group").removeClass("ic_group_ON"),l()(".ic_group").removeAttr("selected"),l()("#oti").addClass("lpis"),window.webview_url&&(window.webview_url.includes("http://")||window.config.otherLinkNewTab||window.config.multiRealm?window.open(window.webview_url,"_blank"):(l()("#chnCategoriesMenu").hide(),l()("#channelArea").hide(),l()("#chatArea").hide(),l()("#otherArea").html(""),l()("#otherArea").show(),l()("#otherArea").append(`<iframe src="${window.webview_url}" class="w100 h100"></iframe>`)))},"main/user-welcome-click":function(){l()("#main-user-hello-display").is(":visible")?l()("#main-user-hello-display").hide():l()("#main-user-hello-display").show()},"main/logout":function(){window._app.logout()},"main/channel-click":function(e){p.IFRAME||k("wait"),zr(e),l()("#channelInputArea").css("height","60px"),l()("#rpchntx").css("height","33px"),setTimeout((function(){if(k("auto"),"wait"===x()&&!p.IFRAME&&null===window._engine.currentChannel()){const e=window.i18n.get("connection-error"),t=window.i18n.get("channel-join-error");new lr(e,t,(function(){window._app.logout()})).present()}}),1e4)},"main/channel-category-icon-mouse-over":function(e){e.find(".ico").css("background-image",`url(${window.assets}/common${window._channel.getCategory(e.attr("category")).imgON})`),window.config.categoriesWhiteColor?e.find(".name").css("color","#9CE4FF"):e.find(".name").css("color","#0DB1F8")},"main/channel-category-icon-mouse-leave":function(e){e.hasClass("selected")||(e.find(".ico").css("background-image",`url(${window.assets}/common${window._channel.getCategory(e.attr("category")).imgOFF})`),window.config.categoriesWhiteColor?e.find(".name").css("color","#FFFFFF"):e.find(".name").css("color","#A1A1A1"))},"main/channel-category-icon-click":function(e){const t=e.attr("category");E(`[Main] Channel Category Icon click: ${t}`),window.activity.update(`[Category] Click: ${t}`),null!==window._engine.currentChannel()&&("-c"===window._engine.currentChannel().slice(-2)?(window._captureCtrl.stop(),window._engine.requestLeaveChannel(window._engine.currentChannel(),""),window._engine.stop()):(window._captureCtrl.stop(),window._engine.requestLeaveChannel(window._engine.currentChannel(),""))),window._channel.setLastCategory(e.attr("category")),l()("#fit").val(""),l()("#lpchm").hide(),l()("#lpchu").html(""),l()(".lpchc").removeClass("selected"),e.addClass("selected"),l()(".lpchc").mouseleave(),l()("#lpchb").show(),window._channel.getCategory(e.attr("category")).activity?window._channel.getChannelList("activity",void 0,void 0,!0):window._channel.getCategory(e.attr("category")).featured?window._channel.getChannelList("featured",e.attr("category"),void 0,!0):void 0!==window._channel.getCategory(e.attr("category")).id?window._channel.getChannelList("channel",e.attr("category"),void 0,!0):(l()("#channelList").html(""),l()("#lpchm").html(""),window.aMoreCategories.forEach((function(e){let t=`<div class="lpchc${e.id} lpchc fr w100 pl10 pt10 pr10 pt" category="${e.id}">`;t+=`<div class="fc fig pl5"><div class="fr w100"><span class="sn n">${e.name}</span><span class="fig"></span>`,t+="</div>",l()("#lpchm").append(t),l()("#lpchm").show()})))},"main/room-click":function(e){k("wait"),Wr(e),setTimeout((function(){"wait"===x()&&k("auto")}),1e4),l()("#channelInputArea").css("height","60px"),l()("#rpchntx").css("height","33px")},"main/new-conference-room-icon-click":async function(){const e=parseInt(window.time.now()),t={type:"open",start_at:e,end_at:e+2592e6,ephemeral:!0},n=await window.Invite.create(t);if(n){window.Invite.data=n;const e=n;window.Events.dispatch("main/enter-ephemeral-conference-room",e)}return n},"main/enter-ephemeral-conference-room":async function(e){E(`enterEphemeralConfereceRoom event with data: ${JSON.stringify(e)}`);const{id:t,type:n,realm:i,host:s,channel:o,start_at:r,end_at:a,time_zone:c,irm_server:d,link:u,created_at:h,updated_at:m,updated_by:w}=e;l()("#session-recording").hide(),l()(".channelExpandRP").show(),l()("#rpchngroupchat").hide(),l()("#rpchnhi").hide(),l()("#chn-session-stop-btn").hide(),window._engine.callbacks().startedCB((async function(t,n,i,r){if(E(`app -> startedCB: ${p.NICK} SIGNED IN : srvClientId:${t}, server:${n}, acsNick:${i}, ppcsNick:${r}`),window.metaverseFixedId=await window._channel.isMetaverseFixed(e.channel),"0"!==window.metaverseFixedId){E(`[METAVERSE FIXED] Id: ${window.metaverseFixedId}`);const t=(await window.metaverse.join(e.channel,window.metaverseFixedId)).metaverse_url;t?(window.metaverse.setIdleTimeout((function(){window.Events.dispatch("metaverse/idle-timeout")}),p.METAVERSE_IDLE_TIMEOUT),l()("#chn-session-start-btn").hide(),l()("#rpchnhi").hide(),l()("#featuredImg").hide(),l()("#medias").html(""),l()("#medias").hide(),l()("#metaverse-area").html(`<iframe src="${t}&auth_token=${p.AUTH_TOKEN}&api_domain=${p.API_SERVER}&nick=${p.ENGINE_NICK.replace("-web","")}" class="w100 h100" allowvr="yes" allow="camera;microphone;display-capture;vr;speaker;"></iframe>`),l()("#rpchnyt").hide(),l()("#rpchnmetaverse").hide(),l()("#rpchnscreensaving").hide(),l()("#metaverse-area").show(),l()("#media-cc").hide(),window._recorderCtrl.isStarted()&&1!==window._channel.getType()&&l()("#record-option-stop").click(),window.metaverse.started=!0,window.metaverse.hideDevices(),l()(".channelAdmChat").hide(),l()(".channelCsmVideosIcon").hide(),l()(".channelAdmGroup").hide(),l()(".channelOtherIcon").hide(),l()("#channel_rp").hide(),l()("#channel_lp").css("width","100%"),l()("#channelChatHide").hide()):console.log("[METAVERSE] Error getting fixed URL!")}window.irmServer=n||p.JANUS_SERVER[0];const a=e.password?e.password:"";window._channel.setType(2),window._channel.setTopic(o),window._channel.setName(o),window._channel.setPassword(a),window._channel.hideTemporaryMessage();const c=p.NICK;c===s&&window._channel.setOperator(c),window._channel.resetChannelMedias(),window._channel.unmuteVideo(),window.devices.unmuteVideoDevice(),window._channel.unmuteAudio(),window.devices.unmuteAudioDevice(),window._engine.requestEnterChannel(o,a)}));const g=window._channel.getSuffix(o);let f="";if(d&&"g"===g)f=`wss://${d.split(":")[0]}:${d.split(":")[1]-14557}`;else{let e=p.IRM_SERVERS||p.JANUS_SERVER,t=443;if("string"!=typeof e){const n=e.length;if(-1===window.lastJanusServerIndex){const e=(new Date).getTime();window.lastJanusServerIndex=e%n}else window.lastJanusServerIndex<n-1?window.lastJanusServerIndex+=1:window.lastJanusServerIndex=0;e=`wss://${e[window.lastJanusServerIndex].split(":")[0]}`,e[window.lastJanusServerIndex].split(":").lenght>1&&(t=parseInt(e[window.lastJanusServerIndex].split(":")[1])-14557)}let n=p.JANUS_SERVER[window.lastJanusServerIndex];p.IRM_SERVERS&&(n=`${e}:${t}`),f=n}window._app.startJanus(f)},"main/show-initial-main-panel":async function(){return l()("#rpchn").hide(),l()("#rpchnbox").hide(),l()(".dialog").hide(),l()("#app").show(),l()("#channelArea").show(),p.GUEST?(l()("#nchi").hide(),l()(".dbuserinfo_buttons").hide(),l()("#dbuserinfo_sendmsg").hide(),l()("#channelInputArea").hide()):l()("#top_menu").show(),p.REALM_LOGO?(l()("#alo").attr("src",p.REALM_LOGO),l()("#alo").css("height","46px"),l()("#alo").show()):l()("#alo").show(),p.CONFIG.showFinderField&&l()("#finder").show(),p.CONFIG.showTransmissionIcon&&l()("#nchi").show(),p.CONFIG.showChannelsIcon&&"watch"!==p.CLIENT_TYPE&&l()("#chni").show(),p.CONFIG.showGroupsIcon&&(p.CONFIG.showGroupsIcon2&&(l()("#groups-icon1").hide(),l()("#groups-icon2").show()),l()("#chng").show(),l()("#groups-icon-text").show()),p.CONFIG.showGroupsIcon2&&p.CONFIG.showGroupsIcon2Realms.includes(p.REALM)&&(l()("#chng").show(),l()("#groups-icon-text").hide(),l()("#groups-icon2-text").show()),p.CONFIG.showPeopleIcon&&l()("#pei").show(),p.CONFIG.showLmsIcon&&(l()("#lms").show(),l()(".channelLmsIcon").show()),p.CONFIG.showGoogleClassroomIcon&&l()("#gci").show(),p.CONFIG.showMainConfigIcon&&l()("#coi").show(),p.CONFIG.showPeopleIcon&&l()("#pei").show(),p.CONFIG.showGoogleClassroomIcon&&l()("#gci").show(),l()(".nick").html(p.NICK),l()(".fullname").html(p.FULLNAME),l()("#title").html(p.REALM_NAME),l()("#favicon").attr("href",p.REALM_FAVICON),p.PERMISSIONS.invite_invite_create_ephemeral&&l()("#ncr").show(),p.CONFIG.showChannelCategoryList&&p.GUEST&&"watch"!==p.CLIENT_TYPE?(l()("#chnCategoriesMenu").show(),l()("#channelCategories").show()):(l()("#chnCategoriesMenu").hide(),l()("#channelCategories").hide()),p.WEBVIEW_URL&&(p.CONFIG.ignoreWebViewUrl||(l()("#oti").show(),p.CONFIG.showChannelOtherLink&&l()(".channelOtherIcon").show())),p.CONFIG.showChannelCategoryList&&!p.GUEST?(l()("#chnCategoriesMenu").show(),l()("#channelCategories").show(),"watch"!==p.CLIENT_TYPE&&("room"===p.CONFIG.initialPanel?window.Events.dispatch("main/rooms-icon-click"):(window._channel.getChannelCategories(),window.Events.dispatch("main/channels-icon-click")))):(l()("#chnCategoriesMenu").hide(),l()("#channelCategories").hide()),l()("#rpchngroupiconimg").attr("src",p.CONFIG.roomIcon),l()("body").on("mouseover",".hint",(function(){const e=l()(this).offset(),t=l()(this).attr("alt");l()("#hint").html(t).css({top:e.top+15,left:e.left+15}).show()})),l()("body").on("mouseout",".hint",(function(){l()("#hint").html("").hide()})),l()("#chi").hide(),l()("#pei").hide(),l()("#channelChatTabIcon").hide(),l()(".channelChatTabIcon").hide(),l()(".dbuserinfo_buttons").hide(),l()(".dbuserinfo_sendmsg").show(),l()(".rpmaic").hide(),!0},"main/set-initial-localstorage":async function(){return localStorage.getItem("version")!==p.VERSION||localStorage.getItem("realm")!==p.REALM||localStorage.getItem("nick")!==p.NICK||(p.TS,parseInt(localStorage.getItem("ts")>864e5)),localStorage.setItem("realm",p.REALM),localStorage.setItem("nick",p.NICK),localStorage.setItem("selectedRealm",p.REALM),localStorage.setItem("version",p.VERSION),localStorage.setItem("ts",p.TS),!0},"main/room-detail-cards-show":async function(e){const t=p.ROOM[e],n=t.name,i=t.topic,s=t.cards;p.SELECTED_ROOM=e,E(`[roomDetailCardsShow] room: ${JSON.stringify(t)}`);const o=t?.enable_avconf,r=t?.enable_csm&&"false"!==p.CSM_ROOM_ENABLE&&!1!==p.CSM_ROOM_ENABLE,a=""!==p.FEED_SPA&&!1!==p.FEED_SP;l()("#roomList").hide(),l()("#roomDetailChannel").html(i),l()("#roomDetailArea").attr("room",n),l()("#roomDetailArea").attr("name",i),l()("#roomDetailB").html("");let c="";if(p.CONFIG.showRoomDetailTest&&(c+=`<div id="roomDetailTest" class="bor br sha fc pt p10 hovbgw" style="width: 180px;height:180px;margin:5px;"><div class="fic" style="margin:10px;"><img id="roomDetailTestImg" src="https://assets.ip.tv/webchat/edusp/prova_paulista.png" style="width:100px;"/></div><div class="fic sl toj b i18n-tests">${window.i18n.get("tests")}</div></div>`,c+=`<div id="roomDetailEssay" class="bor br sha fc pt p10 hovbgw" style="width: 180px;height:180px;margin:5px;"><div class="fic" style="margin:10px;"><img id="roomDetailEssayImg" src="https://assets.ip.tv/webchat/edusp/redacao_paulista.png" style="width:100px;"/></div><div class="fic sl toj b i18n-essay">${window.i18n.get("essay")}</div></div>`),p.TMS_SPA&&(c+=`<div id="roomDetailTms" class="bor br sha fc pt p10 hovbgw" style="width: 180px;height:180px;margin:5px;"><div class="fcm fic" style="margin:10px;width:100px;height:100px"><div class="sxxl p10 toj material-icons" style="font-size:50px;">assignment</div></div><div class="fic sl toj b i18n-tasks">${window.i18n.get("tasks")}</div></div>`),o&&(c+=`<div id="roomDetailConference" class="bor br sha fc pt p10 hovbgw" style="width: 180px;height:180px;margin:5px;"><div class="fcm fic" style="margin:10px;width:100px;height:100px"><div class="sxxl p10 toj material-icons" style="font-size:50px;">videocam</div></div><div class="fic sl toj b i18n-conference">${window.i18n.get("conference")}</div></div>`),a&&(c+=`<div id="roomDetailMural" class="bor br sha fc pt p10 hovbgw" style="width: 180px;height:180px;margin:5px;"><div class="fcm fic" style="margin:10px;width:100px;height:100px"><div class="sxxl p10 toj material-icons" style="font-size:50px;">campaign</div></div><div class="fic sl toj b i18n-mural">${window.i18n.get("mural")}</div></div>`),r&&(c+=`<div id="roomDetailCsm" class="bor br sha fc pt p10 hovbgw" style="width: 180px;height:180px;margin:5px;"><div class="fcm fic" style="margin:10px;width:100px;height:100px"><div class="sxxl p10 toj material-icons" style="font-size:50px;">video_library</div></div><div class="fic sl toj b i18n-recordings">${window.i18n.get("recordings")}</div></div>`),s&&s.length>0)for(let e=0;e<s.length;e+=1){const t=s[e];let o="";if("link"===t.type){const{type:e,icon:s,label:r,url:a,url_placeholders:c,embeddable:l}=t;E(`[roomDetailCardsShow] Card type ${e}: ${JSON.stringify(t)}`);const d=c||[];d.includes("!email")&&""===p.EMAIL?o="":(o+=`<div class="room-card bor br sha fc pt p10 hovbgw" style="width: 180px;height:180px;margin:5px;" type="${e}" url="${a}" label="${r}" embeddable="${!0===l}" name="${n}" topic="${i}" url_placeholders=${JSON.stringify(d)}><div class="fcm fic" style="margin:10px;width:100px;height:100px">`,o+=`<div class="p10"><img src="${s}" style="max-width:100px;max-height:100px;" /></div>`,o+=`</div><div class="fic sl toj b" style="text-align:center;">${r}</div></div>`)}c+=o}l()("#roomDetailB").html(c),l()("#roomDetailArea").show()},"main/room-card-click":async function(e){const{type:t,url:n,embeddable:i,name:s,topic:o,label:r,url_placeholders:a}=e;if(E(`[roomCardClick] data: ${JSON.stringify(e)}`),window.Events.dispatch("main/modal-wait-show"),"link"===t){let e=n;if(a.length>0){if(a.includes("auth_token")&&await window._channel.setExternalPlaceholder("auth_token",window.auth_token),a.includes("room_name")){const e=s;await window._channel.setExternalPlaceholder("room_name",e)}if(a.includes("!email")){const e=p.EMAIL;await window._channel.setExternalPlaceholder("!email",e)}if(a.includes("email")){const e=p.EMAIL||" ";await window._channel.setExternalPlaceholder("email",e)}if(a.includes("seducsp_token")){const e="seducsp_token";E(`[roomCardClick] Verifying if user has data for placeholder: ${e}`);const t=await window._channel.getExternalPlaceholder(e);let n=!1;if(t&&(E(`[roomCardClick] Found token in memory: ${t}`),n=await window._channel.checkExternalAuthentication(e,t,r),E(n?`[roomCardClick] We need now to check if token is already valid and the result is ${n}. We do not have to get a new one!`:`[roomCardClick] We need now to check if token is already valid and the result is ${n}. We have to get a new one!`)),!n){E(`[roomCardClick] No valid token found for placeholder "${e}". Need to get a new one!`);const t=await window._channel.getExternalAuthentication(e,r);t&&(E(`[roomCardClick] Got an authentication for placeholder "${e}": ${JSON.stringify(t)}`),t.token&&(E(`[roomCardClick] Storing placeholder "${e}" with token "${t.token}"`),await window._channel.setExternalPlaceholder(e,t.token)))}}}window.Events.dispatch("main/modal-hide");for(let t=0;t<a.length;t+=1){const n=a[t],i=await window._channel.getExternalPlaceholder(n);if(!i)return E(`[roomCardClick] Error: Normalized url (${e}) still have tokens!`),window.Events.dispatch("main/modal-no-resource-show"),setTimeout((function(){window.Events.dispatch("main/modal-hide")}),3e3),!1;e=e.replace(`{{${n}}}`,i)}if(E(`[roomCardClick] Normalized url: ${e}`),!i)return window.open(e),!0;const t=p.CONFIG.roomIcon,c=o;l()("#roomListDetailMenu").hide(),l()("#top_menu").hide(),l()("#channelArea").hide(),l()("#embedArea").attr("room",s),l()("#embed-area-channel-icon").html(`<img src=${t} style="width:50px;height:50px; "/>`),l()("#embed-area-channel-topic").html(c),l()("#embed-area-body").append(`<iframe src="${e}" allowfullscreen class="w100 h100"></iframe>`),l()("#embedArea").show()}return!1},"main/modal-wait-show":function(){const e=l()("body");window.Events.dispatch("main/modal-hide"),l()(e).append('<div id="modal" class="frm" style="position: absolute; z-index: 9999; width: 100%; height: 100%; color: rgb(255, 255, 255); background-color: rgba(100, 100, 100, 0.5);">\n       <div style="margin-top:auto;margin-bottom:auto">\n          <div class="loaderG"></div>\n       </div>\n    </div>')},"main/modal-hide":function(){const e=l()("body > #modal");e&&e.remove()},"main/modal-no-resource-show":function(){const e=l()("body"),t=`<div id="modal" class="frm" style="position: absolute; z-index: 9999; width: 100%; height: 100%; color: rgb(255, 255, 255); background-color: rgba(100, 100, 100, 0.5);">\n       <div style="margin-top:auto;margin-bottom:auto">\n          <div class="bgw bor br toj p20">${window.i18n.get("resource-unavailable-try-again-later")}</div>\n       </div>\n    </div>`;window.Events.dispatch("main/modal-hide"),l()(e).append(t)},"main/modal-connection-failure-show":function(){const e=l()("body"),t=`<div id="modal" class="frm" style="position: absolute; z-index: 9999; width: 100%; height: 100%; color: rgb(255, 255, 255); background-color: rgba(100, 100, 100, 0.5);">\n       <div style="margin-top:auto;margin-bottom:auto">\n          <div class="bgw bor br toj p20">${window.i18n.get("error-connection-lost")}</div>\n       </div>\n    </div>`;window.Events.dispatch("main/modal-hide"),l()(e).append(t),setTimeout((function(){window.Events.dispatch("main/modal-hide")}),5e3)},"main/body-click":function(e){const{id:t,className:n}=e;return n.includes("bkr_more")||l()("#bkr_config_more_dialog").hide(),n.includes("breakout-config-options-btn")||l()("#breakout-config-options-area").hide(),n.includes("bkr_add_users")||l()("#bkr_config_users_dialog").hide(),!1}};let ta;l()("#channel_close").on("click",(function(){window.Events.dispatch("channel/close")})),l()("#channelAdmGroup").on("click",(function(){window.Events.dispatch("channel/room-icon-click")})),l()("#roomListFilterOptions").on("change",".room-filter",(function(){const e={};e.id=l()(this).attr("value"),window.Events.dispatch("channel/room-filter-change",e)})),l()("#room-list-menu-detail").on("click",(function(){const e={};e.room=l()(this).attr("room"),window.Events.dispatch("channel/room-detail-click",e)})),l()("#roomDetailInfo").on("click",(function(){const e={};e.room=l()("#roomDetailArea").attr("room"),window.Events.dispatch("channel/room-detail-click",e)})),l()("#roomDetailClose").on("click",(function(){window.Events.dispatch("channel/room-detail-close")})),l()("#dbroomdetail_close").on("click",(function(){window.Events.dispatch("channel/room-detail-dialog-close-click")})),l()("#roomList").on("click",".room-list-detail-menu",(function(){const e={};e.room=l()(this).attr("room"),e.position=l()(this).position(),window.Events.dispatch("channel/room-detail-menu-click",e)})),l()("#mural-area-channel-close").on("click",(function(){window.Events.dispatch("channel/room-mural-exit-click")})),l()("#room-list-menu-mural").on("click",(function(){const e={};e.room=l()(this).attr("room"),window.Events.dispatch("channel/room-mural-menu-click",e)})),l()("#roomDetailArea").on("click","#roomDetailMural",(function(){const e={};e.room=l()("#roomDetailArea").attr("room"),window.Events.dispatch("channel/room-mural-menu-click",e)})),l()("#recordings-area-channel-close").on("click",(function(){window.Events.dispatch("channel/room-recordings-exit-click")})),l()("#room-list-menu-recordings").on("click",(function(){const e={};e.room=l()(this).attr("room"),window.Events.dispatch("channel/room-recordings-menu-click",e)})),l()("#roomDetailArea").on("click","#roomDetailCsm",(function(){const e={};e.room=l()("#roomDetailArea").attr("room"),window.Events.dispatch("channel/room-recordings-menu-click",e)})),l()("#tms-area-channel-close").on("click",(function(){window.Events.dispatch("channel/room-tms-exit-click")})),l()("#room-list-menu-tasks").on("click",(function(){const e={};e.room=l()(this).attr("room"),window.Events.dispatch("channel/room-tms-menu-click",e)})),l()("#roomList").on("click",".room-list-menu-tasks",(function(){const e={};e.room=l()(this).attr("room"),e.position=l()(this).position(),window.Events.dispatch("channel/room-tms-menu-click",e)})),l()("#roomDetailArea").on("click","#roomDetailTms",(function(){const e={};e.room=l()("#roomDetailArea").attr("room"),e.position=l()(this).position(),window.Events.dispatch("channel/room-tms-menu-click",e)})),l()("#roomDetailArea").on("click","#roomDetailTest",(function(){const e={};e.room=l()("#roomDetailArea").attr("room"),e.position=l()(this).position(),window.Events.dispatch("channel/room-tms-menu-click",e)})),l()("#roomDetailArea").on("click","#roomDetailEssay",(function(){const e={};e.room=l()("#roomDetailArea").attr("room"),e.position=l()(this).position(),window.Events.dispatch("channel/room-tms-menu-click",e)})),l()("#embed-area-channel-close").on("click",(function(){window.Events.dispatch("channel/room-embed-exit-click")})),l()("#channelOtherIcon").on("click",(function(){window.Events.dispatch("channel/other-icon-click")})),l()(".channelChat").on("click",(function(){window.Events.dispatch("channel/toggle-right-panel")})),l()("#rpchnhi").on("click",(function(e){e.stopPropagation(),window.Events.dispatch("channel/raise-hand-icon-click")})),window.timeClick=0,l()("#db_inv_button").on("click",(function(){window.Events.dispatch("channel/guest-enter-button-click")})),l()("#db_invite_name").on("keyup",(function(e){"Enter"===e.key&&window.Events.dispatch("channel/guest-enter-button-click")})),l()("#db_inv_btn_login").on("click",(function(){window.Events.dispatch("channel/user-enter-button-click")})),l()("#inv_panel_close_btn").on("click",(function(){l()("#db_invite").hide()})),l()("#db_invite_password").on("keyup",(function(e){"Enter"===e.key&&window.Events.dispatch("channel/user-enter-button-click")})),l()("#db_invite_showpassword").click((function(){"password"===l()("#db_invite_password").attr("type")?(l()("#db_invite_showpassword").html("&#xE8F5"),l()("#db_invite_password").removeAttr("type"),l()("#db_invite_password").removeProp("type")):(l()("#showpassword").html("&#xE8F4"),l()("#db_invite_password").prop("type","password"),l()("#db_invite_password").attr("type","password"))})),ta="pt-BR"===window.navigator.language||"pt"===window.navigator.languate?yi["pt-BR"]:yi["en-US"],l()("#channelExpandRP").on("click",(function(){const e=l()(this);window.Events.dispatch("channel/expand-right-panel-btn-click",e)}));const na={"channel/close":function(){Jr("close click event")},"channel/room-icon-click":function(){window.activity.update(`[Channel] Users icon click: ${window._channel.getName()}`),window.config.showChannelUserListIcon&&window._channel.getModes().U&&l()(".channelAdmUserList").show(),window._channel.getModes().m&&l()("#channelMsgAlert").hide(),window._groupEngine.currentChannel()&&window._groupEngine.requestLeaveChannel(window._groupEngine.currentChannel(),""),l()(".rpme").removeClass("toj"),l()("#channelEmoticon").hide(),window._groupEngine.stop(),l()("#channelNoMoreMsg").hide(),l()("#channelMsgCounter").hide(),l()("#channelMsgAlert").hide(),l()(".chnat").hide(),l()("#rpchngroupchat").hide(),l()("#rpchnmodlist").html(""),l()("#rpchnmodlist").hide(),l()("#rpchngroupchat").hide(),l()("#rpchnmetaverselist").hide(),l()("#rpchntasklist").hide(),l()("#rpchncsmlist").hide(),l()("#rpchnfeedlist iframe").remove(),l()("#rpchnfeedlist").html(""),l()("#rpchnfeedlist").hide(),l()("#rpchnusermutelist").html(""),l()("#rpchnuserbanlist").html(""),l()("#rpchnusermutelist").hide(),l()("#rpchnuserbanlist").hide(),l()("#rpchnhtitle").html(window.i18n.get("users")),l()(".rpchnhcount").attr("type","users"),l()("#rpchnconf").hide(),l()("#rpchnconficon").removeClass("tb"),l()("#rpchngrouplist").show(),l()("#rpchnuserlist").hide(),l()("#hp__Channel__").hide(),l()("#channelInputArea").hide(),l()("#channelAdmChat").removeClass("ic_channel_chat_ON"),l()("#channelTaskList").removeClass("tb"),l()("#channelModList").removeClass("tb"),l()("#channelAdmGroup").addClass("ic_group_ON"),l()("#channelAdmUserList").removeClass("tb"),l()("#channelCloudVideosIcon").removeClass("tb"),l()("#channelCsmVideosIcon").removeClass("tb"),l()("#rpchncloudlist").hide(),l()("#rpchncsmlist").hide(),l()("#roomListDetailMenu").hide(),window._channel.getRoomsList(),null!==window._engine.currentChannel()?window._channel.getModes().U&&window._engine.requestUserList():Jr("from room icon click")},"channel/room-filter-change":function(e){const t=e.id;p.ROOMS_SELECTED_FILTER=t,"-1"!==t?window._channel.getRoomsList(t):window._channel.getRoomsList()},"channel/room-detail-click":async function(e){const{room:t}=e,n=p.ROOM[`${t}`];l()("#roomListDetailMenu").hide(),l()("#room-detail-name").html(n.topic),l()("#room-detail-categories").html("");let i=[];n.category_ids.length>0&&(i=await window._channel.getRoomsCategoriesList(n.category_ids));let s="";for(let e=0;e<i.length;e+=1)s+=`<div class="p5">${i[e].name}</div>`;l()("#room-detail-categories").html(s),l()(".dialog").hide(),l()("#dbroomdetail").show(),l()(".modal").show(),l()("#dialog").show()},"channel/room-detail-close":async function(){l()("#roomDetailArea").hide(),window.Events.dispatch("main/rooms-icon-click")},"channel/room-detail-menu-click":function(e){const{room:t,position:n}=e;l()("#roomListDetailMenu").css("min-width",200),l()(".room-list-menu-item").hide(),l()(".room-list-menu-item").attr("room",p.ROOM[`${t}`].name),p.TMS_SPA&&l()("#room-list-menu-tasks").show(),p.CSM_SPA&&p.ROOM[`${t}`].enable_csm&&l()("#room-list-menu-recordings").show(),p.FEED_SPA&&l()("#room-list-menu-mural").show(),l()("#room-list-menu-detail").show(),l()("#roomListDetailMenu").is(":visible")?l()("#roomListDetailMenu").hide():(l()("#roomListDetailMenu").show(),l()("#roomListDetailMenu").css("top",n.top+20),l()("#roomListDetailMenu").css("left",n.left-190))},"channel/room-detail-dialog-close-click":function(){l()("#room-detail-name").html(""),l()("#room-detail-categories").html(""),l()(".dialog").hide(),l()("#dbroomdetail").hide(),l()(".modal").hide(),l()("#dialog").hide()},"channel/room-mural-exit-click":async function(){l()("#muralArea").hide(),l()("#top_menu").show(),l()("#channelArea").show(),l()("#mural-area-channel-topic").html(""),l()("#mural-area-body").html("")},"channel/room-mural-menu-click":async function(e){const{room:t}=e,n=p.CONFIG.roomIcon,i=p.ROOM[`${t}`].topic;l()("#roomListDetailMenu").hide(),l()("#top_menu").hide(),l()("#channelArea").hide(),l()("#mural-area-channel-icon").html(`<img src=${n} style="width:50px;height:50px; "/>`),l()("#mural-area-channel-topic").html(i),l()("#mural-area-body").append(`<iframe src="${window.feed_spa}?auth_token=${window.auth_token}&room=${t}" allowfullscreen class="w100 h100"></iframe>`),l()("#muralArea").show()},"channel/room-recordings-exit-click":async function(){l()("#recordingsArea").hide(),l()("#top_menu").show(),l()("#channelArea").show(),l()("#recordings-area-channel-topic").html(""),l()("#recordings-area-body").html("")},"channel/room-recordings-menu-click":async function(e){const{room:t}=e,n=p.CONFIG.roomIcon,i=p.ROOM[`${t}`].topic;l()("#roomListDetailMenu").hide(),l()("#top_menu").hide(),l()("#channelArea").hide(),l()("#recordings-area-channel-icon").html(`<img src=${n} style="width:50px;height:50px; "/>`),l()("#recordings-area-channel-topic").html(i),l()("#recordings-area-body").append(`<iframe src="${window.csm_spa}?auth_token=${window.auth_token}&room=${t}" allowfullscreen class="w100 h100"></iframe>`),l()("#recordingsArea").show()},"channel/room-tms-exit-click":async function(){l()("#tmsArea").hide(),l()("#top_menu").show(),l()("#channelArea").show(),l()("#tms-area-channel-topic").html(""),l()("#tms-area-body").html("")},"channel/room-tms-menu-click":async function(e){const{room:t}=e,n=p.CONFIG.roomIcon,i=p.ROOM[`${t}`].topic;l()("#roomListDetailMenu").hide(),l()("#top_menu").hide(),l()("#channelArea").hide(),l()("#tms-area-channel-icon").html(`<img src=${n} style="width:50px;height:50px; "/>`),l()("#tms-area-channel-topic").html(i),l()("#tms-area-body").append(`<iframe src="${window.tms_spa}?auth_token=${window.auth_token}&room=${t}" allowfullscreen class="w100 h100"></iframe>`),l()("#tmsArea").show()},"channel/room-embed-exit-click":async function(){l()("#embedArea").hide(),l()("#top_menu").show(),l()("#channelArea").show(),l()("#embed-area-channel-topic").html(""),l()("#embed-area-body").html("")},"channel/other-icon-click":function(){window.webview_url&&(window.webview_url.includes("http")||window.config.otherLinkNewTab||window.config.multiRealm)&&window.open(window.webview_url,"_blank")},"channel/toggle-right-panel":function(){l()("#channel_rp").is(":visible")?(l()("#channelChatShow").show(),l()("#channelChatHide").hide(),l()("#channel_rp").hide(),l()("#channel_mp").hide(),l()("#channelBannerArea").hide(),l()("#channel_lp").css("width","100%"),l()("#channel_lp").css("max-width","100%")):(l()("#channelChatShow").hide(),l()("#channelChatHide").show(),l()("#boxesArea").css("min-height","70%"),l()("#channel_rp").show(),l()("#channel_mp").show(),l()("#channel_lp").css("max-width","70%"),l()("#channelBannerArea").show(),l()("#channel_lp").css("width","70%"),l()("#channelAdm").hasClass("tb")?l()("#channelBannerArea").hide():l()("#channelAdmArea").hide(),""!==l()("#rpchnboxtext").html()&&"1"!==l()("#rpchnbox").attr("hide")||l()("#rpchnbox").hide())},"channel/raise-hand-icon-click":function(){if(window.timeClick+=1,1===window.timeClick&&setTimeout((()=>{window.timeClick=0}),3e3),window.timeClick>1)return!1;window.engineNick=p.ENGINE_NICK,window._channel.getMedias(),p.ROOM=p.ROOM||{};const e=window._channel.isOperator(p.ENGINE_NICK)||p.ROOM[window._engine.currentChannel()]?.oper.includes(p.NICK);if(l()("#rpchnhi").hasClass("tb"))l()("#rpchnhi").removeClass("tb"),window._channel.unsetTransmitting(),window._channelCtrl.getSpeechRecognitionStatus()&&window._channelCtrl.speechRecognitionStop(),window.devicesStream&&window.devicesStream.getTracks().forEach((e=>{e.stop()})),l()("#selfMediaControl").hide(),l()("#rpchnhi").removeClass("ic_collaborate_ON"),l()("#user-media-control").hide(),l()(`#lpchu_${window.engineNick} .chnu_h`).removeClass("tb"),window._channel.getMedias().includes(p.ENGINE_NICK)?(window._channel.getMyMedia()[0].stream().getVideoTracks()[0]&&(window._channel.getMyMedia()[0].stream().getVideoTracks()[0].enabled=!1),window._channel.unsetMediaVoiceUser(window.engineNick),window._channel.unsetVoiceUser(window.engineNick),window._engine.requestTransmission(p.ENGINE_NICK,!1,!1),window._engine.unpublish(),window._engine.unpublishScreen(),window._windowCtrl.stopMirror(),window._windowCtrl.stopMirrorScreen(),window._channel.unsetChannelMedia(window._channel.getMyMedia()[0].metadata.mediaId),window._windowCtrl.redrawWindows(),l()("#selfMediaControl").hide(),setTimeout((function(){l()("#selfMediaControl").hide()}),2e3)):window._engine.requestRaiseHand(0);else{if(""!==window._channel.getActiveRoom())return E("Can not initiate transmission!"),!1;if(window._channel.unmuteVideo(),l()("#user-media-cam").css({color:"#FFFFFF","border-color":"#707070"}),l()("#user-media-cam").html("&#xE04B;"),l()("#videoOn").show(),l()("#videoOff").hide(),l()("#rpchnhi").addClass("tb"),l()("#rpchnhi").addClass("ic_collaborate_ON"),l()(`#lpchu_${window.engineNick} .chnu_h`).addClass("tb"),e){if(window.session.isRunning())return window._engine.requestRaiseHand(1),!1;l()("#input_devices").click()}else window._channel.getMedias().includes(p.ENGINE_NICK)?window._channelCtrl.setTx(!0,!1,!0,!1):window._engine.requestRaiseHand(1)}return!1},"channel/guest-enter-button-click":async function(){const e=window.Invite.data;let t=l()("#db_invite_name").val().trim();const n="-g"===e.channel.substr(-2);if(0===t.length||t.length>50||t.length<3||!t.replaceAll(" ").match(/^(?!.*([a-zA-Z\u00C0-\u017F\s])\1{2})[a-zA-Z\u00C0-\u017F\s]+$/))return l()("#db_invite-alert").html(window.i18n.get("invalid-fullname")),l()("#db_invite-alert").addClass("b"),l()("#db_invite-alert").addClass("sxs"),l()("#db_invite-alert").removeClass("ss"),l()("#db_invite-alert").show(),l()("#db_invite_name").focus(),!1;const i=window.i18n.get("guest-suffix");let s;if(p.NAME=`${t} ${i}`,p.ENGINE_NICK=p.ENGINE_NICK.replaceAll("-web",""),l()("#db_invite").hide(),l()("#app").show(),"watch"===p.CLIENT_TYPE){const e={channel:p.CHANNEL,name:p.CHANNEL,users:0,imgSrc:`${p.FILES_BASE_URL}avatars/user/${p.CHANNEL}/thumb.jpeg`};s=await window.Events.dispatch("main/channel-click",e)}else if(n)s=await window.Events.dispatch("main/enter-ephemeral-conference-room",e);else{const t={channel:e.channel,name:e.channel,users:0,imgSrc:`${p.FILES_BASE_URL}avatars/user/${e.channel}/thumb.jpeg`};s=await window.Events.dispatch("main/channel-click",t)}return s},"channel/user-enter-button-click":async function(){const e=window.Invite.data;if(!e)return!1;const t=window.Invite.data.start_at,n=window.Invite.data.end_at,i=e.realm;window.login.realm=i,l()("#db_inv_alert");const s=l()("#db_invite_username").val().trim(),o=l()("#db_invite_password").val().trim();let r="";const a=await window.timerWorker.now();if(n<a||t>a)return!1;const c=await window.login.getRealmConfig(i);if(r=c.nick_suffix||c.suffix||"",localStorage.setItem("selectedRealm",i),!i)return!1;const d={};let u;if(d.realm=i,d.username=s,-1===d.username.indexOf("-")&&""!==r&&(d.username=`${d.username}-${r}`),d.password=o,l()("#iptv").prop("checked")&&(d.iptv=l()("#iptv").val()),!window.navigator.onLine)return u=ta.authErrorNoInternet,l()(".alert").html(u),l()(".btnLogin").removeClass("bgdg"),!1;function h(){l()("#block").show(),document.getElementById("block").style.cursor="wait"}window.login.username=d.username,window.login.password=d.password,window.login.auth_type="normal",h();const p=await window.login.authenticate();if(p.error&&p.status)return l()("#block").hide(),document.getElementById("block").style.cursor="auto",u=401===p.status?ta.authError401:403===p.status?ta.authError403:ta.authErrorOther,l()(".alert").html(u),l()(".btnLogin").removeClass("bgdg"),!1;h();const m=new URL(window.location.href),w=new URLSearchParams(m.search);w.append("api","mas"),w.append("token",e.token),m.search=w.toString(),window.location.href=m.toString()},"channel/expand-right-panel-btn-click":function(e){const t=e;"navigate_next"===t.html()?(t.html("navigate_before"),l()("#channel_rp").width("30%"),l()("#channel_lp").show(),l()("#channel_mp").show()):(t.html("navigate_next"),l()("#channel_lp").hide(),l()("#channel_rp").width("100%"),l()("#channel_mp").hide())}};function ia(){const e=l()(".emoticons_close").attr("t");l()("#rpEmoticonHeader").html(""),l()("#rpEmoticonBody").html(""),S.forEach((function(e){l()("#rpEmoticonHeader").append(`<span id="emoticonMenu_${e.type}" class="emoticonMenu emoticonMenu_${e.type} material-icons material-icons tg" type="${e.type}">${e.imageCode}</span>`),0!==e.data.length&&l()("#rpEmoticonBody").append(`<div id="emoticon_${e.type}" class="emoticon emoticon_${e.type} toj" type="${e.type}">${e.title}</div>`),e.data.forEach((function(t){l()("#rpEmoticonBody").append(`<div class="emoticonItem" type="${e.type}">${t}</div>`)}))})),l()("#channelEmoticonHeader").html(""),l()("#channelEmoticonHeader").addClass("fr w100"),S.forEach((function(e){l()("#channelEmoticonHeader").append(`<span id="emoticonMenu_${e.type}" class="emoticonMenu emoticonMenu_${e.type} material-icons material-icons tg" type="${e.type}">${e.imageCode}</span>`)})),l()("#channelEmoticonHeader").append(`<div class="fig"></div><div class="emoticons_close pt" t="${e}">X</div>`),l()("#channelEmoticonHeader").append("</div>"),l()("#channelEmoticonBody").html(""),S.forEach((function(e){0!==e.data.length&&l()("#channelEmoticonBody").append(`<div id="emoticon_${e.type}" class="emoticon emoticon_${e.type} toj" type="${e.type}">${e.title}</div>`),e.data.forEach((function(t){l()("#channelEmoticonBody").append(`<div class="emoticonItem" type="${e.type}">${t}</div>`)}))}))}l()("#channelAdmChat").on("click",(function(){l()("channelInputArea").show(),window.Events.dispatch("chat/icon-click")})),l()("#app").on("click",".rpme",(function(){const e=l()(this);window.Events.dispatch("chat/emoticons-icon-click",e)})),l()("#app").on("click",".emoticons_close",(function(){const e=l()(this);window.Events.dispatch("chat/emoticons-icon-click",e)})),l()("#app").on("click",".emoticonItem",(function(){const e=l()(this).html(),t=[];let n=0;const i=l()(this).parent().parent().attr("t");if("privChat"===l()(this).parent().parent().attr("privChat")){const s=l()(`#chnprivc_${i} .rm`).val();p.EMOTICONS[0].data.unshift(e),p.EMOTICONS[0].data.forEach((function(e){t.indexOf(e)<0&&t.push(e),n+=1,n===p.EMOTICONS[0].data.length&&(p.EMOTICONS[0].data=t,ia())})),l()(`#chnprivc_${i} .rm`).val(s+e),l()(`#chnprivc_${i} .rm`).focus()}if("channel"===l()(this).parent().parent().attr("privChat")){const i=l()("#rpchntx").val();p.EMOTICONS[0].data.unshift(e),p.EMOTICONS[0].data.forEach((function(e){t.indexOf(e)<0&&t.push(e),n+=1,n===p.EMOTICONS[0].data.length&&(p.EMOTICONS[0].data=t,ia())})),l()("#rpchntx").val(i+e),l()("#rpchntx").focus()}else{const s=l()(`#${i} .rm`).val();p.EMOTICONS[0].data.unshift(e),p.EMOTICONS[0].data.forEach((function(e){t.indexOf(e)<0&&t.push(e),n+=1,n===p.EMOTICONS[0].data.length&&(p.EMOTICONS[0].data=t,ia())})),l()(`#${i} .rm`).val(s+e),l()(`#${i} .rm`).focus()}})),l()("#app").on("mouseover",".emoticonItem",(function(){!0!==l()(`.emoticonMenu_${l()(this).attr("type")}`).hasClass("toj")&&(l()(".emoticonMenu").removeClass("toj"),l()(`.emoticonMenu_${l()(this).attr("type")}`).addClass("toj"))})),l()("#app").on("click",".emoticonMenu",(function(){l()(".emoticonMenu").removeClass("toj"),l()(this).addClass("toj");const e=l()("#channelEmoticonBody").offset().top,t=l()("#channelEmoticonBody").scrollTop(),n=l()(`#emoticon_${l()(this).attr("type")}`).offset().top;l()("#rpEmoticonBody").scrollTop(n+t-e),l()("#channelEmoticonBody").scrollTop(n+t-e)})),ia(),setTimeout((function(){l()("#rpEmoticon").css("z-index","19"),l()("#rpEmoticon").hide(),l()("#channelEmoticon").css("z-index","19"),l()("#channelEmoticon").hide()}),3e3);const sa={"chat/icon-click":function(){window._channel.setActiveRoom(""),window._channel.isRoomOperator(p.ENGINE_NICK)&&window._channel.unsetRoomOperator(p.ENGINE_NICK),window.config.showChannelUserListIcon&&window._channel.getModes().U&&l()(".channelAdmUserList").show(),l()("#rpchnhtitle").html("Chat"),l()(".rpchnhcount").attr("type","chat"),l()("#rpchnconf").hide(),l()("#rpchnconficon").removeClass("tb"),l()("#rpchnmetaverselist").hide(),l()("#rpchntasklist").hide(),l()("#rpchncsmlist").hide(),l()("#rpchnfeedlist iframe").remove(),l()("#rpchnfeedlist").html(""),l()("#rpchnfeedlist").hide(),l()("#rpchnmodlist").hide(),l()("#rpchngrouplist").hide(),l()("#rpchngroupchat").hide(),l()("#rpchnuserlist").hide(),l()("#rpchnusermutelist").hide(),l()("#rpchnuserbanlist").hide(),l()("#hp__Channel__").show(),l()("#channelNoMoreMsg").hide(),window._channel.getChannelPermissions(),l()("#channelAdmChat").addClass("ic_channel_chat_ON"),l()("#channelTaskList").removeClass("tb"),l()("#channelModList").removeClass("tb"),l()("#channelAdmGroup").removeClass("ic_group_ON"),l()("#channelAdmUserList").removeClass("tb"),l()("#channelCloudVideosIcon").removeClass("tb"),l()("#channelCsmVideosIcon").removeClass("tb"),l()("#channelFeedIcon").removeClass("tb"),l()("#rpchncloudlist").hide(),window._groupEngine.isStarted()&&(window._groupEngine.requestLeaveChannel(),window._groupEngine.stop()),null!==window._engine.currentChannel()?window._channel.getModes().U&&window._engine.requestUserList():Jr()},"chat/emoticons-icon-click":function(e){const t=e,n=t.attr("t"),i=t.attr("privChat"),s=l()(".emoticons_close");s.attr("t",n),s.attr("privChat",i),"__Channel__"===n?(l()("#channelEmoticonBody").scrollTop(0),l()(`#emoticonMenu_${p.EMOTICONS[0].type}`).addClass("toj"),l()("#channelEmoticon").attr("t","__Channel__"),l()("#channelEmoticon").attr("privChat","channel"),l()("#channelEmoticon").toggle(),"none"===l()("#channelEmoticon").css("display")?l()(".rpme").removeClass("toj"):(l()(".rpme").removeClass("toj"),l()(".rpme").addClass("toj"))):"__Group__"===n?(l()("#channelEmoticonBody").scrollTop(0),l()(`#emoticonMenu_${p.EMOTICONS[0].type}`).addClass("toj"),l()("#channelEmoticon").attr("t","__Group__"),l()("#channelEmoticon").attr("privChat","group"),l()("#channelEmoticon").toggle(),"none"===l()("#channelEmoticon").css("display")?l()(".rpme").removeClass("toj"):(l()(".rpme").removeClass("toj"),l()(".rpme").addClass("toj"))):"privChat"===i?(l()("#channelEmoticonBody").scrollTop(0),l()(`#emoticonMenu_${p.EMOTICONS[0].type}`).addClass("toj"),l()("#channelEmoticon").attr("t",n),l()("#channelEmoticon").attr("privChat","privChat"),l()("#channelEmoticon").toggle(),"none"===l()("#channelEmoticon").css("display")?l()(".rpme").removeClass("toj"):(l()(".rpme").removeClass("toj"),l()(".rpme").addClass("toj"))):(l()("#rpEmoticonBody").scrollTop(0),l()(`#emoticonMenu_${p.EMOTICONS[0].type}`).addClass("toj"),l()("#rpEmoticon").attr("t",n),l()("#rpEmoticon").toggle(),"none"===l()("#rpEmoticon").css("display")?l()(".rpme").removeClass("toj"):(l()(".rpme").removeClass("toj"),l()(".rpme").addClass("toj")))}};l()("#channelTaskList").click((function(){window.Events.dispatch("tms/icon-click")}));const oa={"tms/icon-click":function(){window.activity.update(`[Channel] Task icon click: ${window._channel.getName()}`),l()(".rpme").removeClass("toj"),l()("#channelEmoticon").hide(),window._channel.getModes().m&&l()("#channelMsgAlert").hide(),l()("#channelNoMoreMsg").hide(),l()("#channelMsgCounter").hide(),l()("#channelMsgAlert").hide(),l()("#rpchntasksArea").html(""),l()("#rpchnconf").hide(),l()("#rpchnconf").removeClass("tb"),l()("#rpchnmetaverselist").hide(),l()("#rpchntasklist").show(),l()("#rpchncsmlist").hide(),l()("#rpchnfeedlist").hide(),l()("#rpchnmodlist").hide(),l()("#rpchngrouplist").hide(),l()("#rpchngroupchat").hide(),l()("#rpchngrouplist").hide(),l()("#rpchnuserlist").hide(),l()("#rpchnusermutelist").hide(),l()("#rpchnuserbanlist").hide(),l()("#hp__Channel__").hide(),l()("#channelInputArea").hide(),l()("#channelAdmChat").removeClass("ic_channel_chat_ON"),l()("#channelTaskList").addClass("tb"),l()("#channelModList").removeClass("tb"),l()("#channelAdmGroup").removeClass("ic_group_ON"),l()("#channelAdmUserList").removeClass("tb"),l()("#channelCloudVideosIcon").removeClass("tb"),l()("#channelCsmVideosIcon").removeClass("tb"),l()("#channelFeedIcon").removeClass("tb"),l()("#rpchncloudlist").hide(),l()("#rpchntasklist iframe").remove(),l()("#rpchntasklist").html(""),E(`<iframe src="${window.tms_spa}?auth_token=${window.auth_token}&room=${""===window._channel.getActiveRoom()?window._engine.currentChannel():window._groupEngine.currentChannel()}" class="w100 h100"></iframe>`),l()("#rpchntasklist").append(`<iframe src="${window.tms_spa}?auth_token=${window.auth_token}&room=${""===window._channel.getActiveRoom()?window._engine.currentChannel():window._groupEngine.currentChannel()}" class="w100 h100"></iframe>`)}};l()("#channelCsmVideosIcon").on("click",(function(){window.Events.dispatch("csm/icon-click")}));const ra={"csm/icon-click":function(){window.activity.update(`[Channel] Videos icon click: ${window._channel.getName()}`),l()(".rpme").removeClass("toj"),l()("#channelEmoticon").hide(),l()("#channelNoMoreMsg").hide(),l()("#channelMsgCounter").hide(),l()("#channelMsgAlert").hide(),l()(".chnat").hide(),l()("#rpchngroupchat").hide(),l()("#rpchnmodlist").html(""),l()("#rpchnmodlist").hide(),l()("#rpchngroupchat").hide(),l()("#rpchnmetaverselist").hide(),l()("#rpchntasklist").hide(),l()("#rpchncsmlist").show(),l()("#rpchnfeedlist iframe").remove(),l()("#rpchnfeedlist").html(""),l()("#rpchnfeedlist").hide(),l()("#rpchnusermutelist").html(""),l()("#rpchnuserbanlist").html(""),l()("#rpchnusermutelist").hide(),l()("#rpchnuserbanlist").hide(),l()("#rpchnhtitle").html(window.i18n.get("users")),l()(".rpchnhcount").attr("type","users"),l()("#rpchnconf").hide(),l()("#rpchnconficon").removeClass("tb"),l()("#rpchngrouplist").hide(),l()("#rpchnuserlist").hide(),l()("#hp__Channel__").hide(),l()("#channelInputArea").hide(),l()("#channelAdmChat").removeClass("ic_channel_chat_ON"),l()("#channelTaskList").removeClass("tb"),l()("#channelModList").removeClass("tb"),l()("#channelAdmGroup").removeClass("ic_group_ON"),l()("#channelAdmUserList").removeClass("tb"),l()("#channelCloudVideosIcon").removeClass("tb"),l()("#channelCsmVideosIcon").addClass("tb"),l()("#channelFeedIcon").removeClass("tb"),l()("#rpchncloudlist").hide(),l()("#rpchncsmlist iframe").remove(),l()("#rpchncsmlist").html(""),l()("#rpchncsmlist").append(`<iframe src="${window.csm_spa}?auth_token=${window.auth_token}&room=${""===window._channel.getActiveRoom()?window._engine.currentChannel():window._groupEngine.currentChannel()}" allowfullscreen class="w100 h100"></iframe>`)}};l()("#channelFeedIcon").on("click",(function(){window.Events.dispatch("feed/icon-click")}));const aa={"feed/icon-click":function(){window.activity.update(`[Channel] Feed icon click: ${window._channel.getName()}`),l()(".rpme").removeClass("toj"),l()("#channelEmoticon").hide(),l()("#channelNoMoreMsg").hide(),l()("#channelMsgCounter").hide(),l()("#channelMsgAlert").hide(),l()(".chnat").hide(),l()("#rpchngroupchat").hide(),l()("#rpchnmodlist").html(""),l()("#rpchnmodlist").hide(),l()("#rpchngroupchat").hide(),l()("#rpchnmetaverselist").hide(),l()("#rpchntasklist").hide(),l()("#rpchncsmlist").hide(),l()("#rpchnfeedlist").show(),l()("#rpchnusermutelist").html(""),l()("#rpchnuserbanlist").html(""),l()("#rpchnusermutelist").hide(),l()("#rpchnuserbanlist").hide(),l()("#rpchnhtitle").html(window.i18n.get("users")),l()(".rpchnhcount").attr("type","users"),l()("#rpchnconf").hide(),l()("#rpchnconficon").removeClass("tb"),l()("#rpchngrouplist").hide(),l()("#rpchnuserlist").hide(),l()("#hp__Channel__").hide(),l()("#channelInputArea").hide(),l()("#channelAdmChat").removeClass("ic_channel_chat_ON"),l()("#channelTaskList").removeClass("tb"),l()("#channelModList").removeClass("tb"),l()("#channelAdmGroup").removeClass("ic_group_ON"),l()("#channelAdmUserList").removeClass("tb"),l()("#channelCloudVideosIcon").removeClass("tb"),l()("#channelCsmVideosIcon").removeClass("tb"),l()("#channelFeedIcon").addClass("tb"),l()("#rpchncloudlist").hide(),l()("#rpchnfeedlist iframe").remove(),l()("#rpchnfeedlist").html(""),l()("#rpchnfeedlist").append(`<iframe src="${window.feed_spa}?auth_token=${window.auth_token}&room=${""===window._channel.getActiveRoom()?window._engine.currentChannel():window._groupEngine.currentChannel()}" allowfullscreen class="w100 h100"></iframe>`)}};l()("#channelModList").on("click",(function(){window.Events.dispatch("moderators/icon-click")}));const ca={"moderators/icon-click":function(){let e;window.activity.update(`[Channel] Moderators icon click: ${window._channel.getName()}`),window._channel.getModes().m&&l()("#channelMsgAlert").hide(),window._channel.getModes().U&&window._engine.requestUserList(),l()("#channelNoMoreMsg").hide(),l()("#channelMsgCounter").hide(),l()("#channelMsgAlert").hide(),l()("#rpchnmodlist").html(""),l()("#rpchnconf").hide(),l()("#rpchnconf").removeClass("tb"),l()("#rpchnmetaverselist").hide(),l()("#rpchntasklist").hide(),l()("#rpchncsmlist").hide(),l()("#rpchnfeedlist").hide(),l()("#rpchnmodlist").show(),l()("#rpchngrouplist").hide(),l()("#rpchngroupchat").hide(),l()("#rpchnuserlist").hide(),l()("#rpchnusermutelist").hide(),l()("#rpchnuserbanlist").hide(),l()("#hp__Channel__").hide(),l()("#channelInputArea").hide(),l()("#channelAdmChat").removeClass("ic_channel_chat_ON"),l()("#channelTaskList").removeClass("tb"),l()("#channelModList").addClass("tb"),l()("#channelAdmGroup").removeClass("ic_group_ON"),l()("#channelAdmUserList").removeClass("tb"),l()("#channelCloudVideosIcon").removeClass("tb"),l()("#channelCsmVideosIcon").removeClass("tb"),l()("#channelFeedIcon").removeClass("tb"),l()("#rpchncloudlist").hide(),window._channel.getModerators().concat(window._channel.getOperators()).forEach((function(t){t!==p.ENGINE_NICK&&0===l()(`#lpchm_${t}`).length&&(e=`<div id="lpchm_${t}" class="chnmod fr w100 pl10 pt10 pr10 pt" nick="${t}">`,e+=`<img src="${window.assets}/common/img/avatarPerson.png" class="cp lpci" onerror="loadDefaultAvatar(this);">`,e+=`<span id="lpchm_${t}_key" class="material-icons toj sl vat z9 nopt" style="margin-left:-15px;">&#xE0DA;</span>`,e+=`<div class="fc fic fig pl5"><div class="fr w100"><span class="sn n toj">${t}</span><span class="fig"></span>`,e+="</div><div>&nbsp;</div>",e+='<div class="li w100"></div></div>',l()("#rpchnmodlist").append(e))}))}};l()("#rpchnconficon").on("click",(function(){window.Events.dispatch("config/icon-click")}));const la={"config/icon-click":function(){l()("#rpchninvitecopy").removeClass("tb"),l()("#rpchnconf").is(":visible")?(l()("#rpchnconf").hide(),l()("#rpchnconficon").removeClass("tb")):(l()("#rpchnconf").show(),l()("#rpchnconficon").addClass("tb"),window.breakoutRoom&&window.Events.dispatch("breakout-rooms/menu-btn-show"))}};l()("#cc-select").on("click",(function(){window.Events.dispatch("cc/select-option-click")})),l()("#cc-activate").on("click",(function(){window.Events.dispatch("cc/activate-button-click")})),l()("#cc-deactivate").on("click",(function(){window.Events.dispatch("cc/deactivate-button-click")})),l()("#cc-cancel").on("click",(function(){window.Events.dispatch("cc/cancel-button-click")}));const da={"cc/select-option-click":function(){if(!window.navigatorData.browser.includes("chrome")&&!window.navigatorData.browser.includes("edg"))return l()("#control-more-area").hide(),l()("#control-display").css("background-color","#707070"),l()("#alert-closed-caption-chrome").is(":visible")||(l()("#alert-closed-caption-chrome").show(),setTimeout((function(){l()("#alert-closed-caption-chrome").hide()}),3e3)),!1;function e(){l()("#cc-language-capture").html(""),l()("#cc-language-translate").html("");const e=window.cc.supportedLangCodes,t=window.navigator.language;let n=window.cc.captureLanguage||"";""===n&&("pt"===t||"pt-BR"===t?n="pt-BR":"en"===t||"en-US"===t?n="en-US":e.includes(t)&&(n=t)),""!==n&&l()("#cc-language-capture").append(`<option value="${n}">${window.i18n.get(`lang-${n}`)}</option>`);const i=window.cc.transcribeLanguage||"";i&&l()("#cc-language-translate").append(`<option value="${i}">${window.i18n.get(`lang-${i}`)}</option>`),e.forEach((e=>{l()("#cc-language-capture").append(`<option value="${e}">${window.i18n.get(`lang-${e}`)}</option>`),l()("#cc-language-translate").append(`<option value="${e}">${window.i18n.get(`lang-${e}`)}</option>`)}))}return"realms"!==window.config.realm&&"staging"!==window.config.realm||(window.config.allowTranslate=!0),window._channel.getClosedCaption()?window.config.allowTranslate?(e(),l()("#cc-language-capture").attr("disabled","true"),l()("#cc-language-translate").attr("disabled","true"),l()("#cc-activate").hide(),l()("#cc-deactivate").show(),l()(".dialog").hide(),l()("#control-more-area").hide(),l()("#dbclosedcaption").show(),l()(".modal").show(),l()("#dialog").show()):(window._channel.setClosedCaption(!1),l()("#cc-status").html(window.i18n.get("closed-caption-deactivated")),window._channelCtrl.speechRecognitionStop(),l()("#media-cc").hide(),window.resizeMedia.update(),l()("#control-more-area").hide(),l()("#control-display").css("background-color","#707070")):window.config.allowTranslate?(e(),l()("#cc-language-capture").removeAttr("disabled"),l()("#cc-language-translate").removeAttr("disabled"),l()("#cc-activate").show(),l()("#cc-deactivate").hide(),l()(".dialog").hide(),l()("#control-more-area").hide(),l()("#dbclosedcaption").show(),l()(".modal").show(),l()("#dialog").show()):(window._channel.setClosedCaption(!0),l()("#cc-status").html(window.i18n.get("closed-caption-activated")),window._channelCtrl.speechRecognitionStart(),l()("#media-cc").show(),window.resizeMedia.update(),l()("#control-more-area").hide(),l()("#control-display").css("background-color","#707070")),!1},"cc/activate-button-click":function(){window._channel.setClosedCaption(!0),l()("#cc-status").html(window.i18n.get("closed-caption-activated")),window.cc.captureLanguage=l()("#cc-language-capture").val(),window.cc.transcribeLanguage=l()("#cc-language-translate").val(),window._channelCtrl.speechRecognitionStart(),l()("#media-cc").show(),window.resizeMedia.update(),l()("#control-more-area").hide(),l()("#control-display").css("background-color","#707070"),l()(".dialog").hide()},"cc/deactivate-button-click":function(){window._channel.setClosedCaption(!1),l()("#cc-status").html(window.i18n.get("closed-caption-deactivated")),window._channelCtrl.speechRecognitionStop(),l()("#media-cc").hide(),window.resizeMedia.update(),l()("#control-more-area").hide(),l()("#control-display").css("background-color","#707070"),l()(".dialog").hide()},"cc/cancel-button-click":function(){l()("#control-more-area").hide(),l()("#control-display").css("background-color","#707070"),l()(".dialog").hide()}};async function ua(e){const{type:t}=e;let n={},i=!1;if("open"===t){l()("#cinv-public-list-area").hide(),n=window.Invite.channelOpenInvites[0],l()("#cinv-public-edit").hide(),l()("#cinv-public-list-area").hide();const e="-g"===n.channel.substr(-2);i=await window.Invite.delete(n.token),i?.success&&e&&(window.Invite.data=void 0)}else"close"===t&&(l()("#cinv-private-list-area").hide(),n=window.Invite.channelCloseInvites[0],l()("#cinv-private-edit").hide(),l()("#cinv-private-list-area").hide(),i=await window.Invite.delete(n.token));return window.Events.dispatch("invite/icon-click"),i}function ha(e){const{type:t}=e;let n={};if("open"===t){l()("#cinv-public-list-area").hide(),n=window.Invite.channelOpenInvites[0];const e=parseInt(window.time.now()),t=new Date(e);t.setMonth(t.getMonth()+1),n.start_at||(n.start_at=e),n.end_at||(n.end_at=t.getTime()),l()("#cinv-public-edit").show(),l()("#cinv-public-from").attr("value",window.time.getFormDate(n.start_at)),l()("#cinv-public-to").attr("value",window.time.getFormDate(n.end_at)),l()("#cinv-public-edit-link").html(window.i18n.get("save"))}else if("close"===t){l()("#cinv-private-list-area").hide(),n=window.Invite.channelCloseInvites[0];const e=parseInt(window.time.now()),t=new Date(e);t.setMonth(t.getMonth()+1),n.start_at||(n.start_at=e),n.end_at||(n.end_at=t.getTime()),l()("#cinv-private-edit").show(),l()("#cinv-private-from").attr("value",window.time.getFormDate(n.start_at)),l()("#cinv-private-to").attr("value",window.time.getFormDate(n.end_at)),l()("#cinv-private-edit-link").html(window.i18n.get("save"))}return l()("#cinv-options-menu").hide(),!1}function pa(e){const{target:t,type:n}=e;if(l()("#cinv-options-menu").attr("type",n),l()("#cinv-options-menu").is(":visible")?l()("#cinv-options-menu").hide():l()("#cinv-options-menu").show(),p.PERMISSIONS.invite_invite_delete){let e;"open"===n?e=window.Invite.channelOpenInvites[0]:"close"===n&&(e=window.Invite.channelCloseInvites[0]),e.host===p.NICK||p.PERMISSIONS.invite_invite_delete_others?l()("#cinv-option-delete").show():l()("#cinv-option-delete").hide()}else l()("#cinv-option-delete").hide();if(p.PERMISSIONS.invite_invite_edit){let e;"open"===n?e=window.Invite.channelOpenInvites[0]:"close"===n&&(e=window.Invite.channelCloseInvites[0]),e.host===p.NICK||p.PERMISSIONS.invite_invite_edit_others?l()("#cinv-option-edit").show():l()("#cinv-option-edit").hide()}else l()("#cinv-option-edit").hide();return l()("#cinv-options-menu").offset({top:t.offset().top+20,left:t.offset().left-l()("#cinv-options-menu").width()-10}),!1}l()("#channel_invite_icon").on("click",(()=>{window.Events.dispatch("invite/icon-click")})),l()("#rpchninvite").on("click",(()=>{window.Events.dispatch("invite/icon-click")})),l()("#dbcinv_confirm").on("click",(function(){window.Events.dispatch("invite/channel-confirm-button-click")})),l()("#cinv-private-add").on("click",(function(){window.Events.dispatch("invite/channel-private-add-button-click")})),l()("#cinv-private-edit-link").on("click",(function(){window.Events.dispatch("invite/channel-private-create-link-click")})),l()("#cinv-private-link-copy").on("click",(function(){window.Events.dispatch("invite/channel-private-link-copy-click")})),l()("#cinv-option-delete").on("click",(function(){const e={};e.type=l()("#cinv-options-menu").attr("type"),"close"===e.type&&window.Events.dispatch("invite/channel-private-option-delete-click",e)})),l()("#cinv-option-edit").on("click",(function(){const e={};e.type=l()("#cinv-options-menu").attr("type"),"close"===e.type&&window.Events.dispatch("invite/channel-private-option-edit-click",e)})),l()("#cinv-private-options").on("click",(function(){const e={};e.target=l()(this),e.type="close",window.Events.dispatch("invite/channel-private-options-icon-click",e)})),l()("#cinv-public-add").on("click",(function(){window.Events.dispatch("invite/channel-public-add-button-click")})),l()("#cinv-public-edit-link").on("click",(function(){window.Events.dispatch("invite/channel-public-create-link-click")})),l()("#cinv-public-edit-cancel").on("click",(function(){window.Events.dispatch("invite/channel-public-edit-cancel-click")})),l()("#cinv-public-link-copy").on("click",(function(){window.Events.dispatch("invite/channel-public-link-copy-click")})),l()("#cinv-option-copy").on("click",(function(){const e=l()("#cinv-options-menu").attr("type");"open"===e?window.Events.dispatch("invite/channel-public-link-copy-click"):"close"===e&&window.Events.dispatch("invite/channel-private-link-copy-click")})),l()("#cinv-option-delete").on("click",(function(){const e={};e.type=l()("#cinv-options-menu").attr("type"),"open"===e.type&&window.Events.dispatch("invite/channel-public-option-delete-click",e)})),l()("#cinv-option-edit").on("click",(function(){const e={};e.type=l()("#cinv-options-menu").attr("type"),"open"===e.type&&window.Events.dispatch("invite/channel-public-option-edit-click",e)})),l()("#cinv-public-options").on("click",(function(){const e={};e.target=l()(this),e.type="open",window.Events.dispatch("invite/channel-public-options-icon-click",e)})),l()("#cinv-public-from").on("change",(function(){const e={};e.value=l()(this)[0].value,window.Events.dispatch("invite/channel-public-since-change-value",e)})),l()("#cinv-public-to").on("change",(function(){const e={};e.value=l()(this)[0].value,window.Events.dispatch("invite/channel-public-to-change-value",e)})),l()("#dbninv_token_copy").on("click",(function(){window.Events.dispatch("invite/ephemeral-link-copy-icon-click")})),l()("#dbninv_confirm").on("click",(function(){window.Events.dispatch("invite/ephemeral-confirm-button-click")}));const ma={"invite/icon-click":async function(){l()("#rpchnconf").is(":visible")&&window.Events.dispatch("config/icon-click"),l()(".dialog").hide();const e=window._channel.getName();if("-g"===e.substr(-2)){if(!window.Invite.data)return l()("#rpchninvite").hide(),window.Events.dispatch("invite/ephemeral-confirm-button-click"),!1;window.Invite.data.channel===e?window.Invite.channelInvites=[window.Invite.data]:window.Invite.channelInvites=[],l()("#cinv-private-area").hide()}else l()("#cinv-private-area").show(),window.Invite.channelInvites=await window.Invite.getChannelInvites(e)||[];if(l()("#cinv-public-list-area").hide(),l()("#cinv-public-add").hide(),l()("#cinv-public-edit").hide(),l()("#cinv-private-list-area").hide(),l()("#cinv-private-add").hide(),l()("#cinv-private-edit").hide(),l()("#dbcinv_alert").hide(),l()("#cinv-options-menu").hide(),window.Invite.channelOpenInvites.length>0){const e=window.Invite.channelOpenInvites[0];l()("#cinv-public-link-value").html(e.link),l()("#cinv-public-list-area").show(),l()("#cinv-public-add").hide()}else l()("#cinv-public-add").show();if(window.Invite.channelCloseInvites.length>0){const e=window.Invite.channelCloseInvites[0];l()("#cinv-private-link-value").html(e.link),l()("#cinv-private-list-area").show(),l()("#cinv-private-add").hide()}else l()("#cinv-private-add").show();return l()("#dbcinv").show(),l()(".modal").show(),l()("#dialog").show(),!1},"invite/channel-confirm-button-click":function(){return l()("#dbcinv_alert").removeClass("tr"),l()("#dbcinv_alert").html(""),l()(".dialog").hide(),l()("#dbcinv").hide(),l()(".modal").hide(),!1},"invite/channel-private-add-button-click":function(){const e=window.time.now(),t=window.time.getFormDate(e),n=new Date(e);n.setMonth(n.getMonth()+1);const i=window.time.getFormDate(n);return l()("#cinv-private-from").attr("value",t),l()("#cinv-private-from").val(t),l()("#cinv-private-to").attr("value",i),l()("#cinv-private-to").val(i),l()("#cinv-private-add").hide(),l()("#cinv-private-edit-link").html(window.i18n.get("invite-create")),l()("#cinv-private-edit").show(),!1},"invite/channel-private-create-link-click":async function(){const e={type:"close",start_at:new Date(l()("#cinv-private-from").val()).getTime(),end_at:new Date(l()("#cinv-private-to").val()).getTime(),channel:window._channel.getName(),ephemeral:!1};let t;return window.Invite.channelCloseInvites.length>0?(e.token=window.Invite.channelCloseInvites[0].token,t=await window.Invite.update(e)):t=await window.Invite.create(e),window.Events.dispatch("invite/icon-click"),t},"invite/channel-private-option-delete-click":async function(e){let t=!1;if(p.PERMISSIONS)if(p.PERMISSIONS.invite_invite_delete){const e={};e.type=l()("#cinv-options-menu").attr("type"),"close"===e.type&&(t=await ua(e))}else console.log("[Invite] Option delete: not allowed! Check permissions!");return t},"invite/channel-private-option-edit-click":function(e){return ha(e),!1},"invite/channel-private-options-icon-click":function(e){return pa(e),!1},"invite/channel-private-link-copy-click":function(){const e=window.Invite.channelCloseInvites[0].link;return navigator.clipboard.writeText(e).then((function(){l()("#dbcinv_alert").removeClass("tr"),l()("#dbcinv_alert").html(window.i18n.get("invite-share-link-copied")),l()("#dbcinv_alert").show()}),(function(){l()("#dbcinv_alert").addClass("tr"),l()("#dbcinv_alert").html(window.i18n.get("invite-share-link-copy-error")),l()("#dbcinv_alert").show()})),l()("#cinv-options-menu").hide(),!1},"invite/channel-public-add-button-click":function(){const e=window.time.now(),t=window.time.getFormDate(e),n=new Date(e);n.setMonth(n.getMonth()+1);const i=window.time.getFormDate(n);return l()("#cinv-public-from").attr("value",t),l()("#cinv-public-from").val(t),l()("#cinv-public-to").attr("value",i),l()("#cinv-public-to").val(i),l()("#cinv-public-add").hide(),l()("#cinv-public-edit-link").html(window.i18n.get("invite-create")),l()("#cinv-public-edit").show(),!1},"invite/channel-public-create-link-click":async function(){const e={type:"open",start_at:new Date(l()("#cinv-public-from").val()).getTime(),end_at:new Date(l()("#cinv-public-to").val()).getTime(),channel:window._channel.getName(),ephemeral:!1};let t;return window.Invite.channelOpenInvites.length>0?(e.token=window.Invite.channelOpenInvites[0].token,t=await window.Invite.update(e)):t=await window.Invite.create(e),window.Events.dispatch("invite/icon-click"),t},"invite/channel-public-edit-cancel-click":function(){return window.Events.dispatch("invite/icon-click"),!1},"invite/channel-public-link-copy-click":function(){const e=window.Invite.channelOpenInvites[0].link;return navigator.clipboard.writeText(e).then((function(){l()("#dbcinv_alert").removeClass("tr"),l()("#dbcinv_alert").html(window.i18n.get("invite-share-link-copied")),l()("#dbcinv_alert").show()}),(function(){l()("#dbcinv_alert").addClass("tr"),l()("#dbcinv_alert").html(window.i18n.get("invite-share-link-copy-error")),l()("#dbcinv_alert").show()})),l()("#cinv-options-menu").hide(),!1},"invite/channel-public-option-delete-click":async function(e){let t=!1;if(p.PERMISSIONS)if(p.PERMISSIONS.invite_invite_delete){const e={};e.type=l()("#cinv-options-menu").attr("type"),"open"===e.type&&(t=await ua(e))}else console.log("[Invite] Option delete: not allowed! Check permissions!");return t},"invite/channel-public-option-edit-click":function(e){return ha(e),!1},"invite/channel-public-options-icon-click":function(e){return pa(e),!1},"invite/channel-public-since-change-value":function(e){const{value:t}=e,n=window.time.now(),i=new Date(t).getTime();if(i<=n){const e=window.time.getFormDate(n);l()("#cinv-public-from").val(e)}else l()("#cinv-public-from").attr("value",window.time.getFormDate(i));return!1},"invite/channel-public-to-change-value":function(e){const{value:t}=e,n=new Date(l()("#cinv-public-from").val()).getTime(),i=new Date(t).getTime();if(i<n){const e=window.time.getFormDate(n+864e5);l()("#cinv-public-to").val(e),l()("#cinv-public-to").attr("value",window.time.getFormDate(e))}else l()("#cinv-public-to").attr("value",window.time.getFormDate(i));return!1},"invite/ephemeral-show-share-link-dialog":function(){const e=window.Invite.data.link;l()("#dbninv_token").html(e),l()(".dialog").hide(),l()("#dbninv").show(),l()(".modal").show(),l()("#dialog").show()},"invite/ephemeral-link-copy-icon-click":function(){l()("#dbninv_alert").removeClass("tr"),l()("#dbninv_alert").html("");const e=window.Invite.data.link;l()(this).addClass("tb"),navigator.clipboard.writeText(e).then((function(){l()("#dbninv_alert").removeClass("tr"),l()("#dbninv_alert").html(window.i18n.get("invite-share-link-copied"))}),(function(){l()("#dbninv_alert").addClass("tr"),l()("#dbninv_alert").html(window.i18n.get("invite-share-link-copy-error"))}))},"invite/ephemeral-confirm-button-click":function(){l()("#dbninv_alert").removeClass("tr"),l()("#dbninv_alert").html(""),l()(".dialog").hide(),l()("#dbninv").hide(),l()(".modal").hide()}};l()("#app").on("click",".rpmat",(function(){const e={};e.privChat=l()(this).attr("privChat"),window.Events.dispatch("message/attach-icon-click",e)})),l()("#app").on("click",".rpmaiiv",(function(e){e.stopPropagation();const t={};t.target=l()(this).parent().attr("t"),t.group=l()(this).parent().attr("group"),window.Events.dispatch("message/attach-image-video-option-click",t)})),l()("#app").on("click",".rpmaid",(function(e){e.stopPropagation();const t={};t.target=l()(this).parent().attr("t"),t.group=l()(this).parent().attr("group"),window.Events.dispatch("message/attach-document-option-click",t)})),l()("#app").on("click",".rpmaia",(function(e){e.stopPropagation();const t={};t.target=l()(this).parent().attr("t"),t.group=l()(this).parent().attr("group"),window.Events.dispatch("message/attach-audio-option-click",t)}));const wa={"message/attach-icon-click":function(e){const t=e.privChat;"privChat"===t?l()("#chnprivchatsarea .rpmap").toggle():"channel"===t?l()("#channel_rp .rpmap").toggle():l()(".rpmap").toggle(),l()(".rpme").removeClass("toj"),l()("#rpEmoticon").hide(),l()("#channelEmoticon").hide()},"message/attach-image-video-option-click":function(e){const{target:t,group:n}=e;l()("#filesend").attr("m","imagevideo"),l()("#filesend").attr("accept","image/*,video/*"),l()("#filesend").attr("t",t),l()("#filesend").attr("group",n),l()("#filesend").click()},"message/attach-document-option-click":function(e){const{target:t,group:n}=e;l()("#filesend").attr("m","document"),l()("#filesend").attr("accept",".pdf"),l()("#filesend").attr("t",t),l()("#filesend").attr("group",n),l()("#filesend").click()},"message/attach-audio-option-click":function(e){const{target:t,group:n}=e;l()("#filesend").attr("m","audio"),l()("#filesend").attr("accept","audio/*"),l()("#filesend").attr("t",t),l()("#filesend").attr("group",n),l()("#filesend").click()}};l()("#app").on("click",".og_close",(function(){const e=l()(this).attr("t").replace(/#/g,"__hash__");window.Events.dispatch("opengraph/close-icon-click",e)}));const ga={"opengraph/close-icon-click":function(e){const t=e;l()(`#og_${t}`).attr("display","hidden"),l()(`#og_${t}`).hide(),l()(`#og_${t}`).attr("og_href",""),l()(`#og_${t}`).attr("og_image",""),l()(`#og_${t} .og_Name`).html(""),l()(`#og_${t} .og_Image`).html(""),l()(`#og_${t} .og_Title`).html(""),l()(`#og_${t} .og_Description`).html("")}},fa={"modes/set-operator":async function(e){const{channel:t,user:n}=e,i=await window._channel.isMetaverseFixed(t);return n===p.ENGINE_NICK&&"0"!==i&&(l()(".channelAdmUserList").show(),l()("#channel_rp").show(),l()("#channel_mp").show(),l()("#channel_lp").css("width","70%"),l()("#channelChatHide").show(),l()("#channelAdmUserList").click()),!1}};l()("#medias-view-config-btn").on("click",(function(){const e={};e.displayType=window._medias.displayType,window.Events.dispatch("medias/display-config-btn-icon-click",e)})),l()("#medias-view-option-grid").on("click",(function(){window.Events.dispatch("medias/display-config-option-grid-click")})),l()("#medias-view-option-bottom").on("click",(function(){window.Events.dispatch("medias/display-config-option-bottom-click")})),l()("#medias-view-option-left").on("click",(function(){window.Events.dispatch("medias/display-config-option-left-click")}));const va={"medias/display-config-btn-icon-click":function(e){return window.Events.dispatch("medias/display-config-options-show",e),!1},"medias/display-config-options-icon-hide":function(){return l()("#medias-view-options").is(":visible")&&window.Events.dispatch("medias/display-config-options-hide"),l()("#medias-view-config-btn").is(":visible")&&l()("#medias-view-config-btn").hide(),!1},"medias/display-config-options-icon-show":function(){const e=window._medias.displayType;return l()(".medias-view-config-icon").hide(),l()(".medias-view-selected").html(""),"grid"===e?(l()("#medias-view-config-grid").show(),l()("#medias-view-left-grid").html("check")):"bottom"===e?(l()("#medias-view-config-bottom").show(),l()("#medias-view-left-bottom").html("check")):"left"===e&&(l()("#medias-view-config-left").show(),l()("#medias-view-left-left").html("check")),l()("#medias-view-config-btn").show(),!1},"medias/display-config-options-show":function(e){const t=e.displayType;return l()("#medias-view-options").is(":visible")?(window.Events.dispatch("medias/display-config-options-hide"),!1):(l()(".medias-view-selected").html(""),"grid"===t?l()("#medias-view-grid-selected").html("check"):"bottom"===t?l()("#medias-view-bottom-selected").html("check"):"left"===t&&l()("#medias-view-left-selected").html("check"),l()("#medias-view-options").show(),!1)},"medias/display-config-options-hide":function(){return l()("#medias-view-options").hide(),!1},"medias/display-config-option-grid-click":function(){return window._medias.displayType="grid",window.Events.dispatch("medias/display-config-options-icon-show"),window.Events.dispatch("medias/display-config-options-hide"),window._medias.unmuteAllVideoStreams(),window._medias.clearNewMedias(),window._windowCtrl.redrawWindows(),!1},"medias/display-config-option-bottom-click":function(){return window._medias.clearNewMedias(),window._medias.displayType="bottom",window.Events.dispatch("medias/display-config-options-icon-show"),window.Events.dispatch("medias/display-config-options-hide"),window._medias.updateVisibility(),window._medias.updateControlButtons(),window._medias.redrawWindows(),!1},"medias/display-config-option-left-click":function(){return window._medias.clearNewMedias(),window._medias.displayType="left",window.Events.dispatch("medias/display-config-options-icon-show"),window.Events.dispatch("medias/display-config-options-hide"),window._medias.updateVisibility(),window._medias.updateControlButtons(),window._medias.redrawWindows(),!1}};l()("#channelArea").on("click",".rpchn-breakout-rooms",(function(){window.Events.dispatch("breakout-rooms/icon-click")})),l()("#channelArea").on("click","#breakout-room-create-dialog-close",(function(){window.Events.dispatch("breakout-rooms/create-channels-dialog-hide")})),l()("#channelArea").on("click","#breakout-room-create-continue-btn",(function(){window.Events.dispatch("breakout-rooms/create-channels-dialog-continue-btn-click")})),l()("#channelArea").on("click","#breakout-room-cancel-btn",(function(){window.Events.dispatch("breakout-rooms/create-config-dialog-hide")})),l()("#channelArea").on("click","#breakout-room-config-dialog-close",(function(){window.Events.dispatch("breakout-rooms/create-config-dialog-hide")})),l()("#channelArea").on("click","#breakout-room-close-dialog-btn",(function(){window.Events.dispatch("breakout-rooms/create-config-dialog-hide")})),l()("#channelArea").on("click","#breakout-config-options-btn",(function(){window.Events.dispatch("breakout-rooms/create-config-option-btn-click")})),l()("#channelArea").on("click",".bkr_expand",(function(){const e=l()(this).attr("room");window.Events.dispatch("breakout-rooms/expand-channel-btn-click",e)})),l()("#channelArea").on("click",".bkr_more",(function(){const e=l()(this).attr("room"),t=l()(`#bkr_room_${e} .bkr_more`);window.Events.dispatch("breakout-rooms/config-more-btn-click",{room:e,moreElement:t})})),l()("#channelArea").on("click",".bkr_config_remove",(function(){const e=l()(this).attr("room");window.Events.dispatch("breakout-rooms/create-config-more-dialog-hide"),window.Events.dispatch("breakout-rooms/config-remove-click",e)})),l()("#channelArea").on("click",".bkr_config_rename",(function(){const e=l()(this).attr("room");window.Events.dispatch("breakout-rooms/create-config-more-dialog-hide"),window.Events.dispatch("breakout-rooms/config-rename-click",e)})),l()("#channelArea").on("click",".bkr_room_rename_ok_btn",(function(){const e=l()(this).attr("room");window.Events.dispatch("breakout-rooms/config-rename-ok-click",e)})),l()("#channelArea").on("keydown",".bkr_room_name_field",(function(e){const t=l()(this).attr("room");"Enter"===e.key&&window.Events.dispatch("breakout-rooms/config-rename-ok-click",t)})),l()("#channelArea").on("click",".bkr_room_label",(function(){const e=l()(this).attr("room");l()(`#bkr_room${e}_name_field`).is(":visible")||window.Events.dispatch("breakout-rooms/config-room-label-click",e)})),l()("#channelArea").on("click","#bkr-main-return-ckb",(function(){const e=l()(this);window.Events.dispatch("breakout-rooms/config-main-return-ckb-click",e)})),l()("#channelArea").on("click","#bkr-change-room-ckb",(function(){const e=l()(this);window.Events.dispatch("breakout-rooms/config-any-time-room-change-ckb-click",e)})),l()("#channelArea").on("click",".bkr_add_users",(function(){const e=l()(this).attr("room");window.Events.dispatch("breakout-rooms/config-add-users-btn-click",e)})),l()("#channelArea").on("click",".bkr_user_select",(function(){const e=l()(this).attr("room"),t=l()(this).attr("name"),n=l()(this).attr("fullname");window.Events.dispatch("breakout-rooms/config-user-select-click",{room:e,name:t,fullname:n})})),l()("#channelArea").on("click","#breakout-room-config-create-btn",(function(){window.Events.dispatch("breakout-rooms/config-create-btn-click")})),l()("#breakoutroom-options-btn").on("click",(function(){window.Events.dispatch("breakout-rooms/options-btn-click")})),l()("#channelArea").on("click",".bkr-room-go",(function(){const e=l()(this).attr("room");window.Events.dispatch("breakout-rooms/room-change-click",e)})),l()("#channelArea").on("click","#breakout-room-close-btn",(function(){window.Events.dispatch("breakout-rooms/close-btn-click")})),l()("#channelArea").on("click",".bkr_room_move",(function(){const e=l()(this).attr("room"),t=l()(this).attr("name");window.Events.dispatch("breakout-rooms/user-move-dialog-show",{room:e,name:t})})),l()("#channelArea").on("change","#move-to-room",(async function(){const e=l()(this).val(),t=l()(this).attr("name");l()(this).parent().html(""),await window.breakoutRoom.sendPrivateMessage({action:"move",value:e},t),await window.Events.dispatch("breakout-rooms/create-config-dialog-show")})),l()("#channelArea").on("click","#bkr-refresh-btn",(function(){window.bkrRefresh||(window.Events.dispatch("breakout-rooms/refresh-rooms-btn-click"),window.bkrRefresh=!0,setTimeout((function(){window.bkrRefresh=!1}),5e3))}));const ba={"breakout-rooms/icon-click":function(){const e=l()("#breakoutroom-options-area");e.is(":visible")?e.hide():window.Events.dispatch("config/icon-click"),window.breakoutRoom.xMode?(window.Events.dispatch("breakout-rooms/create-channels-dialog-hide"),window.Events.dispatch("breakout-rooms/create-config-dialog-show")):window.Events.dispatch("breakout-rooms/create-channels-dialog-show")},"breakout-rooms/create-channels-dialog-show":function(){const e=l()("#channelArea"),t=window.i18n.get("breakout-rooms-create"),n=window.i18n.get("breakout-rooms-quantity"),i=window.i18n.get("breakout-rooms-max-allowed"),s=p.CONFIG.breakoutRoomsMax||20;if(0===e.find("#breakout-room-area").length){let o='<div id="breakout-room-area" class="fcm w100 h100" style="position:absolute;z-index:99;background-color:rgba(0,0,0,0.5);">';o+='<div class="fc fic p10" style="width:700px;height:300px;background-color:#fff;border-radius:10px;">',o+='<div class="fr" style="width:100%;">',o+='<div class="sxxl p10 material-icons-round" style="color:#555;width:48px;height:48px;">grid_view</div>',o+=`<div class="fig sxl" style="margin-top:auto;margin-bottom:auto;">${t}</div>`,o+='<div id="breakout-room-create-dialog-close" class="sxl pt pr10" style="margin-top:auto;margin-bottom:auto;">X</div>',o+="</div>",o+='<div class="fic w100" style="border-bottom: 1px solid #AAA;"></div>',o+='<div class="fic fig fc" style="width:100%;">',o+=`<div class="fc w100 h100 p10"><div class="sl fic" style="margin-top:40px;">${n}<input id="breakout-room-quantity" type="text" class="sxl" style="border: 1px solid #CCC;width:40px;border-radius:5px;text-align:center;padding:5px;"/></div>`,o+=`<div id="breakout-room-create-continue-btn" class="sl fic p5 pt" style="width:250px;background-color:#153267;border-radius:5px;color:#fff;text-align:center;margin-top:40px;"">${window.i18n.get("breakout-rooms-create")}</div></div>`,o+="</div>",o+=`<div class="fic">${i} ${s}</div>`,o+="</div></div>",e.append(o),e.find("#breakout-room-quantity").focus()}},"breakout-rooms/create-channels-dialog-hide":function(){window.Events.dispatch("breakout-rooms/create-users-dialog-hide"),window.Events.dispatch("breakout-rooms/create-config-dialog-hide"),window.Events.dispatch("breakout-rooms/create-config-more-dialog-hide");const e=l()("#channelArea").find("#breakout-room-area");0!==e.length&&e.remove()},"breakout-rooms/create-channels-dialog-continue-btn-click":async function(){const e=l()("#breakout-room-quantity"),t=parseInt(e.val());if(e.val(""),Number.isNaN(t))return e.focus(),!1;const n=p.CONFIG.breakoutRoomsMax||20;if(t>n||t<1)return e.focus(),!1;window.breakoutRoom.reset();const i=p.ROOM[window._engine.currentChannel()];let s=!1;i&&(s=i.enable_nesting);const o=window._engine.currentChannel();return s?(window.breakoutRoom.main=o,await window.breakoutRoom.requestClose("",(e=>{E(`[BreakoutRoom] createChannelDialogContinueBtnClick closed rooms: ${JSON.stringify(e)}`),window.breakoutRoom.unsetXMode(),window.Events.dispatch("breakout-rooms/create-channels-dialog-hide"),window.breakoutRoom.requestCreate(t,(e=>{window.Events.dispatch("breakout-rooms/create-config-dialog-show",e)}))})),!0):(console.log(`[BreakoutRoom] createChannelsDialogContinueBtnClick: can not create breakout rooms on channel ${o}`),!1)},"breakout-rooms/create-config-dialog-show":async function(e){const t=e;E(`[BreakoutRoom] createConfigDialogShow: ${JSON.stringify(t)}`);const n=l()("#channelArea"),i=window.i18n.get("breakout-rooms"),s=window.i18n.get("options");let o;t?(o=await window.breakoutRoom.createRooms(t),window.breakoutRoom.setXMode()):o=window.breakoutRoom.rooms;const r=window.breakoutRoom.xMode;function a(e){n.find("#breakout-room-area").remove();let t='<div id="breakout-room-area" class="fcm w100 h100" style="position:absolute;z-index:99;background-color:rgba(0,0,0,0.5);">';t+='<div class="fc fic p10" style="width:700px;height:600px;background-color:#fff;border-radius:10px;">',t+='<div class="fr" style="width:100%;">',t+='<div class="sxxl p10 material-icons-round" style="color:#555;width:48px;height:48px;">grid_view</div>',t+=`<div class="fig sxl" style="margin-top:auto;margin-bottom:auto;">${i}</div>`,t+='<div id="breakout-room-config-dialog-close" class="sxl pt pr10" style="margin-top:auto;margin-bottom:auto;">X</div>',t+="</div>",t+='<div class="fic w100" style="border-bottom: 1px solid #AAA;"></div>',t+='<div class="fr w100 p10 sl fic" style="margin-right:20px;justify-content:flex-end;position:relative;">',t+='<div id="bkr-refresh-btn" class="fic toj sl material-icons pr10">refresh</div>',t+=`<div id="breakout-config-options-btn" style="display:flex;position:relative;"><div class="breakout-config-options-btn toj pr5 pt material-icons">expand_more</div><div class="breakout-config-options-btn toj pt">${s}</div></div>`,t+='<div id="breakout-config-options-area" class="fc bor sha p10 ss" style="position:absolute;left:10px;top:40px;width:680px;background-color:#fff;display:none;">',window.breakoutRoom.allow_return?t+='<div><input type="checkbox" id="bkr-main-return-ckb" checked /> Permite que os participantes retornem Ã  sala principal a qualquer momento</div>':t+='<div><input type="checkbox" id="bkr-main-return-ckb" /> Permite que os participantes retornem Ã  sala principal a qualquer momento</div>',window.breakoutRoom.allow_change?t+='<div><input type="checkbox" id="bkr-change-room-ckb" checked /> Permite que os participantes mudem de sala simultÃ¢nea a qualquer momento</div>':t+='<div><input type="checkbox" id="bkr-change-room-ckb" /> Permite que os participantes mudem de sala simultÃ¢nea a qualquer momento</div>',t+="</div>",t+="</div>",t+='<div class="bkr_rooms_area fic fig fc bor br p5" style="width:100%;overflow:auto;">';for(let e=0;e<o.length;e+=1){t+=`<div id="bkr_room_${o[e].c}" class="bkr_room fc w100 pt5 pb5 pl10 pr10 bor br" room="${o[e].c}" style="border: 1px solid #AAA;margin-top:5px;">`,t+='<div class="fr w100">',t+=`<div class="bkr_expand toj pr5 pt material-icons" room="${o[e].c}">expand_more</div>`,t+=`<div id="bkr_room${o[e].c}_name" class="bkr_room_label sl fic toj pt" room="${o[e].c}">${o[e].n}</div>`,t+='<div class="fig"></div>',t+=`<div id="bkr_add_users_${o[e].c}" class="bkr_add_users sn fic pt toj pr10" room="${o[e].c}">${window.i18n.get("add")}</div>`,t+=`<div class="bkr_more material-icons"room="${o[e].c}">more_vert</div>`,t+="</div>",t+='<div class="bkr_expand_area">';const n=o[e].u;if(n)for(let i=0;i<n.length;i+=1){const s=n[i],r=s.nick,a=s.name;t+=`<div class="fr"><div class="bkr_room_remove bkr_room_move pt pr10" name="${r}" room="${o[e].c}" style="position:relative;">${a}</div><div id="move-${r}" room="${o[e].c}"></div></div>`}t+="</div>",t+="</div>"}t+="</div>",t+='<div class="fr fic p10" style="margin-top:10px;">',r?(t+=`<div id="breakout-room-close-btn" class="sl fic p5 pt" style="width:350px;background-color:#153267;border-radius:5px;color:#fff;text-align:center;">${window.i18n.get("breakout-rooms-finish")}</div>`,t+=`<div id="breakout-room-close-dialog-btn" class="sl bor br fic p5 pt bgw toj" style="width:130px;margin-left:30px;border-radius:5px;text-align:center;">${window.i18n.get("close")}</div>`):(t+=`<div id="breakout-room-cancel-btn" class="sl fic p5 pt toj br" style="width:200px;border: 1px solid #325794;background-color:#fff;border-radius:5px;text-align:center;margin-right:10px;">${window.i18n.get("cancel")}</div>`,t+=`<div id="breakout-room-config-create-btn" class="sl fic p5 pt" style="width:200px;background-color:#153267;border-radius:5px;color:#fff;text-align:center;">${window.i18n.get("create-rooms")}</div>`),t+="</div>",t+="</div></div>",n.append(t),l()(".bkr_rooms_area").on("scroll",(function(){window.Events.dispatch("breakout-rooms/create-config-more-dialog-hide"),window.Events.dispatch("breakout-rooms/create-users-dialog-hide")}))}return window.Events.dispatch("breakout-rooms/create-config-more-dialog-hide"),window.breakoutRoomUsers||(window.breakoutRoomUsers=[]),0!==window.breakoutRoomUsers.length?a(window.breakoutRoomUsers):window.breakoutRoom.getUsers((e=>a())),!1},"breakout-rooms/create-config-dialog-hide":function(){window.Events.dispatch("breakout-rooms/create-users-dialog-hide"),window.Events.dispatch("breakout-rooms/create-config-more-dialog-hide");const e=l()("#channelArea").find("#breakout-room-area");0!==e.length&&e.remove()},"breakout-rooms/create-config-option-btn-click":function(){const e=l()("#breakout-config-options-area");return e.is(":visible")?e.hide():e.show(),!0},"breakout-rooms/expand-channel-btn-click":function(e){const t=e,n=l()(`#bkr_room_${t} > .bkr_expand_area`);return n.is(":visible")?n.hide():n.show(),!0},"breakout-rooms/create-config-more-dialog-show":async function(e){const{room:t,moreElement:n}=e,i=n[0].getBoundingClientRect(),s=l()("#channelArea");return l()("#bkr_config_more_dialog").attr("room")===t?(window.Events.dispatch("breakout-rooms/create-config-more-dialog-hide"),!1):(window.Events.dispatch("breakout-rooms/create-config-more-dialog-hide"),window.breakoutRoom.rooms.length>1?s.append(`<div id="bkr_config_more_dialog" class="fc bgw p5 bor br" style="width:130px;position:absolute;left:${i.left-125}px;top:${i.top+10}px;z-index:999;" room="${t}"><div class="bkr_config_rename p5 pt" room="${t}">Renomear</div><div class="bkr_config_remove p5 pt" room="${t}">Excluir Sala</div></div>`):s.append(`<div id="bkr_config_more_dialog" class="fc bgw p5 bor br" style="width:130px;position:absolute;left:${i.left-125}px;top:${i.top+10}px;z-index:999;" room="${t}"><div class="bkr_config_rename p5 pt" room="${t}">Renomear</div></div>`),!1)},"breakout-rooms/create-config-more-dialog-hide":async function(){const e=l()("#bkr_config_more_dialog");return e&&e.remove(),!1},"breakout-rooms/config-more-btn-click":function(e){const{room:t,moreElement:n}=e;return window.Events.dispatch("breakout-rooms/create-config-more-dialog-show",{room:t,moreElement:n}),!0},"breakout-rooms/config-remove-click":async function(e){const t=e;if(l()(`#bkr_room_${t}`).remove(),window.breakoutRoom.xMode){const e=window.breakoutRoom.rooms;for(let n=0;n<e.length;n+=1){const i=e[n].c;t===i&&(E(`[BreakoutRoom] configRemoveClick: room "${i}" closed!`),window.breakoutRoom.requestClose(i))}}const n=await window.breakoutRoom.removeRoom(t);return window.breakoutRoom.setXMode(),n},"breakout-rooms/config-rename-click":async function(e){const t=e,n=await window.breakoutRoom.getRoomName(t);return E(`[BreakoutRoom] configRenameClick: room "${t}" roomName "${n}"!`),l()(`#bkr_room${t}_name`).html(`<input id="bkr_room${t}_name_field" type="text" class="bkr_room_name_field sl p5 bor br" style="width:300px;" value="${n}" room="${t}" /><span class="bkr_room_rename_ok_btn sxs bgdg tw p5 bor br pt" style="margin-left:10px;" room="${t}">OK</span>`),!0},"breakout-rooms/config-rename-ok-click":async function(e){const t=e;let n=l()(`#bkr_room${t}_name_field`).val().trim();n.length>80&&(n=n.substring(0,80));const i=await window.breakoutRoom.changeRoomName(t,n),s=l()(`#bkr_room${t}_name`),o=await window.breakoutRoom.getRoomName(t);return i?(window.breakoutRoom.xMode&&window.breakoutRoom.setXMode(),s.html(`${o}`),!0):(l()(`#bkr_room${t}_name_field`).val(`${o}`),!1)},"breakout-rooms/config-room-label-click":async function(e){const t=e;return window.Events.dispatch("breakout-rooms/create-config-more-dialog-hide"),window.Events.dispatch("breakout-rooms/config-rename-click",t),!0},"breakout-rooms/config-main-return-ckb-click":function(e){const t=e.is(":checked");return window.breakoutRoom.allow_return=t,window.breakoutRoom.xMode&&window.breakoutRoom.setXMode(),!0},"breakout-rooms/config-any-time-room-change-ckb-click":function(e){const t=e.is(":checked");return window.breakoutRoom.allow_change=t,window.breakoutRoom.xMode&&window.breakoutRoom.setXMode(),!0},"breakout-rooms/config-add-users-btn-click":async function(e){const t=e,n={room:t,addUsersElement:l()(`#bkr_add_users_${t}`)};window.Events.dispatch("breakout-rooms/create-users-dialog-show",n)},"breakout-rooms/create-users-dialog-hide":async function(){const e=l()("#bkr_config_users_dialog");return e&&e.remove(),!1},"breakout-rooms/create-users-dialog-show":async function(e){const{room:t,addUsersElement:n}=e,i=n[0].getBoundingClientRect(),s=l()("#channelArea");if(l()("#bkr_config_users_dialog").attr("room")===t&&l()("#bkr_config_users_dialog").is(":visible"))return window.Events.dispatch("breakout-rooms/create-users-dialog-hide"),!1;window.Events.dispatch("breakout-rooms/create-users-dialog-hide");const o=window.breakoutRoom.usersWithoutRoom;if(o.length<1)return!1;let r=`<div id="bkr_config_users_dialog" class="fc bgw p10 bor br sha" style="width:230px;max-height:200px;overflow:auto;position:absolute;left:${i.left-155}px;top:${i.top+20}px;z-index:999;" room="${t}">`;const a=window._engine.nick();let c=0;for(let e=0;e<o.length;e+=1){const n=o[e].name,i=o[e].fullname;n!==a&&(c+=1,r+=`<div class="bkr_user_select fr pt" name="${n}" room="${t}" fullname="${i}"><span style="max-width:210px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;">${i}</span></div>`)}return r+="</div>",0!==c&&s.append(r),!1},"breakout-rooms/config-user-select-click":async function(e){E(`[BreakoutRoom] configUserSelectClick: ${JSON.stringify(e)}`);const{room:t,name:n,fullname:i}=e;return await window.breakoutRoom.moveUserToRoom({name:n,fullname:i},t),window.Events.dispatch("breakout-rooms/config-room-add-user",e),window.Events.dispatch("breakout-rooms/create-users-dialog-hide"),window.Events.dispatch("breakout-rooms/config-add-users-btn-click",t),!0},"breakout-rooms/config-room-add-user":async function(e){E(`[BreakoutRoom] configRoomAddUser: ${JSON.stringify(e)}`);const{room:t}=e,n=l()(`#bkr_room_${t} > .bkr_expand_area`),i=await window.breakoutRoom.getUsersInRoom(t),s=await window.breakoutRoom.getRoom(t);n.html("");for(let e=0;e<i.length;e+=1){const o=window.breakoutRoom.getUser(i[e].nick),r=o?.name||i[e],a=`<div class="fr"><div class="bkr_room_remove bkr_room_move pt pr10" name="${r}" room="${t}" style="position:relative;">${o?.fullname||i[e]}</div><div id="move-${r}" room="${t}"></div></div>`;if(n.append(a),s.c){const t="move",n=s.c,o=i[e];window.breakoutRoom.sendPrivateMessage({action:t,value:n},o.nick)}}},"breakout-rooms/config-room-remove-user":async function(e){const{room:t,name:n}=e,i=window.breakoutRoom.main,s=n;window.breakoutRoom.sendPrivateMessage({action:"move",value:i},s);const o=l()(`#bkr_room_${t} > .bkr_expand_area`);await window.breakoutRoom.removeRoomUser(t,s);const r=await window.breakoutRoom.getUsersInRoom(t);window.Events.dispatch("breakout-rooms/create-users-dialog-hide"),o.html("");for(let e=0;e<r.length;e+=1){const n=window.breakoutRoom.getUser(r[e].nick),i=`<div class="bkr_room_remove pt" name="${n.name}" room="${t}">${n.fullname}</div>`;o.append(i)}},"breakout-rooms/config-create-btn-click":async function(){const e=window.breakoutRoom.rooms.length;if(!window._channel.isOperator(window._engine.nick()))return console.log("[BreakoutRoom] configCreateBtnClick error: user is not operator!"),!1;await window.breakoutRoom.requestCreate(e);const t=window.breakoutRoom.rooms;return setTimeout((function(){window.breakoutRoom.setXMode()}),3e3),setTimeout((function(){for(let e=0;e<t.length;e+=1){const n=t[e],i=n.c,s=n.u;if(s)for(let e=0;e<s.length;e+=1){const t=s[e];console.log(`[BreakoutRoom] configCreateBtnClic: moving ${t} to channel ${i}`);const n={action:"move"};n.value=i,window.breakoutRoom.sendPrivateMessage(n,t)}}}),6e3),window.Events.dispatch("breakout-rooms/create-config-dialog-hide"),!0},"breakout-rooms/options-btn-click":async function(){const e=l()("#breakoutroom-options-area");if(e.is(":visible"))e.hide();else{const t=window.breakoutRoom.isNested,n=window._channel.isOperator(window._engine.nick()),i=window.breakoutRoom.allow_return,s=window.breakoutRoom.allow_change,o=window.breakoutRoom.main,r=l()("#breakoutroom-options-area");if(r.html(""),n){const e=`<div class="rpchn-breakout-rooms p5 fr w100 pt" style="border-bottom: 1px solid #EEE;"><div class="fig" style="max-width:230px;overflow:hidden;white-space:nowrap;text-overflow: ellipsis;">${window.i18n.get("breakout-rooms-manage")}</div></div>`;r.append(e)}if(t&&(i||n)){const e=`<div class="bkr-room-go p5 fr w100 pt" style="border-bottom: 1px solid #EEE;" room="${o}"><div class="fig" style="max-width:210px;overflow:hidden;white-space:nowrap;text-overflow: ellipsis;">${window.i18n.get("breakout-rooms-return-main")}</div><div class="tg fr material-icons sxl pt" style="width:18px;height:18px;flex-wrap:wrap;">login</div></div>`;r.append(e)}if(s||n){const e=window.breakoutRoom.rooms;for(let t=0;t<e.length;t+=1){const n=e[t],i=n.c,s=n.n;let o="";o=t===e.length-1?`<div class="bkr-room-go p5 fr w100 pt" room="${i}"><div class="fig" style="max-width:210px;overflow:hidden;white-space:nowrap;text-overflow: ellipsis;">${s}</div><div class="tg fr material-icons sxl pt" style="width:18px;height:18px;flex-wrap:wrap;">login</div></div>`:`<div class="bkr-room-go p5 fr w100 pt" room="${i}" style="border-bottom: 1px solid #EEE;"><div class="fig" style="max-width:210px;overflow:hidden;white-space:nowrap;text-overflow: ellipsis;">${s}</div><div class="tg fr material-icons sxl pt" style="width:18px;height:18px;flex-wrap:wrap;">login</div></div>`,r.append(o)}}e.show()}},"breakout-rooms/options-btn-hide":async function(){const e=l()("#breakoutroom-options");e.is(":visible")&&e.hide()},"breakout-rooms/options-btn-show":async function(e){let t=e;const n=l()("#breakoutroom-options-btn");l()("#breakoutroom-options-area").hide();const i=window.breakoutRoom.rooms,s=window.breakoutRoom.xMode;let o;if(t||(t=window._engine.currentChannel()),n.hide(),!p.ROOM)return!1;o=p.ROOM[window._engine.currentChannel()];let r=!1;if(o&&(r=o.enable_nesting),!i||!s||!t)return n.hide(),!1;if(0===i.length)return n.hide(),!1;const a=window.breakoutRoom?.getRoomType(t);if("room"!==a&&"nested"!==a&&"meeting"!==a)return n.hide(),!1;if("room"===a&&!r)return n.hide(),!1;const c=window._channel.isOperator(window._engine.nick()),d=window.breakoutRoom.allow_return,u=window.breakoutRoom.allow_change;return"nested"===a?u||d||c?(n.show(),!0):(n.hide(),!1):c||u?(n.show(),!0):(n.hide(),!1)},"breakout-rooms/menu-btn-show":async function(){const e=l()("#rpchn-breakout-rooms"),t=window._engine.currentChannel(),n=p.ROOM[t];let i=!1;n&&(i=n.enable_nesting);const s=window.breakoutRoom?.getRoomType(t);if("room"!==s&&"nested"!==s&&"meeting"!==s)return e.hide(),!1;if(("room"===s||"meeting"===s)&&!i)return e.hide(),!1;if(window._channel.isOperator(window._engine.nick())){const t=l()("#rpchn-breakout-room-label");if(window.breakoutRoom.xMode){const e=window.i18n.get("breakout-rooms-manage");t.html(e),window.breakoutRoom.requestNames()}else{const e=window.i18n.get("breakout-rooms-create");t.html(e)}return e.show(),!0}return e.hide(),!1},"breakout-rooms/room-change-click":async function(e=""){const t=e.trim();return""===t?(console.log("[BreakoutRoom] roomChange: no room passed!"),!1):(l()("#breakoutroom-options-area").hide(),window.breakoutRoom.changeRoom(t),!0)},"breakout-rooms/close-btn-click":async function(){window.breakoutRoom.unsetXMode(),window.breakoutRoom.requestClose(),window.Events.dispatch("breakout-rooms/create-config-dialog-hide"),window.Events.dispatch("breakout-rooms/create-config-more-dialog-hide"),window.breakoutRoom.reset()},"breakout-rooms/user-move-dialog-show":async function(e){const{room:t,name:n}=e,i=window.breakoutRoom.rooms;if(i.length<1)return console.log(`[BreakoutRoom] userMoveDialogShow: rooms length = ${i.length}`),!1;const s=l()(`#move-${n}`);let o=`<select name="${n}" id="move-to-room" class="p5">`;o+=`<option value="none" selected>${window.i18n.get("breakout-rooms-move-to")}</option>`,o+=`<option value="${window.breakoutRoom.main}">${window.i18n.get("breakout-rooms-main")}</option>`;for(let e=0;e<i.length;e+=1){const n=i[e].c;let s=i[e].n;s.length>60&&(s=`${s.substring(0,60)} ...`),t!==n&&(o+=`<option value="${n}">${s}</option>`)}return o+="</select>",s.html(o),!1},"breakout-rooms/refresh-rooms-btn-click":async function(){await window.Events.dispatch("breakout-rooms/create-config-dialog-show")}};l()("#chn-session-start-btn").on("click",(async()=>{"m"===window._channel.getSuffix(window._engine.currentChannel())?window._channel.startDefaultRecording():window.Events.dispatch("session/start-session-icon-click")})),l()("#chn-session-stop-btn").on("click",(async()=>{window._channel.getSuffix(window._engine.currentChannel()),("p"!==window._channel.getSuffix()||window._recorderCtrl.isStarted()||window.session.isReconnecting()||window._recorderCtrl.isStarted()||!window.session.isRunning())&&window.Events.dispatch("session/stop-session-icon-click")})),l()("#chn-session-continue-btn").on("click",(()=>{window.Events.dispatch("session/continue-session-icon-click")})),l()("#dbcsm-session-start").on("click",(async()=>{window.Events.dispatch("session/dialog-start-session-btn-click")})),l()("#dbcsm-session-new").on("click",(function(){const e=l()(this);window.Events.dispatch("session/new-session-tab-click",e)})),l()("#dbcsm-session-rerecord").on("click",(function(){const e=l()(this);window.Events.dispatch("session/re-record-session-tab-click",e)})),l()("#session-download").on("click",(()=>{window.Events.dispatch("session/download-btn-click")})),l()("#dbcsm-session-spare").on("change",(function(){const e=l()(this);window.Events.dispatch("session/date-spare-dropdown-click",e)})),l()("#dbcsm-session-date-reference").on("change",(function(){window.Events.dispatch("session/reference-date-click")})),l()("#dbcsm-session-date-hour").on("change",(function(){const e=l()(this);window.Events.dispatch("session/hour-change",e)})),l()("#dbcsm-add-category").on("click",(()=>{window.Events.dispatch("session/add-category-label-click")}));const _a={"session/start-session-icon-click":async function(){window.Events.dispatch("session/start","startSessionIconClick"),window.timerWorker.reset("session-");const e=window._engine.currentChannel();if("meeting"===window.breakoutRoom.getRoomType(e)&&l()("#dbcsm-session-rerecord").hide(),"smerj"===window.realm&&l()("#dbcsm-session-rerecord").hide(),p.CONFIG.hideCsmRoomReferenceDate&&l()("#dbcsm-session-date-area").hide(),(await window.session.getActiveSessionInfo(window._engine.currentChannel())).active){l()("#record-option-stop").hide(),l()("#record-option-start").show(),l()("#record-option-icon").css("color","");const e=window.i18n.get("error-session-start");return window._channel.showTemporaryMessage(e,"alert"),!1}if(window.mobile&&p.CONFIG.denySessionOnMobile){const e={};return e.errors=[{message:window.i18n.get("error-csm-no-mobile")}],z(e),!1}window.timeOut&&window.timeOut.isStarted()&&window.timeOut.stop();const t=window.session.getRecordTabShow(),n=window.session.getReRecordTabShow();return t?(l()("#session-record-session").css({border:"0","border-bottom-width":"2px","border-color":"#325794","border-style":"solid"}),l()("#session-rerecord-session").css("border","0")):n&&(l()("#session-rerecord-session").css({border:"0","border-bottom-width":"2px","border-color":"#325794","border-style":"solid"}),l()("#session-record-session").css("border","0")),l()("#record_inout_checkbox").prop("checked",!1),window.recordChatInOut=!1,localStorage.removeItem("session-username"),window.navigatorData.browser.includes("safari")&&"staging"!==window.realm?(l()("#alert-transmission-safari").is(":visible")||(l()("#alert-transmission-safari").show(),setTimeout((function(){l()("#alert-transmission-safari").hide()}),3e3)),!1):window.navigatorData.browser.includes("firefox")&&"staging"!==window.realm&&"school"!==window.realm?(l()("#alert-transmission-firefox").is(":visible")||(l()("#alert-transmission-firefox").show(),setTimeout((function(){l()("#alert-transmission-firefox").hide()}),3e3)),!1):(l()("#dbcsm-session-start-label-error").html(""),l()("#dbcsm-session-start-label-error").hide(),l()("#dbcsm-sessions-availiable-area").html(""),window.session.reset(),l()(".dialog").hide(),l()("#dbcsmstart").show(),l()("#dbcsm-session-new").click(),l()("#dialog").show(),!1)},"session/stop-session-icon-click":async function(){window.Events.dispatch("session/finish","stopSessionIconClick");const e=window.session_id,t={},n=[];if(l()("#dbcsm-session-date-area-select").hide(),window._channel.unsetScreen(),void 0===e)return E("[Session Finish] Session ID is undefined!"),!1;const i=await window.session.getUserListReport(),s=window.sessionMaxDuration;window.live_duration=0;for(const[e,t]of i){const i=e;let o=e;const r=window._channel.getUser(e);r&&r.fullname&&(o=r.fullname);let a=parseInt(t/1e3)>s?s:parseInt(t/1e3);a||(a=0);let c=await window.session.statistics(window.session_id).getUserTxTime(i);c=parseInt(c.ts/1e3),c||(c=0);const l=await window.session.statistics(window.session_id).getUserAttachmentCounter(i),d=await window.session.statistics(window.session_id).getUserMessageSendCounter(i),u=await window.session.statistics(window.session_id).getUserRaiseHandCounter(i);n.push({nick:i,user_name:o,duration:a,tx_duration:c,attachment_count:l,text_count:d,raise_hands_count:u}),a>window.live_duration&&(window.live_duration=a)}t.report={presence:n},t.live_duration=window.live_duration;const o=await window.session.finishSession(e,t);if(E(`Session finished: ${JSON.stringify(o)}`),!o){const e={};return e.errors=[{message:window.i18n.get("session-error-finish")}],z(e),!1}localStorage.removeItem("session_category_ids"),window._recorderCtrl.isStarted()&&window._recorderCtrl.stopRecord(),l()("#session-recording").hide(),l()("#display-define-layout").hide();const r=window._engine.currentChannel();return"meeting"!==window.breakoutRoom.getRoomType(r)&&await async function(){window._mediaWndsArray.forEach((e=>{const t=window._mediaWndsMap.get(e),n=t.metadata.owner,i=t.metadata.mediaVoice;if(!window.session.isReconnecting()||"p"!==window._channel.getSuffix())return("p"!==window._channel.getSuffix()||!window._channel.isDefaultRecord())&&void window._engine.requestTransmission(n,!1,i);window.session.getActiveSessionInfo().then((e=>{if(e.session_id){const t=e.session.live_duration?e.session.live_duration:0;session.finishSession(e.session_id,{live_duration:t}),l()("#record-option-stop").hide(),l()("#record-option-start").show(),l()("#record-option-icon").css("color","")}}))})),window._channel.stopTransmission(),window.devicesStream&&window.devicesStream.getTracks().forEach((e=>{e.stop()})),window.localStream&&window.localStream.getTracks().forEach((e=>{e.stop()}))}(),window.timerWorker.stopTimers("session-"),window.Events.dispatch("session/timer-control","stopTimers"),window.countdown&&window.countdown.stop(),window.softCountdown&&window.softCountdown.stop(),l()("#alert-time-remaining").hide(),window.session.hideTimer(),l()("#media-cc").hide(),window.resizeMedia.update(),l()("#chn-session-stop-btn").hide(),l()("#chn-session-continue-btn").hide(),l()(".dialog").hide(),window.pendingSession?(window.pendingSession=!1,!1):(l()("#session-userlist").html(""),window.session.getUserListReport().then((e=>{e.forEach((([e,t])=>{const n=e,i=window._channel.getUser(e);let s=e;i&&i.fullname&&(s=i.fullname),l()("#session-userlist").append(`<div class="fcm w100 pl5 pr5"><div class="w100 frm p5"style="border-bottom:solid;border-width:1px;"><div class="sxs fig" style="max-width:262px;"><div class="ss toj">${s}</div><div>${n}</div></div><div class="ss frm" style="width:100px;"><div>${U(parseInt(t/1e3))}</div></div></div></div>`)}))})),"p"!==window._channel.getSuffix()&&(l()("#dbsession-finish").show(),l()(".modal").show(),l()("#dialog").show()),!1)},"session/continue-session-icon-click":async function(){(async function(){const e=await window.session.getSessionInfo(window.session_id);return console.log(`[continueSessionIconClick] sessionInfo: ${JSON.stringify(e)}`),window.session.setReconnectTry(0),await window.session.continueSession(e),l()("#chn-session-continue-btn").hide(),!0})().then((()=>{_channel.getModes().A?window._channelCtrl.setTx(!0,!1,!0,!1):window._engine.requestTransmission(p.ENGINE_NICK,!0,!1)}))},"session/dialog-start-session-btn-click":async function(){const e=await window.session.getActiveSessionInfo(window._engine.currentChannel());if(e.active){E(`[Session] Start Error: active session info: ${JSON.stringify(e)}`);const t=window.i18n.get("error-session-start");return window._channel.showTemporaryMessage(t,"alert"),l()(".dialog").hide(),l()(".modal").hide(),l()("#dialog").hide(),!1}await window.session.getRootCategories();const t=window.session.getRootRequiredCategories(),n=window.session.getSelectedCategories();let i,s=!0,o=!1;t.forEach((e=>{n.includes(e)||o||(s=!1,i=e,o=!0)}));const r=l()("#dbcsm-session-input-title").val().trim();if(""===r)return l()("#dbcsm-session-label-start-error").html(window.i18n.get("session-error-insert-title")),l()("#dbcsm-session-label-start-error").show(),!1;if(!p.CONFIG.hideCsmRoomReferenceDate){if(null===l()("#dbcsm-session-spare").val())return l()("#dbcsm-session-label-start-error").html(window.i18n.get("session-error-select-class-type")),l()("#dbcsm-session-label-start-error").show(),!1;if(""===l()("#dbcsm-session-date-reference").val().trim())return l()("#dbcsm-session-label-start-error").html(window.i18n.get("session-error-select-date")),l()("#dbcsm-session-label-start-error").show(),!1;if("-1"===l()("#dbcsm-session-date-hour").val()||"-1"===l()("#dbcsm-session-date-minutes").val())return l()("#dbcsm-session-label-start-error").html(window.i18n.get("session-error-insert-time")),l()("#dbcsm-session-label-start-error").show(),!1}if(l()(".selecting").is(":visible"))return l()("#dbcsm-session-label-start-error").html(window.i18n.get("session-error-finish-selecting")),l()("#dbcsm-session-label-start-error").show(),!1;if(!s){const e=window.session.getCategory(i).name;return l()("#dbcsm-session-label-start-error").html(`${window.i18n.get("session-error-required-category")} "${e}" ${window.i18n.get("session-error-required-notselected")}`),l()("#dbcsm-session-label-start-error").show(),!1}return l()("#dbcsm-session-label-start-error").hide(),l()(".dialog").hide(),async function(){let e;return e=p.CONFIG.hideCsmRoomReferenceDate?window.time.getFormDate(window.time.now()):`${l()("#dbcsm-session-date-reference").val()}T${l()("#dbcsm-session-date-hour").val()}:${l()("#dbcsm-session-date-minutes").val()}`,await window.session.setTitle(r),await window.session.setReferenceDate(e),await window.session.setExtras({}),window.session.startNeeded(!0),!0}().then((()=>{const e=window._engine.currentChannel();l()("#chn-session-start-btn").hide(),l()("#chn-session-continue-btn").hide(),window.session.setStarted(!0),"-m"===e.slice(-2)?window._channelCtrl.setTx(!0,!1,!0,!1):window._engine.requestTransmission(p.ENGINE_NICK,!0,!1)})),!1},"session/new-session-tab-click":async function(e){const t=e;l()(".dbcsmoption").css("border-bottom","0px"),l()(".dbcsmoption").css("color","#4b4b4b"),t.css("border-bottom","3px solid"),t.css("color","#002d70"),l()(".dbcsmstartb-area").hide(),l()("#dbcsm-add-category").show(),l()("#dbcsm-session-start-label-error").html(""),l()("#dbcsm-session-start-label-error").hide(),l()("#dbcsm-session-input-title").val(""),l()("#dbcsm-session-spare").html(`<option value="" class="i18n-session-spare-select-here" disabled="" selected="selected" hidden="">${window.i18n.get("session-spare-select-here")}</option><option value="spare" class="i18n-session-spare-spare">${window.i18n.get("session-spare-spare")}</option><option value="today" class="i18n-session-spare-today">${window.i18n.get("session-spare-today")}</option>`),p.CONFIG.hideCsmRoomReferenceDate&&l()("#dbcsm-session-date-area").hide(),l()("#dbcsm-categories-area").html(""),l()("#dbcsm-session-label-start-error").html(""),l()("#dbcsm-session-label-start-error").hide(),l()("#dbcsm-startb").show()},"session/re-record-session-tab-click":async function(e){const t=e;l()(".dbcsmoption").css("border-bottom","0px"),l()(".dbcsmoption").css("color","#4b4b4b"),t.css("border-bottom","3px solid"),t.css("color","#002d70"),l()(".dbcsmstartb-area").hide(),l()("#dbcsm-rerecordb").show(),l()("#dbcsm-session-start-label-error").hide(),window.session.setType("rerecord"),window.session.setRecordTabShow(!1),window.session.setReRecordTabShow(!0),async function(){const e={channel:window._channel.getName(),owner:p.ENGINE_NICK.replace("-web",""),status:"rerecord"},t=await window.session.getSessionsListInfo(e),n=[];return t.forEach((e=>{const t=e.id,i=new Date(e.reference_date),s=e.reference_date,o=`${i.getDate()<10?`0${i.getDate()}`:i.getDate()}/${i.getMonth()+1<10?`0${i.getMonth()+1}`:`${i.getMonth()+1}`}/${i.getFullYear()} - ${i.getHours()<10?`0${i.getHours()}`:i.getHours()}:${i.getMinutes()<10?`0${i.getMinutes()}`:i.getMinutes()}`;n.push({id:t,reference_date:s,referenceDate:o})})),l()("#dbcsm-sessions-availiable-area").html(""),n.forEach((e=>{l()("#dbcsm-sessions-availiable-area").append(`<div class="w100 fr ss" style="border:0px;border-bottom:1px;border-style: solid;border-color:#EEEEEE;">\n                <div class="p5" style="width:120px;text-align:center"><input type="radio" id="dbcsm-record-session-${e.id}" name="dbcsm-record-session" value="${e.id},${e.reference_date}" /><label for="dbcsm-record-session-${e.id}">${e.id}</label></div>\n                <div class="fig">&nbsp;</div>\n                <div class="p5 fig" style="text-align:center;width:200px;max-width:200px;"><label for="dbcsm-record-session-${e.id}">${e.referenceDate}</label></div></div>`)})),n}().then((e=>{0!==e.length&&E(`Rerecording list result: ${JSON.stringify(e)}`)}))},"session/download-btn-click":async function(){let e="Nome Completo,Apelido,Tempo\n";window.session.getUserListReport().then((t=>{t.forEach((([t,n])=>{const i=t;let s=t;const o=window._channel.getUser(t);o&&o.fullname&&(s=o.fullname),e+=`${s},${i},${U(parseInt(n/1e3))}\n`}));const n=new Blob([e],{type:"text/csv"}),i=window.URL.createObjectURL(n),s=document.createElement("a");s.href=i,s.download="user-list-report.csv",s.click();const o=window.session_id;window.session.getSessionUserJoinLeaveReportCSV(o).then((e=>{const t=new Blob([e],{type:"text/csv"}),n=window.URL.createObjectURL(t),i=document.createElement("a");i.href=n,i.download="user-join-part-report.csv",i.click()}))}))},"session/date-spare-dropdown-click":function(e){const t="spare"===e.val(),n=new Date,i=`${n.getFullYear()}-${n.getMonth()<9?`0${n.getMonth()+1}`:`${n.getMonth()+1}`}-${n.getDate()<10?`0${n.getDate()}`:`${n.getDate()}`}`,s=new Date((new Date).getTime()-864e5).toLocaleDateString().split("/"),o=`${s[2]}-${s[1]}-${s[0]}`;t?(l()("#dbcsm-session-date-reference").val(""),l()("#dbcsm-session-date-reference").removeAttr("min"),l()("#dbcsm-session-date-reference").attr("max",o),l()("#dbcsm-session-date-hour").html('<option value="-1">&nbsp;</option><option value="07">07</option><option value="08">08</option><option value="09">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option>'),l()("#dbcsm-session-date-minutes").html('<option value="-1">&nbsp;</option><option value="00">00</option><option value="05">05</option><option value="10">10</option><option value="15">15</option><option value="20">20</option><option value="25">25</option><option value="30">30</option><option value="35">35</option><option value="40">40</option><option value="45">45</option><option value="50">50</option><option value="55">55</option>')):(l()("#dbcsm-session-date-reference").val(i),l()("#dbcsm-session-date-reference").attr("min",i),l()("#dbcsm-session-date-reference").attr("max",i),l()("#dbcsm-session-date-hour").html('<option value="-1">&nbsp;</option>'),l()("#dbcsm-session-date-reference").change()),l()("#dbcsm-session-date-area-select").show()},"session/reference-date-click":function(){const e=l()("#dbcsm-session-date-reference").val(),t=new Date(e).getTime()+792e5,n=new Date,i=`${n.getFullYear()}`,s=n.getMonth()<9?`0${n.getMonth()+1}`:`${n.getMonth()+1}`,o=n.getDate()<10?`0${n.getDate()}`:`${n.getDate()}`;let r=n.getHours()<10?`0${n.getHours()}`:`${n.getHours()}`;const a=n.getMinutes()<10?`0${n.getMinutes()}`:`${n.getMinutes()}`,c=`${i}-${s}-${o}`;if(t>n.getTime()&&(l()("#dbcsm-session-date-reference").attr("value",c),l()("#dbcsm-session-date-reference").val(c)),l()("#dbcsm-session-date-reference").attr("value")!==e)l()("#dbcsm-session-date-hour").html('<option value="-1">&nbsp;</option><option value="07">07</option><option value="08">08</option><option value="09">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option>'),l()("#dbcsm-session-date-minutes").html('<option value="-1">&nbsp;</option><option value="00">00</option><option value="05">05</option><option value="10">10</option><option value="15">15</option><option value="20">20</option><option value="25">25</option><option value="30">30</option><option value="35">35</option><option value="40">40</option><option value="45">45</option><option value="50">50</option><option value="55">55</option>');else{l()("#dbcsm-session-date-hour").html('<option value="-1">&nbsp;</option>'),parseInt(a)>55&&r<22&&(r=parseInt(r)+1);for(let e=7;e<=parseInt(r);e+=1){const t=e<10?`0${e}`:`${e}`;l()("#dbcsm-session-date-hour").append(`<option value="${t}">${t}</option>`)}l()("#dbcsm-session-date-minutes").html('<option value="-1">&nbsp;</option>');for(let e=0;e<=parseInt(a);e+=5){const t=e<10?`0${e}`:`${e}`;l()("#dbcsm-session-date-minutes").append(`<option value="${t}">${t}</option>`)}}},"session/hour-change":function(e){const t=e,n=new Date,i=`${n.getFullYear()}`,s=n.getMonth()<9?`0${n.getMonth()+1}`:`${n.getMonth()+1}`,o=n.getDate()<10?`0${n.getDate()}`:`${n.getDate()}`,r=n.getHours()<10?`0${n.getHours()}`:`${n.getHours()}`;let a=n.getMinutes()<10?`0${n.getMinutes()}`:`${n.getMinutes()}`;if(`${i}-${s}-${o}`===l()("#dbcsm-session-date-reference").val()){const e=parseInt(t.val()),n=parseInt(r);if(e<n)l()("#dbcsm-session-date-minutes").html('<option value="-1">&nbsp;</option><option value="00">00</option><option value="05">05</option><option value="10">10</option><option value="15">15</option><option value="20">20</option><option value="25">25</option><option value="30">30</option><option value="35">35</option><option value="40">40</option><option value="45">45</option><option value="50">50</option><option value="55">55</option>');else{l()("#dbcsm-session-date-minutes").html('<option value="-1">&nbsp;</option>'),n<e?a=1:parseInt(a)+5<59&&(a=parseInt(a)+5);for(let e=0;e<=parseInt(a);e+=5){const t=e<10?`0${e}`:`${e}`;l()("#dbcsm-session-date-minutes").append(`<option value="${t}">${t}</option>`)}}}},"session/add-category-label-click":function(){l()("#dbcsm-add-category").hide(),l()("#session-label-start-error").hide(),window.session.getRootCategories().then((e=>{let t;window.session.getSessionId().then((n=>{t=n+1,l()("#dbcsm-categories-area").append(`<div id="dbcsm-session-id-${t}" class="w100 bor br"><div class="bor w100 br p5" style="position:relative;"><div class="selected ss"></div><div class="fc selecting w100 p0" name="id"><div class="w100" style="position:relative;"><input type="text" class="insert-category-text bor br p5 w100" style="width:520px;border-color:rgba(0,0,255,0.25);"/><div class="pt rm-categories" style="position:absolute;right:0px;top:2px;" sId="${t}">X</div></div><div class="category-items fc w100 bgw bor sxs" style="position:absolute;top:31px;max-height:200px;width:520px;overflow-y:auto;display:none;"></div></div></div>`),window.categoryItems=[],e.forEach((e=>{const n=e.required?"*":"";l()("#dbcsm-categories-area .category-items").append(`<div class="p5 category-item hovr pt w100" cid="${e.id}" sid="${t}">${e.name} ${n}</div>`);const i={id:e.id,name:`${e.name} ${n}`};window.categoryItems.push(i)}))})),l()("#dbcsm-add-category").hide()}))},"session/show-session-start-btn":async function(){const e=window._engine.currentChannel(),t=window.breakoutRoom.getRoomType(e);"meeting"===t||"room"===t?("meeting"===t?l()("#chn-session-start-btn").html(window.i18n.get("record-start")):l()("#chn-session-start-btn").html(window.i18n.get("session-start")),l()("#chn-session-start-btn").show()):l()("#chn-session-start-btn").hide()},"session/disconnect":function(e){return E(`[Session] Disconnected! Payload: ${JSON.stringify(e)}`),console.log(`[Session] Disconnected! Payload: ${JSON.stringify(e)}`),window._recorderCtrl.stopRecord(!0),!1},"session/reconnect":function(e){return E(`[Session] Reconnect. Payload: ${JSON.stringify(e)}`),console.log(`[Session] Reconnect. Payload: ${JSON.stringify(e)}`),$("#session-recording").hide(),window.session.hideTimer(),C.AUDIO_SESSION_ERROR.play(),!1},"session/finish":function(e){return E(`[Session] Finished! Payload: ${JSON.stringify(e)}`),!1},"session/start":function(e){return E(`[Session] Start! Payload: ${JSON.stringify(e)}`),!1},"session/timer-control":function(e){return E(`[Session] RecorderCtrl started: ${window._recorderCtrl.isStarted()}`),E(`[Session] timerControl! Payload: ${JSON.stringify(e)}`),!1},"session/timer-hide":function(){return E("[Session] Hide Session Timer!"),l()("#session-timer").hide(),!1},"session/timer-show":function(){return E("[Session] Show Session Timer!"),l()("#session-timer").show(),!1}};l()("#channelAdmUserList").on("click",(function(){window.Events.dispatch("users/icon-click")})),l()("body").on("click",".chnu_op",(function(e){const t={element:l()(this),event:e};window.Events.dispatch("users/more-btn-click",t)})),l()("body").on("click",(function(e){const t=l()(e.target);l()("#channelUserPopup").is(":visible")&&!t.is(".chnu_op")&&0===t.parents("#channelUserPopup").length&&l()("#channelUserPopup").hide()})),l()("#channelUserPopup").on("click",".popupItem",(function(){const e=l()(this);window.Events.dispatch("users/item-click",e)}));const ya={"users/icon-click":function(){return window.activity.update(`[Channel] Admin User List icon click: ${window._channel.getName()}`),null===window._engine.currentChannel()&&E("[Event] user-list-icon-click: not in channel!"),l()("#rpchn-MuteAll").hide(),window._channel.isOperator(window._engine.nick())&&l()("#rpchn-MuteAll").show(),l()(".rpme").removeClass("toj"),l()("#channelEmoticon").hide(),window._channel.getModes().m&&l()("#channelMsgAlert").hide(),l()("#channelNoMoreMsg").hide(),l()("#channelMsgCounter").hide(),l()("#channelMsgAlert").hide(),l()("#rpchnmodlist").html(""),l()("#rpchnmodlist").hide(),l()("#rpchngrouplist").hide(),l()("#rpchngroupchat").hide(),l()("#rpchnmetaverselist").hide(),l()("#rpchntasklist").hide(),l()("#rpchncsmlist").hide(),l()("#rpchnfeedlist iframe").remove(),l()("#rpchnfeedlist").html(""),l()("#rpchnfeedlist").hide(),l()("#rpchnusermutelist").html(""),l()("#rpchnuserbanlist").html(""),l()("#rpchnusermutelist").hide(),l()("#rpchnuserbanlist").hide(),l()("#rpchnhtitle").html(window.i18n.get("users")),l()(".rpchnhcount").attr("type","users"),l()("#rpchnconf").hide(),l()("#rpchnconficon").removeClass("tb"),l()("#rpchnuserlist").show(),l()("#hp__Channel__").hide(),l()("#channelInputArea").hide(),l()("#channelAdmChat").removeClass("ic_channel_chat_ON"),l()(".channelAdmChat").hide(),l()("#channelTaskList").removeClass("tb"),l()("#channelModList").removeClass("tb"),l()("#channelAdmGroup").removeClass("ic_group_ON"),l()("#channelAdmUserList").addClass("tb"),l()("#channelCloudVideosIcon").removeClass("tb"),l()("#channelCsmVideosIcon").removeClass("tb"),l()("#channelFeedIcon").removeClass("tb"),l()("#rpchncloudlist").hide(),l()("#rpchncsmlist").hide(),l()(".user-list").hide(),window.metaverse.started||(l()(".channelAdmChat").show(),l()(".channelAdmChat").removeClass("ic_channel_chat_ON")),window._groupEngine.isStarted()&&(window._groupEngine.requestLeaveChannel(),window._groupEngine.stop()),null!==window._engine.currentChannel()&&window._channel.getModes().U&&window._engine.requestUserList(),!1},"users/more-btn-click":function(e){const{element:t,event:n}=e,i=t.attr("nick")||t.attr("from"),s=l()(n.target),o=s.offset().top,r=s.offset().left;if(l()("#channelUserPopup").is(":visible"))return l()("#channelUserPopup").hide(),!1;if(window._channel.getModes().U&&!(window._channel.isInChannel(i)||window._channel.isOperator(p.ENGINE_NICK)||window._channel.isModerator(p.ENGINE_NICK)||window._channel.isRoomOperator(p.ENGINE_NICK)))return!1;let a=i;if("-web"===a.slice(-4)&&(a=a.slice(0,-4)),!window._channel.isOperator(p.ENGINE_NICK)&&!window._channel.isModerator(p.ENGINE_NICK)&&!window._channel.isRoomOperator(p.ENGINE_NICK)){if(p.CONFIG.onlySpecialPrivMessage){if(!(window._channel.isOperator(p.ENGINE_NICK)||window._channel.isOperator(i)||window._channel.isOperator(a)||window._channel.isModerator(p.ENGINE_NICK)||window._channel.isModerator(i)||window._channel.isModerator(a)||window._channel.isRoomOperator(p.ENGINE_NICK)||window._channel.isRoomOperator(i)||window._channel.isRoomOperator(a)))return E("No private messages allowed between normal users!"),!1;if(!p.CONFIG.allowPrivMessage)return!1;if(0===window._channel.getType()&&""===window._channel.getActiveRoom())return!1}if(!window._channel.isOperator(p.ENGINE_NICK)&&!window._channel.isModerator(p.ENGINE_NICK))if(0===l()(`#chnprivc_${i}`).length){const e={};e.nick=i,e.name=i,e.avatar_id="",e.group=!1,l()(".chnprivchatsarea").show(),Yr(e)}else l()(".chnprivchatsarea").show(),l()("#chnprivchatslist").hide(),l()("#chnprivchatsarea > .fc").hide(),l()(`#chnprivc_${i}`).show();return!1}const c=window.lChannelMutedUsers[i.replace("-web","")],d=t.attr("seq");if(window._channel.isOperator(p.ENGINE_NICK)||window._channel.isModerator(p.ENGINE_NICK)||window._channel.isRoomOperator(p.ENGINE_NICK)?(l()("#channelAdmUserList").hasClass("tb")?(l()("#popupItemDelMsg").hide(),l()("#popupItemDelMsg").attr("seq","")):(l()("#popupItemDelMsg").show(),l()("#popupItemDelMsg").attr("seq",d)),l()("#popupMuteMic").show(),l()("#popupMuteCam").show()):(l()("#popupItemDelMsg").hide(),l()("#popupItemDelMsg").attr("seq",""),l()("#popupMuteMic").hide(),l()("#popupMuteCam").hide()),i!==p.ENGINE_NICK?(p.CONFIG.allowPrivMessage?l()("#popupItemSendMsg").show():l()("#popupItemSendMsg").hide(),window._channel.isOperator(p.ENGINE_NICK)||window._channel.isRoomOperator(p.ENGINE_NICK)?window._channel.isOperator(i)?(l()("#popupAddModerator").hide(),l()("#popupDelModerator").show()):(l()("#popupAddModerator").show(),l()("#popupDelModerator").hide()):(l()("#popupAddModerator").hide(),l()("#popupDelModerator").hide())):(l()("#popupItemSendMsg").hide(),l()("#popupAddModerator").hide(),l()("#popupDelModerator").hide()),""===window._channel.getActiveRoom())if(window._channel.getMedias().includes(i))l()("#popupAddVoice").hide(),l()("#popupDelVoice").show();else if(window.session&&1===window._channel.getType()&&window.enableCsm)if(window.session.isStarted())l()("#popupAddVoice").show(),l()("#popupDelVoice").hide();else{if(window._channel.isRoomOperator(i))return!1;l()("#popupAddVoice").hide(),l()("#popupDelVoice").hide()}else l()("#popupAddVoice").show(),l()("#popupDelVoice").hide();else l()("#popupAddVoice").hide(),l()("#popupDelVoice").hide(),l()("#popupAddMediaVoice").hide(),l()("#popupDelMediaVoice").hide();i===window.channelOwner?(l()("#popupItemAddOp").hide(),l()("#popupItemDelOp").hide(),l()("#popupItemAddMute").hide(),l()("#popupItemDelMute").hide(),l()("#popupItemAddBan").hide(),l()("#popupItemKick").hide()):window._channel.isOperator(i)||window._channel.isRoomOperator(i)?(l()("#popupItemAddMute").hide(),l()("#popupItemDelMute").hide(),l()("#popupItemAddBan").hide(),l()("#popupItemKick").hide(),l()("#popupItemDelOp").hide()):(l()("#popupItemAddMute").hide(),l()("#popupItemDelMute").hide(),l()("#popupItemAddBan").hide(),l()("#popupItemKick").show(),p.ENGINE_NICK!==i&&""===window._channel.getActiveRoom()&&(l()("#popupItemAddOp").show(),c?(l()("#popupItemAddMute").hide(),l()("#popupItemDelMute").show()):(l()("#popupItemAddMute").show(),l()("#popupItemDelMute").hide()),window.breakoutRoom&&"nested"===window.breakoutRoom.getRoomType(window._engine.currentChannel())?l()("#popupItemAddBan").hide():l()("#popupItemAddBan").show(),l()("#popupItemListMute").hide(),l()("#popupItemListBan").hide(),""===window._channel.getActiveRoom()&&(l()("#popupItemListMute").show(),l()("#popupItemListBan").show())));const u=l()("#app").height()-o<o?-l()("#channelUserPopup").height():0,h=r-l()("#channelUserPopup").width()-10,m=u+o;return l()("#channelUserPopup").attr("nick",i),l()("#channelUserPopup").css("left",h),l()("#channelUserPopup").css("top",m),l()("#channelUserPopup .popupItem").attr("nick",i),l()("#channelUserPopup").show(),!1},"users/item-click":function(e){const t=e;l()("#channelUserPopup").hide();const n=t.attr("nick"),i=t.attr("seq")||"0",s=[],o=t.attr("t");if(s.push(parseInt(i)),"addVoice"===o)return new hr(`${window.i18n.get("give-collaboration-to")} ${n} ?`,"",(function(){window._engine.requestTransmission(n,!0,!1),window.lChannelVoices[n]=1,N()})).present(),!1;if("delVoice"===o)return new hr(`${window.i18n.get("remove-collaboration-from")} ${n} ?`,"",(function(){window._engine.requestTransmission(n,!1,!1),delete window.lChannelVoices[n],N()})).present(),!1;if("addMediaVoice"===o)return new hr(`${window.i18n.get("delegate-media-voice-to")} ${n} ?`,"",(function(){l()("#rpchnhi").removeClass("ic_collaborate_ON"),l()("#rpchnhi").removeClass("tb"),window._engine.requestTransmission(n,!0,!0),window._channel.unsetVoiceUser(n),window.lChannelVoices[n]&&delete window.lChannelVoices[n]})).present(),!1;if("delMediaVoice"===o)return new hr(`${window.i18n.get("remove-media-voice-from")} ${n} ?`,"",(function(){window._engine.requestTransmission(n,!1,!0),window._channel.unsetMediaVoiceUser(n),delete window.lChannelMediaVoice[n]})).present(),!1;if("muteMic"===o&&window._channel.sendRemoteMute(n,"MIC"),"muteCam"===o&&window._channel.sendRemoteMute(n,"CAM"),"addOp"===o)return new hr(`${window.i18n.get("give-operator-to")} ${n} ?`,"",(function(){""===window._channel.getActiveRoom()?(window._engine.requestSetChannelMode(window._channel.getName(),"+o",n),window._channel.setOperator(n)):(window._groupEngine.requestSetChannelMode(window._channel.getActiveRoom(),"+o",n),window._channel.setOperator(n))})).present(),!1;if("delOp"===o)return new hr(`${window.i18n.get("remove-operator-from")} ${n} ?`,"",(function(){if(""===window._channel.getActiveRoom()){window._engine.requestSetChannelMode(window._channel.getName(),"-o",n),delete window.lChannelOperators[n];for(let e=0;e<window.aChannelOperators.length;e+=1)window.aChannelOperators[e]===n&&window.aChannelOperators.splice(e,1);window._channel.unsetOperator(n)}else window._groupEngine.requestSetChannelMode(window._channel.getActiveRoom(),"-o",n),window._channel.unsetRoomOperator(n)})).present(),!1;if("addModerator"===o)return new hr(`${window.i18n.get("give-moderation-to")} ${n} ?`,"",(function(){l()("#rpchnhi").removeClass("ic_collaborate_ON"),l()("#rpchnhi").removeClass("tb"),window._engine.requestSetChannelMode(window._channel.getName(),"+o",n)})).present(),!1;if("delModerator"===o)return new hr(`${window.i18n.get("remove-moderation-from")} ${n} ?`,"",(function(){l()("#rpchnhi").removeClass("ic_collaborate_ON"),l()("#rpchnhi").removeClass("tb"),window._engine.requestSetChannelMode(window._channel.getName(),"-o",n)})).present(),!1;if("addMute"===o)return new hr(`${window.i18n.get("silence-user")} ${n} ?`,"",(function(){if(!window._channel.isOperator(n)){const e="-web"===n.slice(-4)?n.substr(0,n.length-4):n;E(`User: ${e} silenced!`),""===window._channel.getActiveRoom()?(window._engine.requestChannelSetChatMuteUsers(window._channel.getName(),[e],!0),window.lChannelMutedUsers[e]={}):window._groupEngine.requestChannelSetChatMuteUsers(window._channel.getActiveRoom(),[e],!0)}})).present(),!1;if("delMute"===o)return new hr(`${window.i18n.get("remove-silence-from-user")} ${n} ?`,"",(function(){if(!window._channel.isOperator(n)){const e="-web"===n.slice(-4)?n.substr(0,n.length-4):n;E(`User: ${e} unsilenced!`),""===window._channel.getActiveRoom()?(window._engine.requestChannelSetChatMuteUsers(window._channel.getName(),[e],!1),delete window.lChannelMutedUsers[e]):window._groupEngine.requestChannelSetChatMuteUsers(window._channel.getName(),[e],!1)}})).present(),!1;if("listMute"===o)return window._engine.requestChannelGetChatMuteUsers(window._channel.getName()),!1;if("addBan"===o)return new hr(`${window.i18n.get("ban-user")} ${n} ?`,"",(function(){if(!window._channel.isOperator(n)){const e="-web"===n.slice(-4)?n.substr(0,n.length-4):n;E(`User: ${e} baned!`),""===window._channel.getActiveRoom()?(window._engine.requestSetChannelMode(window._channel.getName(),"+b",`${e}!*@*`),window._engine.requestKickUser(n,"")):(window._groupEngine.requestSetChannelMode(window._channel.getName(),"+b",`${e}!*@*`),window._groupEngine.requestKickUser(n,""))}})).present(),!1;if("listBan"===o)return E("Requested banned users list!"),window._engine.requestChannelBanList(window._channel.getName()),!1;if("kick"===o)return new hr(`${window.i18n.get("kick-user")} ${n} ?`,"",(function(){""===window._channel.getActiveRoom()?window._channel.isOperator(n)||window._engine.requestKickUser(n,""):window._channel.isRoomOperator(n)||window._groupEngine.requestKickUser(n,"")})).present(),!1;if("delMsg"===o)return 0===window._channel.getType()&&""===window._channel.getActiveRoom()?window._channel.delMsg(window._engine.currentChannel(),window._channel.getType(),s):1===window._channel.getType()&&""===window._channel.getActiveRoom()?window._channel.delMsg(window._engine.currentChannel(),1,s):window._channel.delMsg(window._groupEngine.currentChannel(),1,s),!1;if("sendMsg"===o){if(0===l()(`#chnprivc_${n}`).length){const e={};e.nick=n,e.name=n,e.avatar_id="",e.group=!1,l()(".chnprivchatsarea").show(),Yr(e)}else l()(".chnprivchatsarea").show(),l()("#chnprivchatslist").hide(),l()("#chnprivchatsarea > .fc").hide(),l()(`#chnprivc_${n}`).show();return!1}return!1}},Ca={...na,...sa,...oa,...ya,...ra,...aa,...ca,...la,...da,...ma,...wa,...ga,...fa,...va,...ba,..._a,"record/start":function(e){E(`[Event Record] Start! Payload: ${JSON.stringify(e)}`);const t=e||"main";switch(t){case"main":E("[Event Record] Start: Main selected"),l()("#record_main_btn").click();break;case"grid":E("[Event Record] Start: Grid selected"),l()("#record_grid_btn").click();break;case"sidebar":l()("#record_main_sidebar_btn").click();break;default:E(`[Event Record] Start Error: type "${t}" invalid!`)}return!1},"record/stop":function(e){return E(`[Event Record] Stop! Payload: ${JSON.stringify(e)}`),!1}};l()("#db-metaverse-idle-quit").on("click",(function(){window.Events.dispatch("metaverse/idle-timeout-quit-button-click")})),l()("#db-metaverse-idle-continue").on("click",(function(){window.Events.dispatch("metaverse/idle-timeout-continue-button-click")}));const Sa={"metaverse/idle-timeout":async function(){return l()("#db-metaverse-idle").show(),l()(".modal").show(),l()("#dialog").show(),window.Events.dispatch("metaverse/idle-timeout-countdown"),!1},"metaverse/idle-timeout-quit-button-click":async function(){l()(".dialog").hide(),l()("#db-metaverse-idle").hide(),l()(".modal").hide(),l()("#dialog").hide(),window.idleTimeoutCountdown.stop(),window.Events.dispatch("channel/close")},"metaverse/idle-timeout-continue-button-click":async function(){l()(".dialog").hide(),l()("#db-metaverse-idle").hide(),l()(".modal").hide(),l()("#dialog").hide(),window.metaverse.clearIdleTimeout(),window.idleTimeoutCountdown.stop(),window.metaverse.setIdleTimeout((function(){window.Events.dispatch("metaverse/idle-timeout")}),p.METAVERSE_IDLE_TIMEOUT)},"metaverse/idle-timeout-countdown":async function(){return window.idleTimeoutCountdown=new G(31e3,(function(e,t){const n=parseInt(t/1e3);l()("#db-metaverse-idle-countdown").html(n)}),(function(){l()("#db-metaverse-idle").is(":visible")&&window.Events.dispatch("metaverse/idle-timeout-quit-button-click")})),window.idleTimeoutCountdown.start(),!1},"metaverse/start-metaverse-view":async function(){const e=window._channel.isAudioMuted(),t=window._channel.isVideoMuted();window.metaverse.setIdleTimeout((function(){window.Events.dispatch("metaverse/idle-timeout")}),p.METAVERSE_IDLE_TIMEOUT),l()("#chn-session-start-btn").hide(),l()("#rpchnhi").hide(),l()("#featuredImg").hide(),l()("#medias").html(""),l()("#medias").hide(),l()("#metaverse-area").html(`<iframe src="${window.metaverse.url}&flags=1&auth_token=${window.auth_token}&api_domain=${window.apiServer}&nick=${p.ENGINE_NICK.replace("-web","")}" class="w100 h100" allowvr="yes" allow="camera;microphone;display-capture;vr;speaker;"></iframe>`),window._channel.isOperator(p.ENGINE_NICK)&&window.metaverse.started&&l()("#rpchnyt").hide(),l()("#metaverse-area").show(),l()("#dbdev_cancel").click(),window._channel.getClosedCaption()&&l()("#media-cc").hide(),window._recorderCtrl.isStarted()&&0===window._channel.getType()&&l()("#record-option-stop").click(),window.metaverse.started=!0,window.metaverse.hideDevices(e,t),l()("#channelAdmUserList").click(),l()(".channelAdmChat").hide()},"metaverse/finish-metaverse-view":async function(){const e=window._engine.currentChannel(),t=window.breakoutRoom.getRoomType(e);let n={};n=1===window._channel.getType()?await window.rooms.getRoom(e):window._channel.getChannel(e),window.permissions.csm_session_create&&1===window._channel.getType()&&n.enable_csm?(window.Events.dispatch("session/show-session-start-btn"),l()("#rpchnhi").hide()):"meeting"!==t&&"nested"!==t&&l()("#rpchnhi").show();const i=window._engine.currentChannel(),s="nested"===window.breakoutRoom.getRoomType(i),o="room"===window.breakoutRoom.getRoomType(i),r="meeting"===window.breakoutRoom.getRoomType(i);!window._channel.isOperator(p.ENGINE_NICK)||s||o||r||l()("#rpchnyt").show(),l()("#medias").show(),l()("#metaverse-area").html(""),l()("#metaverse-area").hide(),window.metaverse.started=!1,window.metaverse.showDevices(),window._channel.getModes().A&&(window._channel.getMyMedia().length||yr(window.engineNick,!0,!1)),window._channel.getClosedCaption()&&l()("#media-cc").show(),"0"===await window._channel.isMetaverseFixed(window._engine.currentChannel())&&(l()(".channelAdmChat").show(),l()("#channelAdmChat").click()),window.metaverse.hideMetaverseModal()}};let Ea=!1;const xa=()=>{if(window._channel){if(0===window._channel.getMedias().length)return!1;!1===Ea?(l()("#user-transmitting-arrow").html("arrow_drop_down"),l()("#user-transmitting").show()):(l()("#user-transmitting-arrow").html("arrow_right"),l()("#user-transmitting").hide())}return!0};l()(".user-transmitting-label").on("click",(()=>{Ea=!Ea,xa()}));let ka=[],Ma={},Ta=[];const Ia=void xa(),Ra=class{constructor(){this._log=!0,this._connectionStatus={},this._connected=!1,this._name=""}set log(e){this._log=e}showLog(e){this._log&&(window.showLog?E(e):console.log(e))}set name(e){this.showLog(`[Channel] Setting name to ${e}`),this._name=e}get name(){return this.showLog(`[Channel] Getting name ${this._name}`),this._name}set connectionStatus(e){this.showLog(`[Channel] Setting connection status to ${JSON.stringify(e)}`),this._connectionStatus=e,this._connectionStatus.connected&&(this._connected=!0)}get connectionStatus(){return this.showLog(`[Channel] Getting connection status ${JSON.stringify(this._connectionStatus)}`),this._connectionStatus}reset(){this._connectionStatus={},this._connected=!1,this._channel=""}setUserList(e){return ka=e,Ma={},Ta=[],void ka.forEach((e=>{Ma[e.name]=e,Ta.push(e.name)}))}getUserList(){return(()=>{const e=[];for(let t=0;t<Ta.length;t+=1)e.push(Ma[Ta[t]]);return e})()}getUsers(){return Ta}getUser(e){return Ma[e]}setUser(e){return(e=>{const t=e,n=e.name;return!Ma.hasOwnProperty(n)&&(Ta.push(n),Ma[n]=t,!0)})(e)}unsetUser(e){return(e=>!!Ma.hasOwnProperty(e)&&(delete Ma[e],Ta=Ta.filter((t=>t!==e)),!0))(e)}resetUserList(){return ka=[],Ma={},void(Ta=[])}usersViewUpdate(){return Ia()}},Aa={...qr,...ea,...Ca,...Sa,"myheart/connect-cb":async function(){},"myheart/started-cb":async function(e){},"myheart/connection-status":async function(e=window._engine){const t=e.connectionStatus();return Ra.connectionStatus=t,t}},$a=class{static dispatch(e,t){if(Aa[e])return E(t?`[Event] Dispatched event: ${e} with payload: ${JSON.stringify(t)}`:`[Event] Dispatched event: ${e}`),document.dispatchEvent(new CustomEvent(e,{bubles:!0,detail:t})),Aa[e](t);E(`Event "${e}" not allowed!`)}static listen(e,t){document.addEventListener(e,t)}};class La{constructor(e,t,n,i,s){this.mType=e,this.mMsgFlags=t,this.mMediaId=n,this.mJanusCallbacks=i,this.mStateCallbacks=s,this.mPlugin="janus.plugin.irm",this.mHandle=null,this.mPendingSettings=null,this.mPendingCallbacks=null,this.mWebRtcUp=!1,this.mWebRtcReqTs=0,this.mWebRtcTimeoutMs=1e4,this.mStatsTimer=null;const o=s.inactivityTimeoutMs?s.inactivityTimeoutMs():this.mWebRtcTimeoutMs;this.mStatsCtrl=new Ba((e=>{this.mStateCallbacks.inboundRtpInactive&&this.mStateCallbacks.inboundRtpInactive(e)}),(()=>{this.mStateCallbacks.outboundRtpInactive&&this.mStateCallbacks.outboundRtpInactive(flag)}),o),this.mJanusCallbacks.onGetJanusObjCB().attach({plugin:this.mPlugin,opaqueId:`${this.mJanusCallbacks.onGetOpaqueIdCB()}:${this.mType}`,success:e=>{this.mHandle=e,Di.g.log(3,`JanusHandle : success : ${this.info()} :  ---------- Plugin attached ----------`),this.mStateCallbacks.success&&this.mStateCallbacks.success(),(this.mPendingSettings||this.mPendingCallbacks)&&(this.createOffer(this.mPendingSettings,this.mPendingCallbacks),this.mPendingSettings=null,this.mPendingCallbacks=null),this.setWebRtcReqTs()},error:e=>{Di.g.log(3,`JanusHandle : error : ${this.info()} : Could not attach plugin (${e})`)},consentDialog:e=>{Di.g.log(3,`JanusHandle : consentDialog : ${this.info()} : should be ${e?"on":"off"} now`),this.mStateCallbacks.consentDialog&&this.mStateCallbacks.consentDialog(e)},mediaState:(e,t)=>{Di.g.log(3,`JanusHandle : mediaState : ${this.info()} : ${t?"started":"stopped"} receiving our ${e}`),this.mStateCallbacks.mediaState&&this.mStateCallbacks.mediaState(e,t)},webrtcState:e=>{Di.g.log(3,`JanusHandle : webrtcState : ${this.info()} : PeerConnection is ${e?"up":"down"} now`),this.mWebRtcUp=e,e&&(this.setWebRtcReqTs(0),this.startStats()),this.mStateCallbacks.webrtcState&&this.mStateCallbacks.webrtcState(e)},slowLink:(e,t)=>{this.mStateCallbacks.slowLink&&this.mStateCallbacks.slowLink(e,t)},onmessage:(e,t)=>{Di.g.log(3,`JanusHandle : onmessage : ${this.info()}`),this.mStateCallbacks.onmessage&&this.mStateCallbacks.onmessage(e,t)},onlocalstream:e=>{Di.g.log(3,`JanusHandle : onlocalstream : ${this.info()}`),this.mStateCallbacks.onlocalstream&&this.mStateCallbacks.onlocalstream(e)},onremotestream:e=>{Di.g.log(3,`JanusHandle : onremotestream : ${this.info()}`),this.setWebRtcReqTs(),this.mStateCallbacks.onremotestream&&this.mStateCallbacks.onremotestream(e)},oncleanup:()=>{Di.g.log(3,`JanusHandle : oncleanup : ${this.info()}`),this.mStateCallbacks.oncleanup&&this.mStateCallbacks.oncleanup(),this.clearStats()},ontrackmuted:e=>{Di.g.log(3,`JanusHandle : ontrackmuted : ${this.info()}, readyState:${e.readyState}`),this.mStateCallbacks.ontrackmuted&&this.mStateCallbacks.ontrackmuted(e)},ontrackunmuted:e=>{Di.g.log(3,`JanusHandle : ontrackunmuted : ${this.info()}, readyState:${e.readyState}`),this.mStateCallbacks.ontrackunmuted&&this.mStateCallbacks.ontrackunmuted(e)}})}info(){let e=`type:${this.mType}`;return e=this.mHandle?`${e}, id:${this.mHandle.getId()} (${this.mHandle.getPlugin()})`:`${e} (null)`,this.mMediaId&&(e=`${e}, mediaId:${this.mMediaId}`),e}sendMessage(e,t){const n={message:{payload:e,flags:this.mMsgFlags}};null!=t&&(n.jsep=t),this.mHandle?this.mHandle.send(n):Di.g.log(3,`JanusHandle : ${this.info()} : cannot send message`)}createOffer(e,t){if(!this.mHandle)return this.mPendingSettings=e,void(this.mPendingCallbacks=t);this.mHandle.createOffer({media:e.media,simulcast:e.simulcast,success:e=>{t.oncreateoffersuccess&&t.oncreateoffersuccess(e)},error:e=>{t.oncreateoffererror&&t.oncreateoffererror(e)},videoSource:e.videoSource,audioSource:e.audioSource,videoTrackConstraints:e.videoTrackConstraints,stream:e.extStream})}createAnswer(e,t){this.mHandle.createAnswer({jsep:e.jsep,media:e.media,success:e=>{t.oncreateanswersuccess&&t.oncreateanswersuccess(e)},error:e=>{t.oncreateanswererror&&t.oncreateanswererror(e)}})}handleRemoteJsep(e){this.mHandle.handleRemoteJsep({jsep:e})}setWebRtcReqTs(e){this.mWebRtcReqTs=null!=e?e:Date.now()}webRtcTimeout(){return!this.mWebRtcUp&&0!=this.mWebRtcReqTs&&Date.now()-this.mWebRtcReqTs>this.mWebRtcTimeoutMs}isWebRTCUp(){return this.mWebRtcUp}started(){return null!=this.mHandle}isAudioMuted(){return this.mHandle.isAudioMuted()}muteAudio(){return this.mHandle.muteAudio()}unmuteAudio(){return this.mHandle.unmuteAudio()}isVideoMuted(){return this.mHandle.isVideoMuted()}muteVideo(){return this.mHandle.muteVideo()}unmuteVideo(){return this.mHandle.unmuteVideo()}setBitrate(e){this.sendMessage({request:"configure",bitrate:e})}getStats(){return this.mStatsCtrl.info()}iceState(){return this.mHandle.webrtcStuff.pc?this.mHandle.webrtcStuff.pc.iceConnectionState:null}hangup(){this.mHandle&&this.mHandle.hangup()}destroy(){this.mHandle&&this.mHandle.detach()}mediaId(){return this.mMediaId}type(){return this.mType}startStats(){this.mStatsTimer||(Di.g.log(3,`JanusHandle : startStats : ${this.info()}`),this.mStatsTimer=setInterval((()=>{const e=this.mHandle.webrtcStuff.pc;e&&e.getStats().then((e=>{this.mStatsCtrl.onStats(e),this.mJanusCallbacks.onStatsUpdate(this)}))}),1e3))}clearStats(){this.mStatsTimer&&(Di.g.log(3,`JanusHandle : clearStats : ${this.info()}`),clearInterval(this.mStatsTimer),this.mStatsTimer=null)}}class Pa extends La{constructor(e,t,n,i,s){s.success||(s.success=()=>{const e=this.mJanusCallbacks.onGetMyRoomCB(),t=this.mJanusCallbacks.onGetDisplayCB();this.sendMessage({request:"join",room:e,ptype:"publisher",display:t})}),s.onlocalstream||(s.onlocalstream=e=>{this.mMyStream=e,this.mJanusCallbacks.onLocalStreamCB(this,e)}),s.slowLink||(s.slowLink=(e,t)=>{this.mJanusCallbacks.onSlowLink(this)}),s.webrtcState||(s.webrtcState=e=>{this.mJanusCallbacks.onPublisherState(this)}),s.mediaState||(s.mediaState=(e,t)=>{t||this.mRepublish||!this.mMyStream||("audio"===e&&this.mMyStream.getAudioTracks().length>0||"video"===e&&this.mMyStream.getVideoTracks().length>0)&&this.mJanusCallbacks.onPublisherMediaStopped(this)}),super(e,t,n,i,s),this.mMyStream=null,this.mRepublish=!1,this.mRepublishTimeout=null,this.mScheduleRepublishWaitMs=300,this.mUnpublished=!1}isPublished(){return null!=this.mMyStream&&!this.mUnpublished}unpublish(){this.clearScheduleRepublish(),this.mMyStream&&this.isWebRTCUp()?(Di.g.log(3,"JanusPublisherBase : unpublish : unpublishing..."),this.mUnpublished=!0,this.sendMessage({request:"unpublish"})):Di.g.log(3,"JanusPublisherBase : unpublish : not published"),this.setWebRtcReqTs(0)}clearScheduleRepublish(){this.mRepublishTimeout&&(clearTimeout(this.mRepublishTimeout),this.mRepublishTimeout=null)}scheduleRepublish(e,t){const n=null!=t?t:this.mScheduleRepublishWaitMs;this.clearScheduleRepublish(),this.mRepublishTimeout=setTimeout((()=>{this.clearScheduleRepublish(),Di.g.log(3,"JanusPublisher : scheduleRepublish : republishing..."),e()}),n)}destroy(){this.sendMessage({request:"leave"}),super.destroy()}media(){return this.mMyStream?{type:this.mType,stream:this.mMyStream,id:this.mMediaId}:null}}class Da{constructor(e,t){this.mRTPAudio={last:null,lastRcvTs:0,bitrateKbps:0,active:!1},this.mRTPVideo={last:null,lastRcvTs:0,bitrateKbps:0,active:!1},this.mInactiveCB=e,this.mTimeoutMs=t,this.mInactive=!1}onStatsBegin(){if(0==this.mRTPAudio.lastRcvTs||0==this.mRTPVideo.lastRcvTs){const e=Date.now();0==this.mRTPAudio.lastRcvTs&&(this.mRTPAudio.lastRcvTs=e),0==this.mRTPVideo.lastRcvTs&&(this.mRTPVideo.lastRcvTs=e)}}handle(e){"audio"==e.kind?this.handleStream(this.mRTPAudio,e):"video"==e.kind&&this.handleStream(this.mRTPVideo,e)}onStatsEnd(){let e=!1,t=!1;const n=Date.now();n-this.mRTPAudio.lastRcvTs<this.mTimeoutMs&&(e=!0),n-this.mRTPVideo.lastRcvTs<this.mTimeoutMs&&(t=!0),this.mRTPAudio.active=!!(this.mRTPAudio.bitrateKbps>0&&e),this.mRTPVideo.active=!!(this.mRTPVideo.bitrateKbps>0&&t);const i=!e&&!t;i!=this.mInactive&&(this.mInactive=i,this.mInactiveCB(this.mInactive))}stats(){return{video:this.mRTPVideo,audio:this.mRTPAudio,bitrate:this.mRTPVideo.bitrateKbps+this.mRTPAudio.bitrateKbps}}}class Na extends Da{constructor(e,t){super(e,t)}handleStream(e,t){if(e.last){const n=e.last.bytesReceived;if(n!=t.bytesReceived){const i=e.last.timestamp,s=(t.timestamp-i)/1e3,o=Math.round(8*(t.bytesReceived-n)/1e3/s);e.bitrateKbps=o,e.lastRcvTs=Date.now()}}e.last=t}}class Oa extends Da{constructor(e,t){super(e,t)}handleStream(e,t){if(e.last){const n=e.last.bytesSent;if(n!=t.bytesSent){const i=e.last.timestamp,s=(t.timestamp-i)/1e3,o=Math.round(8*(t.bytesSent-n)/1e3/s);e.bitrateKbps=o,e.lastRcvTs=Date.now()}}e.last=t}}class Ba{constructor(e,t,n){this.mInboundRtp=new Na(e,n),this.mOutboundRtp=new Oa(t,n)}onStats(e){this.mInboundRtp.onStatsBegin(),this.mOutboundRtp.onStatsBegin(),e.forEach((e=>{if(e)switch(e.type){case"inbound-rtp":this.mInboundRtp.handle(e);break;case"outbound-rtp":this.mOutboundRtp.handle(e)}})),this.mInboundRtp.onStatsEnd(),this.mOutboundRtp.onStatsEnd()}info(){return{inbound:this.mInboundRtp.stats(),outbound:this.mOutboundRtp.stats()}}}const Fa="main";class Ua extends La{constructor(e){super(Fa,1,void 0,e,{success:()=>{this.mJanusCallbacks.onSuccessCB(this)},onmessage:(e,t)=>{const n=e.message;n&&this.mJanusCallbacks.onMessageCB(this,n,t)}})}static label(){return Fa}}class ja extends Pa{constructor(e){super("pub",2,void 0,e,{onmessage:(e,t)=>{this.handleOnMessageCB(e,t)},oncleanup:()=>{this.mCleanupIgnore?(Di.g.log(3,"JanusPublisher : ignoring cleanup..."),this.mCleanupIgnore=!1):(null!=this.mMyStream&&this.mJanusCallbacks.onCleanupCB(this),this.mRepublish&&(this.mRepublish=!1,Di.g.log(3,"JanusPublisher : oncleanup, scheduling republish..."),this.scheduleRepublish((()=>{this.doRepublish()})))),this.mMyStream=null}}),this.mMyId=null,this.mPublisherSettings={},this.mCleanupIgnore=!1}doRepublish(){this.publish(this.mPublisherSettings.mediaId,this.mPublisherSettings.bitrate,this.mPublisherSettings.useAudio,this.mPublisherSettings.useVideo,this.mPublisherSettings.videoSource,this.mPublisherSettings.audioSource,this.mPublisherSettings.videoPrefRes,this.mPublisherSettings.videoTrackConstraints,this.mPublisherSettings.extStream)}notifyRemoteFeeds(e){e.publishers.forEach((e=>{const t=e.mediaid,n=e.id,i=e.display,s=e.audio_codec,o=e.video_codec;Di.g.log(3,`JanusPublisher : mediaId:${t}, rfId:${n}, display:${i}, audio:${s}, video:${o}`),this.mJanusCallbacks.onNewRemoteFeedCB(this,n,t,i,s,o)}))}handleOnMessageCB(e,t){Di.g.log(3,"JanusPublisher : Got a message"),Di.g.log(3,e);const n=e.videoroom;if(Di.g.log(3,`JanusPublisher : Event:${n}`),null!=n&&null!=n)if("joined"===n)this.mMyId=e.id,Di.g.log(3,`JanusPublisher : Successfully joined room:${e.room}, id:${this.mMyId}`),void 0!==e.publishers&&null!==e.publishers&&(Di.g.log(3,"JanusPublisher : Joined : got a list of available publishers/feeds:"),this.notifyRemoteFeeds(e));else if("destroyed"===n)Di.g.log(3,"JanusPublisher : The room has been destroyed!");else if("event"===n)if(void 0!==e.publishers&&null!==e.publishers)Di.g.log(3,"JanusPublisher : Event : got a list of available publishers/feeds"),this.notifyRemoteFeeds(e);else if(void 0!==e.leaving&&null!==e.leaving){const t=e.leaving;Di.g.log(3,`JanusPublisher : Leaving : Publisher left:${t}`),this.mJanusCallbacks.onSubscriberDetachedCB(t)}else if(void 0!==e.unpublished&&null!==e.unpublished){const t=e.unpublished;if(Di.g.log(3,`JanusPublisher : Unpublished : Publisher left:${t}`),"ok"===t)return;this.mJanusCallbacks.onSubscriberDetachedCB(t)}else void 0!==e.error&&null!==e.error&&(426===e.error_code?Di.g.log(3,"JanusPublisher : Apparently room does not exist... "):Di.g.log(3,`JanusPublisher : Error : ${e.error}`));if(null!=t){Di.g.log(3,"JanusPublisher : Handling SDP as well..."),Di.g.log(3,t),this.handleRemoteJsep(t);const n=e.audio_codec;this.mMyStream&&this.mMyStream.getAudioTracks()&&this.mMyStream.getAudioTracks().length>0&&!n&&Di.g.log(3,"JanusPublisher : Our audio stream has been rejected, viewers won't hear us");const i=e.video_codec;this.mMyStream&&this.mMyStream.getVideoTracks()&&this.mMyStream.getVideoTracks().length>0&&!i&&Di.g.log(3,"JanusPublisher : Our video stream has been rejected, viewers won't see us")}this.mJanusCallbacks.onMessageCB(this,e,t)}publish(e,t,n,i,s,o,r,a,c){this.mUnpublished=!1;const l={mediaId:e,bitrate:t,useAudio:n,useVideo:i,media:{audioRecv:!1,videoRecv:!1,audioSend:n,videoSend:i},simulcast:!1,videoSource:s,audioSource:o,extStream:c,videoTrackConstraints:a};r&&(l.media.video=r),this.mMediaId=e,this.setWebRtcReqTs();const d={oncreateoffersuccess:s=>{const o={request:"configure",audio:n,video:i,bitrate:t,mediaid:e},r=this.mJanusCallbacks.onGetTxVideoCodecCB();r&&i&&(o.videocodec=r),this.sendMessage(o,s)},oncreateoffererror:e=>{Di.g.log(3,`JanusPublisher : oncreateoffererror : ${JSON.stringify(e)}`),this.mJanusCallbacks.onLocalStreamCB(this,null,e)}};this.createOffer(l,d),this.mPublisherSettings=l}restart(e){this.isPublished()?(Di.g.log(3,"publisher restart"),this.mRepublish=!0,this.mPublisherSettings.audioSource=e.audioSource?e.audioSource:null,this.mPublisherSettings.useAudio=e.useAudio,this.mPublisherSettings.videoSource=e.videoSource?e.videoSource:null,this.mPublisherSettings.useVideo=e.useVideo,this.mPublisherSettings.bitrate=e.bitrate,this.mPublisherSettings.videoPrefRes=e.videoPrefRes,this.mPublisherSettings.videoTrackConstraints=e.videoTrackConstraints,this.mPublisherSettings.extStream=e.extStream,this.unpublish(),this.setWebRtcReqTs()):Di.g.log(3,"JanusPublisher : publisher restart : ignoring, not published")}static label(){return"pub"}}const Va="screen";class Ga extends Pa{constructor(e,t,n,i,s){super(Va,2,e,s,{onmessage:(e,t)=>{const n=e.videoroom;null!=n&&null!=n&&"joined"===n&&this.mJanusCallbacks.onScreenSharingReadyCB()&&this.publish(),null!=t&&this.handleRemoteJsep(t)},consentDialog:e=>{e||this.setWebRtcReqTs()},oncleanup:()=>{null!=this.mMyStream&&(this.mJanusCallbacks.onCleanupCB(this),this.mMyStream=null),this.mRepublish&&(this.mRepublish=!1,Di.g.log(3,"JanusPublisherScreen : Republishing..."),this.publish())}}),this.mBitrate=t,this.mFramerate=n,this.mUseAudio=i}publish(){Di.g.log(3,"JanusPublisherScreen : publish"),this.mUnpublished=!1;const e={media:{video:"screen",audioSend:this.mUseAudio,captureDesktopAudio:this.mUseAudio,videoRecv:!1},simulcast:!1},t={oncreateoffersuccess:e=>{const t={request:"configure",audio:this.mUseAudio,video:!0,bitrate:this.mBitrate,screenshareFrameRate:this.mFramerate,mediaid:this.mMediaId},n=this.mJanusCallbacks.onGetTxVideoCodecCB();n&&(t.videocodec=n),this.sendMessage(t,e)},oncreateoffererror:e=>{Di.g.log(3,`JanusPublisherScreen : oncreateoffererror : ${JSON.stringify(e)}`),this.mJanusCallbacks.onLocalStreamCB(this,null,e)}};this.createOffer(e,t)}stop(){this.unpublish(),this.sendMessage({request:"leave"}),this.destroy()}restart(){this.mMyStream&&(this.mRepublish=!0,this.unpublish(),this.setWebRtcReqTs())}static label(){return Va}}class qa extends La{constructor(e,t,n,i,s,o,r){super("sub",2,t,r,{success:()=>{const t=this.mJanusCallbacks.onGetMyRoomCB(),n=this.mJanusCallbacks.onGetRxVideoCodecCB(),i={request:"join",room:t,ptype:"subscriber",feed:e,vcodec:n};this.sendMessage(i)},onmessage:(e,t)=>{const n=e.videoroom;if(void 0!==e.error&&null!==e.error)Di.g.log(3,`JanusSubscriber : Error : ${e.error}`);else if(null!=n&&null!=n&&"attached"===n){const t=e.id;t==this.mRfId?(this.mJanusCallbacks.onSubscriberAttachedCB(this),Di.g.log(3,`JanusSubscriber : Successfully attached to feed:${this.mRfId}, mediaId:${this.mMediaId}, rfDisplay:${this.mRfDisplay}, room:${e.room}`)):Di.g.log(3,`JanusSubscriber : Error Feed mismatch : mRefId:${this.mRfId} != rfId:${t}`)}if(null!=t){Di.g.log(3,"JanusSubscriber : Handling SDP as well..."),Di.g.log(3,t);const e={jsep:t,media:{audioSend:!1,videoSend:!1}},n={oncreateanswersuccess:e=>{Di.g.log(3,"JanusSubscriber : Got SDP!"),Di.g.log(3,e);const t=this.mJanusCallbacks.onGetMyRoomCB();this.sendMessage({request:"start",room:t},e)},oncreateanswererror:e=>{Di.g.log(3,`JanusSubscriber : WebRTC error:${e}`)}};this.createAnswer(e,n)}},onremotestream:e=>{this.mJanusCallbacks.onRemoteStreamCB(this,e)},oncleanup:()=>{Di.g.log(3,`JanusSubscriber : Got a cleanup notification : rfId:${this.mRfId}, mediaId:${this.mMediaId}`),this.mJanusCallbacks.onCleanupCB(this)},ontrackmuted:e=>{this.mJanusCallbacks.onTrackMutedCB(this,e)},ontrackunmuted:e=>{this.mJanusCallbacks.onTrackUnmutedCB(this,e)},inboundRtpInactive:e=>{Di.g.log(3,`JanusSubscriber : inboundRtpInactive : flag:${e}, info:${this.info()}`),this.mInactive=e},webrtcState:e=>{e||this.mJanusCallbacks.onSubscriberDown(this)},slowLink:(e,t)=>{this.mJanusCallbacks.onSlowLink(this)},inactivityTimeoutMs:()=>o||void 0===o?16e3:4e3}),this.mRfId=e,this.mRfDisplay=n,this.mAudio=i,this.mVideo=s,this.mScreen=o,this.mInactive=!1,this.mStatsAnalyser=new Ha,this.mCurrentTab=!0,this.setWebRtcReqTs()}rfId(){return this.mRfId}rfDisplay(){return this.mRfDisplay}audio(){return this.mAudio}video(){return this.mVideo}screen(){return this.mScreen}inactive(){return this.mInactive}info(){return`${super.info()}, rfId:${this.mRfId}`}checkVideoQuality(e){if(this.mCurrentTab){const t=this.getStats();if(!t.inbound.video.active)return void this.mStatsAnalyser.clear();this.mStatsAnalyser.push(t.inbound.video.last),this.mStatsAnalyser.isBadRx(3e3)&&this.mStatsAnalyser.isBadRx(6e3)&&this.mStatsAnalyser.isBadRx(9e3)&&e()}}notifyCurrentTab(e){this.mCurrentTab=e,this.mCurrentTab||this.mStatsAnalyser.clear()}static label(){return"sub"}}class Ha{constructor(e=1e4,t=.2,n=10,i=.5,s=.25){this.mMaxLenMs=e,this.mPacketsLostPercThreshold=t,this.mPacketsLostCountThreshold=n,this.mPacketsRetransmittedThreshold=i,this.mPacketsRequestedThreshold=s,this.mStats=[]}push(e){if(!e)return;let t=this.mStats.length,n=t>0?this.mStats[0]:void 0,i=t>0?this.mStats[t-1]:void 0;if(!n||!i||e!=i&&e.timestamp!=i.timestamp)if(t>0&&e.timestamp<i.timestamp)this.clear(),this.mStats.push(e);else{this.mStats.push(e),n||(n=e);let i=e.timestamp-n.timestamp;for(;t>1&&i>this.mMaxLenMs;)this.mStats.shift(),n=this.mStats[0],t=this.mStats.length,i=e.timestamp-n.timestamp}}isBadRx(e){const t=[...this.mStats],n=t.length;if(n<2)return!1;let i=t[0];const s=t[n-1];if(s.timestamp-i.timestamp<e)return!1;for(;t.length>2&&s.timestamp-i.timestamp>e;)t.shift(),i=t[0];const o=s.packetsReceived-i.packetsReceived,r=s.packetsLost-i.packetsLost;if(o>0&&r>this.mPacketsLostCountThreshold&&r/o>this.mPacketsLostPercThreshold)return Di.g.log(3,`StatsAnalyser : isBadRx(${e}) : packetsLost:${r}, packetsReceived:${o}, ratio:${r/o}`),!0;if(null!=s.retransmittedPacketsReceived){const t=s.nackCount-i.nackCount,n=s.retransmittedPacketsReceived-i.retransmittedPacketsReceived;if(t>0&&t/o>this.mPacketsRequestedThreshold&&n/t<this.mPacketsRetransmittedThreshold)return Di.g.log(3,`StatsAnalyser : isBadRx(${e}) : (2) packetsRequested:${t}, packetsReceived:${o}, ratio:${t/o}, packetsRetransmited:${n} ratio:${n/t}`),!0}return!1}clear(){this.mStats=[]}}function za(){return za=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},za.apply(null,arguments)}let Wa=!0,Ja=!0;function Ya(e,t,n){const i=e.match(t);return i&&i.length>=n&&parseInt(i[n],10)}function Ka(e,t,n){if(!e.RTCPeerConnection)return;const i=e.RTCPeerConnection.prototype,s=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return s.apply(this,arguments);const o=e=>{const t=n(e);t&&(i.handleEvent?i.handleEvent(t):i(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(i,o),s.apply(this,[e,o])};const o=i.removeEventListener;i.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(n))return o.apply(this,arguments);const i=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,i])},Object.defineProperty(i,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function Xa(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Wa=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function Za(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Ja=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function Qa(){if("object"==typeof window){if(Wa)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function ec(e,t){Ja&&console.warn(e+" is deprecated, please use "+t+" instead.")}function tc(e){return"[object Object]"===Object.prototype.toString.call(e)}function nc(e){return tc(e)?Object.keys(e).reduce((function(t,n){const i=tc(e[n]),s=i?nc(e[n]):e[n],o=i&&!Object.keys(s).length;return void 0===s||o?t:za(t,{[n]:s})}),{}):e}function ic(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((i=>{i.endsWith("Id")?ic(e,e.get(t[i]),n):i.endsWith("Ids")&&t[i].forEach((t=>{ic(e,e.get(t),n)}))})))}function sc(e,t,n){const i=n?"outbound-rtp":"inbound-rtp",s=new Map;if(null===t)return s;const o=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((t=>{e.forEach((n=>{n.type===i&&n.trackId===t.id&&ic(e,n,s)}))})),s}const oc=Qa;function rc(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const i=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach((n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const i="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);const s=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];let e={};"number"==typeof i.ideal?(e[s("min",n)]=i.ideal,t.optional.push(e),e={},e[s("max",n)]=i.ideal,t.optional.push(e)):(e[s("",n)]=i.ideal,t.optional.push(e))}void 0!==i.exact&&"number"!=typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[s("",n)]=i.exact):["min","max"].forEach((e=>{void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[s(e,n)]=i[e])}))})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},s=function(e,s){if(t.version>=61)return s(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=i(e.audio)}if(e&&"object"==typeof e.video){let o=e.video.facingMode;o=o&&("object"==typeof o?o:{ideal:o});const r=t.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||r)){let t;if(delete e.video.facingMode,"environment"===o.exact||"environment"===o.ideal?t=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(t=["front"]),t)return n.mediaDevices.enumerateDevices().then((n=>{let r=(n=n.filter((e=>"videoinput"===e.kind))).find((e=>t.some((t=>e.label.toLowerCase().includes(t)))));return!r&&n.length&&t.includes("back")&&(r=n[n.length-1]),r&&(e.video.deviceId=o.exact?{exact:r.deviceId}:{ideal:r.deviceId}),e.video=i(e.video),oc("chrome: "+JSON.stringify(e)),s(e)}))}e.video=i(e.video)}return oc("chrome: "+JSON.stringify(e)),s(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,i){s(e,(e=>{n.webkitGetUserMedia(e,t,(e=>{i&&i(o(e))}))}))}.bind(n),n.mediaDevices.getUserMedia){const e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return s(t,(t=>e(t).then((e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return e}),(e=>Promise.reject(o(e))))))}}}function ac(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((t=>{const i=n.video&&n.video.width,s=n.video&&n.video.height,o=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},i&&(n.video.mandatory.maxWidth=i),s&&(n.video.mandatory.maxHeight=s),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function cc(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function lc(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",(n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.track.id)):{track:n.track};const s=new Event("track");s.track=n.track,s.receiver=i,s.transceiver={receiver:i},s.streams=[t.stream],this.dispatchEvent(s)})),t.stream.getTracks().forEach((n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.id)):{track:n};const s=new Event("track");s.track=n,s.receiver=i,s.transceiver={receiver:i},s.streams=[t.stream],this.dispatchEvent(s)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else Ka(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function dc(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){let s=n.apply(this,arguments);return s||(s=t(this,e),this._senders.push(s)),s};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){i.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach((e=>{this._senders.push(t(this,e))}))};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((e=>{const t=this._senders.find((t=>t.track===e));t&&this._senders.splice(this._senders.indexOf(t),1)}))}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function uc(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,n,i]=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof e))return t.apply(this,[]);const s=function(e){const t={};return e.result().forEach((e=>{const n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((t=>{n[t]=e.stat(t)})),t[n.id]=n})),t},o=function(e){return new Map(Object.keys(e).map((t=>[t,e[t]])))};if(arguments.length>=2){const i=function(e){n(o(s(e)))};return t.apply(this,[i,e])}return new Promise(((e,n)=>{t.apply(this,[function(t){e(o(s(t)))},n])})).then(n,i)}}function hc(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>sc(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),Ka(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>sc(t,e.track,!1)))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,i;return this.getSenders().forEach((n=>{n.track===e&&(t?i=!0:t=n)})),this.getReceivers().forEach((t=>(t.track===e&&(n?i=!0:n=t),t.track===e))),i||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function pc(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((e=>this._shimmedLocalStreams[e][0]))};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const i=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(i)&&this._shimmedLocalStreams[n.id].push(i):this._shimmedLocalStreams[n.id]=[n,i],i};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((e=>{const t=this.getSenders().find((t=>t.track===e));if(t)throw new DOMException("Track already exists.","InvalidAccessError")}));const t=this.getSenders();n.apply(this,arguments);const i=this.getSenders().filter((e=>-1===t.indexOf(e)));this._shimmedLocalStreams[e.id]=[e].concat(i)};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],i.apply(this,arguments)};const s=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]})),s.apply(this,arguments)}}function mc(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return pc(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((e=>this._reverseStreams[e.id]))};const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((e=>{const t=this.getSenders().find((t=>t.track===e));if(t)throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}i.apply(this,[t])};const s=e.RTCPeerConnection.prototype.removeStream;function o(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const i=e._reverseStreams[t],s=e._streams[i.id];n=n.replace(new RegExp(s.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},s.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");const s=this.getSenders().find((e=>e.track===t));if(s)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const o=this._streams[n.id];if(o)o.addTrack(t),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const i=new e.MediaStream([t]);this._streams[n.id]=i,this._reverseStreams[i.id]=n,this.addStream(i)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[t=>{const n=o(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then((e=>o(this,e)))}};e.RTCPeerConnection.prototype[t]=i[t]}));const r=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const i=e._reverseStreams[t],s=e._streams[i.id];n=n.replace(new RegExp(i.id,"g"),s.id)})),new RTCSessionDescription({type:t.type,sdp:n})}(this,arguments[0]),r.apply(this,arguments)):r.apply(this,arguments)};const a=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=a.get.apply(this);return""===e.type?e:o(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach((n=>{this._streams[n].getTracks().find((t=>e.track===t))&&(t=this._streams[n])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function wc(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]}))}function gc(e,t){Ka(e,"negotiationneeded",(e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e}))}function fc(e,t){const n=e&&e.navigator,i=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,i){ec("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"==typeof n&&"object"==typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},i&&i.prototype.getSettings){const t=i.prototype.getSettings;i.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(i&&i.prototype.applyConstraints){const t=i.prototype.applyConstraints;i.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"==typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function vc(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}function bc(){return bc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},bc.apply(null,arguments)}function _c(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function yc(e,t){if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]}));const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,s,o]=arguments;return i.apply(this,[e||null]).then((e=>{if(t.version<53&&!s)try{e.forEach((e=>{e.type=n[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach(((t,i)=>{e.set(i,bc({},t,{type:n[t.type]||t.type}))}))}return e})).then(s,o)}}function Cc(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Sc(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),Ka(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Ec(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){ec("removeStream","removeTrack"),this.getSenders().forEach((t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)}))})}function xc(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function kc(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let e=arguments[1]&&arguments[1].sendEncodings;void 0===e&&(e=[]),e=[...e];const n=e.length>0;n&&e.forEach((e=>{if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const i=t.apply(this,arguments);if(n){const{sender:t}=i,n=t.getParameters();(!("encodings"in n)||1===n.encodings.length&&0===Object.keys(n.encodings[0]).length)&&(n.encodings=e,t.sendEncodings=e,this.setParametersPromises.push(t.setParameters(n).then((()=>{delete t.sendEncodings})).catch((()=>{delete t.sendEncodings}))))}return i})}function Mc(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function Tc(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function Ic(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function Rc(){return Rc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Rc.apply(null,arguments)}function Ac(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((n=>t.call(this,n,e))),e.getVideoTracks().forEach((n=>t.call(this,n,e)))},e.RTCPeerConnection.prototype.addTrack=function(e,...n){return n&&n.forEach((e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach((e=>{n.includes(e.track)&&this.removeTrack(e)}))})}}function $c(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach((e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)}))})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}))}),t.apply(e,arguments)}}}function Lc(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,i=t.createAnswer,s=t.setLocalDescription,o=t.setRemoteDescription,r=t.addIceCandidate;t.createOffer=function(e,t){const i=arguments.length>=2?arguments[2]:arguments[0],s=n.apply(this,[i]);return t?(s.then(e,t),Promise.resolve()):s},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],s=i.apply(this,[n]);return t?(s.then(e,t),Promise.resolve()):s};let a=function(e,t,n){const i=s.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i};t.setLocalDescription=a,a=function(e,t,n){const i=o.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.setRemoteDescription=a,a=function(e,t,n){const i=r.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.addIceCandidate=a}function Pc(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(Dc(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,i){t.mediaDevices.getUserMedia(e).then(n,i)}.bind(t))}function Dc(e){return e&&void 0!==e.video?Rc({},e,{video:nc(e.video)}):e}function Nc(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let i=e.iceServers[n];void 0===i.urls&&i.url?(ec("RTCIceServer.url","RTCIceServer.urls"),i=JSON.parse(JSON.stringify(i)),i.urls=i.url,delete i.url,t.push(i)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function Oc(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Bc(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function Fc(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var Uc=n(541),jc=n.n(Uc);function Vc(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substring(2)),e.candidate&&e.candidate.length){const n=new t(e),i=jc().parseCandidate(e.candidate);for(const e in i)e in n||Object.defineProperty(n,e,{value:i[e]});return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,Ka(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}function Gc(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||Ka(e,"icecandidate",(e=>{if(e.candidate){const t=jc().parseCandidate(e.candidate.candidate);"relay"===t.type&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e}))}function qc(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;const t=jc().splitSections(e.sdp);return t.shift(),t.some((e=>{const t=jc().parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){const e=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!=n?-1:n}(arguments[0]),n=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n}(e),i=function(e,n){let i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);const s=jc().matchPrefix(e.sdp,"a=max-message-size:");return s.length>0?i=parseInt(s[0].substring(19),10):"firefox"===t.browser&&-1!==n&&(i=2147483637),i}(arguments[0],e);let s;s=0===n&&0===i?Number.POSITIVE_INFINITY:0===n||0===i?Math.max(n,i):Math.min(n,i);const o={};Object.defineProperty(o,"maxMessageSize",{get:()=>s}),this._sctp=o}return n.apply(this,arguments)}}function Hc(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const i=arguments[0],s=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&s>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},Ka(e,"datachannel",(e=>(t(e.channel,e.target),e)))}function zc(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}function Wc(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const n=t.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==e.trim())).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return n.apply(this,arguments)}}function Jc(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Yc(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.setLocalDescription;n&&0!==n.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let e=arguments[0]||{};if("object"!=typeof e||e.type&&e.sdp)return n.apply(this,arguments);if(e={type:e.type,sdp:e.sdp},!e.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}return e.sdp||"offer"!==e.type&&"answer"!==e.type?n.apply(this,[e]):("offer"===e.type?this.createOffer:this.createAnswer).apply(this).then((e=>n.apply(this,[e])))})}const Kc=function({window:e}={},t={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const n=Qa,a=function(e){const t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.mozGetUserMedia)t.browser="firefox",t.version=Ya(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=Ya(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=Ya(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),c={browserDetails:a,commonShim:r,extractVersion:Ya,disableLog:Xa,disableWarnings:Za,sdp:Uc};switch(a.browser){case"chrome":if(!i||!wc||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),c;if(null===a.version)return n("Chrome shim can not determine version, not shimming."),c;n("adapter.js shimming chrome."),c.browserShim=i,Jc(e,a),Yc(e),rc(e,a),cc(e),wc(e,a),lc(e),mc(e,a),dc(e),uc(e),hc(e),gc(e,a),Vc(e),Gc(e),zc(e),qc(e,a),Hc(e),Wc(e,a);break;case"firefox":if(!s||!yc||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),c;n("adapter.js shimming firefox."),c.browserShim=s,Jc(e,a),Yc(e),fc(e,a),yc(e,a),_c(e),Ec(e),Cc(e),Sc(e),xc(e),kc(e),Mc(e),Tc(e),Ic(e),Vc(e),zc(e),qc(e,a),Hc(e);break;case"safari":if(!o||!t.shimSafari)return n("Safari shim is not included in this adapter release."),c;n("adapter.js shimming safari."),c.browserShim=o,Jc(e,a),Yc(e),Nc(e),Bc(e),Lc(e),Ac(e),$c(e),Oc(e),Pc(e),Fc(e),Vc(e),Gc(e),qc(e,a),Hc(e),Wc(e,a);break;default:n("Unsupported browser!")}return c}({window:"undefined"==typeof window?void 0:window}),Xc=Kc;el.version="1.0.5",el.sessions={};const Zc=!1;el.isExtensionEnabled=function(){if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return!0;if(window.navigator.userAgent.match("Chrome")){var e=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),t=33;return window.navigator.userAgent.match("Linux")&&(t=35),e>=26&&e<=t||el.extension.isInstalled()}return!0};var Qc={extensionId:"hapfgfdkleiggjjpfpenajgdnfckjpaj",isInstalled:function(){return null!==document.querySelector("#janus-extension-installed")},getScreen:function(e){var t=window.setTimeout((function(){var t=new Error("NavigatorUserMediaError");return t.name="The required Chrome extension is not installed (Janus WebRTC Screensharing)",e(t)}),1e3);this.cache[t]=e,window.postMessage({type:"janusGetScreen",id:t},"*")},init:function(){var e={};this.cache=e,window.addEventListener("message",(function(t){if(t.origin==window.location.origin)if("janusGotScreen"==t.data.type&&e[t.data.id]){var n=e[t.data.id];if(delete e[t.data.id],""===t.data.sourceId){var i=new Error("NavigatorUserMediaError");i.name="You cancelled the request for permission, giving up...",n(i)}else n(null,t.data.sourceId)}else"janusGetScreenPending"==t.data.type&&(console.log("clearing ",t.data.id),window.clearTimeout(t.data.id))}))}};function el(e){if((e=e||{}).success="function"==typeof e.success?e.success:el.noop,e.error="function"==typeof e.error?e.error:el.noop,e.connectionFailed="function"==typeof e.connectionFailed?e.connectionFailed:el.noop,e.connectionClosed="function"==typeof e.connectionClosed?e.connectionClosed:el.noop,e.destroyed="function"==typeof e.destroyed?e.destroyed:el.noop,!el.initDone)return e.error("Library not initialized"),{};if(!el.isWebrtcSupported())return e.error("WebRTC not supported by this browser"),{};if(el.log("Library initialized: "+el.initDone),!e.server)return e.error("Invalid server url"),{};var t=!1,n=null,i={},s=null,o=null,r=0,a=e.server;el.isArray(a)?(el.log("Multiple servers provided ("+a.length+"), will use the first that works"),a=null,o=e.server,el.debug(o)):0===a.indexOf("ws")?(t=!0,el.log("Using WebSockets to contact Janus: "+a)):(t=!1,el.log("Using REST API to contact Janus: "+a));var c=e.iceServers||[{urls:"stun:stun.l.google.com:19302"}],l=e.iceTransportPolicy,d=e.bundlePolicy,u=!0===e.ipv6,h=!1;void 0!==e.withCredentials&&null!==e.withCredentials&&(h=!0===e.withCredentials);var p=10;void 0!==e.max_poll_events&&null!==e.max_poll_events&&(p=e.max_poll_events),p<1&&(p=1);var m=null;void 0!==e.token&&null!==e.token&&(m=e.token);var w=null;void 0!==e.apisecret&&null!==e.apisecret&&(w=e.apisecret),this.destroyOnUnload=!0,void 0!==e.destroyOnUnload&&null!==e.destroyOnUnload&&(this.destroyOnUnload=!0===e.destroyOnUnload);var g=25e3;void 0!==e.keepAlivePeriod&&null!==e.keepAlivePeriod&&(g=e.keepAlivePeriod),isNaN(g)&&(g=25e3);var f=6e4;function v(e){var t={high:9e5,medium:3e5,low:1e5};return null!=e&&(e.high&&(t.high=e.high),e.medium&&(t.medium=e.medium),e.low&&(t.low=e.low)),t}void 0!==e.longPollTimeout&&null!==e.longPollTimeout&&(f=e.longPollTimeout),isNaN(f)&&(f=6e4);var b=!1,_=null,y={},C=this,S=0,E={};function x(){if(null!=_)if(el.debug("Long poll..."),b){var t=a+"/"+_+"?rid="+(new Date).getTime();p&&(t=t+"&maxev="+p),m&&(t=t+"&token="+encodeURIComponent(m)),w&&(t=t+"&apisecret="+encodeURIComponent(w)),el.httpAPICall(t,{verb:"GET",withCredentials:h,success:k,timeout:f,error:function(t,n){if(el.error(t+":",n),++S>3)return b=!1,void e.error("Lost connection to the server (is it down?)");x()}})}else el.warn("Is the server down? (connected=false)")}function k(e,i){if(S=0,t||null==_||!0===i||x(),t||!el.isArray(e))if("keepalive"!==e.janus)if("server_info"!==e.janus)if("ack"!==e.janus)if("success"!==e.janus)if("trickle"===e.janus){const t=e.sender;if(!t)return void el.warn("Missing sender...");const n=y[t];if(!n)return void el.debug("This handle is not attached to this session");var s=e.candidate;el.debug("Got a trickled candidate on session "+_),el.debug(s);var o=n.webrtcStuff;o.pc&&o.remoteSdp?(el.debug("Adding remote candidate:",s),s&&!0!==s.completed?o.pc.addIceCandidate(s):o.pc.addIceCandidate(el.endOfCandidates)):(el.debug("We didn't do setRemoteDescription (trickle got here before the offer?), caching candidate"),o.candidates||(o.candidates=[]),o.candidates.push(s),el.debug(o.candidates))}else{if("webrtcup"===e.janus){el.debug("Got a webrtcup event on session "+_),el.debug(e);const t=e.sender;if(!t)return void el.warn("Missing sender...");const n=y[t];return n?void n.webrtcState(!0):void el.debug("This handle is not attached to this session")}if("hangup"===e.janus){el.debug("Got a hangup event on session "+_),el.debug(e);const t=e.sender;if(!t)return void el.warn("Missing sender...");const n=y[t];if(!n)return void el.debug("This handle is not attached to this session");n.webrtcState(!1,e.reason),n.hangup()}else if("detached"===e.janus){el.debug("Got a detached event on session "+_),el.debug(e);const t=e.sender;if(!t)return void el.warn("Missing sender...");const n=y[t];if(!n)return;n.ondetached(),n.detach()}else if("media"===e.janus){el.debug("Got a media event on session "+_),el.debug(e);const t=e.sender;if(!t)return void el.warn("Missing sender...");const n=y[t];if(!n)return void el.debug("This handle is not attached to this session");n.mediaState(e.type,e.receiving)}else if("slowlink"===e.janus){el.debug("Got a slowlink event on session "+_),el.debug(e);const t=e.sender;if(!t)return void el.warn("Missing sender...");const n=y[t];if(!n)return void el.debug("This handle is not attached to this session");n.slowLink(e.uplink,e.lost)}else{if("error"===e.janus){el.error("Ooops: "+e.error.code+" "+e.error.reason),el.debug(e);var r=e.transaction;if(r){var a=E[r];a&&a(e),delete E[r]}return}if("event"===e.janus){el.debug("Got a plugin event on session "+_),el.debug(e);const t=e.sender;if(!t)return void el.warn("Missing sender...");var c=e.plugindata;if(!c)return void el.warn("Missing plugindata...");el.debug("  -- Event is coming from "+t+" ("+c.plugin+")");var l=c.data;el.debug(l);const n=y[t];if(!n)return void el.warn("This handle is not attached to this session");var d=e.jsep;d&&(el.debug("Handling SDP as well..."),el.debug(d));var u=n.onmessage;u?(el.debug("Notifying application..."),u(l,d)):el.debug("No provided notification callback")}else{if("timeout"===e.janus)return el.error("Timeout on session "+_),el.debug(e),void(t&&n.close(3504,"Gateway timeout"));el.warn("Unknown message/event  '"+e.janus+"' on session "+_),el.debug(e)}}}else{el.debug("Got a success on session "+_),el.debug(e);const t=e.transaction;if(t){const n=E[t];n&&n(e),delete E[t]}}else{el.debug("Got an ack on session "+_),el.debug(e);const t=e.transaction;if(t){const n=E[t];n&&n(e),delete E[t]}}else{el.debug("Got info on the Janus instance"),el.debug(e);const t=e.transaction;if(t){const n=E[t];n&&n(e),delete E[t]}}else el.vdebug("Got a keepalive on session "+_);else for(var h=0;h<e.length;h++)k(e[h],!0)}function M(e,t){const n=JSON.stringify(t);Zc&&el.log(`Send Message:\n${n}`),e.send(n)}function T(){if(a&&t&&b){s=setTimeout(T,g);var e={janus:"keepalive",session_id:_,transaction:el.randomString(12)};m&&(e.token=m),w&&(e.apisecret=w),M(n,e)}}function I(c){var l=el.randomString(12),d={janus:"create",transaction:l};if(c.reconnect&&(b=!1,d.janus="claim",d.session_id=_,n&&(n.onopen=null,n.onerror=null,n.onclose=null,s&&(clearTimeout(s),s=null))),m&&(d.token=m),w&&(d.apisecret=w),!a&&el.isArray(o)&&(0===(a=o[r]).indexOf("ws")?(t=!0,el.log("Server #"+(r+1)+": trying WebSockets to contact Janus ("+a+")")):(t=!1,el.log("Server #"+(r+1)+": trying REST API to contact Janus ("+a+")"))),t)for(var u in n=el.newWebSocket(a,"janus-protocol"),i={error:function(){if(el.error("Error connecting to the Janus WebSockets server... "+a),el.isArray(o)&&!c.reconnect)return++r===o.length?(c.error("Error connecting to any of the provided Janus servers: Is the server down?"),void c.connectionFailed()):(a=null,void setTimeout((function(){I(c)}),200));c.error("Error connecting to the Janus WebSockets server: Is the server down?"),c.connectionFailed()},open:function(){E[l]=function(e){if(el.debug(e),"success"!==e.janus)return el.error("Ooops: "+e.error.code+" "+e.error.reason),void c.error(e.error.reason);s=setTimeout(T,g),b=!0,_=e.session_id?e.session_id:e.data.id,c.reconnect?el.log("Claimed session: "+_):el.log("Created session: "+_),el.sessions[_]=C,c.success()},M(n,d)},message:function(e){Zc&&el.log(`Message Received:\n${e.data}`),k(JSON.parse(e.data))},close:function(){a&&b&&(b=!1,e.error("Lost connection to the server (is it down?)"),c.connectionClosed())}})n.addEventListener(u,i[u]);else el.httpAPICall(a,{verb:"POST",withCredentials:h,body:d,success:function(e){if(el.debug(e),"success"!==e.janus)return el.error("Ooops: "+e.error.code+" "+e.error.reason),void c.error(e.error.reason);b=!0,_=e.session_id?e.session_id:e.data.id,c.reconnect?el.log("Claimed session: "+_):el.log("Created session: "+_),el.sessions[_]=C,x(),c.success()},error:function(e,t){if(el.error(e+":",t),el.isArray(o)&&!c.reconnect)return++r===o.length?void c.error("Error connecting to any of the provided Janus servers: Is the server down?"):(a=null,void setTimeout((function(){I(c)}),200));""===t?c.error(e+": Is the server down?"):c.error(e+": "+t)}})}function R(e,i){if((i=i||{}).success="function"==typeof i.success?i.success:el.noop,i.error="function"==typeof i.error?i.error:el.noop,!b)return el.warn("Is the server down? (connected=false)"),void i.error("Is the server down? (connected=false)");var s=y[e];if(!s||!s.webrtcStuff)return el.warn("Invalid handle"),void i.error("Invalid handle");var o=i.message,r=i.jsep,c=el.randomString(12),l={janus:"message",body:o,transaction:c};if(s.token&&(l.token=s.token),w&&(l.apisecret=w),r&&(l.jsep={type:r.type,sdp:r.sdp},r.e2ee&&(l.jsep.e2ee=!0),"hml"!==r.rid_order&&"lmh"!==r.rid_order||(l.jsep.rid_order=r.rid_order),r.force_relay&&(l.jsep.force_relay=!0)),el.debug("Sending message to plugin (handle="+e+"):"),el.debug(l),t)return l.session_id=_,l.handle_id=e,E[c]=function(e){if(el.debug("Message sent!"),el.debug(e),"success"===e.janus){var t=e.plugindata;if(!t)return el.warn("Request succeeded, but missing plugindata..."),void i.success();el.log("Synchronous transaction successful ("+t.plugin+")");var n=t.data;return el.debug(n),void i.success(n)}"ack"===e.janus?i.success():e.error?(el.error("Ooops: "+e.error.code+" "+e.error.reason),i.error(e.error.code+" "+e.error.reason)):(el.error("Unknown error"),i.error("Unknown error"))},void M(n,l);el.httpAPICall(a+"/"+_+"/"+e,{verb:"POST",withCredentials:h,body:l,success:function(e){if(el.debug("Message sent!"),el.debug(e),"success"===e.janus){var t=e.plugindata;if(!t)return el.warn("Request succeeded, but missing plugindata..."),void i.success();el.log("Synchronous transaction successful ("+t.plugin+")");var n=t.data;return el.debug(n),void i.success(n)}"ack"===e.janus?i.success():e.error?(el.error("Ooops: "+e.error.code+" "+e.error.reason),i.error(e.error.code+" "+e.error.reason)):(el.error("Unknown error"),i.error("Unknown error"))},error:function(e,t){el.error(e+":",t),i.error(e+": "+t)}})}function A(e,i){if(b){var s=y[e];if(s&&s.webrtcStuff){var o={janus:"trickle",candidate:i,transaction:el.randomString(12)};if(s.token&&(o.token=s.token),w&&(o.apisecret=w),el.vdebug("Sending trickle candidate (handle="+e+"):"),el.vdebug(o),t)return o.session_id=_,o.handle_id=e,void M(n,o);el.httpAPICall(a+"/"+_+"/"+e,{verb:"POST",withCredentials:h,body:o,success:function(e){el.vdebug("Candidate sent!"),el.vdebug(e),"ack"===e.janus||el.error("Ooops: "+e.error.code+" "+e.error.reason)},error:function(e,t){el.error(e+":",t)}})}else el.warn("Invalid handle")}else el.warn("Is the server down? (connected=false)")}function $(e,t,n,i,s){var o=y[e];if(o&&o.webrtcStuff){var r=o.webrtcStuff;if(r.pc){var a=function(e){el.log("Received state change on data channel:",e);var t=e.target.label,n=e.target.protocol,i=r.dataChannel[t]?r.dataChannel[t].readyState:"null";if(el.log("State change on <"+t+"> data channel: "+i),"open"===i){if(r.dataChannel[t].pending&&r.dataChannel[t].pending.length>0){for(var s of(el.log("Sending pending messages on <"+t+">:",r.dataChannel[t].pending.length),r.dataChannel[t].pending))el.log("Sending data on data channel <"+t+">"),el.debug(s),r.dataChannel[t].send(s);r.dataChannel[t].pending=[]}o.ondataopen(t,n)}};if(i)r.dataChannel[t]=i;else{var c={ordered:!0};n&&(c.protocol=n),r.dataChannel[t]=r.pc.createDataChannel(t,c)}r.dataChannel[t].onmessage=function(e){el.log("Received message on data channel:",e);var t=e.target.label;o.ondata(e.data,t)},r.dataChannel[t].onopen=a,r.dataChannel[t].onclose=a,r.dataChannel[t].onerror=function(e){el.error("Got error on data channel:",e)},r.dataChannel[t].pending=[],s&&r.dataChannel[t].pending.push(s)}else el.warn("Invalid PeerConnection")}else el.warn("Invalid handle")}function L(e,t){(t=t||{}).success="function"==typeof t.success?t.success:el.noop,t.error="function"==typeof t.error?t.error:el.noop;var n=y[e];if(!n||!n.webrtcStuff)return el.warn("Invalid handle"),void t.error("Invalid handle");var i=n.webrtcStuff,s=t.text||t.data;if(!s)return el.warn("Invalid data"),void t.error("Invalid data");var o=t.label?t.label:el.dataChanDefaultLabel;return i.dataChannel[o]?"open"!==i.dataChannel[o].readyState?(i.dataChannel[o].pending.push(s),void t.success()):(el.log("Sending data on data channel <"+o+">"),el.debug(s),i.dataChannel[o].send(s),void t.success()):($(e,o,t.protocol,!1,s,t.protocol),void t.success())}function P(e,t){(t=t||{}).success="function"==typeof t.success?t.success:el.noop,t.error="function"==typeof t.error?t.error:el.noop;var n=y[e];if(!n||!n.webrtcStuff)return el.warn("Invalid handle"),void t.error("Invalid handle");var i=n.webrtcStuff;if(!i.dtmfSender){if(i.pc){var s=i.pc.getSenders().find((function(e){return e.track&&"audio"===e.track.kind}));if(!s)return el.warn("Invalid DTMF configuration (no audio track)"),void t.error("Invalid DTMF configuration (no audio track)");i.dtmfSender=s.dtmf,i.dtmfSender&&(el.log("Created DTMF Sender"),i.dtmfSender.ontonechange=function(e){el.debug("Sent DTMF tone: "+e.tone)})}if(!i.dtmfSender)return el.warn("Invalid DTMF configuration"),void t.error("Invalid DTMF configuration")}var o=t.dtmf;if(!o)return el.warn("Invalid DTMF parameters"),void t.error("Invalid DTMF parameters");var r=o.tones;if(!r)return el.warn("Invalid DTMF string"),void t.error("Invalid DTMF string");var a="number"==typeof o.duration?o.duration:500,c="number"==typeof o.gap?o.gap:50;el.debug("Sending DTMF string "+r+" (duration "+a+"ms, gap "+c+"ms)"),i.dtmfSender.insertDTMF(r,a,c),t.success()}function D(e,i){(i=i||{}).success="function"==typeof i.success?i.success:el.noop,i.error="function"==typeof i.error?i.error:el.noop;var s=!0===i.noRequest;el.log("Destroying handle "+e+" (only-locally="+s+")"),H(e);var o=y[e];if(!o||o.detached)return delete y[e],void i.success();if(o.detached=!0,s)return delete y[e],void i.success();if(!b)return el.warn("Is the server down? (connected=false)"),void i.error("Is the server down? (connected=false)");var r={janus:"detach",transaction:el.randomString(12)};if(o.token&&(r.token=o.token),w&&(r.apisecret=w),t)return r.session_id=_,r.handle_id=e,M(n,r),delete y[e],void i.success();el.httpAPICall(a+"/"+_+"/"+e,{verb:"POST",withCredentials:h,body:r,success:function(t){el.log("Destroyed handle:"),el.debug(t),"success"!==t.janus&&el.error("Ooops: "+t.error.code+" "+t.error.reason),delete y[e],i.success()},error:function(t,n){el.error(t+":",n),delete y[e],i.success()}})}function N(e,t,n,i,s){var o=y[e];if(!o||!o.webrtcStuff)return el.warn("Invalid handle"),i.stream||el.stopAllTracks(s),void i.error("Invalid handle");var r=o.webrtcStuff;el.debug("streamsDone:",s),s&&(el.debug("  -- Audio tracks:",s.getAudioTracks()),el.debug("  -- Video tracks:",s.getVideoTracks()));var a=!1;if(r.myStream&&n.update&&(!r.streamExternal||n.replaceAudio||n.replaceVideo)){if((!n.update&&z(n)||n.update&&(n.addAudio||n.replaceAudio))&&s.getAudioTracks()&&s.getAudioTracks().length)if(r.myStream.addTrack(s.getAudioTracks()[0]),el.unifiedPlan){el.log((n.replaceAudio?"Replacing":"Adding")+" audio track:",s.getAudioTracks()[0]);var h=null;const e=r.pc.getTransceivers();if(e&&e.length>0)for(const t of e)if(t.sender&&t.sender.track&&"audio"===t.sender.track.kind||t.receiver&&t.receiver.track&&"audio"===t.receiver.track.kind){h=t;break}h&&h.sender?h.sender.replaceTrack(s.getAudioTracks()[0]):r.pc.addTrack(s.getAudioTracks()[0],s)}else el.log((n.replaceAudio?"Replacing":"Adding")+" audio track:",s.getAudioTracks()[0]),r.pc.addTrack(s.getAudioTracks()[0],s);if((!n.update&&J(n)||n.update&&(n.addVideo||n.replaceVideo))&&s.getVideoTracks()&&s.getVideoTracks().length)if(r.myStream.addTrack(s.getVideoTracks()[0]),el.unifiedPlan){el.log((n.replaceVideo?"Replacing":"Adding")+" video track:",s.getVideoTracks()[0]);var p=null;const e=r.pc.getTransceivers();if(e&&e.length>0)for(const t of e)if(t.sender&&t.sender.track&&"video"===t.sender.track.kind||t.receiver&&t.receiver.track&&"video"===t.receiver.track.kind){p=t;break}p&&p.sender?p.sender.replaceTrack(s.getVideoTracks()[0]):r.pc.addTrack(s.getVideoTracks()[0],s)}else el.log((n.replaceVideo?"Replacing":"Adding")+" video track:",s.getVideoTracks()[0]),r.pc.addTrack(s.getVideoTracks()[0],s)}else r.myStream=s,a=!0;if(!r.pc){var m={iceServers:c,iceTransportPolicy:l,bundlePolicy:d};"chrome"===el.webRTCAdapter.browserDetails.browser&&(m.sdpSemantics=el.webRTCAdapter.browserDetails.version<72?"plan-b":"unified-plan");var w={optional:[{DtlsSrtpKeyAgreement:!0}]};if(u&&w.optional.push({googIPv6:!0}),i.rtcConstraints&&"object"==typeof i.rtcConstraints)for(var g in el.debug("Adding custom PeerConnection constraints:",i.rtcConstraints),i.rtcConstraints)w.optional.push(i.rtcConstraints[g]);"edge"===el.webRTCAdapter.browserDetails.browser&&(m.bundlePolicy="max-bundle"),RTCRtpSender&&(RTCRtpSender.prototype.createEncodedStreams||RTCRtpSender.prototype.createEncodedAudioStreams&&RTCRtpSender.prototype.createEncodedVideoStreams)&&(i.senderTransforms||i.receiverTransforms)&&(r.senderTransforms=i.senderTransforms,r.receiverTransforms=i.receiverTransforms,m.forceEncodedAudioInsertableStreams=!0,m.forceEncodedVideoInsertableStreams=!0,m.encodedInsertableStreams=!0),el.log("Creating PeerConnection"),el.debug(w),r.pc=new RTCPeerConnection(m,w),el.debug(r.pc),r.pc.getStats&&(r.volume={},r.bitrate.value="0 kbits/sec"),el.log("Preparing local SDP and gathering candidates (trickle="+r.trickle+")"),r.pc.oniceconnectionstatechange=function(){r.pc&&o.iceState(r.pc.iceConnectionState)},r.pc.onicecandidate=function(t){if(!t.candidate||"edge"===el.webRTCAdapter.browserDetails.browser&&t.candidate.candidate.indexOf("endOfCandidates")>0)el.log("End of candidates."),r.iceDone=!0,!0===r.trickle?A(e,{completed:!0}):function(e,t){(t=t||{}).success="function"==typeof t.success?t.success:el.noop,t.error="function"==typeof t.error?t.error:el.noop;var n=y[e];if(n&&n.webrtcStuff){var i=n.webrtcStuff;el.log("Sending offer/answer SDP..."),i.mySdp?(i.mySdp={type:i.pc.localDescription.type,sdp:i.pc.localDescription.sdp},!1===i.trickle&&(i.mySdp.trickle=!1),el.debug(t),i.sdpSent=!0,t.success(i.mySdp)):el.warn("Local SDP instance is invalid, not sending anything...")}else el.warn("Invalid handle, not sending anything")}(e,i);else{var n={candidate:t.candidate.candidate,sdpMid:t.candidate.sdpMid,sdpMLineIndex:t.candidate.sdpMLineIndex};!0===r.trickle&&A(e,n)}},r.pc.ontrack=function(e){if(el.log("Handling Remote Track"),el.debug(e),e.streams&&(r.remoteStream=e.streams[0],o.onremotestream(r.remoteStream),!e.track.onended)){if(r.receiverTransforms){var t=null;RTCRtpSender.prototype.createEncodedStreams?t=e.receiver.createEncodedStreams():(RTCRtpSender.prototype.createAudioEncodedStreams||RTCRtpSender.prototype.createEncodedVideoStreams)&&("audio"===e.track.kind&&r.receiverTransforms.audio?t=e.receiver.createEncodedAudioStreams():"video"===e.track.kind&&r.receiverTransforms.video&&(t=e.receiver.createEncodedVideoStreams())),t&&(console.log(t),t.readableStream&&t.writableStream?t.readableStream.pipeThrough(r.receiverTransforms[e.track.kind]).pipeTo(t.writableStream):t.readable&&t.writable&&t.readable.pipeThrough(r.receiverTransforms[e.track.kind]).pipeTo(t.writable))}var n=null;el.log("Adding onended callback to track:",e.track),e.track.onended=function(e){el.log("Remote track removed:",e),r.remoteStream&&(clearTimeout(n),r.remoteStream.removeTrack(e.target),o.onremotestream(r.remoteStream))},e.track.onmute=function(e){r.remoteStream&&null==n&&(n=setTimeout((function(){o.ontrackmuted(e.target),n=null}),4e3))},e.track.onunmute=function(e){if(null!=n)clearTimeout(n),n=null;else try{o.ontrackunmuted(e.target)}catch(e){el.error(e)}}}}}if(a&&s){el.log("Adding local stream");var f=!0===i.simulcast2;s.getTracks().forEach((function(e){el.log("Adding local track:",e);var t=null;if(f&&"audio"!==e.kind){el.log("Enabling rid-based simulcasting:",e);var n=v(i.simulcastMaxBitrates),o=r.pc.addTransceiver(e,{direction:"sendrecv",streams:[s],sendEncodings:i.sendEncodings||[{rid:"h",active:!0,maxBitrate:n.high},{rid:"m",active:!0,maxBitrate:n.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:n.low,scaleResolutionDownBy:4}]});o&&(t=o.sender)}else t=r.pc.addTrack(e,s);if(t&&r.senderTransforms){var a=null;RTCRtpSender.prototype.createEncodedStreams?a=t.createEncodedStreams():(RTCRtpSender.prototype.createAudioEncodedStreams||RTCRtpSender.prototype.createEncodedVideoStreams)&&("audio"===t.track.kind&&r.senderTransforms.audio?a=t.createEncodedAudioStreams():"video"===t.track.kind&&r.senderTransforms.video&&(a=t.createEncodedVideoStreams())),a&&(console.log(a),a.readableStream&&a.writableStream?a.readableStream.pipeThrough(r.senderTransforms[t.track.kind]).pipeTo(a.writableStream):a.readable&&a.writable&&a.readable.pipeThrough(r.senderTransforms[t.track.kind]).pipeTo(a.writable))}}))}(function(e){return el.debug("isDataEnabled:",e),"edge"===el.webRTCAdapter.browserDetails.browser?(el.warn("Edge doesn't support data channels yet"),!1):null!=e&&!0===e.data})(n)&&!r.dataChannel[el.dataChanDefaultLabel]&&(el.log("Creating default data channel"),$(e,el.dataChanDefaultLabel,null,!1),r.pc.ondatachannel=function(t){el.log("Data channel created by Janus:",t),$(e,t.channel.label,t.channel.protocol,t.channel)}),r.myStream&&o.onlocalstream(r.myStream),t?r.pc.setRemoteDescription(t).then((function(){if(el.log("Remote description accepted!"),r.remoteSdp=t.sdp,r.candidates&&r.candidates.length>0){for(var s=0;s<r.candidates.length;s++){var o=r.candidates[s];el.debug("Adding remote candidate:",o),o&&!0!==o.completed?r.pc.addIceCandidate(o):r.pc.addIceCandidate(el.endOfCandidates)}r.candidates=[]}!function(e,t,n){(n=n||{}).success="function"==typeof n.success?n.success:el.noop,n.error="function"==typeof n.error?n.error:el.noop,n.customizeSdp="function"==typeof n.customizeSdp?n.customizeSdp:el.noop;var i=y[e];if(!i||!i.webrtcStuff)return el.warn("Invalid handle"),void n.error("Invalid handle");var s=i.webrtcStuff,o=!0===n.simulcast;o?el.log("Creating answer (iceDone="+s.iceDone+", simulcast="+o+")"):el.log("Creating answer (iceDone="+s.iceDone+")");var r=null;if(el.unifiedPlan){r={};var a=null,c=null,l=s.pc.getTransceivers();if(l&&l.length>0)for(var d of l)d.sender&&d.sender.track&&"audio"===d.sender.track.kind||d.receiver&&d.receiver.track&&"audio"===d.receiver.track.kind?a||(a=d):(d.sender&&d.sender.track&&"video"===d.sender.track.kind||d.receiver&&d.receiver.track&&"video"===d.receiver.track.kind)&&(c||(c=d));var u=z(t),h=W(t);if(u||h){if(u&&h){if(a)try{a.setDirection?a.setDirection("sendrecv"):a.direction="sendrecv",el.log("Setting audio transceiver to sendrecv:",a)}catch(e){el.error(e)}}else if(u&&!h)try{a&&(a.setDirection?a.setDirection("sendonly"):a.direction="sendonly",el.log("Setting audio transceiver to sendonly:",a))}catch(e){el.error(e)}else if(!u&&h)if(a)try{a.setDirection?a.setDirection("recvonly"):a.direction="recvonly",el.log("Setting audio transceiver to recvonly:",a)}catch(e){el.error(e)}else a=s.pc.addTransceiver("audio",{direction:"recvonly"}),el.log("Adding recvonly audio transceiver:",a)}else if(t.removeAudio&&a)try{a.setDirection?a.setDirection("inactive"):a.direction="inactive",el.log("Setting audio transceiver to inactive:",a)}catch(e){el.error(e)}var p=J(t),m=Y(t);if(p||m){if(p&&m){if(c)try{c.setDirection?c.setDirection("sendrecv"):c.direction="sendrecv",el.log("Setting video transceiver to sendrecv:",c)}catch(e){el.error(e)}}else if(p&&!m){if(c)try{c.setDirection?c.setDirection("sendonly"):c.direction="sendonly",el.log("Setting video transceiver to sendonly:",c)}catch(e){el.error(e)}}else if(!p&&m)if(c)try{c.setDirection?c.setDirection("recvonly"):c.direction="recvonly",el.log("Setting video transceiver to recvonly:",c)}catch(e){el.error(e)}else c=s.pc.addTransceiver("video",{direction:"recvonly"}),el.log("Adding recvonly video transceiver:",c)}else if(t.removeVideo&&c)try{c.setDirection?c.setDirection("inactive"):c.direction="inactive",el.log("Setting video transceiver to inactive:",c)}catch(e){el.error(e)}}else r="firefox"===el.webRTCAdapter.browserDetails.browser||"edge"===el.webRTCAdapter.browserDetails.browser?{offerToReceiveAudio:W(t),offerToReceiveVideo:Y(t)}:{mandatory:{OfferToReceiveAudio:W(t),OfferToReceiveVideo:Y(t)}};el.debug(r);var w=J(t);if(w&&o&&"firefox"===el.webRTCAdapter.browserDetails.browser){el.log("Enabling Simulcasting for Firefox (RID)");var g=s.pc.getSenders()[1];el.log(g);var f=g.getParameters();el.log(f);var b=v(n.simulcastMaxBitrates);g.setParameters({encodings:n.sendEncodings||[{rid:"h",active:!0,maxBitrate:b.high},{rid:"m",active:!0,maxBitrate:b.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:b.low,scaleResolutionDownBy:4}]})}s.pc.createAnswer(r).then((function(e){el.debug(e);var t={type:e.type,sdp:e.sdp};n.customizeSdp(t),e.sdp=t.sdp,el.log("Setting local description"),w&&o&&("chrome"===el.webRTCAdapter.browserDetails.browser?el.warn("simulcast=true, but this is an answer, and video breaks in Chrome if we enable it"):"firefox"!==el.webRTCAdapter.browserDetails.browser&&el.warn("simulcast=true, but this is not Chrome nor Firefox, ignoring")),s.mySdp={type:"answer",sdp:e.sdp},s.pc.setLocalDescription(e).catch(n.error),s.mediaConstraints=r,s.iceDone||s.trickle?((s.senderTransforms||s.receiverTransforms)&&(e.e2ee=!0),n.success(e)):el.log("Waiting for all candidates...")}),n.error)}(e,n,i)}),i.error):function(e,t,n){(n=n||{}).success="function"==typeof n.success?n.success:el.noop,n.error="function"==typeof n.error?n.error:el.noop,n.customizeSdp="function"==typeof n.customizeSdp?n.customizeSdp:el.noop;var i=y[e];if(!i||!i.webrtcStuff)return el.warn("Invalid handle"),void n.error("Invalid handle");var s=i.webrtcStuff,o=!0===n.simulcast;o?el.log("Creating offer (iceDone="+s.iceDone+", simulcast="+o+")"):el.log("Creating offer (iceDone="+s.iceDone+")");var r={};if(el.unifiedPlan){var a=null,c=null,l=s.pc.getTransceivers();if(l&&l.length>0)for(var d of l)d.sender&&d.sender.track&&"audio"===d.sender.track.kind||d.receiver&&d.receiver.track&&"audio"===d.receiver.track.kind?a||(a=d):(d.sender&&d.sender.track&&"video"===d.sender.track.kind||d.receiver&&d.receiver.track&&"video"===d.receiver.track.kind)&&(c||(c=d));var u=z(t),h=W(t);u||h?u&&h?a&&(a.setDirection?a.setDirection("sendrecv"):a.direction="sendrecv",el.log("Setting audio transceiver to sendrecv:",a)):u&&!h?a&&(a.setDirection?a.setDirection("sendonly"):a.direction="sendonly",el.log("Setting audio transceiver to sendonly:",a)):!u&&h&&(a?(a.setDirection?a.setDirection("recvonly"):a.direction="recvonly",el.log("Setting audio transceiver to recvonly:",a)):(a=s.pc.addTransceiver("audio",{direction:"recvonly"}),el.log("Adding recvonly audio transceiver:",a))):t.removeAudio&&a&&(a.setDirection?a.setDirection("inactive"):a.direction="inactive",el.log("Setting audio transceiver to inactive:",a));var p=J(t),m=Y(t);p||m?p&&m?c&&(c.setDirection?c.setDirection("sendrecv"):c.direction="sendrecv",el.log("Setting video transceiver to sendrecv:",c)):p&&!m?c&&(c.setDirection?c.setDirection("sendonly"):c.direction="sendonly",el.log("Setting video transceiver to sendonly:",c)):!p&&m&&(c?(c.setDirection?c.setDirection("recvonly"):c.direction="recvonly",el.log("Setting video transceiver to recvonly:",c)):(c=s.pc.addTransceiver("video",{direction:"recvonly"}),el.log("Adding recvonly video transceiver:",c))):t.removeVideo&&c&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive",el.log("Setting video transceiver to inactive:",c))}else r.offerToReceiveAudio=W(t),r.offerToReceiveVideo=Y(t);!0===n.iceRestart&&(r.iceRestart=!0),el.debug(r);var w=J(t);if(w&&o&&"firefox"===el.webRTCAdapter.browserDetails.browser){el.log("Enabling Simulcasting for Firefox (RID)");var g=s.pc.getSenders().find((function(e){return e.track&&"video"===e.track.kind}));if(g){var f=g.getParameters();f||(f={});var b=v(n.simulcastMaxBitrates);f.encodings=n.sendEncodings||[{rid:"h",active:!0,maxBitrate:b.high},{rid:"m",active:!0,maxBitrate:b.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:b.low,scaleResolutionDownBy:4}],g.setParameters(f)}}s.pc.createOffer(r).then((function(e){el.debug(e);var t={type:e.type,sdp:e.sdp};n.customizeSdp(t),e.sdp=t.sdp,el.log("Setting local description"),w&&o&&("chrome"===el.webRTCAdapter.browserDetails.browser||"safari"===el.webRTCAdapter.browserDetails.browser?(el.log("Enabling Simulcasting for Chrome (SDP munging)"),e.sdp=function(e){var t=e.split("\r\n"),n=!1,i=[-1],s=[-1],o=null,r=null,a=null,c=null,l=-1;for(let h=0;h<t.length;h++){const p=t[h].match(/m=(\w+) */);if(p){if("video"===p[1]){if(!(i[0]<0)){l=h;break}n=!0}else if(i[0]>-1){l=h;break}}else if(n){if(t[h].match(/a=ssrc-group:SIM (\d+) (\d+) (\d+)/))return el.warn("The SDP already contains a SIM attribute, munging will be skipped"),e;var d=t[h].match(/a=ssrc-group:FID (\d+) (\d+)/);if(d)i[0]=d[1],s[0]=d[2],t.splice(h,1),h--;else{if(i[0]){var u=t[h].match("a=ssrc:"+i[0]+" cname:(.+)");if(u&&(o=u[1]),(u=t[h].match("a=ssrc:"+i[0]+" msid:(.+)"))&&(r=u[1]),(u=t[h].match("a=ssrc:"+i[0]+" mslabel:(.+)"))&&(a=u[1]),(u=t[h].match("a=ssrc:"+i[0]+" label:(.+)"))&&(c=u[1]),0===t[h].indexOf("a=ssrc:"+s[0])){t.splice(h,1),h--;continue}if(0===t[h].indexOf("a=ssrc:"+i[0])){t.splice(h,1),h--;continue}}0!=t[h].length||(t.splice(h,1),h--)}}}if(i[0]<0){l=-1,n=!1;for(let e=0;e<t.length;e++){const d=t[e].match(/m=(\w+) */);if(d){if("video"===d[1]){if(!(i[0]<0)){l=e;break}n=!0}else if(i[0]>-1){l=e;break}}else if(n){if(i[0]<0){var h=t[e].match(/a=ssrc:(\d+)/);if(h){i[0]=h[1],t.splice(e,1),e--;continue}}else{let n=t[e].match("a=ssrc:"+i[0]+" cname:(.+)");if(n&&(o=n[1]),n=t[e].match("a=ssrc:"+i[0]+" msid:(.+)"),n&&(r=n[1]),n=t[e].match("a=ssrc:"+i[0]+" mslabel:(.+)"),n&&(a=n[1]),n=t[e].match("a=ssrc:"+i[0]+" label:(.+)"),n&&(c=n[1]),0===t[e].indexOf("a=ssrc:"+s[0])){t.splice(e,1),e--;continue}if(0===t[e].indexOf("a=ssrc:"+i[0])){t.splice(e,1),e--;continue}}0!==t[e].length||(t.splice(e,1),e--)}}}if(i[0]<0)return el.warn("Couldn't find the video SSRC, simulcasting NOT enabled"),e;l<0&&(l=t.length),i[1]=Math.floor(4294967295*Math.random()),i[2]=Math.floor(4294967295*Math.random()),s[1]=Math.floor(4294967295*Math.random()),s[2]=Math.floor(4294967295*Math.random());for(var p=0;p<i.length;p++)o&&(t.splice(l,0,"a=ssrc:"+i[p]+" cname:"+o),l++),r&&(t.splice(l,0,"a=ssrc:"+i[p]+" msid:"+r),l++),a&&(t.splice(l,0,"a=ssrc:"+i[p]+" mslabel:"+a),l++),c&&(t.splice(l,0,"a=ssrc:"+i[p]+" label:"+c),l++),o&&(t.splice(l,0,"a=ssrc:"+s[p]+" cname:"+o),l++),r&&(t.splice(l,0,"a=ssrc:"+s[p]+" msid:"+r),l++),a&&(t.splice(l,0,"a=ssrc:"+s[p]+" mslabel:"+a),l++),c&&(t.splice(l,0,"a=ssrc:"+s[p]+" label:"+c),l++);return t.splice(l,0,"a=ssrc-group:FID "+i[2]+" "+s[2]),t.splice(l,0,"a=ssrc-group:FID "+i[1]+" "+s[1]),t.splice(l,0,"a=ssrc-group:FID "+i[0]+" "+s[0]),t.splice(l,0,"a=ssrc-group:SIM "+i[0]+" "+i[1]+" "+i[2]),(e=t.join("\r\n")).endsWith("\r\n")||(e+="\r\n"),e}(e.sdp)):"firefox"!==el.webRTCAdapter.browserDetails.browser&&el.warn("simulcast=true, but this is not Chrome nor Firefox, ignoring")),s.mySdp={type:"offer",sdp:e.sdp},s.pc.setLocalDescription(e).catch(n.error),s.mediaConstraints=r,s.iceDone||s.trickle?((s.senderTransforms||s.receiverTransforms)&&(e.e2ee=!0),n.success(e)):el.log("Waiting for all candidates...")}),n.error)}(e,n,i)}function O(e,t,n){(n=n||{}).success="function"==typeof n.success?n.success:el.noop,n.error="function"==typeof n.error?n.error:q;var i=n.jsep;if(t&&i)return el.error("Provided a JSEP to a createOffer"),void n.error("Provided a JSEP to a createOffer");if(!(t||i&&i.type&&i.sdp))return el.error("A valid JSEP is required for createAnswer"),void n.error("A valid JSEP is required for createAnswer");n.media="object"==typeof n.media&&n.media?n.media:{audio:!0,video:!0};var s=n.media,o=y[e];if(!o||!o.webrtcStuff)return el.warn("Invalid handle"),void n.error("Invalid handle");var r,a=o.webrtcStuff;if(a.trickle=(r=n.trickle,el.debug("isTrickleEnabled:",r),!1!==r),a.pc){if(el.log("Updating existing media session"),s.update=!0,n.stream)n.stream!==a.myStream&&el.log("Renegotiation involves a new external stream");else{if(s.addAudio){if(s.keepAudio=!1,s.replaceAudio=!1,s.removeAudio=!1,s.audioSend=!0,a.myStream&&a.myStream.getAudioTracks()&&a.myStream.getAudioTracks().length)return el.error("Can't add audio stream, there already is one"),void n.error("Can't add audio stream, there already is one")}else s.removeAudio?(s.keepAudio=!1,s.replaceAudio=!1,s.addAudio=!1,s.audioSend=!1):s.replaceAudio&&(s.keepAudio=!1,s.addAudio=!1,s.removeAudio=!1,s.audioSend=!0);if(a.myStream&&a.myStream.getAudioTracks()&&0!==a.myStream.getAudioTracks().length?!z(s)||s.removeAudio||s.replaceAudio||(s.keepAudio=!0):(s.replaceAudio&&(s.keepAudio=!1,s.replaceAudio=!1,s.addAudio=!0,s.audioSend=!0),z(s)&&(s.keepAudio=!1,s.addAudio=!0)),s.addVideo){if(s.keepVideo=!1,s.replaceVideo=!1,s.removeVideo=!1,s.videoSend=!0,a.myStream&&a.myStream.getVideoTracks()&&a.myStream.getVideoTracks().length)return el.error("Can't add video stream, there already is one"),void n.error("Can't add video stream, there already is one")}else s.removeVideo?(s.keepVideo=!1,s.replaceVideo=!1,s.addVideo=!1,s.videoSend=!1):s.replaceVideo&&(s.keepVideo=!1,s.addVideo=!1,s.removeVideo=!1,s.videoSend=!0);a.myStream&&a.myStream.getVideoTracks()&&0!==a.myStream.getVideoTracks().length?!J(s)||s.removeVideo||s.replaceVideo||(s.keepVideo=!0):(s.replaceVideo&&(s.keepVideo=!1,s.replaceVideo=!1,s.addVideo=!0,s.videoSend=!0),J(s)&&(s.keepVideo=!1,s.addVideo=!0)),s.addData&&(s.data=!0)}if(z(s)&&s.keepAudio&&J(s)&&s.keepVideo)return o.consentDialog(!1),void N(e,i,s,n,a.myStream)}else s.update=!1,s.keepAudio=!1,s.keepVideo=!1;if(s.update&&(!a.streamExternal||a.streamExternal&&(s.replaceAudio||s.replaceVideo))){if(s.removeAudio||s.replaceAudio){if(a.myStream&&a.myStream.getAudioTracks()&&a.myStream.getAudioTracks().length){var c=a.myStream.getAudioTracks()[0];el.log("Removing audio track:",c),a.myStream.removeTrack(c);try{c.stop()}catch(e){}}if(a.pc.getSenders()&&a.pc.getSenders().length){var l=!0;if(s.replaceAudio&&el.unifiedPlan&&(l=!1),l)for(var d of a.pc.getSenders())d&&d.track&&"audio"===d.track.kind&&(el.log("Removing audio sender:",d),a.pc.removeTrack(d))}}if(s.removeVideo||s.replaceVideo){if(a.myStream&&a.myStream.getVideoTracks()&&a.myStream.getVideoTracks().length){var u=a.myStream.getVideoTracks()[0];el.log("Removing video track:",u),a.myStream.removeTrack(u);try{u.stop()}catch(e){}}if(a.pc.getSenders()&&a.pc.getSenders().length){var h=!0;if(s.replaceVideo&&el.unifiedPlan&&(h=!1),h)for(var p of a.pc.getSenders())p&&p.track&&"video"===p.track.kind&&(el.log("Removing video sender:",p),a.pc.removeTrack(p))}}}if(n.stream){var m=n.stream;return el.log("MediaStream provided by the application"),el.debug(m),!s.update||!a.myStream||a.myStream===n.stream||a.streamExternal||s.replaceAudio||s.replaceVideo||(el.stopAllTracks(a.myStream),a.myStream=null),a.streamExternal=!0,o.consentDialog(!1),void N(e,i,s,n,m)}if(z(s)||J(s)){if(!el.isGetUserMediaAvailable())return void n.error("getUserMedia not available");var w={mandatory:{},optional:[]};o.consentDialog(!0);var g=z(s);g&&s&&"object"==typeof s.audio&&(g=s.audio);var f=J(s);if(f&&s){var v=!0===n.simulcast,b=!0===n.simulcast2;if(!v&&!b||i||s.video||(s.video="hires"),s.video&&"screen"!=s.video&&"window"!=s.video)if("object"==typeof s.video)f=s.video;else{var _=0,C=0;"lowres"===s.video?(C=240,_=320):"lowres-16:9"===s.video?(C=180,_=320):"hires"===s.video||"hires-16:9"===s.video||"hdres"===s.video?(C=720,_=1280):"fhdres"===s.video?(C=1080,_=1920):"4kres"===s.video?(C=2160,_=3840):"stdres"===s.video?(C=480,_=640):"stdres-16:9"===s.video?(C=360,_=640):(el.log("Default video setting is stdres 4:3"),C=480,_=640),el.log("Adding media constraint:",s.video),f={height:{ideal:C},width:{ideal:_}},el.log("Adding video constraint:",f)}else if("screen"===s.video||"window"===s.video){if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return w.video={},s.screenshareFrameRate&&(w.video.frameRate=s.screenshareFrameRate),s.screenshareHeight&&(w.video.height=s.screenshareHeight),s.screenshareWidth&&(w.video.width=s.screenshareWidth),w.audio=s.captureDesktopAudio,void navigator.mediaDevices.getDisplayMedia(w).then((function(t){o.consentDialog(!1),z(s)&&s.screenUseAudioInput?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(o){t.addTrack(o.getAudioTracks()[0]),N(e,i,s,n,t)})):N(e,i,s,n,t)}),(function(e){o.consentDialog(!1),n.error(e)}));const t=function(t,r){o.consentDialog(!1),t?n.error(t):N(e,i,s,n,r)},r=function(e,t,n){el.log("Adding media constraint (screen capture)"),el.debug(e),navigator.mediaDevices.getUserMedia(e).then((function(e){n?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(n){e.addTrack(n.getAudioTracks()[0]),t(null,e)})):t(null,e)})).catch((function(e){o.consentDialog(!1),t(e)}))};if("chrome"===el.webRTCAdapter.browserDetails.browser){var S=el.webRTCAdapter.browserDetails.version,E=33;window.navigator.userAgent.match("Linux")&&(E=35),S>=26&&S<=E?(w={video:{mandatory:{googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:s.screenshareFrameRate,maxFrameRate:s.screenshareFrameRate,chromeMediaSource:"screen"}},audio:z(s)&&!s.keepAudio},r(w,t)):el.extension.getScreen((function(e,i){if(e)return o.consentDialog(!1),n.error(e);(w={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:s.screenshareFrameRate,maxFrameRate:s.screenshareFrameRate},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}}).video.mandatory.chromeMediaSourceId=i,r(w,t,z(s)&&!s.keepAudio)}))}else if("firefox"===el.webRTCAdapter.browserDetails.browser){if(!(el.webRTCAdapter.browserDetails.version>=33)){var x=new Error("NavigatorUserMediaError");return x.name="Your version of Firefox does not support screen sharing, please install Firefox 33 (or more recent versions)",o.consentDialog(!1),void n.error(x)}w={video:{mozMediaSource:s.video,mediaSource:s.video},audio:z(s)&&!s.keepAudio},r(w,(function(e,n){if(t(e,n),!e)var i=n.currentTime,s=window.setInterval((function(){n||window.clearInterval(s),n.currentTime==i&&(window.clearInterval(s),n.onended&&n.onended()),i=n.currentTime}),500)}))}return}}s&&"screen"===s.video||navigator.mediaDevices.enumerateDevices().then((function(t){var r=t.some((function(e){return"audioinput"===e.kind})),a=function(e){if(el.debug("isScreenSendEnabled:",e),!e)return!1;if("object"!=typeof e.video||"object"!=typeof e.video.mandatory)return!1;var t=e.video.mandatory;return t.chromeMediaSource?"desktop"===t.chromeMediaSource||"screen"===t.chromeMediaSource:t.mozMediaSource?"window"===t.mozMediaSource||"screen"===t.mozMediaSource:!!t.mediaSource&&("window"===t.mediaSource||"screen"===t.mediaSource)}(s)||t.some((function(e){return"videoinput"===e.kind})),c=z(s),l=J(s),d=function(e){return el.debug("isAudioSendRequired:",e),!!e&&!1!==e.audio&&!1!==e.audioSend&&void 0!==e.failIfNoAudio&&null!==e.failIfNoAudio&&!0===e.failIfNoAudio}(s),u=function(e){return el.debug("isVideoSendRequired:",e),!!e&&!1!==e.video&&!1!==e.videoSend&&void 0!==e.failIfNoVideo&&null!==e.failIfNoVideo&&!0===e.failIfNoVideo}(s);if(c||l||d||u){var h=!!c&&r,p=!!l&&a;if(!h&&!p)return o.consentDialog(!1),n.error("No capture device found"),!1;if(!h&&d)return o.consentDialog(!1),n.error("Audio capture is required, but no capture device found"),!1;if(!p&&u)return o.consentDialog(!1),n.error("Video capture is required, but no capture device found"),!1}var w={audio:!(!r||s.keepAudio)&&g,video:!(!a||s.keepVideo)&&f};n.audioSource&&(w.audio={deviceId:{exact:n.audioSource}}),n.videoSource&&(w.video={deviceId:{exact:n.videoSource}}),el.debug("getUserMedia constraints",w),w.audio||w.video?navigator.mediaDevices.getUserMedia(w).then((function(t){if(n.videoTrackConstraints){let e=t.getVideoTracks();if(e.length){let t=e[0];t&&t.applyConstraints(n.videoTrackConstraints).then((function(){let e=JSON.stringify(t.getSettings(),null,2);el.log(`Video track constraints : ${e}`)})).catch((e=>{n.error("Could not apply video track constraints")}))}}o.consentDialog(!1),N(e,i,s,n,t)})).catch((function(e){o.consentDialog(!1),n.error({code:e.code,name:e.name,message:e.message})})):(o.consentDialog(!1),N(e,i,s,n,m))})).catch((function(e){o.consentDialog(!1),n.error(e)}))}else N(e,i,s,n)}function B(e,t){(t=t||{}).success="function"==typeof t.success?t.success:el.noop,t.error="function"==typeof t.error?t.error:q,t.customizeSdp="function"==typeof t.customizeSdp?t.customizeSdp:el.noop;var n=t.jsep,i=y[e];if(!i||!i.webrtcStuff)return el.warn("Invalid handle"),void t.error("Invalid handle");var s=i.webrtcStuff;if(n){if(!s.pc)return el.warn("Wait, no PeerConnection?? if this is an answer, use createAnswer and not handleRemoteJsep"),void t.error("No PeerConnection: if this is an answer, use createAnswer and not handleRemoteJsep");t.customizeSdp(n),s.pc.setRemoteDescription(n).then((function(){if(el.log("Remote description accepted!"),s.remoteSdp=n.sdp,s.candidates&&s.candidates.length>0){for(var e=0;e<s.candidates.length;e++){var i=s.candidates[e];el.debug("Adding remote candidate:",i),i&&!0!==i.completed?s.pc.addIceCandidate(i):s.pc.addIceCandidate(el.endOfCandidates)}s.candidates=[]}t.success()}),t.error)}else t.error("Invalid JSEP")}function F(e,t){var n=y[e];if(!n||!n.webrtcStuff)return el.warn("Invalid handle"),0;var i=t?"remote":"local",s=n.webrtcStuff;return s.volume[i]||(s.volume[i]={value:0}),!s.pc.getStats||"chrome"!==el.webRTCAdapter.browserDetails.browser&&"safari"!==el.webRTCAdapter.browserDetails.browser?(el.warn("Getting the "+i+" volume unsupported by browser"),0):t&&!s.remoteStream?(el.warn("Remote stream unavailable"),0):t||s.myStream?s.volume[i].timer?s.volume[i].value:(el.log("Starting "+i+" volume monitor"),s.volume[i].timer=setInterval((function(){s.pc.getStats().then((function(e){e.forEach((function(e){e&&"audio"===e.kind&&(t&&!e.remoteSource||!t&&"media-source"!==e.type||(s.volume[i].value=e.audioLevel?e.audioLevel:0))}))}))}),200),0):(el.warn("Local stream unavailable"),0)}function U(e,t){var n=y[e];if(!n||!n.webrtcStuff)return el.warn("Invalid handle"),!0;var i=n.webrtcStuff;return i.pc?i.myStream?t?i.myStream.getVideoTracks()&&0!==i.myStream.getVideoTracks().length?!i.myStream.getVideoTracks()[0].enabled:(el.warn("No video track"),!0):i.myStream.getAudioTracks()&&0!==i.myStream.getAudioTracks().length?!i.myStream.getAudioTracks()[0].enabled:(el.warn("No audio track"),!0):(el.warn("Invalid local MediaStream"),!0):(el.warn("Invalid PeerConnection"),!0)}function j(e,t,n){var i=y[e];if(!i||!i.webrtcStuff)return el.warn("Invalid handle"),!1;var s=i.webrtcStuff;return s.pc?s.myStream?t?s.myStream.getVideoTracks()&&0!==s.myStream.getVideoTracks().length?(s.myStream.getVideoTracks()[0].enabled=!n,!0):(el.warn("No video track"),!1):s.myStream.getAudioTracks()&&0!==s.myStream.getAudioTracks().length?(s.myStream.getAudioTracks()[0].enabled=!n,!0):(el.warn("No audio track"),!1):(el.warn("Invalid local MediaStream"),!1):(el.warn("Invalid PeerConnection"),!1)}function V(e){var t=y[e];if(!t||!t.webrtcStuff)return el.warn("Invalid handle"),"Invalid handle";var n=t.webrtcStuff;return n.pc?n.pc.getStats?n.bitrate.timer?n.bitrate.value:(el.log("Starting bitrate timer (via getStats)"),n.bitrate.timer=setInterval((function(){n.pc.getStats().then((function(e){e.forEach((function(e){if(e){var t=!1;if(("video"===e.mediaType||e.id.toLowerCase().indexOf("video")>-1)&&"inbound-rtp"===e.type&&e.id.indexOf("rtcp")<0?t=!0:"ssrc"!=e.type||!e.bytesReceived||"VP8"!==e.googCodecName&&""!==e.googCodecName||(t=!0),t)if(n.bitrate.bsnow=e.bytesReceived,n.bitrate.tsnow=e.timestamp,null===n.bitrate.bsbefore||null===n.bitrate.tsbefore)n.bitrate.bsbefore=n.bitrate.bsnow,n.bitrate.tsbefore=n.bitrate.tsnow;else{var i=n.bitrate.tsnow-n.bitrate.tsbefore;"safari"===el.webRTCAdapter.browserDetails.browser&&(i/=1e3);var s=Math.round(8*(n.bitrate.bsnow-n.bitrate.bsbefore)/i);"safari"===el.webRTCAdapter.browserDetails.browser&&(s=parseInt(s/1e3)),n.bitrate.value=s+" kbits/sec",n.bitrate.bsbefore=n.bitrate.bsnow,n.bitrate.tsbefore=n.bitrate.tsnow}}}))}))}),1e3),"0 kbits/sec"):(el.warn("Getting the video bitrate unsupported by browser"),"Feature unsupported by browser"):"Invalid PeerConnection"}function G(e){var t=y[e];if(null==t||null===t.webrtcStuff||void 0===t.webrtcStuff)return el.warn("Invalid handle"),"Invalid handle";var n=t.webrtcStuff;return null===n.pc||void 0===n.pc?null:(n.pc.getStats&&n.pc.getStats().then((function(e){n.stats=e})),n.stats)}function q(e){el.error("WebRTC error:",e)}function H(e,i){el.log("Cleaning WebRTC stuff");var s=y[e];if(s){var o=s.webrtcStuff;if(o){if(!0===i){var r={janus:"hangup",transaction:el.randomString(12)};s.token&&(r.token=s.token),w&&(r.apisecret=w),el.debug("Sending hangup request (handle="+e+"):"),el.debug(r),t?(r.session_id=_,r.handle_id=e,M(n,r)):el.httpAPICall(a+"/"+_+"/"+e,{verb:"POST",withCredentials:h,body:r})}o.remoteStream=null,o.volume&&(o.volume.local&&o.volume.local.timer&&clearInterval(o.volume.local.timer),o.volume.remote&&o.volume.remote.timer&&clearInterval(o.volume.remote.timer)),o.volume={},o.bitrate.timer&&clearInterval(o.bitrate.timer),o.bitrate.timer=null,o.bitrate.bsnow=null,o.bitrate.bsbefore=null,o.bitrate.tsnow=null,o.bitrate.tsbefore=null,o.bitrate.value=null,!o.streamExternal&&o.myStream&&(el.log("Stopping local stream tracks"),el.stopAllTracks(o.myStream)),o.streamExternal=!1,o.myStream=null;try{o.pc.close()}catch(e){}o.pc=null,o.candidates=null,o.mySdp=null,o.remoteSdp=null,o.iceDone=!1,o.dataChannel={},o.dtmfSender=null,o.senderTransforms=null,o.receiverTransforms=null}s.oncleanup()}}function z(e){return el.debug("isAudioSendEnabled:",e),!e||!1!==e.audio&&(void 0===e.audioSend||null===e.audioSend||!0===e.audioSend)}function W(e){return el.debug("isAudioRecvEnabled:",e),!e||!1!==e.audio&&(void 0===e.audioRecv||null===e.audioRecv||!0===e.audioRecv)}function J(e){return el.debug("isVideoSendEnabled:",e),!e||!1!==e.video&&(void 0===e.videoSend||null===e.videoSend||!0===e.videoSend)}function Y(e){return el.debug("isVideoRecvEnabled:",e),!e||!1!==e.video&&(void 0===e.videoRecv||null===e.videoRecv||!0===e.videoRecv)}I(e),this.getServer=function(){return a},this.isConnected=function(){return b},this.reconnect=function(e){(e=e||{}).success="function"==typeof e.success?e.success:el.noop,e.error="function"==typeof e.error?e.error:el.noop,e.reconnect=!0,I(e)},this.getSessionId=function(){return _},this.getInfo=function(e){!function(e){if((e=e||{}).success="function"==typeof e.success?e.success:el.noop,e.error="function"==typeof e.error?e.error:el.noop,el.log("Getting info on Janus instance"),!b)return el.warn("Is the server down? (connected=false)"),void e.error("Is the server down? (connected=false)");var i=el.randomString(12),s={janus:"info",transaction:i};if(m&&(s.token=m),w&&(s.apisecret=w),t)return E[i]=function(t){el.log("Server info:"),el.debug(t),"server_info"!==t.janus&&el.error("Ooops: "+t.error.code+" "+t.error.reason),e.success(t)},void M(n,s);el.httpAPICall(a,{verb:"POST",withCredentials:h,body:s,success:function(t){el.log("Server info:"),el.debug(t),"server_info"!==t.janus&&el.error("Ooops: "+t.error.code+" "+t.error.reason),e.success(t)},error:function(t,n){el.error(t+":",n),""===n?e.error(t+": Is the server down?"):e.error(t+": "+n)}})}(e)},this.destroy=function(o){!function(o){(o=o||{}).success="function"==typeof o.success?o.success:el.noop,o.error="function"==typeof o.error?o.error:el.noop;var r=!0===o.unload,c=!0;void 0!==o.notifyDestroyed&&null!==o.notifyDestroyed&&(c=!0===o.notifyDestroyed);var l=!0===o.cleanupHandles;if(el.log("Destroying session "+_+" (unload="+r+")"),!_)return el.warn("No session to destroy"),o.success(),void(c&&e.destroyed());if(l)for(var d in y)D(d,{noRequest:!0});if(!b)return el.warn("Is the server down? (connected=false)"),_=null,void o.success();var u={janus:"destroy",transaction:el.randomString(12)};if(m&&(u.token=m),w&&(u.apisecret=w),r)return t?(n.onclose=null,n.close(),n=null):navigator.sendBeacon(a+"/"+_,JSON.stringify(u)),el.log("Destroyed session:"),_=null,b=!1,o.success(),void(c&&e.destroyed());if(t){u.session_id=_;var p=function(){for(var e in i)n.removeEventListener(e,i[e]);n.removeEventListener("message",g),n.removeEventListener("error",f),s&&clearTimeout(s),n.close()},g=function(t){var n=JSON.parse(t.data);n.session_id==u.session_id&&n.transaction==u.transaction&&(p(),o.success(),c&&e.destroyed())},f=function(){p(),o.error("Failed to destroy the server: Is the server down?"),c&&e.destroyed()};return n.addEventListener("message",g),n.addEventListener("error",f),void(1===n.readyState?M(n,u):f())}el.httpAPICall(a+"/"+_,{verb:"POST",withCredentials:h,body:u,success:function(t){el.log("Destroyed session:"),el.debug(t),_=null,b=!1,"success"!==t.janus&&el.error("Ooops: "+t.error.code+" "+t.error.reason),o.success(),c&&e.destroyed()},error:function(t,n){el.error(t+":",n),_=null,b=!1,o.success(),c&&e.destroyed()}})}(o)},this.attach=function(e){!function(e){if((e=e||{}).success="function"==typeof e.success?e.success:el.noop,e.error="function"==typeof e.error?e.error:el.noop,e.consentDialog="function"==typeof e.consentDialog?e.consentDialog:el.noop,e.iceState="function"==typeof e.iceState?e.iceState:el.noop,e.mediaState="function"==typeof e.mediaState?e.mediaState:el.noop,e.webrtcState="function"==typeof e.webrtcState?e.webrtcState:el.noop,e.slowLink="function"==typeof e.slowLink?e.slowLink:el.noop,e.onmessage="function"==typeof e.onmessage?e.onmessage:el.noop,e.onlocalstream="function"==typeof e.onlocalstream?e.onlocalstream:el.noop,e.onremotestream="function"==typeof e.onremotestream?e.onremotestream:el.noop,e.ondata="function"==typeof e.ondata?e.ondata:el.noop,e.ondataopen="function"==typeof e.ondataopen?e.ondataopen:el.noop,e.oncleanup="function"==typeof e.oncleanup?e.oncleanup:el.noop,e.ondetached="function"==typeof e.ondetached?e.ondetached:el.noop,e.ontrackmuted="function"==typeof e.ontrackmuted?e.ontrackmuted:el.noop,e.ontrackunmuted="function"==typeof e.ontrackunmuted?e.ontrackunmuted:el.noop,!b)return el.warn("Is the server down? (connected=false)"),void e.error("Is the server down? (connected=false)");var i=e.plugin;if(!i)return el.error("Invalid plugin"),void e.error("Invalid plugin");var s=e.opaqueId,o=e.loopIndex,r=e.token?e.token:m,c=el.randomString(12),l={janus:"attach",plugin:i,opaque_id:s,loop_index:o,transaction:c};if(r&&(l.token=r),w&&(l.apisecret=w),t)return E[c]=function(t){if(el.debug(t),"success"!==t.janus)return el.error("Ooops: "+t.error.code+" "+t.error.reason),void e.error("Ooops: "+t.error.code+" "+t.error.reason);var n=t.data.id;el.log(`Created handle: id:${n}, opaqueId:${s}`);var o={session:C,plugin:i,id:n,token:r,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return n},getPlugin:function(){return i},getVolume:function(){return F(n,!0)},getRemoteVolume:function(){return F(n,!0)},getLocalVolume:function(){return F(n,!1)},isAudioMuted:function(){return U(n,!1)},muteAudio:function(){return j(n,!1,!0)},unmuteAudio:function(){return j(n,!1,!1)},isVideoMuted:function(){return U(n,!0)},muteVideo:function(){return j(n,!0,!0)},unmuteVideo:function(){return j(n,!0,!1)},getBitrate:function(){return V(n)},getStats:function(){return G(n)},send:function(e){R(n,e)},data:function(e){L(n,e)},dtmf:function(e){P(n,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){O(n,!0,e)},createAnswer:function(e){O(n,!1,e)},handleRemoteJsep:function(e){B(n,e)},onlocalstream:e.onlocalstream,onremotestream:e.onremotestream,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,ontrackmuted:e.ontrackmuted,ontrackunmuted:e.ontrackunmuted,hangup:function(e){H(n,!0===e)},detach:function(e){D(n,e)}};y[n]=o,e.success(o)},l.session_id=_,void M(n,l);el.httpAPICall(a+"/"+_,{verb:"POST",withCredentials:h,body:l,success:function(t){if(el.debug(t),"success"!==t.janus)return el.error("Ooops: "+t.error.code+" "+t.error.reason),void e.error("Ooops: "+t.error.code+" "+t.error.reason);var n=t.data.id;el.log("Created handle: "+n);var s={session:C,plugin:i,id:n,token:r,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return n},getPlugin:function(){return i},getVolume:function(){return F(n,!0)},getRemoteVolume:function(){return F(n,!0)},getLocalVolume:function(){return F(n,!1)},isAudioMuted:function(){return U(n,!1)},muteAudio:function(){return j(n,!1,!0)},unmuteAudio:function(){return j(n,!1,!1)},isVideoMuted:function(){return U(n,!0)},muteVideo:function(){return j(n,!0,!0)},unmuteVideo:function(){return j(n,!0,!1)},getBitrate:function(){return V(n)},getStats:function(){return G(n)},send:function(e){R(n,e)},data:function(e){L(n,e)},dtmf:function(e){P(n,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){O(n,!0,e)},createAnswer:function(e){O(n,!1,e)},handleRemoteJsep:function(e){B(n,e)},onlocalstream:e.onlocalstream,onremotestream:e.onremotestream,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,ontrackmuted:e.ontrackmuted,ontrackunmuted:e.ontrackunmuted,hangup:function(e){H(n,!0===e)},detach:function(e){D(n,e)}};y[n]=s,e.success(s)},error:function(t,n){el.error(t+":",n),""===n?e.error(t+": Is the server down?"):e.error(t+": "+n)}})}(e)}}el.useDefaultDependencies=function(e){var t=e&&e.fetch||fetch,n=e&&e.Promise||Promise,i=e&&e.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new i(e,t)},extension:e&&e.extension||Qc,isArray:function(e){return Array.isArray(e)},webRTCAdapter:e&&e.adapter||Xc,httpAPICall:function(e,i){var s={method:i.verb,headers:{Accept:"application/json, text/plain, */*"},cache:"no-cache"};"POST"===i.verb&&(s.headers["Content-Type"]="application/json"),void 0!==i.withCredentials&&(s.credentials=!0===i.withCredentials?"include":i.withCredentials?i.withCredentials:"omit"),i.body&&(s.body=JSON.stringify(i.body));var o=t(e,s).catch((function(e){return n.reject({message:"Probably a network error, is the server down?",error:e})}));if(i.timeout){var r=new n((function(e,t){var n=setTimeout((function(){return clearTimeout(n),t({message:"Request timed out",timeout:i.timeout})}),i.timeout)}));o=n.race([o,r])}return o.then((function(e){return e.ok?typeof i.success==typeof el.noop?e.json().then((function(e){try{i.success(e)}catch(e){el.error("Unhandled httpAPICall success callback error",e)}}),(function(t){return n.reject({message:"Failed to parse response body",error:t,response:e})})):void 0:n.reject({message:"API call failed",response:e})})).catch((function(e){typeof i.error==typeof el.noop&&i.error(e.message||"<< internal error >>",e)})),o}}},el.useOldDependencies=function(e){var t=e&&e.jQuery||jQuery,n=e&&e.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new n(e,t)},isArray:function(e){return t.isArray(e)},extension:e&&e.extension||Qc,webRTCAdapter:e&&e.adapter||Xc,httpAPICall:function(e,n){var i=void 0!==n.body?{contentType:"application/json",data:JSON.stringify(n.body)}:{},s=void 0!==n.withCredentials?{xhrFields:{withCredentials:n.withCredentials}}:{};return t.ajax(t.extend(i,s,{url:e,type:n.verb,cache:!1,dataType:"json",async:n.async,timeout:n.timeout,success:function(e){typeof n.success==typeof el.noop&&n.success(e)},error:function(e,t,i){typeof n.error==typeof el.noop&&n.error(t,i)}}))}}},el.noop=function(){},el.dataChanDefaultLabel="JanusDataChannel",el.endOfCandidates=null,el.stopAllTracks=function(e){try{var t=e.getTracks();for(var n of t)el.log(n),n&&n.stop()}catch(e){}},el.init=function(e){if((e=e||{}).callback="function"==typeof e.callback?e.callback:el.noop,el.initDone)e.callback();else{if(void 0===console.log&&(console.log=function(){}),el.trace=el.noop,el.debug=el.noop,el.vdebug=el.noop,el.log=el.noop,el.warn=el.noop,el.error=el.noop,!0===e.debug||"all"===e.debug)el.trace=console.trace.bind(console),el.debug=console.debug.bind(console),el.vdebug=console.debug.bind(console),el.log=console.log.bind(console),el.warn=console.warn.bind(console),el.error=console.error.bind(console);else if(Array.isArray(e.debug))for(var t of e.debug)switch(t){case"trace":el.trace=console.trace.bind(console);break;case"debug":el.debug=console.debug.bind(console);break;case"vdebug":el.vdebug=console.debug.bind(console);break;case"log":el.log=console.log.bind(console);break;case"warn":el.warn=console.warn.bind(console);break;case"error":el.error=console.error.bind(console);break;default:console.error("Unknown debugging option '"+t+"' (supported: 'trace', 'debug', 'vdebug', 'log', warn', 'error')")}el.log("Initializing library");var n=e.dependencies||el.useDefaultDependencies();el.isArray=n.isArray,el.webRTCAdapter=n.webRTCAdapter,el.httpAPICall=n.httpAPICall,el.newWebSocket=n.newWebSocket,el.extension=n.extension,el.extension.init(),el.listDevices=function(e,t){e="function"==typeof e?e:el.noop,null==t&&(t={audio:!0,video:!0}),el.isGetUserMediaAvailable()?navigator.mediaDevices.getUserMedia(t).then((function(t){navigator.mediaDevices.enumerateDevices().then((function(n){el.debug(n),e(n),el.stopAllTracks(t)}))})).catch((function(t){el.error(t),e([])})):(el.warn("navigator.mediaDevices unavailable"),e([]))},el.attachMediaStream=function(e,t){try{e.srcObject=t}catch(n){try{e.src=URL.createObjectURL(t)}catch(e){el.error("Error attaching stream to element")}}},el.reattachMediaStream=function(e,t){try{e.srcObject=t.srcObject}catch(n){try{e.src=t.src}catch(e){el.error("Error reattaching stream to element")}}};var i=["iPad","iPhone","iPod"].indexOf(navigator.platform)>=0?"pagehide":"beforeunload",s=window["on"+i];if(window.addEventListener(i,(function(){for(var e in el.log("Closing window"),el.sessions)el.sessions[e]&&el.sessions[e].destroyOnUnload&&(el.log("Destroying session "+e),el.sessions[e].destroy({unload:!0,notifyDestroyed:!1}));s&&"function"==typeof s&&s()})),el.safariVp8=!1,"safari"===el.webRTCAdapter.browserDetails.browser&&el.webRTCAdapter.browserDetails.version>=605)if(RTCRtpSender&&RTCRtpSender.getCapabilities&&RTCRtpSender.getCapabilities("video")&&RTCRtpSender.getCapabilities("video").codecs&&RTCRtpSender.getCapabilities("video").codecs.length){for(var o of RTCRtpSender.getCapabilities("video").codecs)if(o&&o.mimeType&&"video/vp8"===o.mimeType.toLowerCase()){el.safariVp8=!0;break}el.safariVp8?el.log("This version of Safari supports VP8"):el.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu")}else{var r=new RTCPeerConnection({});r.createOffer({offerToReceiveVideo:!0}).then((function(e){el.safariVp8=-1!==e.sdp.indexOf("VP8"),el.safariVp8?el.log("This version of Safari supports VP8"):el.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu"),r.close(),r=null}))}if(el.unifiedPlan=!1,"firefox"===el.webRTCAdapter.browserDetails.browser&&el.webRTCAdapter.browserDetails.version>=59)el.unifiedPlan=!0;else if("chrome"===el.webRTCAdapter.browserDetails.browser&&el.webRTCAdapter.browserDetails.version>=72)el.unifiedPlan=!0;else if(window.RTCRtpTransceiver&&"currentDirection"in RTCRtpTransceiver.prototype){var a=new RTCPeerConnection;try{a.addTransceiver("audio"),el.unifiedPlan=!0}catch(e){}a.close()}else el.unifiedPlan=!1;el.initDone=!0,e.callback()}},el.isWebrtcSupported=function(){return!!window.RTCPeerConnection},el.isGetUserMediaAvailable=function(){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia},el.randomString=function(e){for(var t="",n=0;n<e;n++){var i=Math.floor(62*Math.random());t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".substring(i,i+1)}return t};const tl=el;var nl=n(1692);class il{constructor(){this.mRoutes=new sl,this.mObjRoutes=new ol}clear(){this.mRoutes.clear(),this.mObjRoutes.clear()}register(e,t,n,i){return e&&t&&n?(this.mRoutes.register(e,t,n,i),this.mObjRoutes.register(e,t,n,i),!0):(Di.g.log(3,`Delegates : register : invalid input parameters (obj:${e}, fn:${t}, route:${n})`),!1)}unregister(e,t,n,i){return this.mObjRoutes.hasObj(e)?(t?(this.mObjRoutes.unregister(e,t,n,i),this.mRoutes.unregister(e,t,n,i)):this.mObjRoutes.routesArray(e).forEach((t=>{this.unregister(e,t)})),!0):(Di.g.log(3,`Delegates : unregister : no routes registered for object:${e} (input route:${t})`),!1)}dispatch(e,t,n,i){return this.mRoutes.dispatch(e,t,n,i)}}class sl{constructor(){this.mRoutes=new Map}clear(){this.mRoutes.clear()}register(e,t,n,i){if(!e||!t||!n)return Di.g.log(3,`Routes : register : invalid input parameters (obj:${e}, fn:${t}, route:${n})`),!1;this.mRoutes.has(n)||this.mRoutes.set(n,new Map);let s=this.mRoutes.get(n).get(e);return s||(s=new Map,this.mRoutes.get(n).set(e,s)),s.set(i,t),!0}unregister(e,t,n,i){if(!e||!t)return Di.g.log(3,`Routes : unregister : invalid input parameters (obj:${e}, route:${t}`),!1;const s=this.mRoutes.get(t);if(!s)return Di.g.log(3,`Routes : unregister : no routes registered for object:${e} (input route:${t})`),!1;if(n)s.delete(e);else{const t=s.get(i);t&&(t.delete(i),0===t.size&&s.delete(e))}return 0===s.size&&this.mRoutes.delete(t),!0}dispatch(e,t,n,i){const s=[],o=this.mRoutes.get(e);if(o&&o.forEach(((e,i)=>{let o=e.get(n);if(o||null==n||(o=e.get(void 0)),o){const e=o(t,n);void 0!==e&&s.push({val:e,obj:i})}})),0!==s.length)return i?s[0].val:s}}class ol{constructor(){this.mObjRoutes=new Map}clear(){this.mObjRoutes.clear()}register(e,t,n,i){if(!e||!t||!n)return Di.g.log(3,`ObjRoutes : register : invalid input parameters (obj:${e}, fn:${t}, route:${n})`),!1;this.mObjRoutes.has(e)||this.mObjRoutes.set(e,new Map);let s=this.mObjRoutes.get(e).get(n);return s||(s=new Map,this.mObjRoutes.get(e).set(n,s)),s.set(i,i),!0}unregister(e,t,n,i){if(!e||!t)return Di.g.log(3,`ObjRoutes : unregister : invalid input parameters (obj:${e}, route:${t}`),!1;const s=this.mObjRoutes.get(e);if(!s)return Di.g.log(3,`ObjRoutes : unregister : no routes registered for object:${e} (input route:${t})`),!1;if(n)s.delete(t);else{const e=s.get(t);e&&(e.delete(i),0===e.size&&s.delete(t))}return 0===s.size&&this.mObjRoutes.delete(e),!0}routesArray(e){const t=[];return this.mObjRoutes.get(e).forEach((e=>{t.push(e)})),t}hasObj(e){return null!=this.mObjRoutes.get(e)}}class rl{constructor(e,t){this.mWorker=new Worker(e,{type:"module"}),this.mWorkerCB=t,this.mWorker.addEventListener("message",(e=>{this.mWorkerCB(e.data)}))}post(e){this.mWorker.postMessage(e)}}const al="TimerWorkerTick";class cl{constructor(e,t){this.mDelegates=function(){const e=new il;return{register:(t,n,i,s=void 0)=>e.register(t,n,i,s),unregister:(t,n,i=!0,s=void 0)=>e.unregister(t,n,i,s),dispatch:(t,n=void 0,i=void 0,s=!1)=>e.dispatch(t,n,i,s),clear:()=>{e.clear()}}}(),this.mWorker=new rl(t,(({ts:e})=>{this.mTerminated||this.mDelegates.dispatch(al,e)})),this.mTerminated=!1,this.mWorker.post({type:"init",intervalMs:e})}addListener(e,t){this.mTerminated||this.mDelegates.register(e,t,al)}removeListener(e){this.mTerminated||this.mDelegates.unregister(e,al)}terminate(){this.mTerminated=!0,this.mDelegates.clear(),this.mWorker.post({type:"deinit"})}}class ll{constructor(e,t,n,i){this.mTimerWorker=n,this.mLastEvtTs=Date.now(),this.mTimerWorker.addListener(this,(n=>{n>=this.mLastEvtTs+t&&(e(n),this.mLastEvtTs+=t,i&&this.stop())}))}stop(){this.mTimerWorker&&(this.mTimerWorker.removeListener(this),this.mTimerWorker=void 0)}}class dl extends ll{constructor(e,t,n){super(e,t,n,!1)}}class ul extends ll{constructor(e,t,n){super(e,t,n,!0)}}class hl{constructor(e){if(this.mTimerWorker=e,this.mJanus=null,this.mIrmCtrl=null,this.mPublisher=null,this.mPublisherScreen=null,this.mSuccessCB=null,this.mLocalStreamCB=null,this.mMessageCB=null,this.mConnFailedCB=null,this.mConnClosedCB=null,this.mRemoteStreamCB=null,this.mLocalStreamTrackEndedCB=null,this.mCleanupCB=null,this.mReconnectCB=null,this.mScreenSharingReadyCB=null,this.mTrackMutedCB=null,this.mTrackUnmutedCB=null,this.mMediaInfoCB=null,this.mRepublishAVConfCB=null,this.mSlowLinkCB=null,this.mPublisherStateCB=null,this.mScreenUnpublishedCB=null,this.mStatsUpdateCB=null,this.mNetworkAlertCB=null,this.mSubscribersMap=new Map,this.mSubscribersMapByMediaId=new Map,this.mSubscribersResetMap=new Map,this.mMyRoom=0,this.mOpaqueId=null,this.mDisplay="",this.mTxVideoCodec=null,this.mSupportedVideoCodecs=[],this.mSupportedVideoCodecsDefault=[],this.mWatchdogIntervalMs=1e3,this.mLastNetworkAlertTs=0,this.mTimer=void 0,this.mRejoinTimer=void 0,this.mJanusCallbacks={onSuccessCB:e=>{this.onSuccessCB(e)},onMessageCB:(e,t,n)=>{this.onMessageCB(e,t,n)},onLocalStreamCB:(e,t,n)=>{this.onLocalStreamCB(e,t,n)},onRemoteStreamCB:(e,t)=>{this.onRemoteStreamCB(e,t)},onCleanupCB:e=>{this.onCleanupCB(e)},onNewRemoteFeedCB:(e,t,n,i,s,o)=>{this.onNewRemoteFeedCB(e,t,n,i,s,o)},onTrackMutedCB:(e,t)=>{this.onTrackMutedCB(e,t)},onTrackUnmutedCB:(e,t)=>{this.onTrackUnmutedCB(e,t)},onScreenSharingReadyCB:()=>this.onScreenSharingReadyCB(),onGetTxVideoCodecCB:()=>this.onGetTxVideoCodecCB(),onGetRxVideoCodecCB:()=>this.onGetRxVideoCodecCB(),onGetMyRoomCB:()=>this.onGetMyRoomCB(),onGetDisplayCB:()=>this.onGetDisplayCB(),onGetOpaqueIdCB:()=>this.onGetOpaqueIdCB(),onGetJanusObjCB:()=>this.onGetJanusObjCB(),onSubscriberAttachedCB:e=>{this.onSubscriberAttachedCB(e)},onSubscriberDetachedCB:e=>{this.onSubscriberDetachedCB(e)},onSubscriberDown:e=>{this.onSubscriberDown(e)},onPublisherState:e=>{this.onPublisherState(e)},onPublisherMediaStopped:e=>{this.onPublisherMediaStopped(e)},onSlowLink:e=>{this.onSlowLink(e)},onStatsUpdate:e=>{this.onStatsUpdate(e)}},"1.0.5"!=tl.version)throw new Error("Please update janus.js file");const t=["H264","VP9","VP8"];if(RTCRtpSender&&RTCRtpSender.getCapabilities&&RTCRtpSender.getCapabilities("video")&&RTCRtpSender.getCapabilities("video").codecs&&RTCRtpSender.getCapabilities("video").codecs.length){const e=new Map;for(let n in RTCRtpSender.getCapabilities("video").codecs){const i=RTCRtpSender.getCapabilities("video").codecs[n].mimeType;if("string"==typeof i||i instanceof String){let n=null;switch(i.toLowerCase()){case"video/vp8":n="VP8";break;case"video/vp9":n="VP9";break;case"video/h264":n="H264"}n&&t.indexOf(n)>=0&&!e.get(n)&&e.set(n,n)}}for(let n=0;n<t.length;n++){const i=t[n];e.get(i)&&this.mSupportedVideoCodecsDefault.push(i)}this.resetRxVideoCodec()}else{let e=new RTCPeerConnection({},{});e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then((n=>{const i=new Map,s=nl.K0(n.sdp);for(let e=0;e<s.media.length;e++){const n=s.media[e];if("video"===n.type)for(let e=0;e<n.rtp.length;e++){const s=n.rtp[e].codec.toUpperCase();t.indexOf(s)>=0&&!i.get(s)&&i.set(s,s)}}for(let e=0;e<t.length;e++){const n=t[e];i.get(n)&&this.mSupportedVideoCodecsDefault.push(n)}"UNIX"==function(){let e;return-1!=navigator.appVersion.indexOf("Win")&&(e="Windows"),-1!=navigator.appVersion.indexOf("Mac")&&(e="MacOS"),-1!=navigator.appVersion.indexOf("X11")&&(e="UNIX"),-1!=navigator.appVersion.indexOf("Linux")&&(e="Linux"),e}()&&"firefox"===tl.webRTCAdapter.browserDetails.browser&&this.removeSupportedVideoCodec("h264"),this.resetRxVideoCodec(),e.close(),e=null}),(t=>{Di.g.log(3,`MyHeartJanus : Failed to create session description: ${t.toString()}`),e.close(),e=null}))}tl.init({debug:["error","warn"],callback:()=>{}})}setEventHandlers(e,t,n,i,s,o,r,a,c,l,d,u,h,p,m,w,g,f,v){this.mSuccessCB=e,this.mLocalStreamCB=t,this.mMessageCB=n,this.mConnFailedCB=i,this.mConnClosedCB=s,this.mRemoteStreamCB=o,this.mLocalStreamTrackEndedCB=r,this.mCleanupCB=a,this.mReconnectCB=c,this.mScreenSharingReadyCB=l,this.mTrackMutedCB=d,this.mTrackUnmutedCB=u,this.mMediaInfoCB=h,this.mRepublishAVConfCB=p,this.mSlowLinkCB=m,this.mPublisherStateCB=w,this.mScreenUnpublishedCB=g,this.mStatsUpdateCB=f,this.mNetworkAlertCB=v}start(e,t,n){this.mOpaqueId=t,this.mDisplay=n,tl.init({debug:"all",callback:()=>{tl.isWebrtcSupported()?this.mJanus=new tl({server:e,success:()=>{this.mIrmCtrl=new Ua(this.mJanusCallbacks)},error:e=>{Di.g.log(3,`MyHeartJanus : Error : ${e}`)},connectionFailed:()=>{this.mConnFailedCB()},connectionClosed:()=>{this.mConnClosedCB()},destroyed:()=>{Di.g.log(3,"MyHeartJanus : Janus Destroyed")}}):Di.g.log(3,"MyHeartJanus : No WebRTC support... ")}})}stop(){this.leaveRoom(),this.mIrmCtrl&&(this.mIrmCtrl.destroy(),this.mIrmCtrl=null),this.mJanus&&(this.mJanus.destroy(),this.mJanus=null),this.mOpaqueId=null,this.mDisplay=""}started(){return null!=this.mJanus&&null!=this.mIrmCtrl&&this.mIrmCtrl.started()}setRxVideoCodec(e){const t=e.toUpperCase(),n=this.mSupportedVideoCodecs.indexOf(t);return n>-1&&(this.mSupportedVideoCodecs.splice(n,1),this.mSupportedVideoCodecs.unshift(t),!0)}getRxVideoCodec(){return this.mSupportedVideoCodecs[0]}resetRxVideoCodec(){this.mSupportedVideoCodecs=this.mSupportedVideoCodecsDefault.slice()}removeSupportedVideoCodec(e){const t=e.toUpperCase();let n=this.mSupportedVideoCodecsDefault.indexOf(t);n>-1&&this.mSupportedVideoCodecsDefault.splice(n,1),n=this.mSupportedVideoCodecs.indexOf(t),n>-1&&this.mSupportedVideoCodecs.splice(n,1)}leaveRoom(){this.mSubscribersMap.forEach(((e,t)=>{e.destroy()})),this.mSubscribersMap.clear(),this.mSubscribersMapByMediaId.clear(),this.mSubscribersResetMap.clear(),this.mPublisher&&(this.mPublisher.unpublish(),this.mPublisher.destroy(),this.mPublisher=null),this.unpublishScreen(),this.mRejoinTimer&&(this.mRejoinTimer.stop(),this.mRejoinTimer=void 0),this.mTimer&&(this.mTimer.stop(),this.mTimer=void 0),this.mMyRoom=0}setRoomId(e){e!=this.mMyRoom&&(this.leaveRoom(),this.mMyRoom=e,0!=this.mMyRoom&&(this.mPublisher=new ja(this.mJanusCallbacks),this.mTimer=new dl((()=>{this.watchdog()}),this.mWatchdogIntervalMs,this.mTimerWorker)))}onSuccessCB(e){this.mSuccessCB()}onMessageCB(e,t,n){n&&e.setWebRtcReqTs(),this.mMessageCB(t,n,e.type())}onLocalStreamCB(e,t,n){if(Di.g.log(3,`MyHeartJanus : onLocalStreamCB : ${e.mediaId()} ${e.type()}`),t){Di.g.log(3,`MyHeartJanus : onLocalStreamCB : ${t}`);const n=t.getTracks();for(let i=0;i<n.length;i++){const s=n[i];s.onended=()=>{this.mLocalStreamTrackEndedCB(t,s,e.mediaId(),e.type())}}}this.mLocalStreamCB(t,e.mediaId(),e.type(),n)}checkSubscriber(e,t,n=""){const i=this.subscriberByMediaId(e.mediaId());i===e?t():(Di.g.log(3,`MyHeartJanus : ${n} : invalid handler:${e.info()} (current:${i?i.info():null})`),e.destroy())}onRemoteStreamCB(e,t){this.checkSubscriber(e,(()=>{this.mRemoteStreamCB(t,e.mediaId())}),"onRemoteStreamCB")}onCleanupCB(e){this.mCleanupCB(e.mediaId())}sendMessage(e){this.started()?(Di.g.log(3,`MyHeartJanus : sendMessage : ${e}`),this.mIrmCtrl.sendMessage(e)):Di.g.log(3,`MyHeartJanus : sendMessage : ---- Engine Not Started - payload:${e} ----`)}pub(e,t){if(this.mPublisher){let n=this.mPublisher.media();if(n&&n.id==e)return t?n.stream:this.mPublisher}if(this.mPublisherScreen){let n=this.mPublisherScreen.media();if(n&&n.id==e)return t?n.stream:this.mPublisherScreen}return null}localStream(e){return this.pub(e,!0)}publish(e,t,n,i,s,o,r,a,c){this.mPublisher&&this.mPublisher.publish(e,t,n,i,s,o,r,a,c)}unpublish(){this.mPublisher&&this.mPublisher.unpublish()}isPublished(){return!!this.mPublisher&&this.mPublisher.isPublished()}publishScreen(e,t,n,i,s){this.mPublisherScreen?s&&this.mPublisherScreen.publish():this.mPublisherScreen=new Ga(e,t,n,i,this.mJanusCallbacks)}unpublishScreen(){this.mPublisherScreen&&(this.mPublisherScreen.stop(),this.mPublisherScreen=null,this.mScreenUnpublishedCB())}isScreenPublished(){return null!=this.mPublisherScreen}onGetTxVideoCodecCB(){return this.mTxVideoCodec}onGetRxVideoCodecCB(){return this.getRxVideoCodec()}onGetMyRoomCB(){return this.mMyRoom}onGetDisplayCB(){return this.mDisplay}onGetOpaqueIdCB(){return this.mOpaqueId}onGetJanusObjCB(){return this.mJanus}onSubscriberAttachedCB(e){this.checkSubscriber(e,(()=>{this.mSubscribersMap.set(e.rfId(),e)}),"onSubscriberAttachedCB")}onSubscriberDetachedCB(e){this.subscriberDetached(e)}onSubscriberDown(e){this.checkSubscriber(e,(()=>{Di.g.log(3,`MyHeartJanus : onSubscriberDown : ---- Subscriber : feed:${e.rfId()}, mediaId:${e.mediaId()}, inactive:${e.inactive()} ----`),this.resetSubscriber(e)}),"onSubscriberDown")}onPublisherState(e){if(e===this.mPublisher){const t=e.isWebRTCUp();return this.mPublisherStateCB(t),void(t||(Di.g.log(3,`MyHeartJanus : onPublisherState : publisher down : ${e.info()}`),this.mRepublishAVConfCB()))}Di.g.log(3,`MyHeartJanus : onPublisherState : unknown publisher ${e.info()}`)}onPublisherMediaStopped(e){e===this.mPublisher&&(Di.g.log(3,`MyHeartJanus : onPublisherMediaStopped : ${e.info()}`),this.mRepublishAVConfCB())}onSlowLink(e){this.mSlowLinkCB(e.mediaId())}onStatsUpdate(e){this.mStatsUpdateCB(e.mediaId(),e.getStats())}subscriberDetached(e){const t=this.mSubscribersMap.get(e);t&&(Di.g.log(3,`MyHeartJanus : subscriberDetached : Publisher ${e}, mediaId:${t.mediaId()}, rfDisplay:${t.rfDisplay()} has left the room, detaching subscriber...`),this.destroySubscriber(t))}subscriberDetachedByMediaId(e){const t=this.subscriberByMediaId(e);t&&(Di.g.log(3,`MyHeartJanus : subscriberDetachedByMediaId : mediaId:${e}, rfId:${t.rfId()}, rfDisplay:${t.rfDisplay()}`),this.destroySubscriber(t))}destroySubscriber(e){e&&(this.mSubscribersMapByMediaId.delete(e.mediaId()),this.mSubscribersMap.delete(e.rfId()),e.destroy())}subscriberByMediaId(e){return this.mSubscribersMapByMediaId.get(e)}onNewRemoteFeedCB(e,t,n,i,s,o){this.createSubscriber(t,n,i,s,o)}onTrackMutedCB(e,t){this.checkSubscriber(e,(()=>{this.mTrackMutedCB(t,e.mediaId())}),"onTrackMutedCB")}onTrackUnmutedCB(e,t){this.checkSubscriber(e,(()=>{this.mTrackUnmutedCB(t,e.mediaId())}),"onTrackUnmutedCB")}onScreenSharingReadyCB(){return this.mScreenSharingReadyCB()}resetSubscriber(e){this.createSubscriber(e.rfId(),e.mediaId(),e.rfDisplay(),e.audio(),e.video());let t=this.mSubscribersResetMap.get(e.mediaId());t||(t={counter:0},this.mSubscribersResetMap.set(e.mediaId(),t)),t.counter++,t.ts=Date.now()}createSubscriber(e,t,n,i,s){Di.g.log(3,`MyHeartJanus : createSubscriber : mediaId:${t}, rfId:${e}`),this.subscriberDetachedByMediaId(t),this.resetRxVideoCodec(),s&&this.setRxVideoCodec(s);const o=this.mMediaInfoCB(t),r=o?o.screen:void 0,a=new qa(e,t,n,i,s,r,this.mJanusCallbacks);this.mSubscribersMapByMediaId.set(t,a)}watchdog(){let e=!1;this.checkPublishers()&&(e=!0),this.checkSubscribers()&&(e=!0),e&&Di.g.log(3,"MyHeartJanus : watchdog : done")}checkPublishers(){let e=!1;return this.mPublisher&&this.mPublisher.isPublished()&&this.mPublisher.webRtcTimeout()&&(Di.g.log(3,`MyHeartJanus : checkPublishers : Resetting Publisher : mediaId:${this.mPublisher.mediaId()}`),e=!0,this.mRepublishAVConfCB()),this.mPublisherScreen&&this.mPublisherScreen.isPublished()&&this.mPublisherScreen.webRtcTimeout()&&(Di.g.log(3,`MyHeartJanus : checkPublishers : Resetting Screen Sharing : mediaId:${this.mPublisherScreen.mediaId()}`),e=!0,this.mPublisherScreen.restart()),e}checkSubscribers(){let e=!1;return this.mSubscribersMap.forEach(((t,n)=>{const i=this.mMediaInfoCB(t.mediaId()),s=t.webRtcTimeout(),o=t.inactive();(s||i&&i.active&&o)&&(e=!0,Di.g.log(3,`MyHeartJanus : checkSubscribers : Resetting Subscriber : feed:${n}, mediaId:${t.mediaId()}, mediaActive:${i?i.active:void 0}, timeout:${s}, inactive:${o} ----`),this.resetSubscriber(t))})),this.checkSubscribersReset(),this.checkSubscribersVideoQuality(),e}checkSubscribersReset(){const e=Date.now(),t=[];let n=0;this.mSubscribersResetMap.forEach((({counter:i,ts:s},o)=>{!this.mSubscribersMapByMediaId.get(o)||e-s>=1e4?t.push(o):i>2&&n++})),t.forEach((e=>{Di.g.log(3,`MyHeartJanus : checkSubscribersReset : subscriber ${e} removed from reset map`),this.mSubscribersResetMap.delete(e)})),n>this.mSubscribersMap.size/2&&this.notifyNetworkAlert(1)}notifyNetworkAlert(e){const t=Date.now();(!this.mLastNetworkAlertTs||t-this.mLastNetworkAlertTs>=6e4)&&(this.mNetworkAlertCB(e),this.mLastNetworkAlertTs=t)}checkSubscribersVideoQuality(){this.mSubscribersMap.forEach((e=>{e.screen()||e.checkVideoQuality((()=>{this.notifyNetworkAlert(2)}))}))}isAudioMuted(e){const t=this.pub(e);return!!t&&t.isAudioMuted()}muteAudio(e){const t=this.pub(e);return!!t&&t.muteAudio()}unmuteAudio(e){const t=this.pub(e);return!!t&&t.unmuteAudio()}isVideoMuted(e){const t=this.pub(e);return!!t&&t.isVideoMuted()}muteVideo(e){const t=this.pub(e);return!!t&&t.muteVideo()}unmuteVideo(e){const t=this.pub(e);return!!t&&t.unmuteVideo()}listDevices(e){tl.listDevices(e)}attachMediaStream(e,t){tl.attachMediaStream(e,t)}setBitrate(e){this.mPublisher&&this.mPublisher.setBitrate(e)}setBitrateScreen(e){this.mPublisherScreen&&this.mPublisherScreen.setBitrate(e)}setTxVideoCodec(e){this.mTxVideoCodec=e}getTxVideoCodec(){return this.mTxVideoCodec}getBitrate(e){const t=this.subscriberByMediaId(e);return t?t.getBitrate():null}getStats(e){if(this.mPublisher&&this.mPublisher.mediaId()==e)return this.mPublisher.getStats();if(this.mPublisherScreen&&this.mPublisherScreen.mediaId()==e)return this.mPublisherScreen.getStats();const t=this.subscriberByMediaId(e);return t?t.getStats():null}isConnected(){return!!this.mJanus&&this.mJanus.isConnected()}reconnect(){this.started()?this.mJanus.reconnect({success:()=>{this.handleReconnection()},error:e=>{Di.g.log(3,`MyHeartJanus : rconnect : Error : ${e}`)},connectionFailed:()=>{Di.g.log(3,"MyHeartJanus : rconnect : connection failed")},connectionClosed:()=>{this.mConnClosedCB()}}):Di.g.log(3,"MyHeartJanus : reconnect : not started...")}republish(e){Di.g.log(3,"MyHeartJanus : republish"),this.mPublisher&&this.mPublisher.restart(e)}notifyCurrentTab(e){this.mSubscribersMap.forEach((t=>{t.notifyCurrentTab(e)}))}handleReconnection(){Di.g.log(3,"MyHeartJanus : handleReconnection");let e=!1;if("firefox"===tl.webRTCAdapter.browserDetails.browser&&(e=!0),this.mPublisher&&(this.mPublisher.isPublished()&&"failed"==this.mPublisher.iceState()||"disconnected"==this.mPublisher.iceState())&&(Di.g.log(3,`MyHeartJanus : handleReconnection : publisher state ${this.mPublisher.iceState()}...`),e=!0),!this.mPublisherScreen||"failed"!=this.mPublisherScreen.iceState()&&"disconnected"!=this.mPublisherScreen.iceState()||(Di.g.log(3,`MyHeartJanus : handleReconnection : screen state ${this.mPublisherScreen.iceState()}...`),e=!0),this.mSubscribersMap.forEach(((t,n)=>{"failed"!=t.iceState()&&"disconnected"!=t.iceState()||(Di.g.log(3,`MyHeartJanus : handleReconnection : mediaId:${t.mediaId()}, iceState:${t.iceState()}...`),e=!0)})),e){let e=this.mMyRoom;this.leaveRoom(),"edge"===tl.webRTCAdapter.browserDetails.browser?(this.mRejoinTimer&&this.mRejoinTimer.stop(),this.mRejoinTimer=new ul((()=>{this.mRejoinTimer=void 0,this.setRoomId(e)}),2e3,this.mTimerWorker)):this.setRoomId(e)}this.mReconnectCB()}static labelPublisher(){return ja.label()}static labelPublisherScreen(){return Ga.label()}static labelSubscriber(){return qa.label()}static labelIrmCtrl(){return Ua.label()}}function pl(){return{type:hl.labelPublisher(),mediaId:0,bitrate:256e3,useAudio:!0,useVideo:!0,pending:!1,disabled:!1,videoSource:null,audioSource:null,videoPrefRes:"stdres",videoHi:!1,videoTrackConstraints:null,publishPendingTimer:void 0}}function ml(){return{type:hl.labelPublisherScreen(),mediaId:0,bitrate:256e3,framerate:5,useAudio:!0,useVideo:!0,pending:!1,disabled:!1}}function wl(){return{type:hl.labelPublisherScreen(),mediaId:0,bitrate:768e3,framerate:12,useAudio:!0,useVideo:!0,pending:!1,disabled:!1}}const gl=1,fl=5,vl=1,bl=2;function _l(){return String.fromCharCode(gl)}function yl(e){const t={};let n=!1;(e=e.substr(1)).charCodeAt(0)==fl&&(e=e.substr(1)),e.charCodeAt(e.length-1)==gl&&(e=e.substring(0,e.length-1));let i=_l();return e.indexOf(i)<0&&e.indexOf(" ")<0?(t.identifier=e,t.params=[],n=!0):(n=El(t,e,i),n||(n=El(t,e," "))),n?t:null}function Cl(e,t){let n="";if(!$i(e)){const i=_l();if(n=i+e,t){const e=" ";t.forEach((t=>{$i(t)||(n+=`${e}${t}`)}))}n+=i}return n.length>0?`${n}`:""}function Sl(e){let t,n="";if(e.charCodeAt(0)==fl){const i=(e=e.substr(1)).split(String.fromCharCode(fl));2==i.length?(t=i[0],n=i[1]):n=i[0]}else n=e;return{seq:t,message:n}}function El(e,t,n){let i=!1;const s=t.indexOf(n);if(s<0)return!1;const o=[t.slice(0,s),t.slice(s+1)];return o.length>1&&(e.identifier=o[0],e.params=o[1],i=!0),i}function xl(){return{isCTCP:function(e){return function(e){let t=!1;return"string"==typeof e&&e.length>0&&e.charCodeAt(0)==gl&&(t=!0),t}(e)},CHAT:function(){return{parse:Sl}},CTCP:function(){return{parse:yl,format:Cl}},modes:function(){return{privmsg:vl,notice:bl}}}}class kl{constructor(){this.mChannelListCB=null,this.mStartedCB=null,this.mTerminatedCB=null,this.mStartFailedCB=null,this.mEnterChannelCB=null,this.mConnectCB=null,this.mChatMessageCB=null,this.mUserJoinCB=null,this.mUserLeaveCB=null,this.mUserListCB=null,this.mTopicCB=null,this.mMediaMuteCB=null,this.mKickedCB=null,this.mChannelModesCB=null,this.mChannelXModeCB=null,this.mStatusCB=null,this.mTxStateCB=null,this.mMediaStateCB=null,this.mUserModesCB=null,this.mCtcpCB=null,this.mChannelInfoCB=null,this.mLocalStreamCB=null,this.mLocalStreamTrackEndedCB=null,this.mChannelChatMuteSetCB=null,this.mChannelChatMuteListCB=null,this.mChannelBanListCB=null,this.mPublishResponseCB=null,this.mScreenSharingReadyCB=null,this.mScreenSharingPublishedCB=null,this.mScreenSharingUnpublishedCB=null,this.mConnClosedCB=null,this.mMediaMutedByServerCB=null,this.mSlowLinkCB=null,this.mPublisherStateCB=null,this.mPublisherConnectingCB=null,this.mStatsUpdateCB=null,this.mNetworkAlertCB=null}setChannelListCB(e){this.mChannelListCB=e}getChannelListCB(){return this.mChannelListCB}setStartedCB(e){this.mStartedCB=e}getStartedCB(){return this.mStartedCB}setTerminatedCB(e){this.mTerminatedCB=e}getTerminatedCB(){return this.mTerminatedCB}setStartFailedCB(e){this.mStartFailedCB=e}getStartFailedCB(){return this.mStartFailedCB}setEnterChannelCB(e){this.mEnterChannelCB=e}getEnterChannelCB(){return this.mEnterChannelCB}setConnectCB(e){this.mConnectCB=e}getConnectCB(){return this.mConnectCB}setChatMessageCB(e){this.mChatMessageCB=e}getChatMessageCB(){return this.mChatMessageCB}setUserJoinCB(e){this.mUserJoinCB=e}getUserJoinCB(){return this.mUserJoinCB}setUserLeaveCB(e){this.mUserLeaveCB=e}getUserLeaveCB(){return this.mUserLeaveCB}setUserListCB(e){this.mUserListCB=e}getUserListCB(){return this.mUserListCB}setTopicCB(e){this.mTopicCB=e}getTopicCB(){return this.mTopicCB}setMediaMuteCB(e){this.mMediaMuteCB=e}getMediaMuteCB(){return this.mMediaMuteCB}setKickedCB(e){this.mKickedCB=e}getKickedCB(){return this.mKickedCB}setChannelModesCB(e){this.mChannelModesCB=e}getChannelModesCB(){return this.mChannelModesCB}setChannelXModeCB(e){this.mChannelXModeCB=e}getChannelXModeCB(){return this.mChannelXModeCB}setStatusCB(e){this.mStatusCB=e}getStatusCB(){return this.mStatusCB}setTxStateCB(e){this.mTxStateCB=e}getTxStateCB(){return this.mTxStateCB}setMediaStateCB(e){this.mMediaStateCB=e}getMediaStateCB(){return this.mMediaStateCB}setUserModesCB(e){this.mUserModesCB=e}getUserModesCB(){return this.mUserModesCB}setCTCPCB(e){this.mCtcpCB=e}getCTCPCB(){return this.mCtcpCB}setChannelInfoCB(e){this.mChannelInfoCB=e}getChannelInfoCB(){return this.mChannelInfoCB}setLocalStreamCB(e){this.mLocalStreamCB=e}getLocalStreamCB(){return this.mLocalStreamCB}setLocalStreamTrackEndedCB(e){this.mLocalStreamTrackEndedCB=e}getLocalStreamTrackEndedCB(){return this.mLocalStreamTrackEndedCB}setChannelChatMuteSetCB(e){this.mChannelChatMuteSetCB=e}getChannelChatMuteSetCB(){return this.mChannelChatMuteSetCB}setChannelChatMuteListCB(e){this.mChannelChatMuteListCB=e}getChannelChatMuteListCB(){return this.mChannelChatMuteListCB}setChannelBanListCB(e){this.mChannelBanListCB=e}getChannelBanListCB(){return this.mChannelBanListCB}setPublishResponseCB(e){this.mPublishResponseCB=e}getPublishResponseCB(){return this.mPublishResponseCB}setScreenSharingReadyCB(e){this.mScreenSharingReadyCB=e}getScreenSharingReadyCB(){return this.mScreenSharingReadyCB}setScreenSharingPublishedCB(e){this.mScreenSharingPublishedCB=e}getScreenSharingPublishedCB(){return this.mScreenSharingPublishedCB}setScreenSharingUnpublishedCB(e){this.mScreenSharingUnpublishedCB=e}getScreenSharingUnpublishedCB(){return this.mScreenSharingUnpublishedCB}setConnClosedCB(e){this.mConnClosedCB=e}getConnClosedCB(){return this.mConnClosedCB}setMediaMutedByServerCB(e){this.mMediaMutedByServerCB=e}getMediaMutedByServerCB(){return this.mMediaMutedByServerCB}setSlowLinkCB(e){this.mSlowLinkCB=e}getSlowLinkCB(){return this.mSlowLinkCB}setPublisherStateCB(e){this.mPublisherStateCB=e}getPublisherStateCB(){return this.mPublisherStateCB}setPublisherConnectingCB(e){this.mPublisherConnectingCB=e}getPublisherConnectingCB(){return this.mPublisherConnectingCB}setStatsUpdateCB(e){this.mStatsUpdateCB=e}getStatsUpdateCB(){return this.mStatsUpdateCB}setNetworkAlertCB(e){this.mNetworkAlertCB=e}getNetworkAlertCB(){return this.mNetworkAlertCB}setters(){return{channelListCB:e=>{this.setChannelListCB(e)},startedCB:e=>{this.setStartedCB(e)},terminatedCB:e=>{this.setTerminatedCB(e)},startFailedCB:e=>{this.setStartFailedCB(e)},enterChannelCB:e=>{this.setEnterChannelCB(e)},connectCB:e=>{this.setConnectCB(e)},chatMessageCB:e=>{this.setChatMessageCB(e)},userJoinCB:e=>{this.setUserJoinCB(e)},userLeaveCB:e=>{this.setUserLeaveCB(e)},userListCB:e=>{this.setUserListCB(e)},topicCB:e=>{this.setTopicCB(e)},mediaMuteCB:e=>{this.setMediaMuteCB(e)},kickedCB:e=>{this.setKickedCB(e)},channelModesCB:e=>{this.setChannelModesCB(e)},channelXModeCB:e=>{this.setChannelXModeCB(e)},statusCB:e=>{this.setStatusCB(e)},txStateCB:e=>{this.setTxStateCB(e)},mediaStateCB:e=>{this.setMediaStateCB(e)},userModesCB:e=>{this.setUserModesCB(e)},ctcpCB:e=>{this.setCTCPCB(e)},channelInfoCB:e=>{this.setChannelInfoCB(e)},localStreamCB:e=>{this.setLocalStreamCB(e)},localStreamTrackEndedCB:e=>{this.setLocalStreamTrackEndedCB(e)},channelChatMuteSetCB:e=>{this.setChannelChatMuteSetCB(e)},channelChatMuteListCB:e=>{this.setChannelChatMuteListCB(e)},channelBanListCB:e=>{this.setChannelBanListCB(e)},publishResponseCB:e=>{this.setPublishResponseCB(e)},screenSharingReadyCB:e=>{this.setScreenSharingReadyCB(e)},screenSharingPublishedCB:e=>{this.setScreenSharingPublishedCB(e)},screenSharingUnpublishedCB:e=>{this.setScreenSharingUnpublishedCB(e)},connClosedCB:e=>{this.setConnClosedCB(e)},mediaMutedByServerCB:e=>{this.setMediaMutedByServerCB(e)},slowLinkCB:e=>{this.setSlowLinkCB(e)},publisherStateCB:e=>{this.setPublisherStateCB(e)},publisherConnectingCB:e=>{this.setPublisherConnectingCB(e)},statsUpdateCB:e=>{this.setStatsUpdateCB(e)},networkAlertCB:e=>{this.setNetworkAlertCB(e)}}}getters(){return{channelListCB:()=>this.getChannelListCB(),startedCB:()=>this.getStartedCB(),terminatedCB:()=>this.getTerminatedCB(),startFailedCB:()=>this.getStartFailedCB(),enterChannelCB:()=>this.getEnterChannelCB(),connectCB:()=>this.getConnectCB(),chatMessageCB:()=>this.getChatMessageCB(),userJoinCB:()=>this.getUserJoinCB(),userLeaveCB:()=>this.getUserLeaveCB(),userListCB:()=>this.getUserListCB(),topicCB:()=>this.getTopicCB(),mediaMuteCB:()=>this.getMediaMuteCB(),kickedCB:()=>this.getKickedCB(),channelModesCB:()=>this.getChannelModesCB(),channelXModeCB:()=>this.getChannelXModeCB(),statusCB:()=>this.getStatusCB(),txStateCB:()=>this.getTxStateCB(),mediaStateCB:()=>this.getMediaStateCB(),userModesCB:()=>this.getUserModesCB(),ctcpCB:()=>this.getCTCPCB(),channelInfoCB:()=>this.getChannelInfoCB(),localStreamCB:()=>this.getLocalStreamCB(),localStreamTrackEndedCB:()=>this.getLocalStreamTrackEndedCB(),channelChatMuteSetCB:()=>this.getChannelChatMuteSetCB(),channelChatMuteListCB:()=>this.getChannelChatMuteListCB(),channelBanListCB:()=>this.getChannelBanListCB(),publishResponseCB:()=>this.getPublishResponseCB(),screenSharingReadyCB:()=>this.getScreenSharingReadyCB(),screenSharingPublishedCB:()=>this.getScreenSharingPublishedCB(),screenSharingUnpublishedCB:()=>this.getScreenSharingUnpublishedCB(),connClosedCB:()=>this.getConnClosedCB(),mediaMutedByServerCB:()=>this.getMediaMutedByServerCB(),slowLinkCB:()=>this.getSlowLinkCB(),publisherStateCB:()=>this.getPublisherStateCB(),publisherConnectingCB:()=>this.getPublisherConnectingCB(),statsUpdateCB:()=>this.getStatsUpdateCB(),networkAlertCB:()=>this.getNetworkAlertCB()}}}class Ml{static CMD_PREFIX(){return"^-!"}static CMD_PREFIX_API_V2(){return"@"}static API_LEVEL(){return 11}static CMD_PARAM(){return"cmd"}static CMD_PARAM_ENABLED(){return"en"}static CMD_PARAM_MEDIAVOICE(){return"mv"}static CMD_PARAM_USERCOUNT(){return"us"}static CMD_PARAM_PWDPROTECTED(){return"p"}static CMD_PARAM_CHANNEL(){return"c"}static CMD_PARAM_PWD(){return"pw"}static CMD_PARAM_CODE(){return"co"}static CMD_PARAM_SOURCE(){return"so"}static CMD_PARAM_TARGET(){return"ta"}static CMD_PARAM_MESSAGE(){return"me"}static CMD_PARAM_UMODE(){return"u"}static CMD_PARAM_MODE(){return"m"}static CMD_PARAM_MODEPARAM(){return"mp"}static CMD_PARAM_CHANNELMSG(){return"cm"}static CMD_PARAM_USERNAME(){return"n"}static CMD_PARAM_ALIAS(){return"na"}static CMD_PARAM_MEDIAID(){return"mi"}static CMD_PARAM_MEDIACLASS(){return"mc"}static CMD_PARAM_MEDIACLASS_FLAGS(){return"mcf"}static CMD_PARAM_QUALITY(){return"q"}static CMD_PARAM_USERID(){return"ui"}static CMD_PARAM_DEVID(){return"di"}static CMD_PARAM_FLAGS(){return"fl"}static CMD_PARAM_FILTER(){return"fi"}static CMD_PARAM_TOPIC(){return"to"}static CMD_PARAM_SEQ(){return"seq"}static CMD_PARAM_SEQREF(){return"seqref"}static CMD_PARAM_DATA(){return"data"}static CMD_PARAM_API(){return"api"}static CMD_PARAM_LIST(){return"list"}static CMD_PARAM_INDEX(){return"idx"}static CMD_PARAM_REASON(){return"re"}static CMD_PARAM_SSV(){return"ssv"}static CMD_PARAM_COMPLEMENT(){return"com"}static CMD_PARAM_COMPLEMENT2(){return"com2"}static CMD_PARAM_COMPLEMENT3(){return"com3"}static CMD_PARAM_COMPLEMENT4(){return"com4"}static CMD_PARAM_COMPLEMENT5(){return"com5"}static CMD_PARAM_AUDIO(){return"aud"}static CMD_PARAM_VIDEO(){return"vid"}static CMD_PARAM_SERVER(){return"srv"}static CMD_PARAM_VOICEUSERS(){return"vu"}static CMD_PARAM_REQID(){return"rid"}static CMD_PARAM_MCAST(){return"mcast"}static CMD_PARAM_MCAST_IP(){return"mcastip"}static CMD_PARAM_MCAST_PORT(){return"mcastport"}static CMD_PARAM_MCAST_PORT_CTRL(){return"mcastportctrl"}static CMD_PARAM_TAG_ACK(){return"tagack"}static CMD_PARAM_LOGGEDIN(){return"lin"}static CMD_PARAM_ACTIVE(){return"act"}static CMD_PARAM_TIME_ELAPSED(){return"t"}static CMD_PARAM_LIMIT(){return"li"}static CMD_PARAM_FULLNAME(){return"fn"}}class Tl{static SRV_MSG_TXSTATE(){return"srv_tx_state"}static SRV_MSG_CHANNELLIST(){return"srv_channel_list"}static SRV_MSG_ENTERCHANNEL(){return"srv_enter_channel"}static SRV_MSG_PRIVMSG(){return"srv_privmsg"}static SRV_MSG_USERJOIN(){return"srv_user_join"}static SRV_MSG_USERLEAVE(){return"srv_user_leave"}static SRV_MSG_KICKED(){return"srv_kicked"}static SRV_MSG_MEDIASTATE(){return"srv_mediastate"}static SRV_MSG_MEDIAUPDATE(){return"srv_mediaupdate"}static SRV_MSG_USERLIST(){return"srv_userlist"}static SRV_MSG_SIGNEDIN(){return"srv_user_signedin"}static SRV_MSG_AUTHERROR(){return"srv_user_autherror"}static SRV_MSG_CHANNELMODES(){return"srv_channel_modes"}static SRV_MSG_CHANNELXMODE(){return"srv_channel_xmode"}static SRV_MSG_USERMODES(){return"srv_user_modes"}static SRV_MSG_ONLINE_USERS(){return"srv_notify_online_users"}static SRV_MSG_STATUS(){return"srv_status"}static SRV_MSG_USER_EVENT(){return"srv_user_event"}static SRV_MSG_CHANNEL_TOPIC(){return"srv_channel_topic"}static SRV_MSG_RX_QUALITY_AVAILABLE(){return"srv_rx_quality_avail"}static SRV_MSG_CLOUDSTREAM_ACK(){return"srv_cloudstream_ack"}static SRV_MSG_PING(){return"srv_ping"}static SRV_MSG_SRV_LOST_PKTS(){return"srv_lost_pkts"}static SRV_MSG_MEDIA_MUTE(){return"srv_media_mute"}static SRV_MSG_CHANNEL_BAN_LIST(){return"srv_ch_ban_list"}static SRV_MSG_APILEVEL(){return"srv_api_level"}static SRV_MSG_CHANNEL_INFO(){return"srv_ch_info"}static SRV_MSG_MEDIAIDTXEXTRA(){return"srv_mediaid_tx_extra"}static SRV_MSG_CHANNEL_CHAT_MUTE_SET(){return"srv_ch_chat_mute_set"}static SRV_MSG_CHANNEL_CHAT_MUTE_LIST(){return"srv_ch_chat_mute_list"}}class Il{static CLI_MSG_TXREQUEST(){return"cli_tx_req"}static CLI_MSG_RAISEHAND(){return"cli_raise_hand"}static CLI_MSG_CHANNELLIST(){return"cli_channel_list"}static CLI_MSG_ENTERCHANNEL(){return"cli_enter_channel"}static CLI_MSG_LEAVECHANNEL(){return"cli_leave_channel"}static CLI_MSG_CHAT(){return"cli_chat"}static CLI_MSG_IDLE(){return"cli_idle"}static CLI_MSG_MEDIAIDREQUEST(){return"cli_mediaidrequest"}static CLI_MSG_MEDIAIDREQUEST_SET(){return"cli_mediaidrequest_set"}static CLI_MSG_USERLIST(){return"cli_userlist"}static CLI_MSG_LOGIN(){return"cli_login"}static CLI_MSG_LOGOUT(){return"cli_logout"}static CLI_MSG_SET_USER_MODE(){return"cli_set_user_mode"}static CLI_MSG_GET_USER_MODES(){return"cli_get_user_modes"}static CLI_MSG_GET_USER_INFO(){return"cli_get_user_info"}static CLI_MSG_SET_CHANNEL_MODE(){return"cli_set_channel_mode"}static CLI_MSG_SET_CHANNEL_XMODE(){return"cli_set_channel_xmode"}static CLI_MSG_SET_CHANNEL_TOPIC(){return"cli_set_channel_topic"}static CLI_MSG_CHANNEL_CLOSE(){return"cli_channel_close"}static CLI_MSG_CHECK_ONLINE_USERS(){return"cli_check_online_users"}static CLI_MSG_ADD_IM_USER(){return"cli_request_add_im_user"}static CLI_MSG_DEL_IM_USER(){return"cli_request_del_im_user"}static CLI_MSG_SET_MEDIA_RX(){return"cli_set_media_rx"}static CLI_MSG_CLOUDSTREAM(){return"cli_request_cloudstream"}static CLI_MSG_KICK_USER(){return"cli_request_kick_user"}static CLI_MSG_MEDIA_STATE(){return"cli_media_state"}static CLI_MSG_TXSTATE(){return"cli_tx_state"}static CLI_MSG_LOG(){return"cli_log"}static CLI_MSG_MEDIA_MUTE(){return"cli_media_mute"}static CLI_MSG_CHANNEL_BAN_LIST(){return"cli_ch_ban_list"}static CLI_MSG_CHANNEL_MODES(){return"cli_chmodes"}static CLI_MSG_CHANNEL_INFO(){return"cli_ch_info"}static CLI_MSG_MEDIAIDTXEXTRA(){return"cli_mediaid_tx_extra"}static CLI_MSG_MEDIAIDTXEXTRA_DESTROY(){return"cli_mediaid_tx_extra_destroy"}static CLI_MSG_ACK(){return"cli_ack"}static CLI_MSG_CHANNEL_CHAT_MUTE_SET(){return"cli_ch_chat_mute_set"}static CLI_MSG_CHANNEL_CHAT_MUTE_LIST(){return"cli_ch_chat_mute_list"}static CLI_MSG_DROP_TX(){return"cli_drop_tx"}static CLI_MSG_STREAM_START(){return"cli_stream_start"}static CLI_MSG_STREAM_STOP(){return"cli_stream_stop"}static CLI_MSG_NESTED_ROOM(){return"cli_nested_room"}static CLI_MSG_VIDEO_STREAM_LIMIT(){return"cli_video_stream_limit"}}class Rl extends Il{static jsonMsg(e,t,n){const i=Ml;n||(n={});let s=i.CMD_PREFIX_API_V2();return n[i.CMD_PARAM()]=e,n[i.CMD_PARAM_SEQ()]=t,s+JSON.stringify(n)}static login(e,t,n,i,s,o,r,a){const c=Ml,l={};l[c.CMD_PARAM_USERID()]=t,l[c.CMD_PARAM_FULLNAME()]=n,l[c.CMD_PARAM_DEVID()]=s,l[c.CMD_PARAM_PWD()]=i,l[c.CMD_PARAM_API()]=c.API_LEVEL(),l[c.CMD_PARAM_FLAGS()]=r,l[c.CMD_PARAM_COMPLEMENT2()]=o,a&&(l[c.CMD_PARAM_COMPLEMENT3()]=a);const d=Rl;return d.jsonMsg(d.CLI_MSG_LOGIN(),e,l)}static logout(e){const t=Rl;return t.jsonMsg(t.CLI_MSG_LOGOUT(),e)}static setUserMode(e,t){const n={};n[Ml.CMD_PARAM_MODE()]=t;const i=Rl;return i.jsonMsg(i.CLI_MSG_SET_USER_MODE(),e,n)}static channelList(e,t,n,i){const s=Ml,o={};o[s.CMD_PARAM_FILTER()]=t,o[s.CMD_PARAM_LIMIT()]=n,o[s.CMD_PARAM_USERCOUNT()]=i;const r=Rl;return r.jsonMsg(r.CLI_MSG_CHANNELLIST(),e,o)}static idle(e){const t=Rl;return t.jsonMsg(t.CLI_MSG_IDLE(),e)}static enterChannel(e,t,n){const i=Ml,s={};s[i.CMD_PARAM_CHANNEL()]=t,s[i.CMD_PARAM_PWD()]=n;const o=Rl;return o.jsonMsg(o.CLI_MSG_ENTERCHANNEL(),e,s)}static leaveChannel(e){const t=Rl;return t.jsonMsg(t.CLI_MSG_LEAVECHANNEL(),e)}static transmission(e,t,n,i){const s=Ml,o={};o[s.CMD_PARAM_TARGET()]=t,o[s.CMD_PARAM_ENABLED()]=n?1:0,o[s.CMD_PARAM_MEDIAVOICE()]=i?1:0;const r=Rl;return r.jsonMsg(r.CLI_MSG_TXREQUEST(),e,o)}static mediaIdTxExtra(e){const t=Rl;return t.jsonMsg(t.CLI_MSG_MEDIAIDTXEXTRA(),e)}static mediaIdTxExtraDestroy(e,t){const n={};n[Ml.CMD_PARAM_MEDIAID()]=t;const i=Rl;return i.jsonMsg(i.CLI_MSG_MEDIAIDTXEXTRA_DESTROY(),e,n)}static userList(e,t){const n={};n[Ml.CMD_PARAM_CHANNEL()]=t;const i=Rl;return i.jsonMsg(i.CLI_MSG_USERLIST(),e,n)}static chatMessage(e,t,n,i){const s=Ml,o={};o[s.CMD_PARAM_MESSAGE()]=t,o[s.CMD_PARAM_TARGET()]=n,o[s.CMD_PARAM_MODE()]=i;const r=Rl;return r.jsonMsg(r.CLI_MSG_CHAT(),e,o)}static raiseHand(e,t){const n={};n[Ml.CMD_PARAM_ENABLED()]=t?1:0;const i=Rl;return i.jsonMsg(i.CLI_MSG_RAISEHAND(),e,n)}static kickUser(e,t,n){const i=Ml,s={};s[i.CMD_PARAM_TARGET()]=t,s[i.CMD_PARAM_MESSAGE()]=n;const o=Rl;return o.jsonMsg(o.CLI_MSG_KICK_USER(),e,s)}static mediaState(e){const t=Rl;return t.jsonMsg(t.CLI_MSG_MEDIA_STATE(),e)}static setChannelMode(e,t,n,i){const s=Ml,o={};o[s.CMD_PARAM_CHANNEL()]=t,o[s.CMD_PARAM_MODE()]=n,o[s.CMD_PARAM_MODEPARAM()]=i;const r=Rl;return r.jsonMsg(r.CLI_MSG_SET_CHANNEL_MODE(),e,o)}static setChannelXMode(e,t,n,i){const s=Ml,o={};o[s.CMD_PARAM_CHANNEL()]=t,o[s.CMD_PARAM_MODE()]=n,o[s.CMD_PARAM_MODEPARAM()]=i;const r=Rl;return r.jsonMsg(r.CLI_MSG_SET_CHANNEL_XMODE(),e,o)}static channelInfo(e,t){const n={};n[Ml.CMD_PARAM_CHANNEL()]=t;const i=Rl;return i.jsonMsg(i.CLI_MSG_CHANNEL_INFO(),e,n)}static channelClose(e,t,n){const i=Ml,s={};s[i.CMD_PARAM_CHANNEL()]=t,s[i.CMD_PARAM_REASON()]=n;const o=Rl;return o.jsonMsg(o.CLI_MSG_CHANNEL_CLOSE(),e,s)}static txState(e){const t=Rl;return t.jsonMsg(t.CLI_MSG_TXSTATE(),e)}static channelSetChatMuteUsers(e,t,n,i){const s=Ml,o={};o[s.CMD_PARAM_CHANNEL()]=t,o[s.CMD_PARAM_COMPLEMENT()]=i,o[s.CMD_PARAM_SSV()]=n.join(" ");const r=Rl;return r.jsonMsg(r.CLI_MSG_CHANNEL_CHAT_MUTE_SET(),e,o)}static channelGetChatMuteUsers(e,t){const n={};n[Ml.CMD_PARAM_CHANNEL()]=t;const i=Rl;return i.jsonMsg(i.CLI_MSG_CHANNEL_CHAT_MUTE_LIST(),e,n)}static channelBanList(e,t){const n={};n[Ml.CMD_PARAM_CHANNEL()]=t;const i=Rl;return i.jsonMsg(i.CLI_MSG_CHANNEL_BAN_LIST(),e,n)}static dropTx(e,t){const n={};n[Ml.CMD_PARAM_FLAGS()]=t;const i=Rl;return i.jsonMsg(i.CLI_MSG_DROP_TX(),e,n)}static streamStart(e,t,n,i,s){const o=Ml,r={};r[o.CMD_PARAM_SERVER()]=t,r[o.CMD_PARAM_PWD()]=n,r[o.CMD_PARAM_COMPLEMENT()]=s,i&&(r[o.CMD_PARAM_FLAGS()]=i);const a=Rl;return a.jsonMsg(a.CLI_MSG_STREAM_START(),e,r)}static streamStop(e,t){const n={};n[Ml.CMD_PARAM_COMPLEMENT()]=t;const i=Rl;return i.jsonMsg(i.CLI_MSG_STREAM_STOP(),e,n)}static setAudioRx(e,t){const n={};n[Ml.CMD_PARAM_AUDIO()]=t?1:0;const i=Rl;return i.jsonMsg(i.CLI_MSG_SET_MEDIA_RX(),e,n)}static setVideoRx(e,t){const n={};n[Ml.CMD_PARAM_VIDEO()]=t?1:0;const i=Rl;return i.jsonMsg(i.CLI_MSG_SET_MEDIA_RX(),e,n)}static nestedRoom(e,t,n,i){const s=Ml,o={};o[s.CMD_PARAM_REQID()]=t,o[s.CMD_PARAM_CHANNEL()]=n,o[s.CMD_PARAM_DATA()]=i;const r=Rl;return r.jsonMsg(r.CLI_MSG_NESTED_ROOM(),e,o)}static videoStreamLimit(e,t,n,i,s){const o=Ml,r={};r[o.CMD_PARAM_FLAGS()]=t,r[o.CMD_PARAM_COMPLEMENT()]=n,r[o.CMD_PARAM_COMPLEMENT2()]=i,r[o.CMD_PARAM_LIMIT()]=s;const a=Rl;return a.jsonMsg(a.CLI_MSG_VIDEO_STREAM_LIMIT(),e,r)}}class Al{constructor(e){this.mSendCB=e,this.mMessageSeq=0,this.mMessageBuilder=function(){const e=Rl;return{login:(t,n,i,s,o,r,a,c)=>e.login(t,n,i,s,o,r,a,c),logout:t=>e.logout(t),setUserMode:(t,n)=>e.setUserMode(t,n),channelList:(t,n,i,s)=>e.channelList(t,n,i,s),idle:t=>e.idle(t),enterChannel:(t,n,i)=>e.enterChannel(t,n,i),leaveChannel:t=>e.leaveChannel(t),transmission:(t,n,i,s)=>e.transmission(t,n,i,s),mediaIdTxExtra:t=>e.mediaIdTxExtra(t),mediaIdTxExtraDestroy:(t,n)=>e.mediaIdTxExtraDestroy(t,n),userList:(t,n)=>e.userList(t,n),chatMessage:(t,n,i,s)=>e.chatMessage(t,n,i,s),raiseHand:(t,n)=>e.raiseHand(t,n),kickUser:(t,n,i)=>e.kickUser(t,n,i),mediaState:t=>e.mediaState(t),setChannelMode:(t,n,i,s)=>e.setChannelMode(t,n,i,s),setChannelXMode:(t,n,i,s)=>e.setChannelXMode(t,n,i,s),channelInfo:(t,n)=>e.channelInfo(t,n),channelClose:(t,n,i)=>e.channelClose(t,n,i),txState:t=>e.txState(t),channelSetChatMuteUsers:(t,n,i,s)=>e.channelSetChatMuteUsers(t,n,i,s),channelGetChatMuteUsers:(t,n)=>e.channelGetChatMuteUsers(t,n),channelBanList:(t,n)=>e.channelBanList(t,n),dropTx:(t,n)=>e.dropTx(t,n),streamStart:(t,n,i,s,o)=>e.streamStart(t,n,i,s,o),streamStop:(t,n)=>e.streamStop(t,n),setAudioRx:(t,n)=>e.setAudioRx(t,n),setVideoRx:(t,n)=>e.setVideoRx(t,n),nestedRoom:(t,n,i,s)=>e.nestedRoom(t,n,i,s),videoStreamLimit:(t,n,i,s,o)=>e.videoStreamLimit(t,n,i,s,o)}}()}incSeq(){return++this.mMessageSeq}lastSeq(){return this.mMessageSeq}requestLogin(e,t,n,i,s,o,r){this.mSendCB(this.mMessageBuilder.login(this.incSeq(),e,t,n,i,s,o,r))}requestLogout(){this.mSendCB(this.mMessageBuilder.logout(this.incSeq()))}requestTxState(){this.mSendCB(this.mMessageBuilder.txState(this.incSeq()))}sendPing(){this.mSendCB(this.mMessageBuilder.idle(this.incSeq()))}requestSetUserMode(e){this.mSendCB(this.mMessageBuilder.setUserMode(this.incSeq(),e))}requestChannelList(e,t,n){this.mSendCB(this.mMessageBuilder.channelList(this.incSeq(),e,t,n))}requestUserList(e){this.mSendCB(this.mMessageBuilder.userList(this.incSeq(),e))}requestEnterChannel(e,t){this.mSendCB(this.mMessageBuilder.enterChannel(this.incSeq(),e,t))}requestLeaveChannel(){this.mSendCB(this.mMessageBuilder.leaveChannel(this.incSeq()))}requestTransmission(e,t,n){this.mSendCB(this.mMessageBuilder.transmission(this.incSeq(),e,t,n))}requestSendPublicMessage(e,t){this.mSendCB(this.mMessageBuilder.chatMessage(this.incSeq(),e,"",t))}requestSendPrivateMessage(e,t,n){this.mSendCB(this.mMessageBuilder.chatMessage(this.incSeq(),e,t,n))}requestRaiseHand(e){this.mSendCB(this.mMessageBuilder.raiseHand(this.incSeq(),e))}requestKickUser(e,t){this.mSendCB(this.mMessageBuilder.kickUser(this.incSeq(),e,t))}requestMediaState(){this.mSendCB(this.mMessageBuilder.mediaState(this.incSeq()))}requestSetChannelMode(e,t,n){this.mSendCB(this.mMessageBuilder.setChannelMode(this.incSeq(),e,t,n))}requestSetChannelXMode(e,t,n){this.mSendCB(this.mMessageBuilder.setChannelXMode(this.incSeq(),e,t,n))}requestChannelInfo(e){this.mSendCB(this.mMessageBuilder.channelInfo(this.incSeq(),e))}requestChannelClose(e,t){this.mSendCB(this.mMessageBuilder.channelClose(this.incSeq(),e,t))}requestChannelGetChatMuteUsers(e){this.mSendCB(this.mMessageBuilder.channelGetChatMuteUsers(this.incSeq(),e))}requestChannelSetChatMuteUsers(e,t,n){this.mSendCB(this.mMessageBuilder.channelSetChatMuteUsers(this.incSeq(),e,t,n))}requestChannelBanList(e){this.mSendCB(this.mMessageBuilder.channelBanList(this.incSeq(),e))}requestDropTxMedia(e,t,n){let i=0;e&&(i|=1),t&&(i|=2),n&&(i|=4),this.mSendCB(this.mMessageBuilder.dropTx(this.incSeq(),i))}requestSetAudioRx(e){this.mSendCB(this.mMessageBuilder.setAudioRx(this.incSeq(),e))}requestSetVideoRx(e){this.mSendCB(this.mMessageBuilder.setVideoRx(this.incSeq(),e))}requestNestedRoom(e,t,n){this.mSendCB(this.mMessageBuilder.nestedRoom(this.incSeq(),e,t,n))}requestMediaIdTxExtra(){this.mSendCB(this.mMessageBuilder.mediaIdTxExtra(this.incSeq()))}requestMediaIdTxExtraDestroy(e){this.mSendCB(this.mMessageBuilder.mediaIdTxExtraDestroy(this.incSeq(),e))}requestStreamStart(e,t,n,i){this.mSendCB(this.mMessageBuilder.streamStart(this.incSeq(),e,t,n,i))}requestStreamStop(e){this.mSendCB(this.mMessageBuilder.streamStop(this.incSeq(),e))}requestVideoStreamLimit(e,t,n,i){this.mSendCB(this.mMessageBuilder.videoStreamLimit(this.incSeq(),e,t,n,i))}}class $l{static parse(e){let t=null;const n=Ml.CMD_PREFIX(),i=Ml.CMD_PREFIX_API_V2();if(e.startsWith(n)){const i=e.substr(n.length),s=JSON.parse(i),o=s[Ml.CMD_PARAM()],r=s[Ml.CMD_PARAM_DATA()];t={cmd:o,data:0!=r.length?JSON.parse(r):{}}}else if(e.startsWith(i)){const n=e.substr(i.length),s=JSON.parse(n);t={cmd:s[Ml.CMD_PARAM()],data:s}}else YLogger.g.log(3,`MessageParser::parse : invalid message : ${e}`);return t}}const Ll={STATUS_CODE_OK:0,STATUS_CODE_USER_NOT_SIGNED_IN:1,STATUS_CODE_PUBLIC_CHAT_FAILED:2,STATUS_CODE_PRIVATE_CHAT_FAILED:3,STATUS_CODE_REQTX_FAILED:4,STATUS_CODE_ALREADY_SIGNED_IN:5,STATUS_CODE_IRM_NEW_USER_STATUS:6,STATUS_CODE_ADD_IM_USER_FAILED:7,STATUS_CODE_DEL_IM_USER_FAILED:8,STATUS_CODE_SET_TOPIC_FAILED:9,STATUS_CODE_MEDIA_RX:11,STATUS_CODE_IDLE_ACK:12,STATUS_CODE_LOGOUT:14,STATUS_CODE_INVALID_REQUEST:15,STATUS_CODE_TX_NOT_AVAILABLE:16,STATUS_CODE_NESTED_ROOM:17},Pl={IRM_PLUGIN_OK:0,IRM_PLUGIN_INVALID_PARAMETERS:1,IRM_PLUGIN_SOCK_NOT_FOUND:2,IRM_PLUGIN_INIT_USER:3,IRM_PLUGIN_CHANNEL_JOIN:4,IRM_PLUGIN_CREATE_USER:5,IRM_PLUGIN_INVALID_CHANNEL:6,IRM_PLUGIN_INVALID_NICK:7,IRM_PLUGIN_INIT_CONN:8,IRM_PLUGIN_MUST_REDIR:9,IRM_PLUGIN_INVALID_PROTOCOL:10,IRM_PLUGIN_SIGNIN_ERROR:11},Dl={MYHEART_LOGIN_FLAG_DISABLE_RX:8,MYHEART_LOGIN_FLAG_MEDIASTATE2:16,MYHEART_LOGIN_FLAG_CLOSURE:32,MYHEART_LOGIN_FLAG_CHANNELMODES2:256,MYHEART_LOGIN_FLAG_MEDIASTATE3:2048},Nl={MYHEART_IRM_DESTROY_CODE_NONE:0,MYHEART_IRM_DESTROY_CODE_PINGTIMEOUT:1,MYHEART_IRM_DESTROY_CODE_USERNOTRDY:2,MYHEART_IRM_DESTROY_CODE_USERINVALID:3,MYHEART_IRM_DESTROY_CODE_NICKINVALID:4,MYHEART_IRM_DESTROY_CODE_SVCINVALID:5,MYHEART_IRM_DESTROY_CODE_MUSTREDIR:6,MYHEART_IRM_DESTROY_CODE_NOCONNCLASS:7,MYHEART_IRM_DESTROY_CODE_INTERNALERR:8,MYHEART_IRM_DESTROY_CODE_NICKINUSE:9,MYHEART_IRM_DESTROY_CODE_RECONNECTING:10,MYHEART_IRM_DESTROY_CODE_BITRATEOVFL:11,MYHEART_IRM_DESTROY_CODE_IDLETIMEOUT:12,MYHEART_IRM_DESTROY_CODE_NICKCOLLISION:13,MYHEART_IRM_DESTROY_CODE_USERKILLED:14,MYHEART_IRM_DESTROY_CODE_USERAUTHERR:15,MYHEART_IRM_DESTROY_CODE_USERQUIT:16,MYHEART_IRM_DESTROY_CODE_USERDISCD:17,MYHEART_IRM_DESTROY_CODE_USERKICKED:18,MYHEART_IRM_DESTROY_CODE_NICKCHANGED:19,MYHEART_IRM_DESTROY_CODE_USERSWNONCLSR:20,MYHEART_IRM_DESTROY_CODE_ALIASINVALID:21,MYHEART_IRM_DESTROY_CODE_SHUTDOWN:101,MYHEART_IRM_DESTROY_CODE_SRVSQUIT:102},Ol={VIDEO_STREAM_LIMIT_FLAG_NONE:0,VIDEO_STREAM_LIMIT_FLAG_OPERATORS:1,VIDEO_STREAM_LIMIT_FLAG_SCREEN:2,VIDEO_STREAM_LIMIT_FLAG_DENYREPLACE:4};class Bl{constructor(e){if(!e)throw new Error("Missing global timer in parameter constructor");this.mTimerWorker=e,this.mCfg={},this.mChannel=null,this.mMediaState=new Map,this.mMediaStateList=[],this.mMediaStateByUser=new Map,this.mMediaStreams=new Map,this.mMediaIdSelected=void 0,this.mLoggedOut=!0,this.mLastPingSndTs=0,this.mLastCmdRcvTs=0,this.mTxEnabled=!1,this.mMediaVoice=!1,this.mConnReconnect=!1,this.mConnReconnectTs=0,this.mCurReconnectAttempts=0,this.mAvconf=pl(),this.mScreensharing=ml(),this.mMyHeartJanus=function(e){const t=new hl(e);return{setEventHandlers:(e,n,i,s,o,r,a,c,l,d,u,h,p,m,w,g,f,v,b)=>{t.setEventHandlers(e,n,i,s,o,r,a,c,l,d,u,h,p,m,w,g,f,v,b)},start:(e,n,i)=>{t.start(e,n,i)},stop:()=>{t.stop()},started:()=>t.started(),leaveRoom:()=>{t.leaveRoom()},setRoomId:e=>{t.setRoomId(e)},started:()=>t.started(),sendMessage:e=>{t.sendMessage(e)},localStream:e=>t.localStream(e),publish:(e,n,i,s,o,r,a,c,l)=>{t.publish(e,n,i,s,o,r,a,c,l)},unpublish:()=>{t.unpublish()},isPublished:()=>t.isPublished(),publishScreen:(e,n,i,s,o)=>{t.publishScreen(e,n,i,s,o)},unpublishScreen:()=>{t.unpublishScreen()},isScreenPublished:()=>t.isScreenPublished(),isAudioMuted:e=>t.isAudioMuted(e),muteAudio:e=>t.muteAudio(e),unmuteAudio:e=>t.unmuteAudio(e),isVideoMuted:e=>t.isVideoMuted(e),muteVideo:e=>t.muteVideo(e),unmuteVideo:e=>t.unmuteVideo(e),listDevices:e=>{t.listDevices(e)},attachMediaStream:(e,n)=>{t.attachMediaStream(e,n)},setBitrate:e=>{t.setBitrate(e)},setBitrateScreen:e=>{t.setBitrateScreen(e)},setTxVideoCodec:e=>{t.setTxVideoCodec(e)},setRxVideoCodec:e=>{t.setRxVideoCodec(e)},resetRxVideoCodec:()=>{t.resetRxVideoCodec()},getTxVideoCodec:()=>t.getTxVideoCodec(),getRxVideoCodec:()=>t.getRxVideoCodec(),getBitrate:e=>t.getBitrate(e),getStats:e=>t.getStats(e),isConnected:()=>t.isConnected(),reconnect:()=>{t.reconnect()},republish:e=>{t.republish(e)},notifyCurrentTab:e=>{t.notifyCurrentTab(e)},labelPublisher:()=>hl.labelPublisher(),labelPublisherScreen:()=>hl.labelPublisherScreen(),labelSubscriber:()=>hl.labelSubscriber(),labelIrmCtrl:()=>hl.labelIrmCtrl()}}(e),this.mEngineState=0,this.mSrvClientId=0,this.mServerName="",this.mAcsNick="",this.mPpcsNick="",this.mMediaVoiceUser=void 0,this.mCallbackManager=new kl,this.mRequestCtrl=new Al((e=>{this.mMyHeartJanus.sendMessage(`${this.mCfg.nick}:${e}`)})),this.mCheckConnTimer=void 0,this.mCheckStateTimer=void 0,this.mConnFailTimer=void 0,this.mStopTimer=void 0,this.mCheckMediaStatePendingTimer=void 0,this.mYoutubeLiveStreamIngestionActive=!1,document.addEventListener("visibilitychange",(()=>{this.notifyCurrentTab(!document.hidden)}))}callbacks(){return this.mCallbackManager.setters()}version(){return"0.5.286"}startFlagsAvailable(){return Dl}statusCodes(){return Ll}irmPluginRetCodes(){return Pl}nick(){return this.mCfg.nick}isMe(e){return this.nick().toLowerCase()===e.toLowerCase()}currentChannel(){return this.mChannel}isStopped(){return 0==this.mEngineState}isConnecting(){return 1==this.mEngineState}isAuthenticating(){return 2==this.mEngineState}isStarted(){return 3==this.mEngineState}start(e,t,n,i,s,o,r,a,c,l){if(Di.g.log(3,`MyHeartEngine::start : url:${e}, nick:${t}, fullname:${n}, devPwd:${i}, devId:${s}, userData:${a}, userFlags:${c}, userIp:${l}`),!(e&&t&&i&&s))return Di.g.log(3,`MyHeartEngine::start : invalid input parameters url:${e}, nick:${t}, fullname:${n}, devPwd:${i}, devId:${s}, userData:${a}, userFlags:${c}, userIp:${l}`),!1;if(!this.isStopped())return Di.g.log(3,`MyHeartEngine::start : invalid engine state ${this.mEngineState}`),!1;Ko(c,Dl.MYHEART_LOGIN_FLAG_MEDIASTATE3)&&(c|=Dl.MYHEART_LOGIN_FLAG_MEDIASTATE2),this.clearStopTimer(),this.mCfg.url=e,this.mCfg.nick=t,this.mCfg.fullname=n,this.mCfg.devPwd=i,this.mCfg.devId=s,this.mCfg.maxConnectAttempts=o,this.mCfg.intervalSecBetweenAttempts=r,this.mCfg.userData=a,this.mCfg.flags=c,this.mCfg.userIp=l,this.mCfg.sessionId=nr(10),this.mYoutubeLiveStreamIngestionActive=!1,this.mCheckConnTimer=new dl((e=>{this.checkConnection(e)}),2e3,this.mTimerWorker),this.mCheckStateTimer=new dl((()=>{this.checkState()}),2e4,this.mTimerWorker),this.mMyHeartJanus.setEventHandlers((()=>{this.authUser()}),((e,t,n,i)=>{const s=this.mCallbackManager.getters().localStreamCB();s&&s(e,t,n,i),i&&n==this.mMyHeartJanus.labelPublisher()&&(Di.g.log(3,"MyHeartEngine::localStreamCB : publish error..."),this.notifyPublishError(i))}),((e,t,n)=>{if(n==this.mMyHeartJanus.labelIrmCtrl())this.notifyMessage(e);else if(t&&n==this.mMyHeartJanus.labelPublisher()){const t=e.video_codec;Di.g.log(3,`MyHeartEngine::pub publish local stream ack (video:${t}, pending:${this.isPublishPending()})`);const n=!!t,i=!1;this.notifyPublishStatus(n,i)}}),(()=>{this.mConnFailTimer||(Di.g.log(3,"MyHeartEngine::received connection failed notification"),this.mConnFailTimer=new ul((()=>{this.mConnFailTimer=void 0;const e=this.mCallbackManager.getters().startFailedCB();e&&e("Timeout")}),500,this.mTimerWorker))}),(()=>{Di.g.log(3,"MyHeartEngine::connection closed... "+(this.isStopped()?"(Already stopped)":"")),this.handleConnClosed()}),((e,t)=>{const n=e.getAudioTracks().length,i=e.getVideoTracks().length;Di.g.log(3,`MyHeartEngine::remoteStreamCB: id:${t}, audioTracks:${n}, videoTracks:${i}`),this.mMediaStreams.set(t,{stream:e,newTrack:!0}),this.updateMediaState()}),((e,t,n,i)=>{const s=this.mCallbackManager.getters().localStreamTrackEndedCB();s&&s(e,t,n,i)}),(e=>{Di.g.log(3,`MyHeartEngine::received cleanup notification for media ${e}`),this.updateMediaState(!0)}),(()=>{this.clearConnFailTimer(),this.mConnReconnect=!1,this.mConnReconnectTs=0,this.mCurReconnectAttempts=0;const e=this.mCallbackManager.getters().connectCB();e&&e(),this.authUser()}),(()=>{const e=this.mCallbackManager.getters().screenSharingReadyCB();if(e)return e()}),((e,t)=>{this.handleMuteUnmute(e,t)}),((e,t)=>{this.handleMuteUnmute(e,t)}),(e=>this.mediaInfo(e)),(()=>{this.checkRepublishAVConf()}),(e=>{const t=this.mCallbackManager.getters().slowLinkCB();t&&t(e)}),(e=>{const t=this.mCallbackManager.getters().publisherStateCB();t&&t(e,this.isPublishPending())}),(()=>{this.onScreenUnpublished()}),((e,t)=>{const n=this.mCallbackManager.getters().statsUpdateCB();n&&n(e,t)}),(e=>{Di.g.log(3,`MyHeartEngine : NETWORK ALERT! code:${e}`);const t=this.mCallbackManager.getters().networkAlertCB();t&&t()})),this.mMyHeartJanus.start(this.mCfg.url,this.mCfg.sessionId,this.mCfg.nick),this.mEngineState=1;const d=this.mCallbackManager.getters().connectCB();return d&&d(),!0}stop(){this.isStopped()||(Di.g.log(3,"MyHeartEngine::stop"),this.mEngineState=0,this.mSrvClientId=0,this.mServerName="",this.mAcsNick="",this.mPpcsNick="",this.mMediaIdSelected=void 0,this.mMediaState=new Map,this.mMediaStateList=[],this.mMediaStateByUser=new Map,this.mMediaStreams=new Map,this.mTxEnabled=!1,this.mMediaVoice=!1,this.mConnReconnect=!1,this.mConnReconnectTs=0,this.mCurReconnectAttempts=0,this.mChannel=null,this.mYoutubeLiveStreamIngestionActive=!1,this.mLastPingSndTs=0,this.mLastCmdRcvTs=0,this.mMediaVoiceUser=void 0,this.clearCheckStateTimer(),this.clearCheckConnTimer(),this.clearMediaStatePendingTimer(),this.clearPublishPendingTimer(),this.clearConnFailTimer(),this.mAvconf=pl(),this.mScreensharing=ml(),this.mLoggedOut||(this.mRequestCtrl.requestLogout(),Di.g.log(3,"MyHeartEngine::stop : waiting to stop janus..."),this.mStopTimer=new ul((()=>{this.mStopTimer=void 0,Di.g.log(3,"MyHeartEngine::stop : stopping janus now"),this.mMyHeartJanus.stop()}),1e3,this.mTimerWorker)))}checkConnection(e){if(3==this.mEngineState){0==this.mLastCmdRcvTs&&(this.mLastCmdRcvTs=e);const t=e-this.mLastCmdRcvTs;t>6e4?(Di.g.log(3,`MyHeartEngine : checkConnection ping timeout : ${t} ms (last ping:${e-this.mLastPingSndTs} elapsed ms, lastCmdRcvTs:${this.mLastCmdRcvTs})`),this.handleConnClosed()):(0==this.mLastPingSndTs||e>=this.mLastPingSndTs+1e4)&&(this.mRequestCtrl.sendPing(),this.mLastPingSndTs=e)}else if(this.mConnReconnect&&!this.mMyHeartJanus.isConnected())if(this.mCurReconnectAttempts<this.mCfg.maxConnectAttempts){if(0==this.mConnReconnectTs||e>this.mConnReconnectTs+1e3*this.mCfg.intervalSecBetweenAttempts){this.mConnReconnectTs=e,this.mCurReconnectAttempts++;const t=this.mCallbackManager.getters().connectCB();t&&t(),Di.g.log(3,`MyHeartEngine : checkConnection : reconnecting ${this.mCurReconnectAttempts}/${this.mCfg.maxConnectAttempts}...`),this.mMyHeartJanus.reconnect()}}else{Di.g.log(3,`MyHeartEngine : checkConnection : reconnection timeout ${this.mCurReconnectAttempts}/${this.mCfg.maxConnectAttempts}`);const e=this.mCallbackManager.getters().startFailedCB();e&&e("Timeout")}else this.mConnReconnect=!1,this.mConnReconnectTs=0,this.mCurReconnectAttempts=0}checkState(){this.activeMedias().forEach((e=>{const t=this.mediaStats(e),n=this.remoteStream(e),i=n?n.stream?n.stream.getAudioTracks().length:"(stream null)":"(no stream)",s=n?n.stream?n.stream.getVideoTracks().length:"(stream null)":"(no stream)",o=t.stats?t.stats.inbound.video?JSON.stringify(t.stats.inbound.video):"(no inboundVideo)":"(no stats rx)",r=t.stats?t.stats.inbound.audio?JSON.stringify(t.stats.inbound.audio):"(no inboundAudio)":"(no stats rx)";Di.g.log(3,`MyHeartEngine : checkState : idx:${t.m.index}, owner:${t.m.owner}, fullname:${t.m.fullname}, mediaId:${t.m.mediaId}, audioTracks:${i}, videoTracks:${s}, mediaClass:${t.m.mediaClass}, mediaClassFlags:${t.m.mediaClassFlags}, mediaVoice:${t.m.mediaVoice}, active:${t.m.active}, audioMuted:${t.m.audioMuted}, videoMuted:${t.m.videoMuted}, txEnabled:${t.m.txEnabled}, codec:${t.codec}, browser:${t.browser}, inboundVideo:${o}, inboundAudio:${r}`)}))}authUser(){this.mEngineState=2,this.mRequestCtrl.requestLogin(this.mCfg.nick,this.mCfg.fullname,this.mCfg.devPwd,this.mCfg.devId,this.mCfg.userData,this.mCfg.flags,this.mCfg.userIp)}handleSrvUserSignedIn(e){this.mEngineState=3,this.mSrvClientId=e.data[Ml.CMD_PARAM_COMPLEMENT()],this.mServerName=e.data[Ml.CMD_PARAM_SERVER()],this.mServerName||(this.mServerName=""),this.mAcsNick=e.data[Ml.CMD_PARAM_COMPLEMENT2()],this.mPpcsNick=e.data[Ml.CMD_PARAM_COMPLEMENT3()],this.mTxEnabled=!1,this.mMediaVoice=!1,this.mLoggedOut=!1;let t=null;this.mChannel&&(t=this.mChannel,this.mChannel=null);const n=this.mCallbackManager.getters().startedCB();n&&n(this.mSrvClientId,this.mServerName,this.mAcsNick,this.mPpcsNick,t)}handleSrvMediaIdTxExtra(e){if(this.mScreensharing.mediaId=e.data[Ml.CMD_PARAM_MEDIAID()],this.mTxEnabled&&this.mScreensharing.pending){const e=this.mCallbackManager.getters().txStateCB();e&&e(this.mTxEnabled,this.mMediaVoice,!1,!0)}else Di.g.log(3,"MyHeartEngine::handleSrvMediaIdTxExtra : cannot start screen sharing");this.mScreensharing.pending=!1}handleSrvChannelChatMuteSet(e){const t=e.data[Ml.CMD_PARAM_CHANNEL()],n=e.data[Ml.CMD_PARAM_COMPLEMENT()],i=e.data[Ml.CMD_PARAM_SSV()];let s=[];Xo(i)&&(s=i.length>0?i.split(" "):[]);let o=this.mCallbackManager.getters().channelChatMuteSetCB();o&&o(t,n,s)}handleSrvChannelChatMuteList(e){const t=e.data[Ml.CMD_PARAM_CHANNEL()],n=e.data[Ml.CMD_PARAM_SSV()],i=n.length>0?n.split(" "):[],s=this.mCallbackManager.getters().channelChatMuteListCB();s&&s(t,i)}handleSrvTxState(e){const t=e.data[Ml.CMD_PARAM_ENABLED()],n=e.data[Ml.CMD_PARAM_MEDIAVOICE()],i=e.data[Ml.CMD_PARAM_MEDIAID()],s=e.data[Ml.CMD_PARAM_COMPLEMENT()],o=e.data[Ml.CMD_PARAM_FLAGS()];let r=!1,a=!1;t?(this.mAvconf.mediaId=i,s&&(this.mScreensharing.mediaId=s),this.mAvconf.pending&&(this.mAvconf.pending=!1,r=!0),this.mScreensharing.pending&&0!=this.mScreensharing.mediaId&&(this.mScreensharing.pending=!1,a=!0),r||a||(r=!0)):(this.mScreensharing.pending=!1,this.mAvconf.pending=!1),this.mTxEnabled=t,this.mMediaVoice=n,this.mTxEnabled||(this.mAvconf.disabled=!0,this.mScreensharing.disabled=!0);const c=!(!Xo(o)||!Ko(o,1));if(!c){const e=this.mCallbackManager.getters().txStateCB();e&&e(this.mTxEnabled,this.mMediaVoice,r,a)}this.mAvconf.disabled=!1,this.mScreensharing.disabled=!1,c&&this.mTxEnabled&&this.publish(),this.mTxEnabled||(this.unpublish(),this.unpublishScreen())}handleSrvChannelList(e){const t=this.mCallbackManager.getters().channelListCB(),n=Array.isArray(e.data)?e.data:e.data[Ml.CMD_PARAM_LIST()];t&&t(n)}handleSrvEnterChannel(e){const t=e.data[Ml.CMD_PARAM_CHANNEL()],n=e.data[Ml.CMD_PARAM_CODE()],i=e.data[Ml.CMD_PARAM_FLAGS()],s=e.data[Ml.CMD_PARAM_MCAST()],o=e.data[Ml.CMD_PARAM_USERCOUNT()],r=e.data[Ml.CMD_PARAM_VOICEUSERS()],a=e.data[Ml.CMD_PARAM_TOPIC()];if(0===n||100===n){0===n&&(this.mAvconf=pl(),this.mScreensharing=ml()),this.mChannel=t;const i=parseInt(e.data[Ml.CMD_PARAM_COMPLEMENT()]);this.mMyHeartJanus.setRoomId(i)}else this.mChannel=null;this.mMediaIdSelected=void 0,this.mMediaState.clear(),this.mMediaStateList=[],this.mMediaStateByUser.clear(),this.mMediaStreams.clear(),this.mMediaVoiceUser=void 0;const c=this.mCallbackManager.getters().enterChannelCB();c&&c(t,n,i,s,o,r,a)}handleSrvUserList(e){const t=e.data[Ml.CMD_PARAM_CHANNEL()],n=e.data[Ml.CMD_PARAM_LIST()],i=[];if(Array.isArray(n))for(let e=0;e<n.length;e++){const t=n[e],s={};s.name=t[Ml.CMD_PARAM_USERNAME()],s.fullname=t[Ml.CMD_PARAM_FULLNAME()],s.mode=t[Ml.CMD_PARAM_MODE()],s.umode=t[Ml.CMD_PARAM_UMODE()],s.umode||(s.umode=0),i.push(s)}const s=this.mCallbackManager.getters().userListCB();s&&s(i,t)}handleSrvUserJoin(e){const t=e.data[Ml.CMD_PARAM_USERNAME()],n=e.data[Ml.CMD_PARAM_FULLNAME()],i=e.data[Ml.CMD_PARAM_UMODE()],s=this.mCallbackManager.getters().userJoinCB();s&&s(t,n,i||0)}handleSrvUserLeave(e){const t=e.data[Ml.CMD_PARAM_USERNAME()],n=e.data[Ml.CMD_PARAM_REASON()],i=this.mCallbackManager.getters().userLeaveCB();i&&i(t,n)}handleSrvKicked(e){const t=e.data[Ml.CMD_PARAM_CHANNEL()],n=e.data[Ml.CMD_PARAM_USERNAME()];this.mChannel&&t===this.mChannel&&(this.mChannel=null,this.mMyHeartJanus.leaveRoom());const i=this.mCallbackManager.getters().kickedCB();i&&i(t,n)}removeFromMediaState(e,t,n,i){let s=!1;t||(t=this.mMediaState),n||(n=this.mMediaStateList),i||(i=this.mMediaStateByUser);const o=t.get(e);if(o){t.delete(o);let e=0;e=n.indexOf(o),e>=0&&n.splice(e,1);const r=i.get(o.owner);r&&(e=r.indexOf(o),e>=0&&r.splice(e,1),0===r.length&&i.delete(o.owner)),s=!0}return s}addToMediaState(e,t,n,i){const s={index:e[Ml.CMD_PARAM_INDEX()],owner:e[Ml.CMD_PARAM_USERNAME()],fullname:e[Ml.CMD_PARAM_FULLNAME()],mediaId:e[Ml.CMD_PARAM_MEDIAID()],mediaClass:e[Ml.CMD_PARAM_MEDIACLASS()],mediaClassFlags:e[Ml.CMD_PARAM_MEDIACLASS_FLAGS()],mediaVoice:e[Ml.CMD_PARAM_MEDIAVOICE()],active:e[Ml.CMD_PARAM_ACTIVE()],audioMuted:!1,videoMuted:!1,txEnabled:!0},o=e[Ml.CMD_PARAM_ENABLED()];Xo(o)&&(s.txEnabled=o),s.screen=9==s.mediaClass||8==s.mediaClass&&1==s.mediaClassFlags,s.me=this.isMe(s.owner),s.ownerBase=Li.removeSuffixStartingFromSubstring(s.owner,"-").trim(),Di.g.log(3,`MyHeartEngine::addMediaToState: index:${s.index}, owner:${s.owner}, me:${s.me}, mid:${s.mediaId}, mc:${s.mediaClass}, mcf:${s.mediaClassFlags}, mv:${s.mediaVoice}, active:${s.active}, screen:${s.screen}`),t||(t=this.mMediaState),n||(n=this.mMediaStateList),i||(i=this.mMediaStateByUser),this.removeFromMediaState(s.mediaId,t,n,i),t.set(s.mediaId,s),n.push(s);let r=i.get(s.owner);r||(r=[],i.set(s.owner,r)),r.push(s),s.mediaVoice&&(this.mMediaVoiceUser=s.owner)}handleSrvMediaState(e){if(null==this.mChannel)return void Di.g.log(3,"MyHeartEngine::handleSrvMediaState : ignoring (not in channel)");const t=e.data[Ml.CMD_PARAM_MEDIAID()],n=e.data[Ml.CMD_PARAM_LIST()],i=new Map,s=[],o=new Map;if(this.mMediaVoiceUser=void 0,4294967295!=t&&Di.g.log(3,`MyHeartEngine::handleSrvMediaState: mediaIdSelected:${t}`),Array.isArray(n))for(let e=0;e<n.length;e++)this.addToMediaState(n[e],i,s,o);this.mMediaIdSelected=t,this.mMediaState=i,this.mMediaStateList=s,this.mMediaStateByUser=o,this.updateMediaState()}handleSrvMediaUpdate(e){const t=e.data[Ml.CMD_PARAM_LIST()];let n=!1;if(Array.isArray(t))for(let e=0;e<t.length;e++){const i=t[e],s=i[Ml.CMD_PARAM_FLAGS()],o=i[Ml.CMD_PARAM_MEDIAID()];Ko(s,1)?(this.addToMediaState(i),n=!0):Ko(s,2)&&this.removeFromMediaState(o)&&(n=!0);const r=this.mediaInfo(o);if(r){const e=Ko(s,4),t=Ko(s,8);if(e!=r.audioMuted||t!=r.videoMuted){r.audioMuted=e,r.videoMuted=t;const i=this.mCallbackManager.getters().mediaMutedByServerCB();i&&i(o,r.audioMuted,r.videoMuted),n=!0}const a=i[Ml.CMD_PARAM_ACTIVE()];Xo(a)&&a!=r.active&&(r.active=a,n=!0);const c=i[Ml.CMD_PARAM_ENABLED()];Xo(c)&&c!=r.txEnabled&&(r.txEnabled=c,n=!0);const l=i[Ml.CMD_PARAM_MEDIAVOICE()];Xo(l)&&l!=r.mediaVoice&&(r.mediaVoice=l,n=!0)}}const i=e.data[Ml.CMD_PARAM_MEDIAID()];Xo(i)&&(this.mMediaIdSelected=i),n&&this.updateMediaState()}updateMediaState(e){if(Xo(e)&&!0===e)return this.clearMediaStatePendingTimer(),void this.notifyMediaState();this.mCheckMediaStatePendingTimer||(this.mCheckMediaStatePendingTimer=new ul((()=>{this.updateMediaState(!0)}),50,this.mTimerWorker))}getMediaState(){Di.g.log(3,"MyHeartEngine::getMediaState: returning local media state..."),this.updateMediaState(!0)}remoteStream(e){return this.mMediaStreams.get(e)}localStream(e){return this.mMyHeartJanus.localStream(e)}notifyMediaState(){const e=new Map,t=[];this.mMediaStateList.forEach((n=>{let i,s=!1;if(this.mCfg.nick===n.owner)i=this.localStream(n.mediaId);else{const e=this.remoteStream(n.mediaId);e&&(i=e.stream,s=e.newTrack,e.newTrack=!1)}e.set(n.mediaId,{metadata:n,stream:i,newTrack:s}),t.push(n.mediaId)}));const n=this.mCallbackManager.getters().mediaStateCB();n&&n(e,this.mAvconf.mediaId,this.mScreensharing.mediaId,this.mMediaIdSelected,t)}handleSrvPrivMsg(e){const t=e.data[Ml.CMD_PARAM_SOURCE()],n=e.data[Ml.CMD_PARAM_UMODE()],i=e.data[Ml.CMD_PARAM_CHANNELMSG()],s=e.data[Ml.CMD_PARAM_MODE()],o=e.data[Ml.CMD_PARAM_MESSAGE()],r=xl();if(r.isCTCP(o)){const e=r.CTCP().parse(o);if(e){const i=this.mCallbackManager.getters().ctcpCB();i&&i(t,n,e.identifier,e.params)}else Di.g.log(3,`MyHeartEngine::handleSrvPrivMsg: could not parse ctcp message: ${o}`)}else{const e=r.CHAT().parse(o),a=this.mCallbackManager.getters().chatMessageCB();a&&a(t,n,i,s,e.seq,e.message)}}handleSrvUserModes(e){const t=e.data[Ml.CMD_PARAM_USERNAME()],n=e.data[Ml.CMD_PARAM_UMODE()],i=e.data[Ml.CMD_PARAM_FLAGS()],s=this.mCallbackManager.getters().userModesCB();s&&s(t,n,i)}handleSrvNotifyOnlineUsers(e){}handleSrvChannelModes(e){const t=e.data[Ml.CMD_PARAM_CHANNEL()],n=e.data[Ml.CMD_PARAM_MODE()],i=e.data[Ml.CMD_PARAM_MODEPARAM()],s=e.data[Ml.CMD_PARAM_FLAGS()],o=e.data[Ml.CMD_PARAM_LIST()],r=[];if(Array.isArray(o))for(let e=0;e<o.length;e++){const t=o[e],n={mode:t[Ml.CMD_PARAM_MODE()],modeParam:t[Ml.CMD_PARAM_MODEPARAM()],timeElapsed:t[Ml.CMD_PARAM_TIME_ELAPSED()],add:!0};r.push(n)}const a=this.mCallbackManager.getters().channelModesCB();a&&a(t,n,i,s,r)}handleSrvChannelXMode(e){const t=e.data[Ml.CMD_PARAM_CHANNEL()],n=e.data[Ml.CMD_PARAM_MODE()],i=e.data[Ml.CMD_PARAM_MODEPARAM()],s=this.mCallbackManager.getters().channelXModeCB();s&&s(t,n,i)}handleSrvChannelTopic(e){const t=e.data[Ml.CMD_PARAM_CHANNEL()],n=e.data[Ml.CMD_PARAM_USERNAME()],i=e.data[Ml.CMD_PARAM_TOPIC()],s=this.mCallbackManager.getters().topicCB();s&&s(t,n,i)}handleSrvCloudstreamAck(e){}handleSrvPing(e){}handleSrvLostPkts(e){}handleSrvMediaMute(e){const t=e.data[Ml.CMD_PARAM_USERNAME()],n=e.data[Ml.CMD_PARAM_CHANNEL()],i=e.data[Ml.CMD_PARAM_COMPLEMENT()],s=this.mCallbackManager.getters().mediaMuteCB();s&&s(t,n,i)}handleSrvChannelBanList(e){const t=e.data[Ml.CMD_PARAM_CHANNEL()],n=e.data[Ml.CMD_PARAM_LIST()],i=[];if(Array.isArray(n))for(let e=0;e<n.length;e++)i.push(n[e]);const s=this.mCallbackManager.getters().channelBanListCB();s&&s(t,i)}handleSrvStatus(e){const t=e.data[Ml.CMD_PARAM_SEQREF()],n=e.data[Ml.CMD_PARAM_CODE()],i=e.data[Ml.CMD_PARAM_COMPLEMENT()],s=e.data[Ml.CMD_PARAM_COMPLEMENT2()],o=e.data[Ml.CMD_PARAM_COMPLEMENT3()],r=e.data[Ml.CMD_PARAM_COMPLEMENT4()],a=e.data[Ml.CMD_PARAM_COMPLEMENT5()];switch(n){case Ll.STATUS_CODE_USER_NOT_SIGNED_IN:this.authUser();break;case Ll.STATUS_CODE_ALREADY_SIGNED_IN:this.mEngineState=3,this.mRequestCtrl.requestTxState();break;case Ll.STATUS_CODE_LOGOUT:const e=i.length>0?parseInt(i):0;Di.g.log(3,`MyHeartEngine::received logout from server, code:${e}`),this.mLoggedOut=!0,this.stop(),this.mLoggedOut=!1;const t=this.mCallbackManager.getters().terminatedCB();t&&t(e)}const c=this.mCallbackManager.getters().statusCB();c&&c(t,n,i,s,o,r,a)}handleSrvUserEvent(e){}handleSrvApiLevel(e){e.data[Ml.CMD_PARAM_API()]}handleSrvChannelInfo(e){const t=e.data[Ml.CMD_PARAM_CHANNEL()],n=e.data[Ml.CMD_PARAM_FLAGS()],i=e.data[Ml.CMD_PARAM_USERCOUNT()],s=this.mCallbackManager.getters().channelInfoCB();s&&s(t,n,i)}handleSrvAuthError(e){const t=this.mCallbackManager.getters().startFailedCB();t&&t("AuthError")}handleMuteUnmute(e,t){const n=this.mediaInfo(t);n?!1===n.screen&&"video"===e.kind&&(Di.g.log(3,`MyHeartEngine::handleMuteUnmute : mediaId:${t}, kind:${e.kind}, muted:${e.muted}`),this.updateMediaState()):Di.g.log(3,`MyHeartEngine::handleMuteUnmute : m is undefined (mediaId:${t})`)}handleConnClosed(){if(this.isStopped())return;Di.g.log(3,"MyHeartEngine::handleConnClosed"),this.clearConnFailTimer();let e=!0;const t=this.mCallbackManager.getters().connClosedCB();t&&(e=t()),this.mConnReconnect=e,this.mConnReconnectTs=0,this.mLastPingSndTs=0,this.mLastCmdRcvTs=0,this.mConnReconnect?this.mEngineState=1:this.isStopped()||this.isConnecting()||(Di.g.log(3,"handleConnClosed : stopping engine"),this.stop())}clearCheckConnTimer(){this.mCheckConnTimer&&(this.mCheckConnTimer.stop(),this.mCheckConnTimer=void 0)}clearCheckStateTimer(){this.mCheckStateTimer&&(this.mCheckStateTimer.stop(),this.mCheckStateTimer=void 0)}clearMediaStatePendingTimer(){this.mCheckMediaStatePendingTimer&&(this.mCheckMediaStatePendingTimer.stop(),this.mCheckMediaStatePendingTimer=void 0)}clearConnFailTimer(){this.mConnFailTimer&&(this.mConnFailTimer.stop(),this.mConnFailTimer=void 0)}clearStopTimer(){this.mStopTimer&&(this.mStopTimer.stop(),this.mStopTimer=void 0)}notifyMessage(e){Di.g.log(3,`MyHeartEngine::notifyMessage: ${e}`);const t=$l.parse(e);if(this.mLastCmdRcvTs=Date.now(),Xo(t))switch(t.cmd){case Tl.SRV_MSG_TXSTATE():this.handleSrvTxState(t);break;case Tl.SRV_MSG_CHANNELLIST():this.handleSrvChannelList(t);break;case Tl.SRV_MSG_ENTERCHANNEL():this.handleSrvEnterChannel(t);break;case Tl.SRV_MSG_PRIVMSG():this.handleSrvPrivMsg(t);break;case Tl.SRV_MSG_USERJOIN():this.handleSrvUserJoin(t);break;case Tl.SRV_MSG_USERLEAVE():this.handleSrvUserLeave(t);break;case Tl.SRV_MSG_KICKED():this.handleSrvKicked(t);break;case Tl.SRV_MSG_MEDIASTATE():this.handleSrvMediaState(t);break;case Tl.SRV_MSG_MEDIAUPDATE():this.handleSrvMediaUpdate(t);break;case Tl.SRV_MSG_USERLIST():this.handleSrvUserList(t);break;case Tl.SRV_MSG_SIGNEDIN():this.handleSrvUserSignedIn(t);break;case Tl.SRV_MSG_AUTHERROR():this.handleSrvAuthError(t);break;case Tl.SRV_MSG_CHANNELMODES():this.handleSrvChannelModes(t);break;case Tl.SRV_MSG_CHANNELXMODE():this.handleSrvChannelXMode(t);break;case Tl.SRV_MSG_USERMODES():this.handleSrvUserModes(t);break;case Tl.SRV_MSG_ONLINE_USERS():this.handleSrvNotifyOnlineUsers(t);break;case Tl.SRV_MSG_STATUS():this.handleSrvStatus(t);break;case Tl.SRV_MSG_USER_EVENT():this.handleSrvUserEvent(t);break;case Tl.SRV_MSG_CHANNEL_TOPIC():this.handleSrvChannelTopic(t);break;case Tl.SRV_MSG_RX_QUALITY_AVAILABLE():break;case Tl.SRV_MSG_CLOUDSTREAM_ACK():this.handleSrvCloudstreamAck(t);break;case Tl.SRV_MSG_PING():this.handleSrvPing(t);break;case Tl.SRV_MSG_SRV_LOST_PKTS():this.handleSrvLostPkts(t);break;case Tl.SRV_MSG_MEDIA_MUTE():this.handleSrvMediaMute(t);break;case Tl.SRV_MSG_CHANNEL_BAN_LIST():this.handleSrvChannelBanList(t);break;case Tl.SRV_MSG_APILEVEL():this.handleSrvApiLevel(t);break;case Tl.SRV_MSG_CHANNEL_INFO():this.handleSrvChannelInfo(t);break;case Tl.SRV_MSG_MEDIAIDTXEXTRA():this.handleSrvMediaIdTxExtra(t);break;case Tl.SRV_MSG_CHANNEL_CHAT_MUTE_SET():this.handleSrvChannelChatMuteSet(t);break;case Tl.SRV_MSG_CHANNEL_CHAT_MUTE_LIST():this.handleSrvChannelChatMuteList(t);break;default:Di.g.log(3,`MyHeartEngine::notifyMessage: invalid message ${e}`)}else Di.g.log(3,`MyHeartEngine::could not parse message ${e}`)}startPublishPending(){Di.g.log(3,"MyHeartEngine::startPublishPending");const e=this.mCallbackManager.getters().publisherConnectingCB();e&&e(),this.clearPublishPendingTimer(),this.mAvconf.publishPendingTimer=new ul((()=>{Di.g.log(3,"MyHeartEngine::startPublishPending : publish pending timeout"),this.notifyPublishStatus(void 0,!0)}),1e4,this.mTimerWorker)}notifyPublishError(e){this.notifyPublishStatus(void 0,!1,e)}notifyPublishStatus(e,t,n){this.clearPublishPendingTimer(),(n||t)&&(Di.g.log(3,"MyHeartEngine::notifyPublishStatus : unpublishing..."),this.mMyHeartJanus.unpublish());const i=this.mCallbackManager.getters().publishResponseCB();i&&i(e,t,n)}clearPublishPendingTimer(){this.mAvconf.publishPendingTimer&&(this.mAvconf.publishPendingTimer.stop(),this.mAvconf.publishPendingTimer=void 0)}prePublishScreen(){this.mScreensharing.pending=!0,this.mRequestCtrl.requestMediaIdTxExtra()}setCaptureSource(e,t,n){if(this.isPublishPending())return void Di.g.log(3,`MyHeartEngine::setCaptureSource : PUBLISH PENDING (waiting response) : audioSource:${e}, videoSource:${t}, extStream:${Xo(n)}, txEnabled:${this.mTxEnabled}, published:${this.isPublished()}`);const i=void 0!==e,s=void 0!==t;e==this.mAvconf.audioSource&&t==this.mAvconf.videoSource&&i==this.mAvconf.useAudio&&s==this.mAvconf.useVideo&&function(e,t){let n=!!(e&&!t||!e&&t);if(!n&&e&&t){const i=e.getAudioTracks(),s=e.getVideoTracks(),o=t.getAudioTracks(),r=t.getVideoTracks();if(i.length!=o.length||s.length!=r.length)n=!0;else{const e=i.length>0?i[0].getSettings().deviceId:void 0,t=s.length>0?s[0].getSettings().deviceId:void 0,a=o.length>0?o[0].getSettings().deviceId:void 0,c=r.length>0?r[0].getSettings().deviceId:void 0;e==a&&t==c||(n=!0)}}return!n}(this.mAvconf.extStream,n)||(this.mAvconf.audioSource=e,this.mAvconf.videoSource=t,this.mAvconf.useAudio=i,this.mAvconf.useVideo=s,this.mAvconf.extStream=n,Di.g.log(3,`MyHeartEngine::setCaptureSource : useAudio:${i}, useVideo:${s}, audioSource:${e}, videoSource:${t}, extStream:${Xo(n)}, txEnabled:${this.mTxEnabled}, published:${this.isPublished()}`),this.checkRepublishAVConf())}checkRepublishAVConf(){this.isPublished()&&this.mTxEnabled&&(Di.g.log(3,"MyHeartEngine::checkRepublishAVConf"),this.mMyHeartJanus.republish(this.mAvconf),this.startPublishPending())}checkPublishParams(e,t,n,i,s){if(0==this.mAvconf.mediaId)return Di.g.log(3,"MyHeartEngine::checkPublishParams : cannot publish since mediaId is not set"),!1;if(!this.mTxEnabled)return Di.g.log(3,"MyHeartEngine::checkPublishParams : cannot publish since transmission is not set"),!1;if(this.mAvconf.disabled)return Di.g.log(3,"MyHeartEngine::checkPublishParams : cannot publish since avconf is disabled"),!1;if(Xo(s)){const t=s?{type:hl.labelPublisher(),mediaId:0,bitrate:1024e3,useAudio:!0,useVideo:!0,pending:!1,disabled:!1,videoSource:null,audioSource:null,videoPrefRes:"hires",videoHi:!0,videoTrackConstraints:{width:{min:640,ideal:1280},height:{min:360,ideal:720},frameRate:15},publishPendingTimer:void 0}:pl();this.setAvConfBitrate(e||t.bitrate),this.mAvconf.videoPrefRes=t.videoPrefRes,this.mAvconf.videoHi=t.videoHi,this.mAvconf.videoTrackConstraints=t.videoTrackConstraints}else Xo(i)&&(this.mAvconf.videoPrefRes=i),Xo(e)&&this.setAvConfBitrate(e);return Xo(t)&&(this.mAvconf.useAudio=t),Xo(n)&&(this.mAvconf.useVideo=n),!0}publish(e,t,n,i,s){return Di.g.log(3,"MyHeartEngine::publish"),!!this.checkPublishParams(e,t,n,i,s)&&(this.mMyHeartJanus.publish(this.mAvconf.mediaId,this.mAvconf.bitrate,this.mAvconf.useAudio,this.mAvconf.useVideo,this.mAvconf.videoSource,this.mAvconf.audioSource,this.mAvconf.videoPrefRes,this.mAvconf.videoTrackConstraints,this.mAvconf.extStream),this.startPublishPending(),!0)}publishRestart(e,t,n,i,s){if(Di.g.log(3,"MyHeartEngine::publishRestart"),!this.checkPublishParams(e,t,n,i,s))return!1;this.mMyHeartJanus.republish(this.mAvconf),this.startPublishPending()}unpublish(){return Di.g.log(3,"MyHeartEngine::unpublish"),this.mMyHeartJanus.unpublish(),!0}toggleScreen(){let e=!1;return this.isScreenReady()?this.isScreenPublished()?this.unpublishScreen():(this.publishScreen(),e=!0):this.prePublishScreen(),e}publishScreen(e,t,n,i){if(Di.g.log(3,"MyHeartEngine::publishScreen"),!this.isScreenReady())return Di.g.log(3,"MyHeartEngine::publishScreen : cannot publish screen since it is not ready"),!1;if(!this.mTxEnabled)return Di.g.log(3,"MyHeartEngine::publishScreen : cannot publish screen since we do not have voice or mediavoice"),!1;if(this.mScreensharing.disabled)return Di.g.log(3,"MyHeartEngine::publishScreen : cannot publish screensharing since is disabled"),!1;if(this.mYoutubeLiveStreamIngestionActive){const e=wl();this.setScreenSharingBitrate(e.bitrate),this.setScreenSharingFrameRate(e.framerate)}else Xo(e)&&this.setScreenSharingBitrate(e),Xo(t)&&this.setScreenSharingFrameRate(t),Xo(n)&&(this.mScreensharing.useAudio=n);Di.g.log(3,`MyHeartEngine::publishScreen : mediaId:${this.mScreensharing.mediaId}, bitrate:${this.mScreensharing.bitrate}, framerate:${this.mScreensharing.framerate}, useAudio:${this.mScreensharing.useAudio}, now:${i}`),this.mMyHeartJanus.publishScreen(this.mScreensharing.mediaId,this.mScreensharing.bitrate,this.mScreensharing.framerate,this.mScreensharing.useAudio,i);const s=this.mCallbackManager.getters().screenSharingPublishedCB();return s&&s(),!0}setAvConfBitrate(e){return this.setStreamBitrate(e,!0)}setScreenSharingBitrate(e){return this.setStreamBitrate(e,!1)}setStreamBitrate(e,t){const n=t?this.mAvconf:this.mScreensharing;if(e){const i=t?64e3:256e3,s=2048e3;n.bitrate=e<i?i:e>s?s:e}return n.bitrate}setScreenSharingFrameRate(e){if(e){const t=1,n=60;this.mScreensharing.framerate=e<t?t:e>n?n:e}return this.mScreensharing.framerate}publishScreenNow(){this.publishScreen(this.mScreensharing.bitrate,this.mScreensharing.framerate,this.mScreensharing.useAudio,!0)}onScreenUnpublished(){const e=this.mCallbackManager.getters().screenSharingUnpublishedCB();e&&e()}unpublishScreen(){return Di.g.log(3,"MyHeartEngine::unpublishScreen"),this.mScreensharing.disabled?(Di.g.log(3,"MyHeartEngine::unpublishScreen : cannot unpublish screensharing since it is disabled"),!1):!!this.isScreenPublished()&&(0!=this.mScreensharing.mediaId&&(this.mRequestCtrl.requestMediaIdTxExtraDestroy(this.mScreensharing.mediaId),this.mScreensharing.mediaId=0),this.mMyHeartJanus.unpublishScreen(),!0)}isScreenReady(){return 0!=this.mScreensharing.mediaId}isScreenPublished(){return this.mMyHeartJanus.isScreenPublished()}isAudioMuted(e){return this.mMyHeartJanus.isAudioMuted(e)}muteAudio(e){return this.mMyHeartJanus.muteAudio(e)}unmuteAudio(e){return this.mMyHeartJanus.unmuteAudio(e)}isVideoMuted(e){return this.mMyHeartJanus.isVideoMuted(e)}muteVideo(e){return this.mMyHeartJanus.muteVideo(e)}unmuteVideo(e){return this.mMyHeartJanus.unmuteVideo(e)}listDevices(e){this.mMyHeartJanus.listDevices(e)}attachMediaStream(e,t){this.mMyHeartJanus.attachMediaStream(e,t)}setBitrate(e){this.mMyHeartJanus.setBitrate(this.setAvConfBitrate(e))}setBitrateScreen(e){this.mMyHeartJanus.setBitrateScreen(this.setScreenSharingBitrate(e))}setTxVideoCodecDefault(){this.mMyHeartJanus.setTxVideoCodec(null)}setTxVideoCodecH264(){this.mMyHeartJanus.setTxVideoCodec("h264")}setTxVideoCodecVP9(){this.mMyHeartJanus.setTxVideoCodec("vp9")}setTxVideoCodecVP8(){this.mMyHeartJanus.setTxVideoCodec("vp8")}getTxVideoCodec(){return this.mMyHeartJanus.getTxVideoCodec()}setRxVideoCodecDefault(){this.mMyHeartJanus.resetRxVideoCodec()}setRxVideoCodecH264(){return this.mMyHeartJanus.setRxVideoCodec("h264")}setRxVideoCodecVP9(){return this.mMyHeartJanus.setRxVideoCodec("vp9")}setRxVideoCodecVP8(){return this.mMyHeartJanus.setRxVideoCodec("vp8")}getRxVideoCodec(){return this.mMyHeartJanus.getRxVideoCodec()}mediaIdSelected(){return this.mMediaIdSelected}activeMedias(){const e=[];return this.mMediaStateList.forEach((t=>{e.push(t.mediaId)})),e}mediaInfo(e){return this.mMediaState.get(e)}mediaInfoAt(e){let t=null;return e<this.mMediaStateList.length&&(t=this.mMediaStateList[e]),t}getUserMediaInfoList(e){const t=this.mMediaStateByUser.get(e);return void 0===t?[]:t}mediaStats(e){let t=null;const n=this.mediaInfo(e);return n&&(t={m:n},t.stats=this.mMyHeartJanus.getStats(e),t.browser=tl.webRTCAdapter.browserDetails.browser,this.isMe(n.owner)?t.codec=this.getTxVideoCodec():t.codec=this.getRxVideoCodec()),t}isTxEnabled(){return this.mTxEnabled}isMediaVoice(){return this.mMediaVoice}mediaVoiceUser(){return this.mMediaVoiceUser}connectionStatus(){return{connected:this.mMyHeartJanus.isConnected(),reconnAttempts:this.mCurReconnectAttempts,reconnAttemptsMax:this.mCfg.maxConnectAttempts}}txInfoAvconf(){const e=this.localStream(this.mAvconf.mediaId);return{avconf:!0,screen:!1,mediaId:this.mAvconf.mediaId,type:this.mAvconf.type,extStream:this.mAvconf.extStream,stream:e}}txInfoScreen(){const e=this.localStream(this.mScreensharing.mediaId);return{avconf:!1,screen:!0,mediaId:this.mScreensharing.mediaId,type:this.mScreensharing.type,stream:e}}txInfo(e){switch(e){case this.mAvconf.type:return this.txInfoAvconf();case this.mScreensharing.type:return this.txInfoScreen();default:return Di.g.log(3,`MyHeartEngine::txInfo : invalid type ${e}`),null}}isCapturing(e,t){let n,i=!1;if(e===this.mAvconf.type?n=this.txInfoAvconf():e===this.mScreensharing.type&&(n=this.txInfoScreen()),n&&n.stream){const e=n.stream.getTracks();for(let n=0;n<e.length;n++)if(e[n].kind===t){i=!0;break}}return i}isAVConfVideoHi(){return this.mAvconf.videoHi}isCapturingAudioCam(){return this.isCapturing(this.mAvconf.type,"audio")}isCapturingVideoCam(){return this.isCapturing(this.mAvconf.type,"video")}isTxTypeAVConf(e){return this.mAvconf.type===e}getTxTypeAVConf(){return this.mAvconf.type}isTxTypeScreen(e){return this.mScreensharing.type===e}getTxTypeScreen(){return this.mScreensharing.type}isPublishPending(){return Xo(this.mAvconf.publishPendingTimer)}isPublished(){return this.mMyHeartJanus.isPublished()}startYoutubeLiveStreamIngestion(e,t,n){if(!this.mTxEnabled)return Di.g.log(3,"MyHeartEngine::startYoutubeLiveStreamIngestion : cannot start youtube transmisssion since user has no tx status"),!1;let i=!1;if("string"==typeof e&&e.length>0&&"string"==typeof t&&t.length>0){const s=e.toLowerCase(),o=t.toLowerCase();try{const e=new URL(s);if("rtmp:"===e.protocol||"rtmps:"===e.protocol){if(Di.g.log(3,`MyHeartEngine::startYoutubeLiveStreamIngestion : url:${s}, key:${o}, flags:${n}`),this.mRequestCtrl.requestStreamStart(s,o,n,1),this.mYoutubeLiveStreamIngestionActive=!0,this.isScreenPublished()){let e=wl();this.mScreensharing.bitrate==e.bitrate&&this.mScreensharing.framerate==e.framerate||(this.unpublishScreen(),Di.g.log(3,"MyHeartEngine::startYoutubeLiveStreamIngestion : please restart screen sharing because current parameters are suboptimal for youtube"))}i=!0}else Di.g.log(3,`MyHeartEngine::startYoutubeLiveStreamIngestion : invalid parameters url:${s}, key:${o}`)}catch(e){Di.g.log(3,`MyHeartEngine::startYoutubeLiveStreamIngestion : invalid url:${s}`)}}else Di.g.log(3,`MyHeartEngine::startYoutubeLiveStreamIngestion : invalid parameters url:${e}, key:${streamKey}`);return i}stopYoutubeLiveStreamIngestion(){Di.g.log(3,"MyHeartEngine::stopYoutubeLiveStreamIngestion"),this.mRequestCtrl.requestStreamStop(1),this.mYoutubeLiveStreamIngestionActive=!1}isYoutubeLiveStreamIngestionActive(){return this.mYoutubeLiveStreamIngestionActive}notifyCurrentTab(e){Di.g.log(3,`MyHeartEngine::notifyCurrentTab : ${e}`),this.mMyHeartJanus.notifyCurrentTab(e)}requestSetUserMode(e){this.mRequestCtrl.requestSetUserMode(e)}requestChannelList(e,t,n){this.mRequestCtrl.requestChannelList(e,t,n)}requestUserList(e){this.mRequestCtrl.requestUserList(e)}requestEnterChannel(e,t){Di.g.log(3,`MyHeartEngine::requestEnterChannel: channel: ${e} channelPwd: ${t}`),this.mTxEnabled=!1,this.mMediaVoice=!1,this.mRequestCtrl.requestEnterChannel(e,t)}requestLeaveChannel(){this.clearPublishPendingTimer(),this.mTxEnabled=!1,this.mMediaVoice=!1,this.mChannel=null,this.mAvconf=pl(),this.mScreensharing=ml(),this.mMediaIdSelected=void 0,this.mMediaState.clear(),this.mMediaStateList=[],this.mMediaStateByUser.clear(),this.mYoutubeLiveStreamIngestionActive=!1,this.mMediaVoiceUser=void 0,this.mMediaStreams.clear(),this.mMyHeartJanus.leaveRoom(),this.mRequestCtrl.requestLeaveChannel()}requestTransmission(e,t,n){Di.g.log(3,`MyHeartEngine::requestTransmission: target:${e} enableTx:${t} mediaVoice:${n}`),t&&e==this.mCfg.nick&&(this.mAvconf.pending=!0,0==t&&(this.mTxEnabled=!1,this.mMediaVoice=!1)),this.mRequestCtrl.requestTransmission(e,t,n)}requestSendPublicMessage(e,t){this.mRequestCtrl.requestSendPublicMessage(e,t)}requestSendPrivateMessage(e,t,n){this.mRequestCtrl.requestSendPrivateMessage(e,t,n)}requestRaiseHand(e){this.mRequestCtrl.requestRaiseHand(e)}requestKickUser(e,t){this.mRequestCtrl.requestKickUser(e,t)}requestMediaState(){this.mRequestCtrl.requestMediaState()}requestSetChannelMode(e,t,n){this.mRequestCtrl.requestSetChannelMode(e,t,n)}requestSetChannelXMode(e,t,n){this.mRequestCtrl.requestSetChannelXMode(e,t,n)}requestChannelInfo(e){this.mRequestCtrl.requestChannelInfo(e)}requestChannelClose(e,t){this.mRequestCtrl.requestChannelClose(e,t)}requestChannelGetChatMuteUsers(e){this.mRequestCtrl.requestChannelGetChatMuteUsers(e)}requestChannelSetChatMuteUsers(e,t,n){this.mRequestCtrl.requestChannelSetChatMuteUsers(e,t,n)}requestChannelBanList(e){this.mRequestCtrl.requestChannelBanList(e)}requestDropTxMedia(e,t,n){Di.g.log(3,`MyHeartEngine::requestDropTxMedia : dropVideo:${e}, dropAudio:${t}, dropScreen:${n}`),this.mRequestCtrl.requestDropTxMedia(e,t,n)}requestSetAudioRx(e){this.mRequestCtrl.requestSetAudioRx(e)}requestSetVideoRx(e){this.mRequestCtrl.requestSetVideoRx(e)}requestNestedRoom(e,t,n){this.mRequestCtrl.requestNestedRoom(e,t,n)}requestVideoStreamLimit(e,t,n,i){this.mRequestCtrl.requestVideoStreamLimit(e,t,n,i)}lastRequestSeq(){return this.mRequestCtrl.lastSeq()}}function Fl(e){const t=new Bl(e);return{callbacks:()=>t.callbacks(),version:()=>t.version(),startFlagsAvailable:()=>t.startFlagsAvailable(),statusCodes:()=>t.statusCodes(),irmPluginRetCodes:()=>t.irmPluginRetCodes(),nick:()=>t.nick(),isMe:e=>t.isMe(e),currentChannel:()=>t.currentChannel(),isStopped:()=>t.isStopped(),isConnecting:()=>t.isConnecting(),isAuthenticating:()=>t.isAuthenticating(),isStarted:()=>t.isStarted(),start:(e,n,i,s,o,r,a,c,l,d)=>t.start(e,n,i,s,o,r,a,c,l,d),stop:()=>{t.stop()},getMediaState:()=>{t.getMediaState()},setCaptureSource:(e,n,i)=>{t.setCaptureSource(e,n,i)},publish:(e,n,i,s,o)=>t.publish(e,n,i,s,o),publishRestart:(e,n,i,s,o)=>{t.publishRestart(e,n,i,s,o)},unpublish:()=>t.unpublish(),toggleScreen:()=>t.toggleScreen(),publishScreen:(e,n,i,s)=>t.publishScreen(e,n,i,s),publishScreenNow:()=>{t.publishScreenNow()},unpublishScreen:()=>t.unpublishScreen(),isScreenReady:()=>t.isScreenReady(),isScreenPublished:()=>t.isScreenPublished(),isAudioMuted:e=>t.isAudioMuted(e),muteAudio:e=>t.muteAudio(e),unmuteAudio:e=>t.unmuteAudio(e),isVideoMuted:e=>t.isVideoMuted(e),muteVideo:e=>t.muteVideo(e),unmuteVideo:e=>t.unmuteVideo(e),listDevices:e=>{t.listDevices(e)},attachMediaStream:(e,n)=>{t.attachMediaStream(e,n)},setBitrate:e=>{t.setBitrate(e)},setBitrateScreen:e=>{t.setBitrateScreen(e)},setTxVideoCodecDefault:()=>{t.setTxVideoCodecDefault()},setTxVideoCodecH264:()=>{t.setTxVideoCodecH264()},setTxVideoCodecVP9:()=>{t.setTxVideoCodecVP9()},setTxVideoCodecVP8:()=>{t.setTxVideoCodecVP8()},getTxVideoCodec:()=>t.getTxVideoCodec(),setRxVideoCodecDefault:()=>{t.setRxVideoCodecDefault()},setRxVideoCodecH264:()=>{t.setTxVideoCodecH264()},setRxVideoCodecVP9:()=>{t.setRxVideoCodecVP9()},setRxVideoCodecVP8:()=>{t.setRxVideoCodecVP8()},getRxVideoCodec:()=>t.getRxVideoCodec(),mediaIdSelected:()=>t.mediaIdSelected(),activeMedias:()=>t.activeMedias(),mediaInfo:e=>t.mediaInfo(e),mediaInfoAt:e=>t.mediaInfoAt(e),getUserMediaInfoList:e=>t.getUserMediaInfoList(e),mediaStats:e=>t.mediaStats(e),isTxEnabled:()=>t.isTxEnabled(),isMediaVoice:()=>t.isMediaVoice(),mediaVoiceUser:()=>t.mediaVoiceUser(),connectionStatus:()=>t.connectionStatus(),txInfoAvconf:()=>t.txInfoAvconf(),txInfoScreen:()=>t.txInfoScreen(),txInfo:e=>t.txInfo(e),isAVConfVideoHi:()=>t.isAVConfVideoHi(),isCapturingAudioCam:()=>t.isCapturingAudioCam(),isCapturingVideoCam:()=>t.isCapturingVideoCam(),isTxTypeAVConf:e=>t.isTxTypeAVConf(e),getTxTypeAVConf:()=>t.getTxTypeAVConf(),isTxTypeScreen:e=>t.isTxTypeScreen(e),getTxTypeScreen:()=>t.getTxTypeScreen(),isPublishPending:()=>t.isPublishPending(),isPublished:()=>t.isPublished(),startYoutubeLiveStreamIngestion:(e,n,i)=>t.startYoutubeLiveStreamIngestion(e,n,i),stopYoutubeLiveStreamIngestion:()=>{t.stopYoutubeLiveStreamIngestion()},isYoutubeLiveStreamIngestionActive:()=>t.isYoutubeLiveStreamIngestionActive(),lastRequestSeq:()=>t.lastRequestSeq(),requestChannelList:(e="",n=100,i=1)=>{t.requestChannelList(e,n,i)},requestUserList:e=>{t.requestUserList(e)},requestEnterChannel:(e,n)=>{t.requestEnterChannel(e,n)},requestLeaveChannel:()=>{t.requestLeaveChannel()},requestTransmission:(e,n,i)=>{t.requestTransmission(e,n,i)},requestSendPublicMessage:(e,n)=>{t.requestSendPublicMessage(e,n)},requestSendPrivateMessage:(e,n,i)=>{t.requestSendPrivateMessage(e,n,i)},requestRaiseHand:e=>{t.requestRaiseHand(e)},requestKickUser:(e,n)=>{t.requestKickUser(e,n)},requestMediaState:()=>{t.requestMediaState()},requestSetChannelMode:(e,n,i)=>{t.requestSetChannelMode(e,n,i)},requestSetChannelXMode:(e,n,i)=>{t.requestSetChannelXMode(e,n,i)},requestChannelInfo:e=>{t.requestChannelInfo(e)},requestChannelClose:(e,n)=>{t.requestChannelClose(e,n)},requestChannelGetChatMuteUsers:e=>{t.requestChannelGetChatMuteUsers(e)},requestChannelSetChatMuteUsers:(e,n,i)=>{t.requestChannelSetChatMuteUsers(e,n,i)},requestChannelBanList:e=>{t.requestChannelBanList(e)},requestDropTxMedia:(e,n,i)=>{t.requestDropTxMedia(e,n,i)},requestSetAudioRx:e=>{t.requestSetAudioRx(e)},requestSetVideoRx:e=>{t.requestSetVideoRx(e)},requestNestedRoom:(e,n,i)=>{t.requestNestedRoom(e,n,i)},requestVideoStreamLimit:(e=0,n=[],i=[],s=-1)=>{t.requestVideoStreamLimit(e,n,i,s)}}}function Ul(){let e;window.WebSocket=window.WebSocket||window.MozWebSocket;let t=(new Date).getTime();const n=function(){let e=null,t=null,n=null,i=null;return{setters:{resetCB:function(t){e=t},logoutCB:function(e){t=e},notifyMsgStatusCB:function(e){n=e},sendMsgCB:function(e){i=e}},getters:{resetCB:function(){return e},logoutCB:function(){return t},notifyMsgStatusCB:function(){return n},sendMsgCB:function(){return i}}}}();function i(){let e;return window.performance?window.performance.timeOrigin?e=window.performance.timeOrigin+performance.now():(E("[App] Getting User timestamp: Navigator does not support window.performance.timeOrigin"),e=(new Date).getTime()):(E("[App] Getting User timestamp: Navigator does not support window.performance"),e=(new Date).getTime()),E(`[App] User timestamp: ${e}`),e}return{logout:function(){const e=n.getters.logoutCB();return window!==window.top&&window._mediaWndsMap&&window._mediaWndsMap.size<1?(window.document.body.style.backgroundColor="black",!1):!p.IFRAME&&void(e&&!p.IFRAME&&e())},isOnline:function(){return navigator.onLine},startJanus:function(e,t){const n=p.ENGINE_NICK,i=p.NAME,s=p.PASSWORD,o=p.DEVICE_ID,r=window._engine.startFlagsAvailable(),a=r.MYHEART_LOGIN_FLAG_CLOSURE|r.MYHEART_LOGIN_FLAG_MEDIASTATE2;E(`app -> starting engine ${window._engine.version()}, restart:${!!t}, nick:${n}, devId:${o}, url:${e}`),o&&""!==o&&"wss://"!==e&&void 0!==e&&(t&&window._engine.stop(),window._engine.start(e,n,i,s,o,3,60,window.userData,a,window.ip)||E("app -> start engine failed..."))},startGroupJanus:function(e,t){const n=p.ENGINE_NICK,i=p.NAME,s=p.PASSWORD,o=p.DEVICE_ID,r=window._engine.startFlagsAvailable(),a=r.MYHEART_LOGIN_FLAG_CLOSURE|r.MYHEART_LOGIN_FLAG_MEDIASTATE2;E(`app -> starting engine ${window._engine.version()}, restart:${!!t}, nick:${n}, devId:${o}, url:${e}`),o&&""!==o&&(t&&window._groupEngine.stop(),window._groupEngine.start(e,n,i,s,o,10,60,window.userData,a,window.ip)||E("app -> start engine failed..."))},getUserTs:i,setServerTs:function(t){E(`[App] Setting server timestamp: ${t}`);const n=i();return e=t-n,E(`[App] Delta timestamp: ${e}`),e},getServerTs:function(){const t=i();return E(`[App] Getting server timestamp: ${t+e}`),t+e},callbacks:function(){return n.setters},sendMsg:function(e,i,s,o,r){const a={action:"sendMsg",pushSeq:(t+=1,t),target:e,text:i,sequence:s,type:o,group:r},c=n.getters.sendMsgCB();c&&(E(`Tx: ${JSON.stringify(a)} ts: ${parseInt((new Date).getTime()/1e3)}`),c(a,t,parseInt((new Date).getTime()/1e3)))}}}function jl(e){return null!==e&&"object"==typeof e&&"constructor"in e&&e.constructor===Object}function Vl(e,t){void 0===e&&(e={}),void 0===t&&(t={}),Object.keys(t).forEach((n=>{void 0===e[n]?e[n]=t[n]:jl(t[n])&&jl(e[n])&&Object.keys(t[n]).length>0&&Vl(e[n],t[n])}))}const Gl={body:{},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector:()=>null,querySelectorAll:()=>[],getElementById:()=>null,createEvent:()=>({initEvent(){}}),createElement:()=>({children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName:()=>[]}),createElementNS:()=>({}),importNode:()=>null,location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function ql(){const e="undefined"!=typeof document?document:{};return Vl(e,Gl),e}const Hl={document:Gl,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState(){},pushState(){},go(){},back(){}},CustomEvent:function(){return this},addEventListener(){},removeEventListener(){},getComputedStyle:()=>({getPropertyValue:()=>""}),Image(){},Date(){},screen:{},setTimeout(){},clearTimeout(){},matchMedia:()=>({}),requestAnimationFrame:e=>"undefined"==typeof setTimeout?(e(),null):setTimeout(e,0),cancelAnimationFrame(e){"undefined"!=typeof setTimeout&&clearTimeout(e)}};function zl(){const e="undefined"!=typeof window?window:{};return Vl(e,Hl),e}function Wl(e,t){return void 0===t&&(t=0),setTimeout(e,t)}function Jl(){return Date.now()}function Yl(e){return"object"==typeof e&&null!==e&&e.constructor&&"Object"===Object.prototype.toString.call(e).slice(8,-1)}function Kl(){const e=Object(arguments.length<=0?void 0:arguments[0]),t=["__proto__","constructor","prototype"];for(let i=1;i<arguments.length;i+=1){const s=i<0||arguments.length<=i?void 0:arguments[i];if(null!=s&&(n=s,!("undefined"!=typeof window&&void 0!==window.HTMLElement?n instanceof HTMLElement:n&&(1===n.nodeType||11===n.nodeType)))){const n=Object.keys(Object(s)).filter((e=>t.indexOf(e)<0));for(let t=0,i=n.length;t<i;t+=1){const i=n[t],o=Object.getOwnPropertyDescriptor(s,i);void 0!==o&&o.enumerable&&(Yl(e[i])&&Yl(s[i])?s[i].__swiper__?e[i]=s[i]:Kl(e[i],s[i]):!Yl(e[i])&&Yl(s[i])?(e[i]={},s[i].__swiper__?e[i]=s[i]:Kl(e[i],s[i])):e[i]=s[i])}}}var n;return e}function Xl(e,t,n){e.style.setProperty(t,n)}function Zl(e){let{swiper:t,targetPosition:n,side:i}=e;const s=zl(),o=-t.translate;let r,a=null;const c=t.params.speed;t.wrapperEl.style.scrollSnapType="none",s.cancelAnimationFrame(t.cssModeFrameID);const l=n>o?"next":"prev",d=(e,t)=>"next"===l&&e>=t||"prev"===l&&e<=t,u=()=>{r=(new Date).getTime(),null===a&&(a=r);const e=Math.max(Math.min((r-a)/c,1),0),l=.5-Math.cos(e*Math.PI)/2;let h=o+l*(n-o);if(d(h,n)&&(h=n),t.wrapperEl.scrollTo({[i]:h}),d(h,n))return t.wrapperEl.style.overflow="hidden",t.wrapperEl.style.scrollSnapType="",setTimeout((()=>{t.wrapperEl.style.overflow="",t.wrapperEl.scrollTo({[i]:h})})),void s.cancelAnimationFrame(t.cssModeFrameID);t.cssModeFrameID=s.requestAnimationFrame(u)};u()}function Ql(e,t){return void 0===t&&(t=""),[...e.children].filter((e=>e.matches(t)))}function ed(e){try{return void console.warn(e)}catch(e){}}function td(e,t){void 0===t&&(t=[]);const n=document.createElement(e);return n.classList.add(...Array.isArray(t)?t:function(e){return void 0===e&&(e=""),e.trim().split(" ").filter((e=>!!e.trim()))}(t)),n}function nd(e,t){return zl().getComputedStyle(e,null).getPropertyValue(t)}function id(e){let t,n=e;if(n){for(t=0;null!==(n=n.previousSibling);)1===n.nodeType&&(t+=1);return t}}function sd(e,t,n){const i=zl();return n?e["width"===t?"offsetWidth":"offsetHeight"]+parseFloat(i.getComputedStyle(e,null).getPropertyValue("width"===t?"margin-right":"margin-top"))+parseFloat(i.getComputedStyle(e,null).getPropertyValue("width"===t?"margin-left":"margin-bottom")):e.offsetWidth}let od,rd,ad;function cd(){return od||(od=function(){const e=zl(),t=ql();return{smoothScroll:t.documentElement&&t.documentElement.style&&"scrollBehavior"in t.documentElement.style,touch:!!("ontouchstart"in e||e.DocumentTouch&&t instanceof e.DocumentTouch)}}()),od}function ld(e){return void 0===e&&(e={}),rd||(rd=function(e){let{userAgent:t}=void 0===e?{}:e;const n=cd(),i=zl(),s=i.navigator.platform,o=t||i.navigator.userAgent,r={ios:!1,android:!1},a=i.screen.width,c=i.screen.height,l=o.match(/(Android);?[\s\/]+([\d.]+)?/);let d=o.match(/(iPad).*OS\s([\d_]+)/);const u=o.match(/(iPod)(.*OS\s([\d_]+))?/),h=!d&&o.match(/(iPhone\sOS|iOS)\s([\d_]+)/),p="Win32"===s;let m="MacIntel"===s;return!d&&m&&n.touch&&["1024x1366","1366x1024","834x1194","1194x834","834x1112","1112x834","768x1024","1024x768","820x1180","1180x820","810x1080","1080x810"].indexOf(`${a}x${c}`)>=0&&(d=o.match(/(Version)\/([\d.]+)/),d||(d=[0,1,"13_0_0"]),m=!1),l&&!p&&(r.os="android",r.android=!0),(d||h||u)&&(r.os="ios",r.ios=!0),r}(e)),rd}const dd=(e,t)=>{if(!e||e.destroyed||!e.params)return;const n=t.closest(e.isElement?"swiper-slide":`.${e.params.slideClass}`);if(n){let t=n.querySelector(`.${e.params.lazyPreloaderClass}`);!t&&e.isElement&&(n.shadowRoot?t=n.shadowRoot.querySelector(`.${e.params.lazyPreloaderClass}`):requestAnimationFrame((()=>{n.shadowRoot&&(t=n.shadowRoot.querySelector(`.${e.params.lazyPreloaderClass}`),t&&t.remove())}))),t&&t.remove()}},ud=(e,t)=>{if(!e.slides[t])return;const n=e.slides[t].querySelector('[loading="lazy"]');n&&n.removeAttribute("loading")},hd=e=>{if(!e||e.destroyed||!e.params)return;let t=e.params.lazyPreloadPrevNext;const n=e.slides.length;if(!n||!t||t<0)return;t=Math.min(t,n);const i="auto"===e.params.slidesPerView?e.slidesPerViewDynamic():Math.ceil(e.params.slidesPerView),s=e.activeIndex;if(e.params.grid&&e.params.grid.rows>1){const n=s,o=[n-t];return o.push(...Array.from({length:t}).map(((e,t)=>n+i+t))),void e.slides.forEach(((t,n)=>{o.includes(t.column)&&ud(e,n)}))}const o=s+i-1;if(e.params.rewind||e.params.loop)for(let i=s-t;i<=o+t;i+=1){const t=(i%n+n)%n;(t<s||t>o)&&ud(e,t)}else for(let i=Math.max(s-t,0);i<=Math.min(o+t,n-1);i+=1)i!==s&&(i>o||i<s)&&ud(e,i)};var pd={updateSize:function(){const e=this;let t,n;const i=e.el;t=void 0!==e.params.width&&null!==e.params.width?e.params.width:i.clientWidth,n=void 0!==e.params.height&&null!==e.params.height?e.params.height:i.clientHeight,0===t&&e.isHorizontal()||0===n&&e.isVertical()||(t=t-parseInt(nd(i,"padding-left")||0,10)-parseInt(nd(i,"padding-right")||0,10),n=n-parseInt(nd(i,"padding-top")||0,10)-parseInt(nd(i,"padding-bottom")||0,10),Number.isNaN(t)&&(t=0),Number.isNaN(n)&&(n=0),Object.assign(e,{width:t,height:n,size:e.isHorizontal()?t:n}))},updateSlides:function(){const e=this;function t(t,n){return parseFloat(t.getPropertyValue(e.getDirectionLabel(n))||0)}const n=e.params,{wrapperEl:i,slidesEl:s,size:o,rtlTranslate:r,wrongRTL:a}=e,c=e.virtual&&n.virtual.enabled,l=c?e.virtual.slides.length:e.slides.length,d=Ql(s,`.${e.params.slideClass}, swiper-slide`),u=c?e.virtual.slides.length:d.length;let h=[];const p=[],m=[];let w=n.slidesOffsetBefore;"function"==typeof w&&(w=n.slidesOffsetBefore.call(e));let g=n.slidesOffsetAfter;"function"==typeof g&&(g=n.slidesOffsetAfter.call(e));const f=e.snapGrid.length,v=e.slidesGrid.length;let b=n.spaceBetween,_=-w,y=0,C=0;if(void 0===o)return;"string"==typeof b&&b.indexOf("%")>=0?b=parseFloat(b.replace("%",""))/100*o:"string"==typeof b&&(b=parseFloat(b)),e.virtualSize=-b,d.forEach((e=>{r?e.style.marginLeft="":e.style.marginRight="",e.style.marginBottom="",e.style.marginTop=""})),n.centeredSlides&&n.cssMode&&(Xl(i,"--swiper-centered-offset-before",""),Xl(i,"--swiper-centered-offset-after",""));const S=n.grid&&n.grid.rows>1&&e.grid;let E;S?e.grid.initSlides(d):e.grid&&e.grid.unsetSlides();const x="auto"===n.slidesPerView&&n.breakpoints&&Object.keys(n.breakpoints).filter((e=>void 0!==n.breakpoints[e].slidesPerView)).length>0;for(let i=0;i<u;i+=1){let s;if(E=0,d[i]&&(s=d[i]),S&&e.grid.updateSlide(i,s,d),!d[i]||"none"!==nd(s,"display")){if("auto"===n.slidesPerView){x&&(d[i].style[e.getDirectionLabel("width")]="");const o=getComputedStyle(s),r=s.style.transform,a=s.style.webkitTransform;if(r&&(s.style.transform="none"),a&&(s.style.webkitTransform="none"),n.roundLengths)E=e.isHorizontal()?sd(s,"width",!0):sd(s,"height",!0);else{const e=t(o,"width"),n=t(o,"padding-left"),i=t(o,"padding-right"),r=t(o,"margin-left"),a=t(o,"margin-right"),c=o.getPropertyValue("box-sizing");if(c&&"border-box"===c)E=e+r+a;else{const{clientWidth:t,offsetWidth:o}=s;E=e+n+i+r+a+(o-t)}}r&&(s.style.transform=r),a&&(s.style.webkitTransform=a),n.roundLengths&&(E=Math.floor(E))}else E=(o-(n.slidesPerView-1)*b)/n.slidesPerView,n.roundLengths&&(E=Math.floor(E)),d[i]&&(d[i].style[e.getDirectionLabel("width")]=`${E}px`);d[i]&&(d[i].swiperSlideSize=E),m.push(E),n.centeredSlides?(_=_+E/2+y/2+b,0===y&&0!==i&&(_=_-o/2-b),0===i&&(_=_-o/2-b),Math.abs(_)<.001&&(_=0),n.roundLengths&&(_=Math.floor(_)),C%n.slidesPerGroup==0&&h.push(_),p.push(_)):(n.roundLengths&&(_=Math.floor(_)),(C-Math.min(e.params.slidesPerGroupSkip,C))%e.params.slidesPerGroup==0&&h.push(_),p.push(_),_=_+E+b),e.virtualSize+=E+b,y=E,C+=1}}if(e.virtualSize=Math.max(e.virtualSize,o)+g,r&&a&&("slide"===n.effect||"coverflow"===n.effect)&&(i.style.width=`${e.virtualSize+b}px`),n.setWrapperSize&&(i.style[e.getDirectionLabel("width")]=`${e.virtualSize+b}px`),S&&e.grid.updateWrapperSize(E,h),!n.centeredSlides){const t=[];for(let i=0;i<h.length;i+=1){let s=h[i];n.roundLengths&&(s=Math.floor(s)),h[i]<=e.virtualSize-o&&t.push(s)}h=t,Math.floor(e.virtualSize-o)-Math.floor(h[h.length-1])>1&&h.push(e.virtualSize-o)}if(c&&n.loop){const t=m[0]+b;if(n.slidesPerGroup>1){const i=Math.ceil((e.virtual.slidesBefore+e.virtual.slidesAfter)/n.slidesPerGroup),s=t*n.slidesPerGroup;for(let e=0;e<i;e+=1)h.push(h[h.length-1]+s)}for(let i=0;i<e.virtual.slidesBefore+e.virtual.slidesAfter;i+=1)1===n.slidesPerGroup&&h.push(h[h.length-1]+t),p.push(p[p.length-1]+t),e.virtualSize+=t}if(0===h.length&&(h=[0]),0!==b){const t=e.isHorizontal()&&r?"marginLeft":e.getDirectionLabel("marginRight");d.filter(((e,t)=>!(n.cssMode&&!n.loop)||t!==d.length-1)).forEach((e=>{e.style[t]=`${b}px`}))}if(n.centeredSlides&&n.centeredSlidesBounds){let e=0;m.forEach((t=>{e+=t+(b||0)})),e-=b;const t=e-o;h=h.map((e=>e<=0?-w:e>t?t+g:e))}if(n.centerInsufficientSlides){let e=0;if(m.forEach((t=>{e+=t+(b||0)})),e-=b,e<o){const t=(o-e)/2;h.forEach(((e,n)=>{h[n]=e-t})),p.forEach(((e,n)=>{p[n]=e+t}))}}if(Object.assign(e,{slides:d,snapGrid:h,slidesGrid:p,slidesSizesGrid:m}),n.centeredSlides&&n.cssMode&&!n.centeredSlidesBounds){Xl(i,"--swiper-centered-offset-before",-h[0]+"px"),Xl(i,"--swiper-centered-offset-after",e.size/2-m[m.length-1]/2+"px");const t=-e.snapGrid[0],n=-e.slidesGrid[0];e.snapGrid=e.snapGrid.map((e=>e+t)),e.slidesGrid=e.slidesGrid.map((e=>e+n))}if(u!==l&&e.emit("slidesLengthChange"),h.length!==f&&(e.params.watchOverflow&&e.checkOverflow(),e.emit("snapGridLengthChange")),p.length!==v&&e.emit("slidesGridLengthChange"),n.watchSlidesProgress&&e.updateSlidesOffset(),e.emit("slidesUpdated"),!(c||n.cssMode||"slide"!==n.effect&&"fade"!==n.effect)){const t=`${n.containerModifierClass}backface-hidden`,i=e.el.classList.contains(t);u<=n.maxBackfaceHiddenSlides?i||e.el.classList.add(t):i&&e.el.classList.remove(t)}},updateAutoHeight:function(e){const t=this,n=[],i=t.virtual&&t.params.virtual.enabled;let s,o=0;"number"==typeof e?t.setTransition(e):!0===e&&t.setTransition(t.params.speed);const r=e=>i?t.slides[t.getSlideIndexByData(e)]:t.slides[e];if("auto"!==t.params.slidesPerView&&t.params.slidesPerView>1)if(t.params.centeredSlides)(t.visibleSlides||[]).forEach((e=>{n.push(e)}));else for(s=0;s<Math.ceil(t.params.slidesPerView);s+=1){const e=t.activeIndex+s;if(e>t.slides.length&&!i)break;n.push(r(e))}else n.push(r(t.activeIndex));for(s=0;s<n.length;s+=1)if(void 0!==n[s]){const e=n[s].offsetHeight;o=e>o?e:o}(o||0===o)&&(t.wrapperEl.style.height=`${o}px`)},updateSlidesOffset:function(){const e=this,t=e.slides,n=e.isElement?e.isHorizontal()?e.wrapperEl.offsetLeft:e.wrapperEl.offsetTop:0;for(let i=0;i<t.length;i+=1)t[i].swiperSlideOffset=(e.isHorizontal()?t[i].offsetLeft:t[i].offsetTop)-n-e.cssOverflowAdjustment()},updateSlidesProgress:function(e){void 0===e&&(e=this&&this.translate||0);const t=this,n=t.params,{slides:i,rtlTranslate:s,snapGrid:o}=t;if(0===i.length)return;void 0===i[0].swiperSlideOffset&&t.updateSlidesOffset();let r=-e;s&&(r=e),i.forEach((e=>{e.classList.remove(n.slideVisibleClass,n.slideFullyVisibleClass)})),t.visibleSlidesIndexes=[],t.visibleSlides=[];let a=n.spaceBetween;"string"==typeof a&&a.indexOf("%")>=0?a=parseFloat(a.replace("%",""))/100*t.size:"string"==typeof a&&(a=parseFloat(a));for(let e=0;e<i.length;e+=1){const c=i[e];let l=c.swiperSlideOffset;n.cssMode&&n.centeredSlides&&(l-=i[0].swiperSlideOffset);const d=(r+(n.centeredSlides?t.minTranslate():0)-l)/(c.swiperSlideSize+a),u=(r-o[0]+(n.centeredSlides?t.minTranslate():0)-l)/(c.swiperSlideSize+a),h=-(r-l),p=h+t.slidesSizesGrid[e],m=h>=0&&h<=t.size-t.slidesSizesGrid[e];(h>=0&&h<t.size-1||p>1&&p<=t.size||h<=0&&p>=t.size)&&(t.visibleSlides.push(c),t.visibleSlidesIndexes.push(e),i[e].classList.add(n.slideVisibleClass)),m&&i[e].classList.add(n.slideFullyVisibleClass),c.progress=s?-d:d,c.originalProgress=s?-u:u}},updateProgress:function(e){const t=this;if(void 0===e){const n=t.rtlTranslate?-1:1;e=t&&t.translate&&t.translate*n||0}const n=t.params,i=t.maxTranslate()-t.minTranslate();let{progress:s,isBeginning:o,isEnd:r,progressLoop:a}=t;const c=o,l=r;if(0===i)s=0,o=!0,r=!0;else{s=(e-t.minTranslate())/i;const n=Math.abs(e-t.minTranslate())<1,a=Math.abs(e-t.maxTranslate())<1;o=n||s<=0,r=a||s>=1,n&&(s=0),a&&(s=1)}if(n.loop){const n=t.getSlideIndexByData(0),i=t.getSlideIndexByData(t.slides.length-1),s=t.slidesGrid[n],o=t.slidesGrid[i],r=t.slidesGrid[t.slidesGrid.length-1],c=Math.abs(e);a=c>=s?(c-s)/r:(c+r-o)/r,a>1&&(a-=1)}Object.assign(t,{progress:s,progressLoop:a,isBeginning:o,isEnd:r}),(n.watchSlidesProgress||n.centeredSlides&&n.autoHeight)&&t.updateSlidesProgress(e),o&&!c&&t.emit("reachBeginning toEdge"),r&&!l&&t.emit("reachEnd toEdge"),(c&&!o||l&&!r)&&t.emit("fromEdge"),t.emit("progress",s)},updateSlidesClasses:function(){const e=this,{slides:t,params:n,slidesEl:i,activeIndex:s}=e,o=e.virtual&&n.virtual.enabled,r=e.grid&&n.grid&&n.grid.rows>1,a=e=>Ql(i,`.${n.slideClass}${e}, swiper-slide${e}`)[0];let c,l,d;if(t.forEach((e=>{e.classList.remove(n.slideActiveClass,n.slideNextClass,n.slidePrevClass)})),o)if(n.loop){let t=s-e.virtual.slidesBefore;t<0&&(t=e.virtual.slides.length+t),t>=e.virtual.slides.length&&(t-=e.virtual.slides.length),c=a(`[data-swiper-slide-index="${t}"]`)}else c=a(`[data-swiper-slide-index="${s}"]`);else r?(c=t.filter((e=>e.column===s))[0],d=t.filter((e=>e.column===s+1))[0],l=t.filter((e=>e.column===s-1))[0]):c=t[s];c&&(c.classList.add(n.slideActiveClass),r?(d&&d.classList.add(n.slideNextClass),l&&l.classList.add(n.slidePrevClass)):(d=function(e,t){const n=[];for(;e.nextElementSibling;){const i=e.nextElementSibling;t?i.matches(t)&&n.push(i):n.push(i),e=i}return n}(c,`.${n.slideClass}, swiper-slide`)[0],n.loop&&!d&&(d=t[0]),d&&d.classList.add(n.slideNextClass),l=function(e,t){const n=[];for(;e.previousElementSibling;){const i=e.previousElementSibling;t?i.matches(t)&&n.push(i):n.push(i),e=i}return n}(c,`.${n.slideClass}, swiper-slide`)[0],n.loop&&0===!l&&(l=t[t.length-1]),l&&l.classList.add(n.slidePrevClass))),e.emitSlidesClasses()},updateActiveIndex:function(e){const t=this,n=t.rtlTranslate?t.translate:-t.translate,{snapGrid:i,params:s,activeIndex:o,realIndex:r,snapIndex:a}=t;let c,l=e;const d=e=>{let n=e-t.virtual.slidesBefore;return n<0&&(n=t.virtual.slides.length+n),n>=t.virtual.slides.length&&(n-=t.virtual.slides.length),n};if(void 0===l&&(l=function(e){const{slidesGrid:t,params:n}=e,i=e.rtlTranslate?e.translate:-e.translate;let s;for(let e=0;e<t.length;e+=1)void 0!==t[e+1]?i>=t[e]&&i<t[e+1]-(t[e+1]-t[e])/2?s=e:i>=t[e]&&i<t[e+1]&&(s=e+1):i>=t[e]&&(s=e);return n.normalizeSlideIndex&&(s<0||void 0===s)&&(s=0),s}(t)),i.indexOf(n)>=0)c=i.indexOf(n);else{const e=Math.min(s.slidesPerGroupSkip,l);c=e+Math.floor((l-e)/s.slidesPerGroup)}if(c>=i.length&&(c=i.length-1),l===o&&!t.params.loop)return void(c!==a&&(t.snapIndex=c,t.emit("snapIndexChange")));if(l===o&&t.params.loop&&t.virtual&&t.params.virtual.enabled)return void(t.realIndex=d(l));const u=t.grid&&s.grid&&s.grid.rows>1;let h;if(t.virtual&&s.virtual.enabled&&s.loop)h=d(l);else if(u){const e=t.slides.filter((e=>e.column===l))[0];let n=parseInt(e.getAttribute("data-swiper-slide-index"),10);Number.isNaN(n)&&(n=Math.max(t.slides.indexOf(e),0)),h=Math.floor(n/s.grid.rows)}else if(t.slides[l]){const e=t.slides[l].getAttribute("data-swiper-slide-index");h=e?parseInt(e,10):l}else h=l;Object.assign(t,{previousSnapIndex:a,snapIndex:c,previousRealIndex:r,realIndex:h,previousIndex:o,activeIndex:l}),t.initialized&&hd(t),t.emit("activeIndexChange"),t.emit("snapIndexChange"),(t.initialized||t.params.runCallbacksOnInit)&&(r!==h&&t.emit("realIndexChange"),t.emit("slideChange"))},updateClickedSlide:function(e,t){const n=this,i=n.params;let s=e.closest(`.${i.slideClass}, swiper-slide`);!s&&n.isElement&&t&&t.length>1&&t.includes(e)&&[...t.slice(t.indexOf(e)+1,t.length)].forEach((e=>{!s&&e.matches&&e.matches(`.${i.slideClass}, swiper-slide`)&&(s=e)}));let o,r=!1;if(s)for(let e=0;e<n.slides.length;e+=1)if(n.slides[e]===s){r=!0,o=e;break}if(!s||!r)return n.clickedSlide=void 0,void(n.clickedIndex=void 0);n.clickedSlide=s,n.virtual&&n.params.virtual.enabled?n.clickedIndex=parseInt(s.getAttribute("data-swiper-slide-index"),10):n.clickedIndex=o,i.slideToClickedSlide&&void 0!==n.clickedIndex&&n.clickedIndex!==n.activeIndex&&n.slideToClickedSlide()}},md={getTranslate:function(e){void 0===e&&(e=this.isHorizontal()?"x":"y");const{params:t,rtlTranslate:n,translate:i,wrapperEl:s}=this;if(t.virtualTranslate)return n?-i:i;if(t.cssMode)return i;let o=function(e,t){void 0===t&&(t="x");const n=zl();let i,s,o;const r=function(e){const t=zl();let n;return t.getComputedStyle&&(n=t.getComputedStyle(e,null)),!n&&e.currentStyle&&(n=e.currentStyle),n||(n=e.style),n}(e);return n.WebKitCSSMatrix?(s=r.transform||r.webkitTransform,s.split(",").length>6&&(s=s.split(", ").map((e=>e.replace(",","."))).join(", ")),o=new n.WebKitCSSMatrix("none"===s?"":s)):(o=r.MozTransform||r.OTransform||r.MsTransform||r.msTransform||r.transform||r.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),i=o.toString().split(",")),"x"===t&&(s=n.WebKitCSSMatrix?o.m41:16===i.length?parseFloat(i[12]):parseFloat(i[4])),"y"===t&&(s=n.WebKitCSSMatrix?o.m42:16===i.length?parseFloat(i[13]):parseFloat(i[5])),s||0}(s,e);return o+=this.cssOverflowAdjustment(),n&&(o=-o),o||0},setTranslate:function(e,t){const n=this,{rtlTranslate:i,params:s,wrapperEl:o,progress:r}=n;let a,c=0,l=0;n.isHorizontal()?c=i?-e:e:l=e,s.roundLengths&&(c=Math.floor(c),l=Math.floor(l)),n.previousTranslate=n.translate,n.translate=n.isHorizontal()?c:l,s.cssMode?o[n.isHorizontal()?"scrollLeft":"scrollTop"]=n.isHorizontal()?-c:-l:s.virtualTranslate||(n.isHorizontal()?c-=n.cssOverflowAdjustment():l-=n.cssOverflowAdjustment(),o.style.transform=`translate3d(${c}px, ${l}px, 0px)`);const d=n.maxTranslate()-n.minTranslate();a=0===d?0:(e-n.minTranslate())/d,a!==r&&n.updateProgress(e),n.emit("setTranslate",n.translate,t)},minTranslate:function(){return-this.snapGrid[0]},maxTranslate:function(){return-this.snapGrid[this.snapGrid.length-1]},translateTo:function(e,t,n,i,s){void 0===e&&(e=0),void 0===t&&(t=this.params.speed),void 0===n&&(n=!0),void 0===i&&(i=!0);const o=this,{params:r,wrapperEl:a}=o;if(o.animating&&r.preventInteractionOnTransition)return!1;const c=o.minTranslate(),l=o.maxTranslate();let d;if(d=i&&e>c?c:i&&e<l?l:e,o.updateProgress(d),r.cssMode){const e=o.isHorizontal();if(0===t)a[e?"scrollLeft":"scrollTop"]=-d;else{if(!o.support.smoothScroll)return Zl({swiper:o,targetPosition:-d,side:e?"left":"top"}),!0;a.scrollTo({[e?"left":"top"]:-d,behavior:"smooth"})}return!0}return 0===t?(o.setTransition(0),o.setTranslate(d),n&&(o.emit("beforeTransitionStart",t,s),o.emit("transitionEnd"))):(o.setTransition(t),o.setTranslate(d),n&&(o.emit("beforeTransitionStart",t,s),o.emit("transitionStart")),o.animating||(o.animating=!0,o.onTranslateToWrapperTransitionEnd||(o.onTranslateToWrapperTransitionEnd=function(e){o&&!o.destroyed&&e.target===this&&(o.wrapperEl.removeEventListener("transitionend",o.onTranslateToWrapperTransitionEnd),o.onTranslateToWrapperTransitionEnd=null,delete o.onTranslateToWrapperTransitionEnd,n&&o.emit("transitionEnd"))}),o.wrapperEl.addEventListener("transitionend",o.onTranslateToWrapperTransitionEnd))),!0}};function wd(e){let{swiper:t,runCallbacks:n,direction:i,step:s}=e;const{activeIndex:o,previousIndex:r}=t;let a=i;if(a||(a=o>r?"next":o<r?"prev":"reset"),t.emit(`transition${s}`),n&&o!==r){if("reset"===a)return void t.emit(`slideResetTransition${s}`);t.emit(`slideChangeTransition${s}`),"next"===a?t.emit(`slideNextTransition${s}`):t.emit(`slidePrevTransition${s}`)}}var gd={slideTo:function(e,t,n,i,s){void 0===e&&(e=0),void 0===t&&(t=this.params.speed),void 0===n&&(n=!0),"string"==typeof e&&(e=parseInt(e,10));const o=this;let r=e;r<0&&(r=0);const{params:a,snapGrid:c,slidesGrid:l,previousIndex:d,activeIndex:u,rtlTranslate:h,wrapperEl:p,enabled:m}=o;if(o.animating&&a.preventInteractionOnTransition||!m&&!i&&!s||o.destroyed)return!1;const w=Math.min(o.params.slidesPerGroupSkip,r);let g=w+Math.floor((r-w)/o.params.slidesPerGroup);g>=c.length&&(g=c.length-1);const f=-c[g];if(a.normalizeSlideIndex)for(let e=0;e<l.length;e+=1){const t=-Math.floor(100*f),n=Math.floor(100*l[e]),i=Math.floor(100*l[e+1]);void 0!==l[e+1]?t>=n&&t<i-(i-n)/2?r=e:t>=n&&t<i&&(r=e+1):t>=n&&(r=e)}if(o.initialized&&r!==u){if(!o.allowSlideNext&&(h?f>o.translate&&f>o.minTranslate():f<o.translate&&f<o.minTranslate()))return!1;if(!o.allowSlidePrev&&f>o.translate&&f>o.maxTranslate()&&(u||0)!==r)return!1}let v;if(r!==(d||0)&&n&&o.emit("beforeSlideChangeStart"),o.updateProgress(f),v=r>u?"next":r<u?"prev":"reset",h&&-f===o.translate||!h&&f===o.translate)return o.updateActiveIndex(r),a.autoHeight&&o.updateAutoHeight(),o.updateSlidesClasses(),"slide"!==a.effect&&o.setTranslate(f),"reset"!==v&&(o.transitionStart(n,v),o.transitionEnd(n,v)),!1;if(a.cssMode){const e=o.isHorizontal(),n=h?f:-f;if(0===t){const t=o.virtual&&o.params.virtual.enabled;t&&(o.wrapperEl.style.scrollSnapType="none",o._immediateVirtual=!0),t&&!o._cssModeVirtualInitialSet&&o.params.initialSlide>0?(o._cssModeVirtualInitialSet=!0,requestAnimationFrame((()=>{p[e?"scrollLeft":"scrollTop"]=n}))):p[e?"scrollLeft":"scrollTop"]=n,t&&requestAnimationFrame((()=>{o.wrapperEl.style.scrollSnapType="",o._immediateVirtual=!1}))}else{if(!o.support.smoothScroll)return Zl({swiper:o,targetPosition:n,side:e?"left":"top"}),!0;p.scrollTo({[e?"left":"top"]:n,behavior:"smooth"})}return!0}return o.setTransition(t),o.setTranslate(f),o.updateActiveIndex(r),o.updateSlidesClasses(),o.emit("beforeTransitionStart",t,i),o.transitionStart(n,v),0===t?o.transitionEnd(n,v):o.animating||(o.animating=!0,o.onSlideToWrapperTransitionEnd||(o.onSlideToWrapperTransitionEnd=function(e){o&&!o.destroyed&&e.target===this&&(o.wrapperEl.removeEventListener("transitionend",o.onSlideToWrapperTransitionEnd),o.onSlideToWrapperTransitionEnd=null,delete o.onSlideToWrapperTransitionEnd,o.transitionEnd(n,v))}),o.wrapperEl.addEventListener("transitionend",o.onSlideToWrapperTransitionEnd)),!0},slideToLoop:function(e,t,n,i){void 0===e&&(e=0),void 0===t&&(t=this.params.speed),void 0===n&&(n=!0),"string"==typeof e&&(e=parseInt(e,10));const s=this;if(s.destroyed)return;const o=s.grid&&s.params.grid&&s.params.grid.rows>1;let r=e;if(s.params.loop)if(s.virtual&&s.params.virtual.enabled)r+=s.virtual.slidesBefore;else{let e;if(o){const t=r*s.params.grid.rows;e=s.slides.filter((e=>1*e.getAttribute("data-swiper-slide-index")===t))[0].column}else e=s.getSlideIndexByData(r);const t=o?Math.ceil(s.slides.length/s.params.grid.rows):s.slides.length,{centeredSlides:n}=s.params;let i=s.params.slidesPerView;"auto"===i?i=s.slidesPerViewDynamic():(i=Math.ceil(parseFloat(s.params.slidesPerView,10)),n&&i%2==0&&(i+=1));let a=t-e<i;if(n&&(a=a||e<Math.ceil(i/2)),a){const i=n?e<s.activeIndex?"prev":"next":e-s.activeIndex-1<s.params.slidesPerView?"next":"prev";s.loopFix({direction:i,slideTo:!0,activeSlideIndex:"next"===i?e+1:e-t+1,slideRealIndex:"next"===i?s.realIndex:void 0})}if(o){const e=r*s.params.grid.rows;r=s.slides.filter((t=>1*t.getAttribute("data-swiper-slide-index")===e))[0].column}else r=s.getSlideIndexByData(r)}return requestAnimationFrame((()=>{s.slideTo(r,t,n,i)})),s},slideNext:function(e,t,n){void 0===e&&(e=this.params.speed),void 0===t&&(t=!0);const i=this,{enabled:s,params:o,animating:r}=i;if(!s||i.destroyed)return i;let a=o.slidesPerGroup;"auto"===o.slidesPerView&&1===o.slidesPerGroup&&o.slidesPerGroupAuto&&(a=Math.max(i.slidesPerViewDynamic("current",!0),1));const c=i.activeIndex<o.slidesPerGroupSkip?1:a,l=i.virtual&&o.virtual.enabled;if(o.loop){if(r&&!l&&o.loopPreventsSliding)return!1;if(i.loopFix({direction:"next"}),i._clientLeft=i.wrapperEl.clientLeft,i.activeIndex===i.slides.length-1&&o.cssMode)return requestAnimationFrame((()=>{i.slideTo(i.activeIndex+c,e,t,n)})),!0}return o.rewind&&i.isEnd?i.slideTo(0,e,t,n):i.slideTo(i.activeIndex+c,e,t,n)},slidePrev:function(e,t,n){void 0===e&&(e=this.params.speed),void 0===t&&(t=!0);const i=this,{params:s,snapGrid:o,slidesGrid:r,rtlTranslate:a,enabled:c,animating:l}=i;if(!c||i.destroyed)return i;const d=i.virtual&&s.virtual.enabled;if(s.loop){if(l&&!d&&s.loopPreventsSliding)return!1;i.loopFix({direction:"prev"}),i._clientLeft=i.wrapperEl.clientLeft}function u(e){return e<0?-Math.floor(Math.abs(e)):Math.floor(e)}const h=u(a?i.translate:-i.translate),p=o.map((e=>u(e)));let m=o[p.indexOf(h)-1];if(void 0===m&&s.cssMode){let e;o.forEach(((t,n)=>{h>=t&&(e=n)})),void 0!==e&&(m=o[e>0?e-1:e])}let w=0;if(void 0!==m&&(w=r.indexOf(m),w<0&&(w=i.activeIndex-1),"auto"===s.slidesPerView&&1===s.slidesPerGroup&&s.slidesPerGroupAuto&&(w=w-i.slidesPerViewDynamic("previous",!0)+1,w=Math.max(w,0))),s.rewind&&i.isBeginning){const s=i.params.virtual&&i.params.virtual.enabled&&i.virtual?i.virtual.slides.length-1:i.slides.length-1;return i.slideTo(s,e,t,n)}return s.loop&&0===i.activeIndex&&s.cssMode?(requestAnimationFrame((()=>{i.slideTo(w,e,t,n)})),!0):i.slideTo(w,e,t,n)},slideReset:function(e,t,n){void 0===e&&(e=this.params.speed),void 0===t&&(t=!0);const i=this;if(!i.destroyed)return i.slideTo(i.activeIndex,e,t,n)},slideToClosest:function(e,t,n,i){void 0===e&&(e=this.params.speed),void 0===t&&(t=!0),void 0===i&&(i=.5);const s=this;if(s.destroyed)return;let o=s.activeIndex;const r=Math.min(s.params.slidesPerGroupSkip,o),a=r+Math.floor((o-r)/s.params.slidesPerGroup),c=s.rtlTranslate?s.translate:-s.translate;if(c>=s.snapGrid[a]){const e=s.snapGrid[a];c-e>(s.snapGrid[a+1]-e)*i&&(o+=s.params.slidesPerGroup)}else{const e=s.snapGrid[a-1];c-e<=(s.snapGrid[a]-e)*i&&(o-=s.params.slidesPerGroup)}return o=Math.max(o,0),o=Math.min(o,s.slidesGrid.length-1),s.slideTo(o,e,t,n)},slideToClickedSlide:function(){const e=this;if(e.destroyed)return;const{params:t,slidesEl:n}=e,i="auto"===t.slidesPerView?e.slidesPerViewDynamic():t.slidesPerView;let s,o=e.clickedIndex;const r=e.isElement?"swiper-slide":`.${t.slideClass}`;if(t.loop){if(e.animating)return;s=parseInt(e.clickedSlide.getAttribute("data-swiper-slide-index"),10),t.centeredSlides?o<e.loopedSlides-i/2||o>e.slides.length-e.loopedSlides+i/2?(e.loopFix(),o=e.getSlideIndex(Ql(n,`${r}[data-swiper-slide-index="${s}"]`)[0]),Wl((()=>{e.slideTo(o)}))):e.slideTo(o):o>e.slides.length-i?(e.loopFix(),o=e.getSlideIndex(Ql(n,`${r}[data-swiper-slide-index="${s}"]`)[0]),Wl((()=>{e.slideTo(o)}))):e.slideTo(o)}else e.slideTo(o)}},fd={loopCreate:function(e){const t=this,{params:n,slidesEl:i}=t;if(!n.loop||t.virtual&&t.params.virtual.enabled)return;const s=()=>{Ql(i,`.${n.slideClass}, swiper-slide`).forEach(((e,t)=>{e.setAttribute("data-swiper-slide-index",t)}))},o=t.grid&&n.grid&&n.grid.rows>1,r=n.slidesPerGroup*(o?n.grid.rows:1),a=t.slides.length%r!=0,c=o&&t.slides.length%n.grid.rows!=0,l=e=>{for(let i=0;i<e;i+=1){const e=t.isElement?td("swiper-slide",[n.slideBlankClass]):td("div",[n.slideClass,n.slideBlankClass]);t.slidesEl.append(e)}};a?(n.loopAddBlankSlides?(l(r-t.slides.length%r),t.recalcSlides(),t.updateSlides()):ed("Swiper Loop Warning: The number of slides is not even to slidesPerGroup, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)"),s()):c?(n.loopAddBlankSlides?(l(n.grid.rows-t.slides.length%n.grid.rows),t.recalcSlides(),t.updateSlides()):ed("Swiper Loop Warning: The number of slides is not even to grid.rows, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)"),s()):s(),t.loopFix({slideRealIndex:e,direction:n.centeredSlides?void 0:"next"})},loopFix:function(e){let{slideRealIndex:t,slideTo:n=!0,direction:i,setTranslate:s,activeSlideIndex:o,byController:r,byMousewheel:a}=void 0===e?{}:e;const c=this;if(!c.params.loop)return;c.emit("beforeLoopFix");const{slides:l,allowSlidePrev:d,allowSlideNext:u,slidesEl:h,params:p}=c,{centeredSlides:m}=p;if(c.allowSlidePrev=!0,c.allowSlideNext=!0,c.virtual&&p.virtual.enabled)return n&&(p.centeredSlides||0!==c.snapIndex?p.centeredSlides&&c.snapIndex<p.slidesPerView?c.slideTo(c.virtual.slides.length+c.snapIndex,0,!1,!0):c.snapIndex===c.snapGrid.length-1&&c.slideTo(c.virtual.slidesBefore,0,!1,!0):c.slideTo(c.virtual.slides.length,0,!1,!0)),c.allowSlidePrev=d,c.allowSlideNext=u,void c.emit("loopFix");let w=p.slidesPerView;"auto"===w?w=c.slidesPerViewDynamic():(w=Math.ceil(parseFloat(p.slidesPerView,10)),m&&w%2==0&&(w+=1));const g=p.slidesPerGroupAuto?w:p.slidesPerGroup;let f=g;f%g!=0&&(f+=g-f%g),f+=p.loopAdditionalSlides,c.loopedSlides=f;const v=c.grid&&p.grid&&p.grid.rows>1;l.length<w+f?ed("Swiper Loop Warning: The number of slides is not enough for loop mode, it will be disabled and not function properly. You need to add more slides (or make duplicates) or lower the values of slidesPerView and slidesPerGroup parameters"):v&&"row"===p.grid.fill&&ed("Swiper Loop Warning: Loop mode is not compatible with grid.fill = `row`");const b=[],_=[];let y=c.activeIndex;void 0===o?o=c.getSlideIndex(l.filter((e=>e.classList.contains(p.slideActiveClass)))[0]):y=o;const C="next"===i||!i,S="prev"===i||!i;let E=0,x=0;const k=v?Math.ceil(l.length/p.grid.rows):l.length,M=(v?l[o].column:o)+(m&&void 0===s?-w/2+.5:0);if(M<f){E=Math.max(f-M,g);for(let e=0;e<f-M;e+=1){const t=e-Math.floor(e/k)*k;if(v){const e=k-t-1;for(let t=l.length-1;t>=0;t-=1)l[t].column===e&&b.push(t)}else b.push(k-t-1)}}else if(M+w>k-f){x=Math.max(M-(k-2*f),g);for(let e=0;e<x;e+=1){const t=e-Math.floor(e/k)*k;v?l.forEach(((e,n)=>{e.column===t&&_.push(n)})):_.push(t)}}if(c.__preventObserver__=!0,requestAnimationFrame((()=>{c.__preventObserver__=!1})),S&&b.forEach((e=>{l[e].swiperLoopMoveDOM=!0,h.prepend(l[e]),l[e].swiperLoopMoveDOM=!1})),C&&_.forEach((e=>{l[e].swiperLoopMoveDOM=!0,h.append(l[e]),l[e].swiperLoopMoveDOM=!1})),c.recalcSlides(),"auto"===p.slidesPerView?c.updateSlides():v&&(b.length>0&&S||_.length>0&&C)&&c.slides.forEach(((e,t)=>{c.grid.updateSlide(t,e,c.slides)})),p.watchSlidesProgress&&c.updateSlidesOffset(),n)if(b.length>0&&S){if(void 0===t){const e=c.slidesGrid[y],t=c.slidesGrid[y+E]-e;a?c.setTranslate(c.translate-t):(c.slideTo(y+E,0,!1,!0),s&&(c.touchEventsData.startTranslate=c.touchEventsData.startTranslate-t,c.touchEventsData.currentTranslate=c.touchEventsData.currentTranslate-t))}else if(s){const e=v?b.length/p.grid.rows:b.length;c.slideTo(c.activeIndex+e,0,!1,!0),c.touchEventsData.currentTranslate=c.translate}}else if(_.length>0&&C)if(void 0===t){const e=c.slidesGrid[y],t=c.slidesGrid[y-x]-e;a?c.setTranslate(c.translate-t):(c.slideTo(y-x,0,!1,!0),s&&(c.touchEventsData.startTranslate=c.touchEventsData.startTranslate-t,c.touchEventsData.currentTranslate=c.touchEventsData.currentTranslate-t))}else{const e=v?_.length/p.grid.rows:_.length;c.slideTo(c.activeIndex-e,0,!1,!0)}if(c.allowSlidePrev=d,c.allowSlideNext=u,c.controller&&c.controller.control&&!r){const e={slideRealIndex:t,direction:i,setTranslate:s,activeSlideIndex:o,byController:!0};Array.isArray(c.controller.control)?c.controller.control.forEach((t=>{!t.destroyed&&t.params.loop&&t.loopFix({...e,slideTo:t.params.slidesPerView===p.slidesPerView&&n})})):c.controller.control instanceof c.constructor&&c.controller.control.params.loop&&c.controller.control.loopFix({...e,slideTo:c.controller.control.params.slidesPerView===p.slidesPerView&&n})}c.emit("loopFix")},loopDestroy:function(){const e=this,{params:t,slidesEl:n}=e;if(!t.loop||e.virtual&&e.params.virtual.enabled)return;e.recalcSlides();const i=[];e.slides.forEach((e=>{const t=void 0===e.swiperSlideIndex?1*e.getAttribute("data-swiper-slide-index"):e.swiperSlideIndex;i[t]=e})),e.slides.forEach((e=>{e.removeAttribute("data-swiper-slide-index")})),i.forEach((e=>{n.append(e)})),e.recalcSlides(),e.slideTo(e.realIndex,0)}};function vd(e,t,n){const i=zl(),{params:s}=e,o=s.edgeSwipeDetection,r=s.edgeSwipeThreshold;return!o||!(n<=r||n>=i.innerWidth-r)||"prevent"===o&&(t.preventDefault(),!0)}function bd(e){const t=this,n=ql();let i=e;i.originalEvent&&(i=i.originalEvent);const s=t.touchEventsData;if("pointerdown"===i.type){if(null!==s.pointerId&&s.pointerId!==i.pointerId)return;s.pointerId=i.pointerId}else"touchstart"===i.type&&1===i.targetTouches.length&&(s.touchId=i.targetTouches[0].identifier);if("touchstart"===i.type)return void vd(t,i,i.targetTouches[0].pageX);const{params:o,touches:r,enabled:a}=t;if(!a)return;if(!o.simulateTouch&&"mouse"===i.pointerType)return;if(t.animating&&o.preventInteractionOnTransition)return;!t.animating&&o.cssMode&&o.loop&&t.loopFix();let c=i.target;if("wrapper"===o.touchEventsTarget&&!t.wrapperEl.contains(c))return;if("which"in i&&3===i.which)return;if("button"in i&&i.button>0)return;if(s.isTouched&&s.isMoved)return;const l=!!o.noSwipingClass&&""!==o.noSwipingClass,d=i.composedPath?i.composedPath():i.path;l&&i.target&&i.target.shadowRoot&&d&&(c=d[0]);const u=o.noSwipingSelector?o.noSwipingSelector:`.${o.noSwipingClass}`,h=!(!i.target||!i.target.shadowRoot);if(o.noSwiping&&(h?function(e,t){return void 0===t&&(t=this),function t(n){if(!n||n===ql()||n===zl())return null;n.assignedSlot&&(n=n.assignedSlot);const i=n.closest(e);return i||n.getRootNode?i||t(n.getRootNode().host):null}(t)}(u,c):c.closest(u)))return void(t.allowClick=!0);if(o.swipeHandler&&!c.closest(o.swipeHandler))return;r.currentX=i.pageX,r.currentY=i.pageY;const p=r.currentX,m=r.currentY;if(!vd(t,i,p))return;Object.assign(s,{isTouched:!0,isMoved:!1,allowTouchCallbacks:!0,isScrolling:void 0,startMoving:void 0}),r.startX=p,r.startY=m,s.touchStartTime=Jl(),t.allowClick=!0,t.updateSize(),t.swipeDirection=void 0,o.threshold>0&&(s.allowThresholdMove=!1);let w=!0;c.matches(s.focusableElements)&&(w=!1,"SELECT"===c.nodeName&&(s.isTouched=!1)),n.activeElement&&n.activeElement.matches(s.focusableElements)&&n.activeElement!==c&&n.activeElement.blur();const g=w&&t.allowTouchMove&&o.touchStartPreventDefault;!o.touchStartForcePreventDefault&&!g||c.isContentEditable||i.preventDefault(),o.freeMode&&o.freeMode.enabled&&t.freeMode&&t.animating&&!o.cssMode&&t.freeMode.onTouchStart(),t.emit("touchStart",i)}function _d(e){const t=ql(),n=this,i=n.touchEventsData,{params:s,touches:o,rtlTranslate:r,enabled:a}=n;if(!a)return;if(!s.simulateTouch&&"mouse"===e.pointerType)return;let c,l=e;if(l.originalEvent&&(l=l.originalEvent),"pointermove"===l.type){if(null!==i.touchId)return;if(l.pointerId!==i.pointerId)return}if("touchmove"===l.type){if(c=[...l.changedTouches].filter((e=>e.identifier===i.touchId))[0],!c||c.identifier!==i.touchId)return}else c=l;if(!i.isTouched)return void(i.startMoving&&i.isScrolling&&n.emit("touchMoveOpposite",l));const d=c.pageX,u=c.pageY;if(l.preventedByNestedSwiper)return o.startX=d,void(o.startY=u);if(!n.allowTouchMove)return l.target.matches(i.focusableElements)||(n.allowClick=!1),void(i.isTouched&&(Object.assign(o,{startX:d,startY:u,currentX:d,currentY:u}),i.touchStartTime=Jl()));if(s.touchReleaseOnEdges&&!s.loop)if(n.isVertical()){if(u<o.startY&&n.translate<=n.maxTranslate()||u>o.startY&&n.translate>=n.minTranslate())return i.isTouched=!1,void(i.isMoved=!1)}else if(d<o.startX&&n.translate<=n.maxTranslate()||d>o.startX&&n.translate>=n.minTranslate())return;if(t.activeElement&&l.target===t.activeElement&&l.target.matches(i.focusableElements))return i.isMoved=!0,void(n.allowClick=!1);i.allowTouchCallbacks&&n.emit("touchMove",l),o.previousX=o.currentX,o.previousY=o.currentY,o.currentX=d,o.currentY=u;const h=o.currentX-o.startX,p=o.currentY-o.startY;if(n.params.threshold&&Math.sqrt(h**2+p**2)<n.params.threshold)return;if(void 0===i.isScrolling){let e;n.isHorizontal()&&o.currentY===o.startY||n.isVertical()&&o.currentX===o.startX?i.isScrolling=!1:h*h+p*p>=25&&(e=180*Math.atan2(Math.abs(p),Math.abs(h))/Math.PI,i.isScrolling=n.isHorizontal()?e>s.touchAngle:90-e>s.touchAngle)}if(i.isScrolling&&n.emit("touchMoveOpposite",l),void 0===i.startMoving&&(o.currentX===o.startX&&o.currentY===o.startY||(i.startMoving=!0)),i.isScrolling)return void(i.isTouched=!1);if(!i.startMoving)return;n.allowClick=!1,!s.cssMode&&l.cancelable&&l.preventDefault(),s.touchMoveStopPropagation&&!s.nested&&l.stopPropagation();let m=n.isHorizontal()?h:p,w=n.isHorizontal()?o.currentX-o.previousX:o.currentY-o.previousY;s.oneWayMovement&&(m=Math.abs(m)*(r?1:-1),w=Math.abs(w)*(r?1:-1)),o.diff=m,m*=s.touchRatio,r&&(m=-m,w=-w);const g=n.touchesDirection;n.swipeDirection=m>0?"prev":"next",n.touchesDirection=w>0?"prev":"next";const f=n.params.loop&&!s.cssMode,v="next"===n.touchesDirection&&n.allowSlideNext||"prev"===n.touchesDirection&&n.allowSlidePrev;if(!i.isMoved){if(f&&v&&n.loopFix({direction:n.swipeDirection}),i.startTranslate=n.getTranslate(),n.setTransition(0),n.animating){const e=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0});n.wrapperEl.dispatchEvent(e)}i.allowMomentumBounce=!1,!s.grabCursor||!0!==n.allowSlideNext&&!0!==n.allowSlidePrev||n.setGrabCursor(!0),n.emit("sliderFirstMove",l)}if((new Date).getTime(),i.isMoved&&i.allowThresholdMove&&g!==n.touchesDirection&&f&&v&&Math.abs(m)>=1)return Object.assign(o,{startX:d,startY:u,currentX:d,currentY:u,startTranslate:i.currentTranslate}),i.loopSwapReset=!0,void(i.startTranslate=i.currentTranslate);n.emit("sliderMove",l),i.isMoved=!0,i.currentTranslate=m+i.startTranslate;let b=!0,_=s.resistanceRatio;if(s.touchReleaseOnEdges&&(_=0),m>0?(f&&v&&i.allowThresholdMove&&i.currentTranslate>(s.centeredSlides?n.minTranslate()-n.slidesSizesGrid[n.activeIndex+1]:n.minTranslate())&&n.loopFix({direction:"prev",setTranslate:!0,activeSlideIndex:0}),i.currentTranslate>n.minTranslate()&&(b=!1,s.resistance&&(i.currentTranslate=n.minTranslate()-1+(-n.minTranslate()+i.startTranslate+m)**_))):m<0&&(f&&v&&i.allowThresholdMove&&i.currentTranslate<(s.centeredSlides?n.maxTranslate()+n.slidesSizesGrid[n.slidesSizesGrid.length-1]:n.maxTranslate())&&n.loopFix({direction:"next",setTranslate:!0,activeSlideIndex:n.slides.length-("auto"===s.slidesPerView?n.slidesPerViewDynamic():Math.ceil(parseFloat(s.slidesPerView,10)))}),i.currentTranslate<n.maxTranslate()&&(b=!1,s.resistance&&(i.currentTranslate=n.maxTranslate()+1-(n.maxTranslate()-i.startTranslate-m)**_))),b&&(l.preventedByNestedSwiper=!0),!n.allowSlideNext&&"next"===n.swipeDirection&&i.currentTranslate<i.startTranslate&&(i.currentTranslate=i.startTranslate),!n.allowSlidePrev&&"prev"===n.swipeDirection&&i.currentTranslate>i.startTranslate&&(i.currentTranslate=i.startTranslate),n.allowSlidePrev||n.allowSlideNext||(i.currentTranslate=i.startTranslate),s.threshold>0){if(!(Math.abs(m)>s.threshold||i.allowThresholdMove))return void(i.currentTranslate=i.startTranslate);if(!i.allowThresholdMove)return i.allowThresholdMove=!0,o.startX=o.currentX,o.startY=o.currentY,i.currentTranslate=i.startTranslate,void(o.diff=n.isHorizontal()?o.currentX-o.startX:o.currentY-o.startY)}s.followFinger&&!s.cssMode&&((s.freeMode&&s.freeMode.enabled&&n.freeMode||s.watchSlidesProgress)&&(n.updateActiveIndex(),n.updateSlidesClasses()),s.freeMode&&s.freeMode.enabled&&n.freeMode&&n.freeMode.onTouchMove(),n.updateProgress(i.currentTranslate),n.setTranslate(i.currentTranslate))}function yd(e){const t=this,n=t.touchEventsData;let i,s=e;if(s.originalEvent&&(s=s.originalEvent),"touchend"===s.type||"touchcancel"===s.type){if(i=[...s.changedTouches].filter((e=>e.identifier===n.touchId))[0],!i||i.identifier!==n.touchId)return}else{if(null!==n.touchId)return;if(s.pointerId!==n.pointerId)return;i=s}if(["pointercancel","pointerout","pointerleave","contextmenu"].includes(s.type)&&(!["pointercancel","contextmenu"].includes(s.type)||!t.browser.isSafari&&!t.browser.isWebView))return;n.pointerId=null,n.touchId=null;const{params:o,touches:r,rtlTranslate:a,slidesGrid:c,enabled:l}=t;if(!l)return;if(!o.simulateTouch&&"mouse"===s.pointerType)return;if(n.allowTouchCallbacks&&t.emit("touchEnd",s),n.allowTouchCallbacks=!1,!n.isTouched)return n.isMoved&&o.grabCursor&&t.setGrabCursor(!1),n.isMoved=!1,void(n.startMoving=!1);o.grabCursor&&n.isMoved&&n.isTouched&&(!0===t.allowSlideNext||!0===t.allowSlidePrev)&&t.setGrabCursor(!1);const d=Jl(),u=d-n.touchStartTime;if(t.allowClick){const e=s.path||s.composedPath&&s.composedPath();t.updateClickedSlide(e&&e[0]||s.target,e),t.emit("tap click",s),u<300&&d-n.lastClickTime<300&&t.emit("doubleTap doubleClick",s)}if(n.lastClickTime=Jl(),Wl((()=>{t.destroyed||(t.allowClick=!0)})),!n.isTouched||!n.isMoved||!t.swipeDirection||0===r.diff&&!n.loopSwapReset||n.currentTranslate===n.startTranslate&&!n.loopSwapReset)return n.isTouched=!1,n.isMoved=!1,void(n.startMoving=!1);let h;if(n.isTouched=!1,n.isMoved=!1,n.startMoving=!1,h=o.followFinger?a?t.translate:-t.translate:-n.currentTranslate,o.cssMode)return;if(o.freeMode&&o.freeMode.enabled)return void t.freeMode.onTouchEnd({currentPos:h});const p=h>=-t.maxTranslate()&&!t.params.loop;let m=0,w=t.slidesSizesGrid[0];for(let e=0;e<c.length;e+=e<o.slidesPerGroupSkip?1:o.slidesPerGroup){const t=e<o.slidesPerGroupSkip-1?1:o.slidesPerGroup;void 0!==c[e+t]?(p||h>=c[e]&&h<c[e+t])&&(m=e,w=c[e+t]-c[e]):(p||h>=c[e])&&(m=e,w=c[c.length-1]-c[c.length-2])}let g=null,f=null;o.rewind&&(t.isBeginning?f=o.virtual&&o.virtual.enabled&&t.virtual?t.virtual.slides.length-1:t.slides.length-1:t.isEnd&&(g=0));const v=(h-c[m])/w,b=m<o.slidesPerGroupSkip-1?1:o.slidesPerGroup;if(u>o.longSwipesMs){if(!o.longSwipes)return void t.slideTo(t.activeIndex);"next"===t.swipeDirection&&(v>=o.longSwipesRatio?t.slideTo(o.rewind&&t.isEnd?g:m+b):t.slideTo(m)),"prev"===t.swipeDirection&&(v>1-o.longSwipesRatio?t.slideTo(m+b):null!==f&&v<0&&Math.abs(v)>o.longSwipesRatio?t.slideTo(f):t.slideTo(m))}else{if(!o.shortSwipes)return void t.slideTo(t.activeIndex);!t.navigation||s.target!==t.navigation.nextEl&&s.target!==t.navigation.prevEl?("next"===t.swipeDirection&&t.slideTo(null!==g?g:m+b),"prev"===t.swipeDirection&&t.slideTo(null!==f?f:m)):s.target===t.navigation.nextEl?t.slideTo(m+b):t.slideTo(m)}}function Cd(){const e=this,{params:t,el:n}=e;if(n&&0===n.offsetWidth)return;t.breakpoints&&e.setBreakpoint();const{allowSlideNext:i,allowSlidePrev:s,snapGrid:o}=e,r=e.virtual&&e.params.virtual.enabled;e.allowSlideNext=!0,e.allowSlidePrev=!0,e.updateSize(),e.updateSlides(),e.updateSlidesClasses();const a=r&&t.loop;!("auto"===t.slidesPerView||t.slidesPerView>1)||!e.isEnd||e.isBeginning||e.params.centeredSlides||a?e.params.loop&&!r?e.slideToLoop(e.realIndex,0,!1,!0):e.slideTo(e.activeIndex,0,!1,!0):e.slideTo(e.slides.length-1,0,!1,!0),e.autoplay&&e.autoplay.running&&e.autoplay.paused&&(clearTimeout(e.autoplay.resizeTimeout),e.autoplay.resizeTimeout=setTimeout((()=>{e.autoplay&&e.autoplay.running&&e.autoplay.paused&&e.autoplay.resume()}),500)),e.allowSlidePrev=s,e.allowSlideNext=i,e.params.watchOverflow&&o!==e.snapGrid&&e.checkOverflow()}function Sd(e){const t=this;t.enabled&&(t.allowClick||(t.params.preventClicks&&e.preventDefault(),t.params.preventClicksPropagation&&t.animating&&(e.stopPropagation(),e.stopImmediatePropagation())))}function Ed(){const e=this,{wrapperEl:t,rtlTranslate:n,enabled:i}=e;if(!i)return;let s;e.previousTranslate=e.translate,e.isHorizontal()?e.translate=-t.scrollLeft:e.translate=-t.scrollTop,0===e.translate&&(e.translate=0),e.updateActiveIndex(),e.updateSlidesClasses();const o=e.maxTranslate()-e.minTranslate();s=0===o?0:(e.translate-e.minTranslate())/o,s!==e.progress&&e.updateProgress(n?-e.translate:e.translate),e.emit("setTranslate",e.translate,!1)}function xd(e){const t=this;dd(t,e.target),t.params.cssMode||"auto"!==t.params.slidesPerView&&!t.params.autoHeight||t.update()}function kd(){const e=this;e.documentTouchHandlerProceeded||(e.documentTouchHandlerProceeded=!0,e.params.touchReleaseOnEdges&&(e.el.style.touchAction="auto"))}const Md=(e,t)=>{const n=ql(),{params:i,el:s,wrapperEl:o,device:r}=e,a=!!i.nested,c="on"===t?"addEventListener":"removeEventListener",l=t;n[c]("touchstart",e.onDocumentTouchStart,{passive:!1,capture:a}),s[c]("touchstart",e.onTouchStart,{passive:!1}),s[c]("pointerdown",e.onTouchStart,{passive:!1}),n[c]("touchmove",e.onTouchMove,{passive:!1,capture:a}),n[c]("pointermove",e.onTouchMove,{passive:!1,capture:a}),n[c]("touchend",e.onTouchEnd,{passive:!0}),n[c]("pointerup",e.onTouchEnd,{passive:!0}),n[c]("pointercancel",e.onTouchEnd,{passive:!0}),n[c]("touchcancel",e.onTouchEnd,{passive:!0}),n[c]("pointerout",e.onTouchEnd,{passive:!0}),n[c]("pointerleave",e.onTouchEnd,{passive:!0}),n[c]("contextmenu",e.onTouchEnd,{passive:!0}),(i.preventClicks||i.preventClicksPropagation)&&s[c]("click",e.onClick,!0),i.cssMode&&o[c]("scroll",e.onScroll),i.updateOnWindowResize?e[l](r.ios||r.android?"resize orientationchange observerUpdate":"resize observerUpdate",Cd,!0):e[l]("observerUpdate",Cd,!0),s[c]("load",e.onLoad,{capture:!0})},Td=(e,t)=>e.grid&&t.grid&&t.grid.rows>1;var Id={setBreakpoint:function(){const e=this,{realIndex:t,initialized:n,params:i,el:s}=e,o=i.breakpoints;if(!o||o&&0===Object.keys(o).length)return;const r=e.getBreakpoint(o,e.params.breakpointsBase,e.el);if(!r||e.currentBreakpoint===r)return;const a=(r in o?o[r]:void 0)||e.originalParams,c=Td(e,i),l=Td(e,a),d=i.enabled;c&&!l?(s.classList.remove(`${i.containerModifierClass}grid`,`${i.containerModifierClass}grid-column`),e.emitContainerClasses()):!c&&l&&(s.classList.add(`${i.containerModifierClass}grid`),(a.grid.fill&&"column"===a.grid.fill||!a.grid.fill&&"column"===i.grid.fill)&&s.classList.add(`${i.containerModifierClass}grid-column`),e.emitContainerClasses()),["navigation","pagination","scrollbar"].forEach((t=>{if(void 0===a[t])return;const n=i[t]&&i[t].enabled,s=a[t]&&a[t].enabled;n&&!s&&e[t].disable(),!n&&s&&e[t].enable()}));const u=a.direction&&a.direction!==i.direction,h=i.loop&&(a.slidesPerView!==i.slidesPerView||u),p=i.loop;u&&n&&e.changeDirection(),Kl(e.params,a);const m=e.params.enabled,w=e.params.loop;Object.assign(e,{allowTouchMove:e.params.allowTouchMove,allowSlideNext:e.params.allowSlideNext,allowSlidePrev:e.params.allowSlidePrev}),d&&!m?e.disable():!d&&m&&e.enable(),e.currentBreakpoint=r,e.emit("_beforeBreakpoint",a),n&&(h?(e.loopDestroy(),e.loopCreate(t),e.updateSlides()):!p&&w?(e.loopCreate(t),e.updateSlides()):p&&!w&&e.loopDestroy()),e.emit("breakpoint",a)},getBreakpoint:function(e,t,n){if(void 0===t&&(t="window"),!e||"container"===t&&!n)return;let i=!1;const s=zl(),o="window"===t?s.innerHeight:n.clientHeight,r=Object.keys(e).map((e=>{if("string"==typeof e&&0===e.indexOf("@")){const t=parseFloat(e.substr(1));return{value:o*t,point:e}}return{value:e,point:e}}));r.sort(((e,t)=>parseInt(e.value,10)-parseInt(t.value,10)));for(let e=0;e<r.length;e+=1){const{point:o,value:a}=r[e];"window"===t?s.matchMedia(`(min-width: ${a}px)`).matches&&(i=o):a<=n.clientWidth&&(i=o)}return i||"max"}},Rd={init:!0,direction:"horizontal",oneWayMovement:!1,swiperElementNodeName:"SWIPER-CONTAINER",touchEventsTarget:"wrapper",initialSlide:0,speed:300,cssMode:!1,updateOnWindowResize:!0,resizeObserver:!0,nested:!1,createElements:!1,eventsPrefix:"swiper",enabled:!0,focusableElements:"input, select, option, textarea, button, video, label",width:null,height:null,preventInteractionOnTransition:!1,userAgent:null,url:null,edgeSwipeDetection:!1,edgeSwipeThreshold:20,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",breakpoints:void 0,breakpointsBase:"window",spaceBetween:0,slidesPerView:1,slidesPerGroup:1,slidesPerGroupSkip:0,slidesPerGroupAuto:!1,centeredSlides:!1,centeredSlidesBounds:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,normalizeSlideIndex:!0,centerInsufficientSlides:!1,watchOverflow:!0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,allowTouchMove:!0,threshold:5,touchMoveStopPropagation:!1,touchStartPreventDefault:!0,touchStartForcePreventDefault:!1,touchReleaseOnEdges:!1,uniqueNavElements:!0,resistance:!0,resistanceRatio:.85,watchSlidesProgress:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,loop:!1,loopAddBlankSlides:!0,loopAdditionalSlides:0,loopPreventsSliding:!0,rewind:!1,allowSlidePrev:!0,allowSlideNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",noSwipingSelector:null,passiveListeners:!0,maxBackfaceHiddenSlides:10,containerModifierClass:"swiper-",slideClass:"swiper-slide",slideBlankClass:"swiper-slide-blank",slideActiveClass:"swiper-slide-active",slideVisibleClass:"swiper-slide-visible",slideFullyVisibleClass:"swiper-slide-fully-visible",slideNextClass:"swiper-slide-next",slidePrevClass:"swiper-slide-prev",wrapperClass:"swiper-wrapper",lazyPreloaderClass:"swiper-lazy-preloader",lazyPreloadPrevNext:0,runCallbacksOnInit:!0,_emitClasses:!1};function Ad(e,t){return function(n){void 0===n&&(n={});const i=Object.keys(n)[0],s=n[i];"object"==typeof s&&null!==s?(!0===e[i]&&(e[i]={enabled:!0}),"navigation"===i&&e[i]&&e[i].enabled&&!e[i].prevEl&&!e[i].nextEl&&(e[i].auto=!0),["pagination","scrollbar"].indexOf(i)>=0&&e[i]&&e[i].enabled&&!e[i].el&&(e[i].auto=!0),i in e&&"enabled"in s?("object"!=typeof e[i]||"enabled"in e[i]||(e[i].enabled=!0),e[i]||(e[i]={enabled:!1}),Kl(t,n)):Kl(t,n)):Kl(t,n)}}const $d={eventsEmitter:{on(e,t,n){const i=this;if(!i.eventsListeners||i.destroyed)return i;if("function"!=typeof t)return i;const s=n?"unshift":"push";return e.split(" ").forEach((e=>{i.eventsListeners[e]||(i.eventsListeners[e]=[]),i.eventsListeners[e][s](t)})),i},once(e,t,n){const i=this;if(!i.eventsListeners||i.destroyed)return i;if("function"!=typeof t)return i;function s(){i.off(e,s),s.__emitterProxy&&delete s.__emitterProxy;for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];t.apply(i,o)}return s.__emitterProxy=t,i.on(e,s,n)},onAny(e,t){const n=this;if(!n.eventsListeners||n.destroyed)return n;if("function"!=typeof e)return n;const i=t?"unshift":"push";return n.eventsAnyListeners.indexOf(e)<0&&n.eventsAnyListeners[i](e),n},offAny(e){const t=this;if(!t.eventsListeners||t.destroyed)return t;if(!t.eventsAnyListeners)return t;const n=t.eventsAnyListeners.indexOf(e);return n>=0&&t.eventsAnyListeners.splice(n,1),t},off(e,t){const n=this;return!n.eventsListeners||n.destroyed?n:n.eventsListeners?(e.split(" ").forEach((e=>{void 0===t?n.eventsListeners[e]=[]:n.eventsListeners[e]&&n.eventsListeners[e].forEach(((i,s)=>{(i===t||i.__emitterProxy&&i.__emitterProxy===t)&&n.eventsListeners[e].splice(s,1)}))})),n):n},emit(){const e=this;if(!e.eventsListeners||e.destroyed)return e;if(!e.eventsListeners)return e;let t,n,i;for(var s=arguments.length,o=new Array(s),r=0;r<s;r++)o[r]=arguments[r];return"string"==typeof o[0]||Array.isArray(o[0])?(t=o[0],n=o.slice(1,o.length),i=e):(t=o[0].events,n=o[0].data,i=o[0].context||e),n.unshift(i),(Array.isArray(t)?t:t.split(" ")).forEach((t=>{e.eventsAnyListeners&&e.eventsAnyListeners.length&&e.eventsAnyListeners.forEach((e=>{e.apply(i,[t,...n])})),e.eventsListeners&&e.eventsListeners[t]&&e.eventsListeners[t].forEach((e=>{e.apply(i,n)}))})),e}},update:pd,translate:md,transition:{setTransition:function(e,t){const n=this;n.params.cssMode||(n.wrapperEl.style.transitionDuration=`${e}ms`,n.wrapperEl.style.transitionDelay=0===e?"0ms":""),n.emit("setTransition",e,t)},transitionStart:function(e,t){void 0===e&&(e=!0);const n=this,{params:i}=n;i.cssMode||(i.autoHeight&&n.updateAutoHeight(),wd({swiper:n,runCallbacks:e,direction:t,step:"Start"}))},transitionEnd:function(e,t){void 0===e&&(e=!0);const n=this,{params:i}=n;n.animating=!1,i.cssMode||(n.setTransition(0),wd({swiper:n,runCallbacks:e,direction:t,step:"End"}))}},slide:gd,loop:fd,grabCursor:{setGrabCursor:function(e){const t=this;if(!t.params.simulateTouch||t.params.watchOverflow&&t.isLocked||t.params.cssMode)return;const n="container"===t.params.touchEventsTarget?t.el:t.wrapperEl;t.isElement&&(t.__preventObserver__=!0),n.style.cursor="move",n.style.cursor=e?"grabbing":"grab",t.isElement&&requestAnimationFrame((()=>{t.__preventObserver__=!1}))},unsetGrabCursor:function(){const e=this;e.params.watchOverflow&&e.isLocked||e.params.cssMode||(e.isElement&&(e.__preventObserver__=!0),e["container"===e.params.touchEventsTarget?"el":"wrapperEl"].style.cursor="",e.isElement&&requestAnimationFrame((()=>{e.__preventObserver__=!1})))}},events:{attachEvents:function(){const e=this,{params:t}=e;e.onTouchStart=bd.bind(e),e.onTouchMove=_d.bind(e),e.onTouchEnd=yd.bind(e),e.onDocumentTouchStart=kd.bind(e),t.cssMode&&(e.onScroll=Ed.bind(e)),e.onClick=Sd.bind(e),e.onLoad=xd.bind(e),Md(e,"on")},detachEvents:function(){Md(this,"off")}},breakpoints:Id,checkOverflow:{checkOverflow:function(){const e=this,{isLocked:t,params:n}=e,{slidesOffsetBefore:i}=n;if(i){const t=e.slides.length-1,n=e.slidesGrid[t]+e.slidesSizesGrid[t]+2*i;e.isLocked=e.size>n}else e.isLocked=1===e.snapGrid.length;!0===n.allowSlideNext&&(e.allowSlideNext=!e.isLocked),!0===n.allowSlidePrev&&(e.allowSlidePrev=!e.isLocked),t&&t!==e.isLocked&&(e.isEnd=!1),t!==e.isLocked&&e.emit(e.isLocked?"lock":"unlock")}},classes:{addClasses:function(){const e=this,{classNames:t,params:n,rtl:i,el:s,device:o}=e,r=function(e,t){const n=[];return e.forEach((e=>{"object"==typeof e?Object.keys(e).forEach((i=>{e[i]&&n.push(t+i)})):"string"==typeof e&&n.push(t+e)})),n}(["initialized",n.direction,{"free-mode":e.params.freeMode&&n.freeMode.enabled},{autoheight:n.autoHeight},{rtl:i},{grid:n.grid&&n.grid.rows>1},{"grid-column":n.grid&&n.grid.rows>1&&"column"===n.grid.fill},{android:o.android},{ios:o.ios},{"css-mode":n.cssMode},{centered:n.cssMode&&n.centeredSlides},{"watch-progress":n.watchSlidesProgress}],n.containerModifierClass);t.push(...r),s.classList.add(...t),e.emitContainerClasses()},removeClasses:function(){const{el:e,classNames:t}=this;e.classList.remove(...t),this.emitContainerClasses()}}},Ld={};class Pd{constructor(){let e,t;for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];1===i.length&&i[0].constructor&&"Object"===Object.prototype.toString.call(i[0]).slice(8,-1)?t=i[0]:[e,t]=i,t||(t={}),t=Kl({},t),e&&!t.el&&(t.el=e);const o=ql();if(t.el&&"string"==typeof t.el&&o.querySelectorAll(t.el).length>1){const e=[];return o.querySelectorAll(t.el).forEach((n=>{const i=Kl({},t,{el:n});e.push(new Pd(i))})),e}const r=this;r.__swiper__=!0,r.support=cd(),r.device=ld({userAgent:t.userAgent}),r.browser=(ad||(ad=function(){const e=zl(),t=ld();let n=!1;function i(){const t=e.navigator.userAgent.toLowerCase();return t.indexOf("safari")>=0&&t.indexOf("chrome")<0&&t.indexOf("android")<0}if(i()){const t=String(e.navigator.userAgent);if(t.includes("Version/")){const[e,i]=t.split("Version/")[1].split(" ")[0].split(".").map((e=>Number(e)));n=e<16||16===e&&i<2}}const s=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(e.navigator.userAgent),o=i();return{isSafari:n||o,needPerspectiveFix:n,need3dFix:o||s&&t.ios,isWebView:s}}()),ad),r.eventsListeners={},r.eventsAnyListeners=[],r.modules=[...r.__modules__],t.modules&&Array.isArray(t.modules)&&r.modules.push(...t.modules);const a={};r.modules.forEach((e=>{e({params:t,swiper:r,extendParams:Ad(t,a),on:r.on.bind(r),once:r.once.bind(r),off:r.off.bind(r),emit:r.emit.bind(r)})}));const c=Kl({},Rd,a);return r.params=Kl({},c,Ld,t),r.originalParams=Kl({},r.params),r.passedParams=Kl({},t),r.params&&r.params.on&&Object.keys(r.params.on).forEach((e=>{r.on(e,r.params.on[e])})),r.params&&r.params.onAny&&r.onAny(r.params.onAny),Object.assign(r,{enabled:r.params.enabled,el:e,classNames:[],slides:[],slidesGrid:[],snapGrid:[],slidesSizesGrid:[],isHorizontal:()=>"horizontal"===r.params.direction,isVertical:()=>"vertical"===r.params.direction,activeIndex:0,realIndex:0,isBeginning:!0,isEnd:!1,translate:0,previousTranslate:0,progress:0,velocity:0,animating:!1,cssOverflowAdjustment(){return Math.trunc(this.translate/2**23)*2**23},allowSlideNext:r.params.allowSlideNext,allowSlidePrev:r.params.allowSlidePrev,touchEventsData:{isTouched:void 0,isMoved:void 0,allowTouchCallbacks:void 0,touchStartTime:void 0,isScrolling:void 0,currentTranslate:void 0,startTranslate:void 0,allowThresholdMove:void 0,focusableElements:r.params.focusableElements,lastClickTime:0,clickTimeout:void 0,velocities:[],allowMomentumBounce:void 0,startMoving:void 0,pointerId:null,touchId:null},allowClick:!0,allowTouchMove:r.params.allowTouchMove,touches:{startX:0,startY:0,currentX:0,currentY:0,diff:0},imagesToLoad:[],imagesLoaded:0}),r.emit("_swiper"),r.params.init&&r.init(),r}getDirectionLabel(e){return this.isHorizontal()?e:{width:"height","margin-top":"margin-left","margin-bottom ":"margin-right","margin-left":"margin-top","margin-right":"margin-bottom","padding-left":"padding-top","padding-right":"padding-bottom",marginRight:"marginBottom"}[e]}getSlideIndex(e){const{slidesEl:t,params:n}=this,i=id(Ql(t,`.${n.slideClass}, swiper-slide`)[0]);return id(e)-i}getSlideIndexByData(e){return this.getSlideIndex(this.slides.filter((t=>1*t.getAttribute("data-swiper-slide-index")===e))[0])}recalcSlides(){const{slidesEl:e,params:t}=this;this.slides=Ql(e,`.${t.slideClass}, swiper-slide`)}enable(){const e=this;e.enabled||(e.enabled=!0,e.params.grabCursor&&e.setGrabCursor(),e.emit("enable"))}disable(){const e=this;e.enabled&&(e.enabled=!1,e.params.grabCursor&&e.unsetGrabCursor(),e.emit("disable"))}setProgress(e,t){const n=this;e=Math.min(Math.max(e,0),1);const i=n.minTranslate(),s=(n.maxTranslate()-i)*e+i;n.translateTo(s,void 0===t?0:t),n.updateActiveIndex(),n.updateSlidesClasses()}emitContainerClasses(){const e=this;if(!e.params._emitClasses||!e.el)return;const t=e.el.className.split(" ").filter((t=>0===t.indexOf("swiper")||0===t.indexOf(e.params.containerModifierClass)));e.emit("_containerClasses",t.join(" "))}getSlideClasses(e){const t=this;return t.destroyed?"":e.className.split(" ").filter((e=>0===e.indexOf("swiper-slide")||0===e.indexOf(t.params.slideClass))).join(" ")}emitSlidesClasses(){const e=this;if(!e.params._emitClasses||!e.el)return;const t=[];e.slides.forEach((n=>{const i=e.getSlideClasses(n);t.push({slideEl:n,classNames:i}),e.emit("_slideClass",n,i)})),e.emit("_slideClasses",t)}slidesPerViewDynamic(e,t){void 0===e&&(e="current"),void 0===t&&(t=!1);const{params:n,slides:i,slidesGrid:s,slidesSizesGrid:o,size:r,activeIndex:a}=this;let c=1;if("number"==typeof n.slidesPerView)return n.slidesPerView;if(n.centeredSlides){let e,t=i[a]?Math.ceil(i[a].swiperSlideSize):0;for(let n=a+1;n<i.length;n+=1)i[n]&&!e&&(t+=Math.ceil(i[n].swiperSlideSize),c+=1,t>r&&(e=!0));for(let n=a-1;n>=0;n-=1)i[n]&&!e&&(t+=i[n].swiperSlideSize,c+=1,t>r&&(e=!0))}else if("current"===e)for(let e=a+1;e<i.length;e+=1)(t?s[e]+o[e]-s[a]<r:s[e]-s[a]<r)&&(c+=1);else for(let e=a-1;e>=0;e-=1)s[a]-s[e]<r&&(c+=1);return c}update(){const e=this;if(!e||e.destroyed)return;const{snapGrid:t,params:n}=e;function i(){const t=e.rtlTranslate?-1*e.translate:e.translate,n=Math.min(Math.max(t,e.maxTranslate()),e.minTranslate());e.setTranslate(n),e.updateActiveIndex(),e.updateSlidesClasses()}let s;if(n.breakpoints&&e.setBreakpoint(),[...e.el.querySelectorAll('[loading="lazy"]')].forEach((t=>{t.complete&&dd(e,t)})),e.updateSize(),e.updateSlides(),e.updateProgress(),e.updateSlidesClasses(),n.freeMode&&n.freeMode.enabled&&!n.cssMode)i(),n.autoHeight&&e.updateAutoHeight();else{if(("auto"===n.slidesPerView||n.slidesPerView>1)&&e.isEnd&&!n.centeredSlides){const t=e.virtual&&n.virtual.enabled?e.virtual.slides:e.slides;s=e.slideTo(t.length-1,0,!1,!0)}else s=e.slideTo(e.activeIndex,0,!1,!0);s||i()}n.watchOverflow&&t!==e.snapGrid&&e.checkOverflow(),e.emit("update")}changeDirection(e,t){void 0===t&&(t=!0);const n=this,i=n.params.direction;return e||(e="horizontal"===i?"vertical":"horizontal"),e===i||"horizontal"!==e&&"vertical"!==e||(n.el.classList.remove(`${n.params.containerModifierClass}${i}`),n.el.classList.add(`${n.params.containerModifierClass}${e}`),n.emitContainerClasses(),n.params.direction=e,n.slides.forEach((t=>{"vertical"===e?t.style.width="":t.style.height=""})),n.emit("changeDirection"),t&&n.update()),n}changeLanguageDirection(e){const t=this;t.rtl&&"rtl"===e||!t.rtl&&"ltr"===e||(t.rtl="rtl"===e,t.rtlTranslate="horizontal"===t.params.direction&&t.rtl,t.rtl?(t.el.classList.add(`${t.params.containerModifierClass}rtl`),t.el.dir="rtl"):(t.el.classList.remove(`${t.params.containerModifierClass}rtl`),t.el.dir="ltr"),t.update())}mount(e){const t=this;if(t.mounted)return!0;let n=e||t.params.el;if("string"==typeof n&&(n=document.querySelector(n)),!n)return!1;n.swiper=t,n.parentNode&&n.parentNode.host&&n.parentNode.host.nodeName===t.params.swiperElementNodeName.toUpperCase()&&(t.isElement=!0);const i=()=>`.${(t.params.wrapperClass||"").trim().split(" ").join(".")}`;let s=n&&n.shadowRoot&&n.shadowRoot.querySelector?n.shadowRoot.querySelector(i()):Ql(n,i())[0];return!s&&t.params.createElements&&(s=td("div",t.params.wrapperClass),n.append(s),Ql(n,`.${t.params.slideClass}`).forEach((e=>{s.append(e)}))),Object.assign(t,{el:n,wrapperEl:s,slidesEl:t.isElement&&!n.parentNode.host.slideSlots?n.parentNode.host:s,hostEl:t.isElement?n.parentNode.host:n,mounted:!0,rtl:"rtl"===n.dir.toLowerCase()||"rtl"===nd(n,"direction"),rtlTranslate:"horizontal"===t.params.direction&&("rtl"===n.dir.toLowerCase()||"rtl"===nd(n,"direction")),wrongRTL:"-webkit-box"===nd(s,"display")}),!0}init(e){const t=this;if(t.initialized)return t;if(!1===t.mount(e))return t;t.emit("beforeInit"),t.params.breakpoints&&t.setBreakpoint(),t.addClasses(),t.updateSize(),t.updateSlides(),t.params.watchOverflow&&t.checkOverflow(),t.params.grabCursor&&t.enabled&&t.setGrabCursor(),t.params.loop&&t.virtual&&t.params.virtual.enabled?t.slideTo(t.params.initialSlide+t.virtual.slidesBefore,0,t.params.runCallbacksOnInit,!1,!0):t.slideTo(t.params.initialSlide,0,t.params.runCallbacksOnInit,!1,!0),t.params.loop&&t.loopCreate(),t.attachEvents();const n=[...t.el.querySelectorAll('[loading="lazy"]')];return t.isElement&&n.push(...t.hostEl.querySelectorAll('[loading="lazy"]')),n.forEach((e=>{e.complete?dd(t,e):e.addEventListener("load",(e=>{dd(t,e.target)}))})),hd(t),t.initialized=!0,hd(t),t.emit("init"),t.emit("afterInit"),t}destroy(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0);const n=this,{params:i,el:s,wrapperEl:o,slides:r}=n;return void 0===n.params||n.destroyed||(n.emit("beforeDestroy"),n.initialized=!1,n.detachEvents(),i.loop&&n.loopDestroy(),t&&(n.removeClasses(),s.removeAttribute("style"),o.removeAttribute("style"),r&&r.length&&r.forEach((e=>{e.classList.remove(i.slideVisibleClass,i.slideFullyVisibleClass,i.slideActiveClass,i.slideNextClass,i.slidePrevClass),e.removeAttribute("style"),e.removeAttribute("data-swiper-slide-index")}))),n.emit("destroy"),Object.keys(n.eventsListeners).forEach((e=>{n.off(e)})),!1!==e&&(n.el.swiper=null,function(e){const t=e;Object.keys(t).forEach((e=>{try{t[e]=null}catch(e){}try{delete t[e]}catch(e){}}))}(n)),n.destroyed=!0),null}static extendDefaults(e){Kl(Ld,e)}static get extendedDefaults(){return Ld}static get defaults(){return Rd}static installModule(e){Pd.prototype.__modules__||(Pd.prototype.__modules__=[]);const t=Pd.prototype.__modules__;"function"==typeof e&&t.indexOf(e)<0&&t.push(e)}static use(e){return Array.isArray(e)?(e.forEach((e=>Pd.installModule(e))),Pd):(Pd.installModule(e),Pd)}}function Dd(){let e={},t=!0,n="",i="",s="",o="",r="",a=0,c="",d="",u={};const h={};let m={},w={},g=!1,f="",v="",b=[],_={},y=0,C=[],S={},x=[],k={};const M={};let T,I=[],R={},A=[],$={},L=[],P={},D=[],N={},O=[],U={},j=0,V=0,q=!1,z="",W=0,J=0,Y=0,K=!1,X=[],Z="",Q="",ee=!1,te=!1,ne=[],ie={},se=[],oe=0,re=!1,ae=!1,ce={},le="",de=null,ue=!1,he=null,pe="0",me=[];const we={};let ge=[],fe=[];const ve=[];let be=!1;const _e={};let ye="";const Ce={audioMute:!1,audioOnly:!1,autoOp:!1,autoVoice:0,bandShare:!1,banned:{},bitrate:0,chanOp:{},chanMod:{},chatLog:!1,chgUBitRate:!1,closure:!1,commerce:0,inviteOnly:!1,interactive:!0,key:"",limit:0,mediaVoiceRx:!1,mobile:!1,moderated:!1,multiVoice:!1,namesLimit:0,noAutoDevoice:!1,noPrivMsg:!1,oneAudio:!1,owner:"",persistent:!1,private:!1,secret:!1,selfVoice:!1,showUserList:!1,textOnly:!1,topicLimit:!1,voice:{},voiceLimit:0,voiceRx:!1};let Se,Ee,xe,ke,Me,Te,Ie;function Re(){Se={allowBanUser:!0,allowKickUser:!0,allowMediaAttachments:!0,allowRealTimeVideo:!0,allowReceiveMedia:!0,allowSelfVoice:!0,allowSendChatMessage:!0,allowSetMediaVoice:!0,allowSetVoice:!0,allowShareScreen:!0,allowTopicChange:!0},Ee={allowBanUser:!0,allowKickUser:!0,allowMediaAttachments:!0,allowRealTimeVideo:!0,allowReceiveMedia:!0,allowSelfVoice:!0,allowSendChatMessage:!0,allowSetMediaVoice:!0,allowSetVoice:!0,allowShareScreen:!0,allowTopicChange:!0},xe={allowBanUser:!0,allowKickUser:!0,allowMediaAttachments:!0,allowRealTimeVideo:!0,allowReceiveMedia:!0,allowSelfVoice:!0,allowSendChatMessage:!0,allowSetMediaVoice:!0,allowSetVoice:!0,allowShareScreen:!0,allowTopicChange:!0},ke={allowBanUser:!1,allowKickUser:!1,allowMediaAttachments:!0,allowRealTimeVideo:!1,allowReceiveMedia:!0,allowSelfVoice:!1,allowSendChatMessage:!0,allowSetMediaVoice:!1,allowSetVoice:!1,allowShareScreen:!1,allowTopicChange:!1},Me={allowBanUser:!1,allowKickUser:!1,allowMediaAttachments:!0,allowRealTimeVideo:!0,allowReceiveMedia:!0,allowSelfVoice:!1,allowSendChatMessage:!0,allowSetMediaVoice:!0,allowSetVoice:!0,allowShareScreen:!0,allowTopicChange:!1},Te={allowBanUser:!1,allowKickUser:!1,allowMediaAttachments:!1,allowRealTimeVideo:!1,allowReceiveMedia:!0,allowSelfVoice:!1,allowSendChatMessage:!0,allowSetMediaVoice:!1,allowSetVoice:!1,allowShareScreen:!1,allowTopicChange:!1},Ie={allowBanUser:!1,allowKickUser:!1,allowMediaAttachments:!1,allowRealTimeVideo:!1,allowReceiveMedia:!0,allowSelfVoice:!1,allowSendChatMessage:!1,allowSetMediaVoice:!1,allowSetVoice:!1,allowShareScreen:!1,allowTopicChange:!1}}Re();const Ae=[],$e={},Le=function(){let e=null,t=null,n=null,i=null,s=null,o=null,r=null,a=null,c=null,l=null;return{setters:{channelPermissionsCB:function(e){a=e},channelCategoriesCB:function(t){e=t},channelListCB:function(e){t=e},roomsListCB:function(e){n=e},sendMsgCB:function(e){i=e},delMsgCB:function(e){s=e},sendOpenGraphCB:function(e){o=e},printMsgCB:function(e){r=e},getMediasCB:function(e){c=e},voiceRequestCB:function(e){l=e}},getters:{channelPermissionsCB:function(){return a},channelCategoriesCB:function(){return e},channelListCB:function(){return t},roomsListCB:function(){return n},sendMsgCB:function(){return i},delMsgCB:function(){return s},sendOpenGraphCB:function(){return o},printMsgCB:function(){return r},getMediasCB:function(){return c},voiceRequestCB:function(){return l}}}}();function Pe(){return n}function De(){return y}function Ne(){return i}function Oe(){return a}function Be(){return C}function Fe(){return c}function Ue(){return ie}function je(e){return!!P[e]&&(L=B(L,e),delete P[e],!0)}function Ve(e){const t=Object.values(Ue());for(let n=0;n<t.length;n+=1)if(t[n].mediaVoice&&t[n].owner===e)return!0;return!1}function Ge(e){return N[e.owner]?!e.mediaId||1!==N[e.owner].length||N[e.owner][0].mediaId===e.mediaId||(N[e.owner].push({owner:e.owner,mediaId:e.mediaId}),!0):(e.mediaId&&(N[e.owner]=[{owner:e.owner,mediaId:e.mediaId}]),D.includes(e.owner)||D.push(e.owner),!0)}function qe(e){return!!U[e]&&(O=B(O,e),delete U[e],!0)}function He(e){const t=Object.values(Ue());for(let n=0;n<t.length;n+=1)if(!t[n].mediaVoice&&t[n].owner===e)return!0;return!1}function ze(e){const t=[];let n=0;return window._mediaWndsMap.forEach((i=>{i.metadata&&(-2===i.metadata.mediaId&&"youtube"===e?t.push(i):!i.metadata.owner||i.metadata.owner!==e&&i.metadata.owner!==`${e}-web`||(i.metadata.mediaId>n?(n=i.metadata.mediaId,t.push(i)):i.metadata.mediaId<n&&t.unshift(i)))})),0!==t.length&&t}function We(){return e}function Je(e){return!!e&&!!(u[e]||u[e.replace("-web","")]||u[`${e}-web`])}function Ye(e){return!!h[e]}function Ke(e){return!!m[e]}function Xe(e){return r===e}function Ze(){return y}async function Qe(e,t){const n=e,i=t?`${t}`:p.ROOMS_SELECTED_FILTER,s=n.rooms,o=[];for(let e=0;e<s.length;e+=1){const t=s[e].category_ids;if(t&&0!==t.length)for(let e=0;e<t.length;e+=1)o.includes(t[e])||o.push(t[e])}const r=await et(o),a={};for(let e=0;e<r.length;e+=1){const t={},n=r[e].id,i=r[e].name,s=r[e].parent_id,o=r[e].show_in_filter,c=r[e].show_in_list;t.id=n,t.name=i,s&&(t.parentId=`${s}`),t.showInFilter=o,t.showInList=c,a[`${i.toLowerCase()},${n}`]=t,we[`${n}`]=t}const c=H(a);ge=[],fe=[];for(const[e,t]of Object.entries(c)){const e=t.showInFilter,n=t.showInList;e&&ge.push(t),n&&(fe.push(t),ve.includes(t.id)||ve.push(t.id))}p.ROOMS_CATEGORIES_FILTER=ge,p.ROOMS_CATEGORIES_LIST=fe,p.ROOMS_CATEGORIES_LIST_IDS=ve;const l=[],d=[];p.ROOM||(p.ROOM={});for(let e=0;e<fe.length;e+=1){const t=parseInt(`${fe[e].id}`),n={};n.category=fe[e],n.rooms=[];for(let e=0;e<s.length;e+=1){const o=s[e].category_ids;0!==o.length&&o.includes(t)&&(i&&"-1"!==i?s[e].category_ids.includes(parseInt(i))&&n.rooms.push(s[e]):n.rooms.push(s[e]),d.includes(s[e].id)||d.push(s[e].id)),p.ROOM[`${s[e].name}`]||(p.ROOM[`${s[e].name}`]=s[e])}l.push(n)}const u=[];for(let e=0;e<s.length;e+=1)d.includes(s[e].id)||(i&&"-1"!==i?s[e].category_ids.includes(parseInt(i))&&u.push(s[e]):u.push(s[e]),p.ROOM[`${s[e].name}`]||(p.ROOM[`${s[e].name}`]=s[e]));if(0!==u.length){const e={category:{id:-1,name:"uncategory"}};e.rooms=u,l.push(e)}return l}async function et(e){let t=[];return 0!==e.length&&(t=await ui(e)),me=t,t}function tt(e,t){if(ie.hasOwnProperty(e))ie[e].ts=t;else{let n="",i=0;-2===e?n="youtube":(n=window._mediaWndsMap.get(e).metadata.owner,i=window._mediaWndsMap.get(e).metadata.mediaVoice),ie[e]={ts:t,owner:n,mediaVoice:i},ne.push(e)}}function nt(e){delete ie[e],ne=B(ne,e)}return{setJustEntered:function(e){t=e},justEntered:function(){return t},setActiveRoom:function(e){n=e},getActiveRoom:Pe,setType:function(e){return y=e,!0},getType:De,setChannel:function(e,t){return $e[e]||(Ae.push(e),$e[e]=t),!1},getChannel:function(e){return $e[e]},getChannelData:async function(e){return await si(e)},setName:function(e){return i=e,!0},getName:Ne,setPassword:function(e){return s=e,!0},getPassword:function(){return s},setTopic:function(e=""){return o=e,!0},getTopic:function(){return o},setUsersCount:function(e){return a=e,!0},getUsersCount:Oe,setUsers:function(e){C=[];for(let t=0;t<e.length;t+=1){const n=e[t];if(C.push(n.name),S[n.name]=n,t===e.length-1)return!1}return!0},setUser:function(e,t){return!S[e]&&(C.push(e),S[e]={name:e,fullname:t},!0)},unsetUser:function(e){return!!S[e]&&(delete S[e],C=B(C,e),!0)},getUsers:Be,getUser:function(e){if(S[e]){const t=S[e];return Je(t.name)&&(t.operator=!0),Xe(t.name)&&(t.owner=!0),Ke(t.name)&&(t.moderator=!0),Ve(t.name)&&(t.mediaVoice=!0),He(t.name)&&(t.voice=!0),t}if(S[`${e}-web`]){const t=S[`${e}-web`];return Je(t.name)&&(t.operator=!0),Xe(t.name)&&(t.owner=!0),Ke(t.name)&&(t.moderator=!0),Ve(t.name)&&(t.mediaVoice=!0),He(t.name)&&(t.voice=!0),t}return!1},setUsername:function(e){return c=e,!0},getUsername:Fe,setImgSource:function(e){return d=e,!0},getImgSource:function(){return d},setSharingState:function(e){return q=e,!0},isSharing:function(){return q},isInChannel:function(e){if(0===C.length)return!1;for(let t=0;t<C.length;t+=1){if(C[t]===e)return!0;if(t===C.length-1)return!1}return!1},setSharedScreen:function(e){return 0===x.length?(x.push("sharedScreen"),k.sharedScreen=e):k.sharedScreen=e,!0},unsetSharedScreen:function(){x=[],delete k.sharedScreen},getSharedScreen:function(){return k.sharedScreen},setYoutube:function(e){return tt(-2),0===I.length?(I.push("youtube"),R.youtube=e):R.youtube=e,!0},unsetYoutube:function(){I=[],delete R.youtube,nt(-2)},getYoutube:function(){return R.youtube},setMediaVoice:function(e,t){return P[e]||L.push(e),P[e]=t,!0},unsetMediaVoice:je,getMediaVoice:function(e){return P[e]},getMediaVoices:function(){return L},setMediaVoiceUser:function(e){return $[e.owner]?!e.mediaId||1!==$[e.owner].length||$[e.owner][0].mediaId===e.mediaId||($[e.owner].push({owner:e.owner,mediaId:e.mediaId}),!0):(e.mediaId&&($[e.owner]=[{owner:e.owner,mediaId:e.mediaId}]),A.includes(e.owner)||A.push(e.owner),!0)},unsetMediaVoiceUser:function(e){return!!A.includes(e)&&(A=B(A,e),delete $[e],!0)},getMediaVoiceUsers:function(){return A},getMediaVoiceUser:function(e){return $[e]},hasMediaVoice:Ve,setVoice:function(e,t){return U[e]||O.push(e),U[e]=t,Ge({owner:t.metadata.owner,mediaId:t.metadata.mediaId}),!0},unsetVoice:qe,getVoice:function(e){return U[e]},getVoices:function(){return O},setVoiceUser:Ge,unsetVoiceUser:function(e){return D=B(D,e),delete N[e],!0},getVoiceUsers:function(){return D.sort()},getVoiceUser:function(e){return N[e]},getMedia:function(e){return window._mediaWndsMap.get(e)},hasVoice:He,updateMedia:function(e,t,n){return"sharedScreen"===e?(k.sharedScreen[t]=n,!0):"youtube"===e?(R.youtube[t]=n,!0):P[e]?(P[e][t]=n,!0):!!U[e]&&(U[e][t]=n,!0)},unsetMedia:function(e){P[e]&&je(e),U[e]&&qe(e),D.forEach((t=>{N[t]&&(N[t]=F(N[t],"mediaId",e))})),A.forEach((t=>{$[t]&&($[t]=F($[t],"mediaId",e))}))},getMedias:function(){const e=Le.getters.getMediasCB(),t=[],n=[],i=[],s=[];let o=[];return Object.values(Ue()).forEach((e=>{const o=!!e.owner&&window._channel.isOperator(e.owner);if("youtube"===e.owner)n.push("youtube");else if(o){const n=window._channel.getUserMedia(e.owner);n[0]&&n[0].metadata&&n[0].metadata.active&&t.push(e.owner)}else if(e.mediaVoice){const t=window._channel.getUserMedia(e.owner);t[0]&&t[0].metadata&&t[0].metadata.active&&i.push(e.owner)}else{const t=window._channel.getUserMedia(e.owner);t[0]&&t[0].metadata&&t[0].metadata.active&&s.push(e.owner)}})),o=[...n,...t,...i,...s],e&&e(o),o},getUserMedia:ze,getMyMedia:function(){return ze(p.ENGINE_NICK)||!1},mediasCount:function(){return x.length+I.length+O.length+L.length},setMediaState:function(e,t,n){return M[e]||(M[e]={}),M[e][t]=n,!0},getMediaState:function(e){return M[e]?M[e]:{}},setMirror:function(e){return j=e,!0},getMirror:function(){return j},unsetMirror:function(){return N[p.ENGINE_NICK]=F(N[p.ENGINE_NICK],"mediaId",j),j=0,!0},setScreen:function(e){return V=e,!0},getScreen:function(){return V},unsetScreen:function(){return N[p.ENGINE_NICK]=F(N[p.ENGINE_NICK],"mediaId",V),V=0,!0},setMode:function(t){return"d"===t&&(Ce.noAutoDevoice=!0),"G"===t&&(Ce.chatLog=!0),"m"===t&&(Se.allowSendChatMessage=!0,Ee.allowSendChatMessage=!0,xe.allowSendChatMessage=!0,Me.allowSendChatMessage=!0,""===Pe&&(ke.allowSendChatMessage=!1,Te.allowSendChatMessage=!1),Ie.allowSendChatMessage=!1),"M"===t&&(Te.allowSendChatMessage=!0),"n"===t&&!1===e.m&&(Se.allowSendChatMessage=!0,Ee.allowSendChatMessage=!0,xe.allowSendChatMessage=!0,Me.allowSendChatMessage=!0,ke.allowSendChatMessage=!0,Ie.allowSendChatMessage=!1),"T"===t&&(Se.allowMediaAttachments=!0,Ee.allowMediaAttachments=!0,xe.allowMediaAttachments=!0,Me.allowMediaAttachments=!1,ke.allowMediaAttachments=!1,Te.allowMediaAttachments=!1,Ie.allowMediaAttachments=!1),"U"===t&&(Ce.showUserList=!0),"V"===t&&(Ce.multiVoice=!0),e[t]=!0,!0},getMode:function(t){return e[t]},unsetMode:function(t){return e[t]=!1,"m"===t&&(Se.allowSendChatMessage=!0,Ee.allowSendChatMessage=!0,Me.allowSendChatMessage=!0,ke.allowSendChatMessage=!0,Te.allowSendChatMessage=!0,Ie.allowSendChatMessage=!1),!0},getModes:We,setOwner:function(e){return Ce.owner=e,r=e,!0},getOwner:function(){return r},setOperator:function(e){return Ce.chanOp[e]=!0,u[e]=!0,!0},unsetOperator:function(e){return delete Ce.chanOp[e],delete u[e],!0},getOperators:function(){const e=[];for(const t in u)e.push(t);return e.sort()},setRoomOperator:function(e){return h[e]=!0,!0},unsetRoomOperator:function(e){return delete h[e],!0},getRoomOperators:function(){const e=[];for(const t in h)e.push(t);return e.sort()},setModerator:function(e){return Ce.chanMod[e]=!0,m[e]=!0,!0},unsetModerator:function(e){return delete Ce.chanOp[e],delete m[e],!0},getModerators:function(){const e=[];for(const t in m)e.push(t);return e.sort()},setBannedUser:function(e){return w[e]=!0,Ce.banned[e]=!0,!0},unsetBannedUser:function(e){delete Ce.banned[e],delete w[e]},getBannedUsers:function(){const e=[];for(const t in w)e.push(t);return e},setFeatured:function(e){return g=e,!0},isFeatured:function(){return g},setFeaturedImg:function(e){return f=e,!0},getFeaturedImg:function(){return f},isOperator:Je,isRoomOperator:Ye,isModerator:Ke,isOwner:Xe,setLastCategory:function(e){v=e},getLastCategory:function(){return v||""},setCategory:function(e,t,n){_[e][t]=n},getCategory:function(e){return _[e]},getChannelPermissions:function(){const e=Le.getters.channelPermissionsCB();return!!e&&e({owner:Se,operator:Ee,moderator:xe,user:ke,voiceUser:Me,guest:Ie})},getChannelSettings:function(){return Ce},setChannelType:function(e){return y=e,!1},getChannelType:Ze,getChannelCategories:function(){const e=Le.getters.channelCategoriesCB();if(e&&window._app.isOnline()){const t=function(t){b=[],_={},window.config.showChannelMoreCategoryIcon&&t.push({icon:"more",name:"Mais",priority:0});let n="";p.CONFIG.categoriesWhiteColor&&(n="w_"),t.forEach((function(e){"starred"===e.icon&&(e.imgON=`/img/${n}ic_starred_ON.png`,e.imgOFF=`/img/${n}ic_starred_OFF.png`),"recommended"===e.icon&&(e.imgON=`/img/${n}ic_recommended_ON.png`,e.imgOFF=`/img/${n}ic_recommended_OFF.png`),"more"===e.icon&&(e.imgON=`/img/${n}ic_more_ON.png`,e.imgOFF=`/img/${n}ic_more_OFF.png`),"education"===e.icon&&(e.imgON=`/img/${n}ic_education_ON.png`,e.imgOFF=`/img/${n}ic_education_OFF.png`),"broadcast"===e.icon&&(e.imgON=`/img/${n}ic_radioTV_ON.png`,e.imgOFF=`/img/${n}ic_radioTV_OFF.png`),"chat"===e.icon&&(e.imgON=`/img/${n}ic_chat_ON.png`,e.imgOFF=`/img/${n}ic_chat_OFF.png`),"game"===e.icon&&(e.imgON=`/img/${n}ic_game_ON.png`,e.imgOFF=`/img/${n}ic_game_OFF.png`),"person"===e.icon&&(e.imgON=`/img/${n}ic_person_ON.png`,e.imgOFF=`/img/${n}ic_person_OFF.png`),"shopping"===e.icon&&(e.imgON=`/img/${n}ic_shopping_ON.png`,e.imgOFF=`/img/${n}ic_shopping_OFF.png`),"tv"===e.icon&&(e.imgON=`/img/${n}ic_tv_ON.png`,e.imgOFF=`/img/${n}ic_tv_OFF.png`),"theater"===e.icon&&(e.imgON=`/img/${n}ic_theater_ON.png`,e.imgOFF=`/img/${n}ic_broadcast_OFF.png`),"info"===e.icon&&(e.imgON=`/img/${n}ic_info_ON.png`,e.imgOFF=`/img/${n}ic_info_OFF.png`),"service"===e.icon&&(e.imgON=`/img/${n}ic_service_ON.png`,e.imgOFF=`/img/${n}ic_service_OFF.png`),"other"===e.icon&&(e.imgON=`/img/${n}ic_other_ON.png`,e.imgOFF=`/img/${n}ic_other_OFF.png`),"running"===e.icon&&(e.imgON=`/img/${n}ic_running_ON.png`,e.imgOFF=`/img/${n}ic_running_OFF.png`),"health"===e.icon&&(e.imgON=`/img/${n}ic_health_ON.png`,e.imgOFF=`/img/${n}ic_health_OFF.png`),_[e.id]=e,b.push(e)})),e(b)},n=async()=>{const e=await oi();if(e){const n=e.reverseSortBy("priority");t(n),localStorage.setItem("channelCategories",JSON.stringify(n));const i=window.time.now();return localStorage.setItem("channelCategoriesTS",parseInt(i)),!1}return!1},i=window.time.now();let s=!1;const o=216e5,r=localStorage.getItem("channelCategoriesTS");if(r?i-parseInt(r)>o&&(s=!0):s=!0,null==localStorage.getItem("channelCategories")||"[]"===localStorage.getItem("channelCategories")||s)return n(),!1;try{const e=JSON.parse(localStorage.getItem("channelCategories"));return e.length>0?(t(e),!0):(localStorage.removeItem("channelCategories"),oi(),!1)}catch(e){return localStorage.removeItem("channelCategories"),n(),!1}}return!1},getChannelCategories2:async function(){return await oi()},getChannelMessages:async function(e,t,n){return await hi(e,t,n)},getChannelMessages2:async function(e,t,n){return await pi(e,t,n)},getChannelList:function(e,t,n,i){let s=1500;clearTimeout(T),i&&(s=1),T=setTimeout((()=>{const i=Le.getters.channelListCB();if(i){const s=(e,t,n)=>(t&&E(`Request server for channel list to category: ${t}`),"channel"===e&&ii(t,n).then((s=>{E(`Channels: ${JSON.stringify(s)}`),i(s,e,t,n),t&&s&&0!==s.length&&(s[0].ts=(new Date).getTime(),localStorage.setItem(`categoryList_${t}`,JSON.stringify(s)))})),"featured"===e&&ci(t,n).then((s=>{E(`Featured Channels: ${JSON.stringify(s)}`),i(s,e,t,n)})),"activity"===e&&li(n).then((s=>{E(`Activity Channels: ${JSON.stringify(s)}`),i(s,e,t,n)})),!1);if(t&&null!=localStorage.getItem(`categoryList_${t}`)&&"[]"!==localStorage.getItem(`categoryList_${t}`)){if(!localStorage.getItem(`categoryList_${t}`))return localStorage.removeItem(`categoryList_${t}`),s(e,t,n),!1;try{const o=JSON.parse(localStorage.getItem(`categoryList_${t}`)),r=(new Date).getTime();let a=0;return 0!==o.length&&(a=(r-o[0].ts)/36e5),0===o.length||a>2?(localStorage.removeItem(`categoryList_${t}`),s(e,t,n),!1):(E(`LocalStorage access for channel list to category: ${t}`),i(JSON.parse(localStorage.getItem(`categoryList_${t}`)),e,t,n),!1)}catch(i){return localStorage.removeItem(`categoryList_${t}`),s(e,t,n),!1}}if(window._app.isOnline())return s(e,t,n),!1}return!1}),s)},getRoomsList:async function(e){const t=e,n=Le.getters.roomsListCB();async function i(e){const t=await di();if(t){t.ts=parseInt(window.time.now()),window.rooms.config=t.config,window.rooms.server=t.server;const i={};for(let e=0;e<t.rooms.length;e+=1)i[`${t.rooms[e].topic},${t.rooms[e].id}`]=t.rooms[e];const s=[];for(const[e,t]of Object.entries(H(i)))s.push(t);window.rooms.rooms=s,t.rooms=s,p.ROOMS_LIST=t,localStorage.setItem("roomsList",JSON.stringify(t));const o=await Qe(t,e);t.rooms=o,n(t)}else n(!1)}if(null!=localStorage.getItem("roomsList"))try{const e=JSON.parse(localStorage.getItem("roomsList"));if(e)if(Array.isArray(e.rooms)&&e.rooms.length>0){window.rooms.config=e.config,window.rooms.server=e.server,window.rooms.rooms=e.rooms;if((window.time.now()-i.ts)/36e5<2){p.ROOMS_LIST=e;const i=await Qe(e,t);e.rooms=i,n(e)}else i(t)}else i(t);else i(t)}catch(e){console.log(`erro e: ${e}`),i(t)}else i(t);return!1},getRoomsCategoriesList:et,modifyChannel:function(e,t,n){$e[e]&&($e[e][t]=n)},sendMsg:function(e,t,i){const s=window._engine.currentChannel(),o={action:"Channel sendMsg",text:e,id:t,target:i};window.activity.update(`[Channel] Channel: ${window._channel.getName()} - Sent message: ${JSON.stringify(o)}`);const r=e.replace(/\n/g," "),a=Le.getters.sendMsgCB();if(a&&window._app.isOnline()&&r){const e=(new Date).getTime();if(o.mode=i?"private":"public",0===y&&!Je(Fe())&&""===n){if(window.msg_drop_rate&&window.msg_drop_rate>0){const t=parseInt(Oe()/window.msg_drop_rate);if(parseInt((e-window.lastMsgTs)/1e3)<t)return E(`Dropped Message (drop rate): ${r}`),a(o),!1}if(0===window.msg_per_day)return E(`Dropped Message (drop rate): ${r}`),a(o),!1}if(function(e){const t=["anal","anus","arma","arombado","arrombada","arrombado","baba-ovo","babaca","babaovo","bacura","bagos","baitola","baleia","bastardinhos","bastardo","bct","bctt","bebum","beck","biba","bicha","bichinha","bichona","bilau","bisca","bixa","bixinha","bixona","boceta","bocetinha","bocetuda","boco","bocÃ³","boga","boiola","boiolao","bolagato","bolcat","bolsoasno","bolsodoria","bolsoland","bolsolixo","bolsomito","bolsonabo","bolsonarismo","bolsonaroo","bolsonarooo","bolsonaroooo","bolsonaroooooo","bolsonaru","boquete","bordel","bosseta","bosta","bostaa","bostaaa","bostaaaa","bostaaaaa","bostaaaaaa","bostaaaaaaaa","bostana","bouceta","bozo","bozonaro","boÃ§eta","brioco","bronha","buceta","bucetinha","bucetuda","bunda","bundeira","bunduda","burra","burro","bussa","busseta","buÃ§a","c@ralho","cabaca","cabaco","cabaÃ§a","cabaÃ§o","caceta","cacete","caga","cagado","cagando","cagao","cagar","cagona","cagÃ£o","camisinha","canalha","car@lho","carai","caraio","caraleo","caralhento","caralho","caralhoo","caralhooo","caralhoooo","caralhooooo","caralhoooooo","caralhooooooo","caralhoooow","carluxo","cartucho","casseta","caÃ§ete","chacina","chapado","checheca","chereca","chibumba","chibumbo","chifruda","chifrudo","chochota","chota","chupa","chupada","chupado","ciririca","clitoris","clitÃ³ris","clr","cocaina","cocaÃ­na","cocoo","cocooo","cocÃ´","comuna","comunista","comunistinha","corna","corno","cornuda","cornudo","corote","covas","cretina","cretino","cu","cuh","culhao","culhÃ£o","culhÃµes","curalho","cusona","cuu","cuuuuuuuu","cuzao","cuzona","cuzuda","cuzudo","cuzÃ£o","cÃº","dealer","debil","debiloide","demonio","demÃ´nio","dentuÃ§a","dentuÃ§o","dick","ditadoria","dorialula","dorime","enforcar","equerdopata","escrota","escroto","esporrada","esporrado","esquerdinha","esquerdomacho","estupida","estupidez","estupido","estuprada","estuprar","estuprei","estupro","estÃºpida","estÃºpido","facada","fascista","fascistinha","fdp","fdpp","fds","fedorenta","feiosa","feioso","feioza","feiozo","ff","foda","fodasse","fode","foder","fodida","fodido","forabolsonaro","forabozo","forabozonaro","foradoria","fornica","fortifier","fortnite","fuckers","fudeca","fudecao","fudendo","fudeÃ§Ã£o","fudida","fudido","furnica","furnicar","furona","fuzil","gaiata","gaiato","garai","gay","gays","glock","gorda","gordo","gozar","gozei","gozo","grelinho","grelo","hash","haxixe","hentai","homo-sexual","homosexual","homossexual","idiota","idiotice","imbecil","iscrota","iscroto","jegue","k-pop","karai","karalho","kidbengala","kidbengalaaaaa","kpop","krai","lanca","leprosa","leproso","lesbica","lixo","lolo","lsd","lubrificante","lulalivre","lulodoria","lÃ©sbica","macaca","macaco","machona","machorra","maconha","maconheira","maconheiro","magrela","magrelo","maldicao","maldita","maldito","maldiÃ§Ã£o","manguaca","manguaÃ§a","masturba","matar","mendigo","merda","meuzovo","mija","mijada","mijado","mijo","miliciano","minion","mito","mocrea","mocreia","mocrÃ©a","mocrÃ©ia","moleque","mondronga","mondrongo","morrer","morte","motel","multilar","multilaÃ§Ã£o","mutilar","naba","nadega","nariguda","narigudo","nazi","nazista","ney","nojeira","nojenta","nojento","nojo","nud","nude","nudes","nuds","nudsss","olhota","oporra","orelhuda","orelhudo","otaria","otario","otÃ¡ria","otÃ¡rio","pal","pariu","paspalha","paspalhao","paspalho","pau","pawerguido","pcc","peia","peido","pemba","penis","pentelha","pentelho","perereca","pica","picao","picpay","picÃ£o","pilantra","piloca","piloquinha","pint*","pinto","piranha","piroca","piroco","pirocudo","piroquinha","piru","piruzinho","pistola","piu","poha","pohan","poooooorrrrrraaaaaa","poota","poposao","poposÃ£o","popozao","popozÃ£o","pora","porno","pornÃ´","porr4","porra","porraaa","porraaaaaaa","porran","porrra","pourra","powerguido","ppk","pqp","prega","prensado","prostituta","prostituto","punheta","punhetao","punhetÃ£o","puta","putao","putaria","puteiro","putero","putinha","puto","putÃ£o","puxa-saco","puxasaco","pÃªnis","raba","rabao","rabo","rabuda","rabudao","rabudo","rabudona","rabudÃ£o","rabÃ£o","racha","rachada","ramela","redtube","remela","retardada","retardado","revÃ³lver","ridicula","ridÃ­cula","rola","rolinha","roludo","rosca","saaaaasuukeee","sacana","safada","safado","sapatao","sapatÃ£o","saporra","sasuke","sasukee","sasukeeeeeeeeee","satan","sequisu","sexo","sidoka","sifilis","siririca","suamaepeladaeucomo","suicida","suicidar","suicidio","suicÃ­dio","suruba","surudoria","sÃ­filis","tarada","tarado","testuda","testudo","testÃ£o","tezao","tezuda","tezudo","tezÃ£o","tiro","tnc","tonto","totosa","trafica","traficante","trafico","transo","traveco","travecona","travecuda","travesti","trocha","trolha","troucha","trouxa","troxa","vaca","vadia","vagabunda","vagabundo","vagina","veada","veadao","veado","veadÃ£o","verdinha","viada","viadao","viadasso","viadaÃ§o","viadinho","viadinhos","viado","viadola","viadÃ£o","vsf","vtnc","weed","weedzao","xana","xaninha","xavasca","xereca","xerereca","xexeca","xibiu","xibumba","xochota","xota","xoxota","xvideos","zoiuda","zoiudo","zovo","zuruba","Ã nus","Ã¡nus","zap","zapzap","whatsapp","telegram","instagram","facebook","fuder"];for(let n=0;n<t.length;n+=1){if(new RegExp(`(^${t[n]}\\s+)|(\\s+${t[n]}\\s+)|(\\s+${t[n]}$)|(^${t[n]}$)`).test(e.toLowerCase()))return!0;if(n===t.lenght-1)return!1}return!1}(r)&&!Je(Fe()))return E(`Message blacklisted: ${r}`),a(o),!1;if(c=r,(new RegExp(/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/).test(c.toLowerCase())||new RegExp(/^(link|audio|image|document|video)=/).test(c.toLowerCase()))&&!Je(Fe())&&We().T&&!Ye(Fe())&&(!0!==window.config.allowNormalUserSendLink||!window._channel.getModes().A))return E(`Message has link: ${r}`),a(o),!1;window.lastMsgTs=e,i?""===Pe()?window._engine.requestSendPrivateMessage(r,i,1):window._groupEngine.requestSendPrivateMessage(r,i,1):window._channel.getModes().G?(""===window.room_server&&(window.room_server=`${window.realm}-room`),""===window.ppcs_server&&(window.ppcs_server=`${window.realm}-ppcs`),1!==Ze()&&""===Pe()?(window.ppcs_server||(window.ppcs_server=`${window.realm}-ppcs`),window._engine.requestSendPrivateMessage(`SENDMSG #${s} ${Date.now()} :${r}`,window.ppcs_server,1)):1===window._channel.getType()&&""===Pe()?window._engine.requestSendPrivateMessage(`SENDMSG #${s} ${Date.now()} :${r}`,window.room_server,1):window._groupEngine.requestSendPrivateMessage(`SENDMSG #${Pe()} ${Date.now()} :${r}`,window.room_server,1)):""===Pe()?window._engine.requestSendPublicMessage(r,1):window._groupEngine.requestSendPublicMessage(r,1),E(`Tx: ${JSON.stringify(o)} ts: ${parseInt((new Date).getTime()/1e3)}`),a(o)}var c;return!1},delMsg:function(e,t,n){const i={action:"Channel delMsg",channel:e,channelType:t,seqs:n},s=e,o=""===window._channel.getActiveRoom()?window._engine:window._groupEngine,r=1===window._channel.getType()||""!==window._channel.getActiveRoom()?window.room_server:window.ppcs_server;let a="";const c=Le.getters.delMsgCB();if(E(`"DELMESSAGES #${window._channel.getActiveRoom()} ${n[0]}", "${r}"`),c&&window._app.isOnline())for(let e=0;e<n.length;e+=1)a+=` ${n[e]}`,e===n.length-1&&(o.requestSendPrivateMessage(`DELMESSAGES #${s}${a}`,r,1),E(`Tx: ${JSON.stringify(i)} ts: ${parseInt((new Date).getTime()/1e3)}`),c(i))},sendOpenGraph:function(e,t,n,i,s,o,r,a){const c={};c.href=t||"/#",c.name=o||"",c.title=n||"",c.image=i||"",c.description=s||"",c.text=e||"",c.description.length>150&&(c.description=`${c.description.slice(0,149)}...`,JSON.stringify(c).length>350&&(c.description=`${c.description.slice(0,100)}...`,JSON.stringify(c).length>350&&(c.description=`${c.description.slice(0,50)}...`,JSON.stringify(c).length>350&&(c.description="",JSON.stringify(c).length>350&&(c.text=`${c.text.slice(0,50)}...`)))));let l,d,u=`link={"href":"${c.href}","name":"${c.name}","title":"${c.title}","image":"${c.image}","description":"${c.description}","text":"${c.text}"}`;u.length>350&&(c.text="",u=`link={"href":"${c.href}","name":"${c.name}","title":"${c.title}","image":"${c.image}","description":"${c.description}","text":"${c.text}"}`,u.length>350&&(u=e)),""===Pe()?(l=window._engine.currentChannel(),d={action:"Channel sendOpenGraph",text:c.text,href:c.href,title:c.title,image:c.image,description:c.description,name:c.name,id:r,target:a}):(l=Pe(),d={action:"Romm in Channel sendOpenGraph",text:c.text,href:c.href,title:c.title,image:c.image,description:c.description,name:c.name,id:r,target:a});let h="";e===u?(d={action:"Only link sent from opengraph",text:e,id:r,target:a},h=e):h=`link=${JSON.stringify(c)}`;const p=Le.getters.sendOpenGraphCB();if(p&&window._app.isOnline()){if(!Je(Fe())&&!Ye(Fe())&&We().T&&(!0!==window.config.allowNormalUserSendLink||!window._channel.getModes().A))return E(`OpenGraph not permitted for normal user: ${e}`),p(d),!1;e&&(a?(""===Pe()?window._engine.requestSendPrivateMessage(h,a,1):window._groupEngine.requestSendPrivateMessage(h,a,1),d.mode="private",d.target=a):window._channel.getModes().G?(""===Pe()?0===window._channel.getType()?window._engine.requestSendPrivateMessage(`SENDMSG #${l} ${Date.now()} :${h}`,window.ppcs_server,1):window._engine.requestSendPrivateMessage(`SENDMSG #${l} ${Date.now()} :${h}`,window.room_server,1):window._groupEngine.requestSendPrivateMessage(`SENDMSG #${Pe()} ${Date.now()} :${h}`,window.room_server,1),d.mode="private"):(""===Pe()?window._engine.requestSendPublicMessage(h,1):window._groupEngine.requestSendPublicMessage(h,1),d.mode="public"),E(`Tx: ${JSON.stringify(d)} ts: ${parseInt((new Date).getTime()/1e3,10)}`),p(d))}return!1},printMsg:function(e,t,n,i){const s=Le.getters.printMsgCB(),o={action:"channel printMsg",from:e,to:t,text:n,id:i};s&&n&&window._app.isOnline()&&(E(`Tx: ${JSON.stringify(o)} ts: ${parseInt((new Date).getTime()/1e3,10)}`),s(o))},requestDebug:function(e){const t=p.ENGINE_NICK;return window._engine.requestSendPrivateMessage(`${String.fromCharCode(1)}DEBUG ${t},1${String.fromCharCode(1)}`,e,1),!1},stopDebug:function(e){const t=p.ENGINE_NICK;return window._engine.requestSendPrivateMessage(`${String.fromCharCode(1)}DEBUG ${t},0${String.fromCharCode(1)}`,e,1),!1},setPollSessionId:function(e){z=e},getPollSessionId:function(){return z},setInitialTransmission:function(){W=(new Date).getTime()},getInitialTransmission:function(){return W},stopTransmission:function(){const e=(new Date).getTime(),t=parseInt((e-W)/1e3);if(1===De()){let e;e=""===Pe()?Ne():Pe();try{if(localStorage.getItem(`room_${e}`)){const n=JSON.parse(localStorage.getItem(`room_${e}`));n.txCredit-=t,localStorage.setItem(`room_${e}`,JSON.stringify(n))}}catch(e){console.log(e)}}return!0},setMediaBoxArea:function(e,t){return J=e,Y=t,!0},getMediaBoxArea:function(){const e={};return e.width=J,e.height=Y,e},setWindows:function(e){const t=e.wf.list;X=[],Z="",Q="",X=[],t.forEach((e=>{e.pip?Z=e.n:e.main?Q=e.n:X.push(e.n)})),K=!0},getWindows:function(){return!!K&&{pip:Z,main:Q,users:X}},unsetWindows:function(){return K=!1,!0},muteAudio:function(){return ee=!0,!0},unmuteAudio:function(){return ee=!1,!0},isAudioMuted:function(){return ee},muteVideo:function(){return te=!0,!0},unmuteVideo:function(){return te=!1,!0},isVideoMuted:function(){return te},setVoiceRequests:function(e){const t=Le.getters.voiceRequestCB();return!se.includes(e)&&(se.push(e),t&&t(se),!0)},unsetVoiceRequests:function(e){const t=Le.getters.voiceRequestCB();return!!se.includes(e)&&(se=se.filter((function(t){return t!==e})),t&&t(se),!0)},getVoiceRequests:function(){return se},reset:function(){Re(),t=!0,e={},y=0,n="",i="",s="",o="",a=0,C=[],S={},d="",r="",u={},m={},w={},g=!1,f="",q=!1,x=[],k={},I=[],R={},A=[],$={},L=[],P={},D=[],N={},O=[],U={},z="",J=0,Y=0,K=!1,X=[],Z="",Q="",ee=!1,te=!1,oe=0,se=[],ae=!1,ce={},le="",de=null,ue=!1,pe="0",ye=""},setChannelMedia:tt,unsetChannelMedia:nt,getChannelMediasArray:function(){return ne},getChannelMediasObject:Ue,resetChannelMedias:function(){ne=[],ie={}},setMsgSeq:function(e){oe=e},getMsgSeq:function(){return oe},setScreenSharingWaitingUserStart:function(e){return re=!!e,!1},getScreenSharingWaitingUserStart:function(){return re},setTransmitting:function(){ae=!0},unsetTransmitting:function(){ae=!1},isTransmitting:function(){return ae},callbacks:function(){return Le.setters},getSessionCategory:mi,setCsmObject:function(e){ce=e},getCsmObject:function(){return ce},setRecordingDisplay:function(e){le=e},getRecordingDisplay:function(e){return le},setOnMediasUpdatedCB:function(e){de=e},mediasUpdatedEvent:function(){de&&de()},setClosedCaption:function(e){ue=e},getClosedCaption:function(){return ue},showTemporaryMessage:function(e,t=0,n=6e3){const i=n<1?6e3:n,s=e;let o,r="",a="";if("normal"===t||0===t)o="#000000";else if("red"===t||1===t)o="#FF0000";else if("success"===t||"done"===t||2===t)r="done",a="#28a745",o="#000000";else if("warning"===t||3===t)r="report",a="#ffc107",o="#000000";else if("alert"===t||"problem"===t||4===t)r="report_problem",a="#FF0000",o="#000000";else{if("loading"!==t&&5!==t)return E("[showTemporaryMessage] Invalid parameters!"),!1;r='<div class="loader"></div>',a="#FF0000",o="#000000"}return he&&clearTimeout(he),l()("#alert-display-icon").html(r).css("color",a),l()("#alert-display-message").html(s).css("color",o),l()("#alert-display").show(),he=setTimeout((function(){l()("#alert-display").hide()}),i),!1},hideTemporaryMessage:function(){he&&clearTimeout(he),l()("#alert-display").hide()},showModalMessage:function(e,t=0,n=null){const i=e;let s="",o="";if("success"===t||"done"===t||1===t)s="done",o="#28a745";else if("warning"===t||2===t)s="report",o="#ffc107";else{if("alert"!==t&&"problem"!==t&&0!==t)return E("[showModalMessage] Invalid parameters!"),!1;s="report_problem",o="#FF0000"}window.modalCB=function(){l()("#modalDialog").hide(),n&&n()};const r=`<div id="modalDialog" style="width:100%;height:100%;position:absolute;">\n        <div style="position:absolute;width:100%;height:100%;background-color:rgba(100,100,100,0.5);z-index:998;"></div>\n        <div style="position:absolute;width:100%;height:100%;z-index:999;display:flex;flex-direction:row;justify-content:center;">\n          <div style="display:flex;flex-direction:column;justify-content:center;"><div style="padding:20px;background-color:#FFFFFF;border-radius:5px;min-width:200px;">\n            <div style="display:flex;flex-direction:row;justify-content:center;">\n              <span class="material-icons" style="color:${o};padding-right:10px;">${s}</span>\n              <span style="font-size:20px;">${i}</span>\n            </div>\n            <div style="padding-top:20px;width:100%;display:flex;flex-direction:row;justify-content:center;" onClick="modalCB()">\n              <div style="padding:5px 30px 5px 30px;background-color:#43C9FF;color:#FFFFFF;border-radius:5px;cursor:pointer;">OK</div>\n            </div>\n          </div>\n        </div>\n        </div>`;document.getElementById("modalDialog")?console.log(`${l()("#modalDialog").html(r)}`):l()("body").prepend(r),l()("#modalDialog").show()},stopAllTransmissions:function(){console.log("[Media] stopAllTransmissions"),window._mediaWndsArray.forEach((e=>{const t=window._mediaWndsMap.get(e),n=t.metadata.owner,i=t.metadata.mediaVoice;window._engine.requestTransmission(n,!1,i)})),window._channel.stopTransmission(),window.devicesStream&&window.devicesStream.getTracks().forEach((e=>{e.stop()})),window.localStream&&window.localStream.getTracks().forEach((e=>{e.stop()})),window._recorderCtrl.isStarted()&&window._recorderCtrl.stopRecord()},startDefaultRecording:async function(e){if((await window.session.getActiveSessionInfo(window._engine.currentChannel())).active){const e=window.i18n.get("error-session-start");return window._channel.showTemporaryMessage(e,"alert"),!1}if("safari"===tl.webRTCAdapter.browserDetails.browser&&"staging"!==window.realm)return l()("#alert-transmission-safari").is(":visible")||(l()("#alert-transmission-safari").show(),setTimeout((function(){l()("#alert-transmission-safari").hide()}),3e3)),!1;if(window.navigatorData.browser.includes("firefox")&&"staging"!==window.realm&&"school"!==window.realm)return l()("#alert-transmission-firefox").is(":visible")||(l()("#alert-transmission-firefox").show(),setTimeout((function(){l()("#alert-transmission-firefox").hide()}),3e3)),!1;window.session.reset();const t=new Date,n=`${t.getFullYear()}`,i=t.getMonth()<9?`0${t.getMonth()+1}`:`${t.getMonth()+1}`,s=t.getDate()<10?`0${t.getDate()}`:`${t.getDate()}`,o=t.getHours()<10?`0${t.getHours()}`:`${t.getHours()}`,r=t.getMinutes()<10?`0${t.getMinutes()}`:`${t.getMinutes()}`,a={},c=`${n}-${i}-${s} ${o}:${r}`,d=`${n}-${i}-${s}T${o}:${r}`;await window.session.setTitle(c),await window.session.setReferenceDate(d),await window.session.setExtras(a);const u=await window.session.create(a),h=u.id;window.session_id=u.id,window.createdAt=u.created_at,window.sessionFinishedAt=(new Date).getTime()+1e3*u.max_duration;const p=await window.session.start(a,h);E(`Session started: ${JSON.stringify(p)}`);const m=window.sessionFinishedAt-(new Date).getTime()-window.tsDiff;E("[StartDefaultRecording] Reset Timer"),window.timerWorker.reset("session-"),window.timerWorker.startTimer(`session-${window.session_id}`),window.Events.dispatch("session/timer-control",{event:"startTimer",session:window.session_id}),window.session.setRunning(!0),be=!0,l()("#record-option-icon").css("color","red"),l()("#record-option-stop").show(),l()("#record-option-start").hide(),l()("#rpchnhi").hide(),window.sessionTimerShowed=!1,window.countdown=new G(m,((e,t)=>{window.sessionTimerShowed||(window.session.showTimer(),window.sessionTimerShowed=!0),t<=12e4?(l()("#session-timer-icon").hasClass("tr")||l()("#session-timer-icon").addClass("tr"),l()("#session-timer-value").html(`<span class="tr">${e}</span>`)):(l()("#session-timer-icon").removeClass("tr"),l()("#session-timer-value").html(e))}),(()=>{"m"===window._channel.getSuffix()?l()("#chn-session-stop-btn").click():window._channel.stopDefaultRecording()}));const w=window.i18n.get("session-initiating-recording");return window._channel.showTemporaryMessage(w,"loading",4900),await window.session.startUserListUpdate(),setTimeout((function(){const t=window._channel.getSuffix();"m"===t&&l()("#display-define-layout").show(),window._recorderCtrl.isStarted()||("m"===t?window.Events.dispatch("record/start","sidebar"):e||"grid"!==window._medias.displayType?window.Events.dispatch("record/start","main"):window.Events.dispatch("record/start","grid")),setTimeout(window.countdown.start,800)}),5e3),!0},stopDefaultRecording:async function(){const e=window.session_id,t=await window.timerWorker.getTimer(`session-${window.session_id}`),n=parseInt(t.ts/1e3);E("[StopDefaultRecording] Reset Timer"),window.timerWorker.reset("session-"),window.session.setRunning(!1),be=!1;const i={};i.live_duration=n;const s=await window.session.getActiveSessionInfo();s.session_id&&s.session_id===e&&(i.live_duration=s.session.live_duration>i.live_duration?s.session.live_duration:n);const o=await window.session.finishSession(e,i);E(`Session finished: ${JSON.stringify(o)}`),window._recorderCtrl.isStarted()&&(window._recorderCtrl.stopRecord(),l()("#record-option-stop").hide(),l()("#record-option-start").show(),l()("#record-option-icon").css("color","")),window.countdown&&(window.countdown.stop(),window.sessionTimerShowed=!1),window.softCountdown&&window.softCountdown.stop(),window.session.hideTimer(),l()("#rpchnhi").show()},isMetaverseFixed:async function(e){if(!e||0===p.METAVERSE_FIXED.length)return"0";let t="0";for(let n=0;n<p.METAVERSE_FIXED.length;n+=1){const i=p.METAVERSE_FIXED[n];i.channel===e&&(t=i.id,pe=t)}return t},getMetaverseFixedId:function(){return pe},isChannelMember:async function(e){let t=!1;try{if(t=await ai(e),t?.is_member)return!0}catch(e){console.log(e)}return!1},isDefaultRecord:function(){return be},setExternalPlaceholder:async function(e,t){const n=t;return _e[e]=n,!0},getExternalPlaceholder:async function(e){const t=e;return!!_e[t]&&_e[t]},getExternalAuthentication:async function(e,t){const n=e,i=t;E(`[channel] getExternalAuthentication: placeholder = "${n}"`);const s=await bi(n,i);return s&&(s.token?_e[n]=s.token:s.room_name&&(_e[n]=s.room_name)),s},checkExternalAuthentication:async function(e,t,n){const i=e,s=t,o=n;return E(`[channel] checkExternalAuthentication: placeholder = "${i}" value = "${s}"`),await _i(i,s,o)},setRecorderFeaturedUser:function(e){return ye=e,!0},getRecorderFeaturedUser:function(){return Be().includes(ye)&&""!==ye?ye:window._engine.nick()},getSuffix:function(e){const t=e||window._engine.currentChannel();return!!t&&t[t.length-1]},close:function(){Jr("disconnect")},showNewCategoriesWithChannels:async function(){let e=null;const t=(new Date).getTime();let n=localStorage.getItem("categories_ts");if(n){if(n=parseInt(n),t-n>216e5){const e=localStorage.getItem("categories");if(null!=e){let n=null;try{n=JSON.parse(e)}catch(e){console.log(e)}if(n)for(let e=0;e<n.length;e++){const t=n[e];localStorage.removeItem(`category${t.id}`)}localStorage.removeItem("categories"),localStorage.setItem("categories_ts",t)}}}else localStorage.setItem("categories_ts",t);if(null!=localStorage.getItem("categories"))try{e=JSON.parse(localStorage.getItem("categories"))}catch(e){console.log(e)}if(null===e){const t=(await oi()).filter((e=>!0===e.primary)).sort(((e,t)=>t.priority-e.priority)),n=[];for(let e=0;e<t.length;e++){const i=t[e],{id:s,name:o}=i;n.push({id:s,name:o})}localStorage.setItem("categories",JSON.stringify(n)),e=n}l()("#channelList").html("");const i={};for(const n of e){const{id:e,name:s}=n;let o=null;if(null!=localStorage.getItem(`category${e}`))try{o=JSON.parse(localStorage.getItem(`category${e}`))}catch(e){console.log(e)}null===o&&(o=await ii(e),localStorage.setItem(`category${e}`,JSON.stringify(o)));let r='<div class="sha bgw" style="margin-left:1.7%;margin-bottom:1.7%;border-radius:10px;"><div class="w100">';if(r+=`<img src="${p.FILES_BASE_URL}featured/channel/{{channel}}/full.jpeg?${t}" class="lpch_{{channel}} chn pt w100" channel="{{channel}}" name="{{channelName}}" users="0" imgsrc="${p.FILES_BASE_URL}avatars/channel/{{channel}}/thumb.jpeg?${t}" style="border-top-left-radius:10px;border-top-right-radius:10px;></div>`,r+=`<div id="lpch_{{channel}}" class="lpch_{{channel}} chn fr w100 p10 pt" channel="{{channel}}" name="{{channelName}}" users="0" imgsrc="${p.FILES_BASE_URL}avatars/channel/{{channel}}/thumb.jpeg?${t}}}">`,r+='<div class="frm p10">',r+='<div class="fc fig pl10"><div class="fr w100"><span class="lpcn sn toj">{{channelName}}</span><span class="fig"></span></div>',r+="</div></div></div></div>",0!==o.length){l()("#channelList").append(`<div class="toj sxl b pt10 pl20">${s}</div>`);let t=`<div id="swiper-area" style="height: 190px;position:relative;width:100%;overflow:hidden;"><div class="swiper-container-${e}"><div class="swiper-wrapper swiper-wrapper-${e}">`;for(let e=0;e<o.length;e++){const n=o[e];window._channel.setChannel(n.name,n);let i=r.replaceAll("{{channel}}",n.name);i=i.replaceAll("{{channelName}}",n.topic),t+=`<div class="swiper-slide" style="max-width: 460px;margin-right:10px;">${i}</div>`}t+="</div>",t+=`<div class="swiper-button-next swiper-button-next-${e}" category="${e}" style="display:none;"></div><div class="swiper-button-prev swiper-button-prev-${e}" category="${e}" style="display:none;"></div>`,t+="</div></div>",l()("#channelList").append(t),setTimeout((function(){i[e]=new Pd(`.swiper-container-${e}`,{slidesPerView:3,spaceBetween:10,loop:!1,freeMode:!0,watchSlidesVisibility:!0,watchSlidesProgress:!0,navigation:{nextEl:`.swiper-button-next-${e}`,prevEl:`.swiper-button-prev-${e}`},on:{init(){setTimeout((()=>{!function(e,t){const n=e,s=document.querySelector(`.swiper-button-prev-${t}`),o=document.querySelector(`.swiper-button-next-${t}`);n.slides.length<=n.params.slidesPerView?(s.style.display="none",o.style.display="none",l()(`.swiper-wrapper-${t}`).css("display","flex")):(s.style.display=n.isBeginning?"none":"block",o.style.display=n.isEnd?"none":"block",l()(`.swiper-wrapper-${t}`).css("display","flex")),l()(".swiper-button-prev").off("click"),l()(".swiper-button-prev").on("click",(function(){const e=l()(this).attr("category");i[e].slidePrev(),l()(`.swiper-button-next-${e}`).show(),i[e].isBeginning&&l()(`.swiper-button-prev-${e}`).hide()})),l()(".swiper-button-next").off("click"),l()(".swiper-button-next").on("click",(function(){const e=l()(this).attr("category");i[e].slideNext(),l()(`.swiper-button-prev-${e}`).show(),i[e].isEnd&&l()(`.swiper-button-next-${e}`).hide()}))}(this,e),this.update()}),1e3)}}})}),1e3)}}return!1},sendRemoteMute:function(e,t="ALL"){let n=[];_mediaWndsMap.forEach((e=>{!1===e.metadata.me&&n.push(e.metadata.owner)}));const i=""===e?n:e,s=t;if("ALL"!==s&&"MIC"!==s&&"CAM"!==s)return E(`[Remote Mute] Invalid parameter ${s}`),!1;function o(e){const t=[e];return xl().CTCP().format("DEVMUTE",t)}function r(e,t){if("object"!=typeof t){E(`[Remote Device Mute] sendPrivateMessage: message "${JSON.stringify(e)}" target "${JSON.stringify(t)}"`);const n=o(e),i=t,s=xl().modes().notice;return window._engine.requestSendPrivateMessage(n,i,s),!0}for(let n=0;n<t.length;n++){E(`[Remote Device Mute] sendPrivateMessage: message "${JSON.stringify(e)}" target "${JSON.stringify(t[n])}"`);const i=o(e),s=t[n],r=xl().modes().notice;return window._engine.requestSendPrivateMessage(i,s,r),!0}}if("object"==typeof i)for(let e=0;e<i.length;e++)r(s,i[e]);else r(s,i);return!0}}}function Nd(){const e={},t=function(){let e=null;return{setters:{panelUserCB:function(t){e=t}},getters:{panelUserCB:function(){return e}}}}();return{setPanelUser:function(n,i){const s=t.getters.panelUserCB();e[n]=i,s&&s(i)},setMessage:function(e,t,n,i,s,o){return E(`SetMessage: ${e} - ${t} - ${n} - ${i} - ${s} - ${o}`),!1},callbacks:function(){return t.setters}}}function Od(){var e=l()("ul.user_list"),t=null;function n(t){var n=e.find(`[href='${t}']`);n&&n.length>0&&n.remove()}return{setEventHandlers:function(e,n,i,s,o,r,a,c,l,d,u){t=e},add:function(i,s,o){n(i);var r=l()("<li/>").appendTo(e),a="user-context-menu";isMe(i)&&(a+=" bold"),l()("<a/>").addClass(a).text(`${i} : ${s} ${o}`).attr("href",i).appendTo(r).click((function(e){t&&t(e,i)}))},remove:n,clear:function(){e.empty()},parseName:function(e){const t=e.indexOf(":")-1;return e.slice(0,t)}}}Object.keys($d).forEach((e=>{Object.keys($d[e]).forEach((t=>{Pd.prototype[t]=$d[e][t]}))})),Pd.use([function(e){let{swiper:t,on:n,emit:i}=e;const s=zl();let o=null,r=null;const a=()=>{t&&!t.destroyed&&t.initialized&&(i("beforeResize"),i("resize"))},c=()=>{t&&!t.destroyed&&t.initialized&&i("orientationchange")};n("init",(()=>{t.params.resizeObserver&&void 0!==s.ResizeObserver?t&&!t.destroyed&&t.initialized&&(o=new ResizeObserver((e=>{r=s.requestAnimationFrame((()=>{const{width:n,height:i}=t;let s=n,o=i;e.forEach((e=>{let{contentBoxSize:n,contentRect:i,target:r}=e;r&&r!==t.el||(s=i?i.width:(n[0]||n).inlineSize,o=i?i.height:(n[0]||n).blockSize)})),s===n&&o===i||a()}))})),o.observe(t.el)):(s.addEventListener("resize",a),s.addEventListener("orientationchange",c))})),n("destroy",(()=>{r&&s.cancelAnimationFrame(r),o&&o.unobserve&&t.el&&(o.unobserve(t.el),o=null),s.removeEventListener("resize",a),s.removeEventListener("orientationchange",c)}))},function(e){let{swiper:t,extendParams:n,on:i,emit:s}=e;const o=[],r=zl(),a=function(e,n){void 0===n&&(n={});const i=new(r.MutationObserver||r.WebkitMutationObserver)((e=>{if(t.__preventObserver__)return;if(1===e.length)return void s("observerUpdate",e[0]);const n=function(){s("observerUpdate",e[0])};r.requestAnimationFrame?r.requestAnimationFrame(n):r.setTimeout(n,0)}));i.observe(e,{attributes:void 0===n.attributes||n.attributes,childList:void 0===n.childList||n.childList,characterData:void 0===n.characterData||n.characterData}),o.push(i)};n({observer:!1,observeParents:!1,observeSlideChildren:!1}),i("init",(()=>{if(t.params.observer){if(t.params.observeParents){const e=function(e,t){const n=[];let i=e.parentElement;for(;i;)n.push(i),i=i.parentElement;return n}(t.hostEl);for(let t=0;t<e.length;t+=1)a(e[t])}a(t.hostEl,{childList:t.params.observeSlideChildren}),a(t.wrapperEl,{attributes:!1})}})),i("destroy",(()=>{o.forEach((e=>{e.disconnect()})),o.splice(0,o.length)}))}]),Pd.use([a.Navigation]);const Bd={pt:"ptBr","pt-BR":"ptBr","en-US":"enUs"},Fd={edupr:{ptBr:{others:"Plataformas","session-finished":"Aula Finalizada!",tests:"Provas",conference:"Sala Virtual",tasks:'<span style="font-size:16px;">Provas<br />Atividades</span>'},enUs:{others:"Platforms","session-finished":"Session Finished!",tests:"Tests",conference:"Virtual Room",tasks:'<span style="font-size:16px;">Exams<br />Activities</span>'}},edusp:{ptBr:{"session-finished":"Aula Finalizada!","session-interrupted":"A aula foi interrompida inesperadamente e poderÃ¡ ser retomada pelo professor em atÃ©:",tests:"Prova Paulista",essay:"RedaÃ§Ã£o Paulista",tasks:'<span style="font-size:16px;">Provas<br />Atividades</span>',conference:"Sala de Aula Virtual"},enUs:{"session-finished":"Session Finished!","session-interrupted":"The class was interrupted and can be restarted in:",tests:"Tests",essay:"Essay",tasks:"<span>Exams<br />Activities</span>",conference:"Virtual Classroom"}},realms:{ptBr:{groups:"Salas"},enUs:{groups:"Rooms"}},smerec:{ptBr:{channels:"ConteÃºdos",others:"Recursos"},enUs:{channels:"Contents",others:"Resources"}},school:{ptBr:{conference:"Sala Virtual",tasks:"Atividades"},enUs:{conference:"Virtual Room",tasks:"Activities"}}};function Ud(e,t){const n=e,i=Bd[t]||t,s=Fd[window.config.realm];let o="";return s&&s[i]&&(o=s[i][n]||""),o}const jd={pt:"ptBr","pt-BR":"ptBr","en-US":"enUs"},Vd={hello:"Hello","you-were-invited":"You were invited to join this conference room",username:"Username",password:"Password",name:"Name","guest-login":"Entrer as a Guest","invalid-username-password":"Incorrect username or password!","invite-expired":"Expired invite!",authError401:"Incorrect username or password!",authError403:"Unauthorized user!",authErrorOther:"Sorry, we were unable to authenticate your user at this time. Please try again later.",authErrorNoInternet:"Sorry, we were unable to authenticate your user at this time. Please check your internet connection and try again.","internet-connection-instable":"Instable connection.<br />Video reception will be limited.",enter:"Enter",continue:"Continue",forward:"Forward","forward-contact":"Forward Contact",channel:"Channel",channels:"Channels",chats:"Chats","chats-cap":"CHATS",people:"People","people-cap":"PEOPLE","device-config":"Device Configuration","advanced-settings":"Advanced settings","channel-link-copy":"Copy Link","channel-link-copy-message":"Link copy success!","channel-link-copy-error":"Link copy error!","audio-input":"Audio Input","audio-output":"Audio Output","video-cam":"Video","youtube-playlist":"Youtube Playlist","new-video":"New video",playlist:"Playlist",settings:"Settings","youtube-video-url":"Youbute video URL",search:"Search","video-title":"Video title",title:"Title",preview:"Preview",cancel:"Cancel","quit-channel":"Quit Channel",update:"Update",save:"Save",start:"Start",all:"ALL",options:"Options",add:"Add","insert-name":"Insert your name:","you-were-invited-to-watch-channel":"You were invited to watch the channel","you-do-not-have-permission-to-watch-channel":"You do not have permission to watch the channel","invite-expired-to-watch-channel":"Expired invite to watch the channel","invite-already-expired":"This invitation expired on","invite-not-started":"This invitation will be available from","video-sucessfuly-added-to-playlist":"Video sucessfully added to playlist!","add-new-video":"Add new video","auto-play":"Auto play","show-control":"Show control",loop:"loop","tv-mode":"TV mode","receiving-call":"Receiving Call",confirm:"Confirm",city:"City","last-login":"Last login",following:"Following",friend:"Friend",friends:"Friends",block:"Block",message:"Menssage","send-message":"Send Message","group-data":"Group Data","silence-notifications":"Silence Notifications",participants:"Participants","sound-alert":"Sound alert for new messages",ok:"OK",reply:"Reply",copy:"Copy",edit:"Edit",delete:"Delete","private-message":"Private Message","give-collaboration":"Give Collaboration","give-collaboration-to":"Give Collaboration to","remove-collaboration":"Remove Collaboration","remove-collaboration-from":"Remove Collaboration from","give-moderation":"Give Moderation","give-moderation-to":"Give Moderation to","remove-moderation":"Remove Moderation","remove-moderation-from":"Remove Moderation from","delegate-media-voice-to":"Delegate media voice to","remove-media-voice-from":"Remove media voice from","give-operator-to":"Give operator to","remove-operator-from":"Remove operator from",kick:"Kick","kick-user":"Kick User",silence:"Silence","silence-user":"Silence user","remove-silence":"Remove Silence","remove-silence-from-user":"Remove Silence from User",ban:"Ban","ban-user":"Ban User","delete-message":"Delete Message","broadcast-live":"Broadcast Live",groups:"Rooms",rooms:"Rooms",others:"Others","google-classroom":"Google Classroom",quit:"Quit",filters:"Filters:","enable-microphone":"Enable Microphone","disable-microphone":"Disable Microphone","enable-camera":"Enable Camera","disable-camera":"Disable Camera","webcam-bitrate":"Webcam bitrate:","screen-bitrate":"Screensharing bitrate:","screen-framerate":"Screensharing framerate:","no-limit":"No limit","congratulations-you-won":"Congratulations you won!","use-your-extra-life-and-keep-playing":"Use your extra life and keep <br />playing","use-extra-life":"Use extra life","keep-watching":"Keep Watching","stop-presentation":"Stop Presentation","share-screen":"Share screen","block-chat":"Block Chat","unblock-chat":"Unblock Chat","send-notification":"Send Notification","list-silenced":"List Silenced","silenced-users":"Silenced Users","no-silenced-users":"No silenced users!","list-banned":"List Banned","banned-users":"Banned users","no-banned-users":"No banned users!","my-tasks":"My Tasks","tasks-delivered":"Tasks Delivered","photos-and-videos":"Photos and Videos","share-document":"Share Document","share-audio":"Share Audio","share-contact":"Share Contact","collaboration-request":"Collaboration Request",transmitting:"Transmitting","list-of-users-in-session":"List of users in session","maximum-number-of-messages-reached":"Maximum number of messages reached. Tomorrow you can send more messages.","chat-blocked-by-administrator":"Chat blocked by administrator","no-response-from-the-app":"No response from the app!","check-your-connection":"Check your connection and if your device has the app open!","getting-data":"Getting data...","keep-your-app-connected":"Keep your app connectred to the internet.","phone-is-not-connected":"Phone is not connected","make-sure-your-phone-has-an-active-internet-connection":"Make sure your phone has an active internet connection.","connection-error":"Connection Error!","your-connection-to-the-server-was-unexpectedly-terminated":"Your connection to the server was unexpectedly terminated. Wait for us to re-establish the connection or login again by clicking here!","delete-conversation":"Delete Conversation","do-you-want-to-start-transmission":"Do you want to start transmission?","you-are-presenting":"You are presenting","choose-the-chat-you-want-to-access":"Choose the chat you want to access","quiz-you-are-eliminated":"YOU ARE ELIMINATED!","quiz-result":"RESULT","quiz-correct":"CORRECT","quiz-incorrect":"INCORRECT","quiz-there-were-no-winners":"There were no winners!","quiz-you-were-the-winner":"You were the winner!","quiz-you-lost":"You lost!","quiz-you-and":"You and","quiz-other-participants-were-winners":"other participants <br />were winners!","quiz-participant-won":"participant won!","quiz-participants-won":"participants won!",users:"Users","youtube-the-owner-does-not-allow-embedded":"The owner of the requested video does not allow this video to be embedded!","youtube-invalid-parameter":"Invalid parameter!","youtube-the-requested-content-cannot-be-played":"The requested content cannot be played!","youtube-the-requested-video-was-not-found":"The requested video was not found or was marked private!","youtube-invalid-address":"Invalid address!",close:"Close","transmission-start":"Transmission",today:"Today",yesterday:"Yesterday",sunday:"Sunday",monday:"Monday",tuesday:"Tuesday",wednesday:"Wednesday",thusday:"Thusday",friday:"Friday",saturday:"Saturday","session-start":"Start Session","session-initiating-recording":"Initiating recording...","session-new":"New Session","session-safari-not-supported":'Safari does not support "Start Session"',"session-firefox-not-supported":'Firefox does not support "Start Session"',"session-continue":"Continue Session","session-finished":"Session Finished!","session-stop":"Stop Session","session-date-reference":"Class date","session-spare-select-here":"Select here","session-spare-spare":"Spare","session-spare-today":"Today","session-report":"Session Report","session-insert-title":"Insert title...","session-insert-category":"Insert Category","session-error-insert-title":"Insert a title!","session-error-select-class-type":"Select class type!","session-error-select-date":"Select date!","session-error-insert-time":"Insert hour and minutes!","session-error-required-category":"Required category","session-error-required-notselected":"not selected!","session-error-finish-selecting":"Finish category selection!","session-error-finish":"Session could not be finished!","session-need-for-transmission":"Need to start session to start transmission!","session-date-time":"Time:","session-recording":"Recording","session-time-remaining":"Session ends in 2 minutes","session-do-not-leave":"Need to end session before leave!","session-do-not-leave-channel":"Need to stop recording before leave!","session-is-active":"Session is active","session-interrupted":"The session was interrupted and can be restarted by the owner in:","record-session":"Record Session","rerecord-session":"Change Record","record-start":"Start Record","record-stop":"Stop Record","error-session-record-connection-failed":"Recording stopped due to instability in your internet connection!","record-reconnecting":"Instable internet connection! Trying to reconnect...","display-define-layout":"Define Layout","closed-caption":"Subtitles","closed-caption-activated":"On","closed-caption-deactivated":"Off","closed-caption-chrome-only":"Closed Captioning only suported on Chrome Browser","new-conference-room":"New Conference Room",invite:"Invite","invite-public":"Public","invite-anyone":"Anyone with the link","invite-private":"Private","invite-only-members":"Only for members","invite-valid-since":"Valid since:","invite-create":"Create invite","invite-to":"To","invite-share-link":"Share the following link with whom you want to join this Conference Room","invite-share-link-copied":"Invitation copied to clipboard!","invite-share-link-copy-error":"Error copying link to clipboard!","invite-anonymous-login":"Anonymous login","invite-allow-chat":"Allow chat","invite-allow-media":"Allow cam/microphone","invite-expiration-time":"Expiration time (HH:MM):","invite-generate-invite":"Invites","channel-joined":"joined.","channel-join-error":"Error entering channel. Verify your connection and try again!","channel-leaved":"left.",attention:"Attention!","error-session-start":"Impossible to start a record session because there is already a session running!","error-session-create":"Session create error!","error-session-create-permission":"No session create permission!","error-session-request-not-allowed":"Request not allowed!","error-session-transmiting":"Session transmiting error!","error-connection-lost":"Conection lost! Verify your internet connection and try again.","error-cam-not-ready":"Falha ao capturar a cÃ¢mera! CÃ¢mera ativa em outro aplicativo!","error-csm-no-mobile":"The requested transmission is not enabled for mobile devices!","error-csm-wait":"Wait a moment to start new session!","error-wrong-credentials":"You do not have permission!","room-tutorial":"Show tutorial","room-no-category":"No category","room-no-room":"No rooms",metaverse:"Metaverse","metaverse-idle-msg":"Do you want to stay on Metaverse?","metaverse-idle-quit":"QUIT","metaverse-idle-continue":"YES, CONTINUE",enabled:"Enabled",disabled:"Disabled","error-publish":"Error starting transmission!","error-publish-timeout":"Error starting transmission!","devices-webcam-not-allowed":"The webcam is blocked! Click at the camera icon in your navigator address bar and enable it!","devices-audio-not-allowed":"The microphone is blocked! Click at the camera icon in your navigator address bar and enable it!","devices-no-webcam":"No webcam detected!","devices-no-audio":"No microphone detected!","try-again":"Try again","devices-webcam-blocked-title":"The webcam is blocked!","devices-webcam-blocked":"The application needs to access the webcam.<br />Click at the blocked camera icon in your navigator address bar and enable it!","devices-microphone-blocked-title":"The microphone is blocked!","devices-microphone-blocked":"The application needs to access the microphone.<br />Click at the blocked camera icon in your navigator address bar and enable it!","devices-blocked-title":"The webcam and the microphone are blocked!","devices-blocked":"The application needs to access the webcam and the microphone.<br />Click at the blocked camera icon in your navigator address bar and enable them!","devices-used-by-others":"The application needs to access the webcam and the microphone.<br />But the devices is been used by other application!","devices-not-found-title":"Camera and microphone unavailable!","devices-not-found":"Webcam and microphone not found!","devices-camera-not-found-title":"Camera unavailable!","devices-camera-not-found":"Camera device not found!","devices-microphone-not-found-title":"Microphone unavailable!","devices-microphone-not-found":"Microphone device not found!","lang-en-AU":"English (Australia)","lang-en-GB":"English (United Kingdom)","lang-en-US":"English (United States)","lang-fr-FR":"French","lang-de-DE":"German","lang-it-IT":"Italian","lang-ja-JP":"Japanese","lang-ko-KR":"Korean","lang-pt-BR":"Portuguese (Brazil)","lang-es-US":"Spanish (United States)",activate:"Activate",deactivate:"Deactivate","select-the-language-to-be-spoken":"Select the language to be spoken.","select-which-language-will-be-translated-to":"Select which language will be translated to.","subtitles-appeared-in-the-chosen-language":"Subtitles appeared in the chosen language.",tests:"Tests",essay:"Essay",tasks:"Tasks",recordings:"Recordings",conference:"Conference",mural:"Feed",details:"Details","screen-saving":"Record metaverse",default:"Default","screen-bottom":"Screen to bottom","screen-left":"Screen to left","breakout-rooms":"Breakout Rooms","create-rooms":"Create Rooms","breakout-rooms-create":"Create Breakout Rooms","breakout-rooms-manage":"Manage Breakout Rooms","breakout-rooms-manage2":"Manage Rooms","breakout-rooms-quantity":"Rooms quantity:","breakout-rooms-max-allowed":"Max rooms allowed:","breakout-rooms-move-to":"Move to:","breakout-rooms-main":"Main room","breakout-rooms-return-main":"Return to main room","breakout-rooms-finish":"Finish Breakout Rooms","resource-unavailable-try-again-later":"Resource unavailable. Try again later.","record-reminder":"For the transmitted content to be recorded, it is necessary to start the recording!","you-will-start-transmission":"You will go live on the broadcast!","your-rooms-will-be-here":"Your rooms will be here soon!","error-getting-rooms":"We were unable to search for your rooms, please try again!","mute-mic":"Mute Microphone","mute-cam":"Mute Camera","find-rooms":"Find Rooms","irm-nick-conflit":"We detected that someone else accessed your account from a new device.","update-room-list":"Update room list","scan-qrcode-text":"To log in, scan the QrCode on the back of your student card by pointing it at the camera.","start-button":"Read with QrCode","back-login-panel-button":"Back","back-info-panel-button":"Back","point-message":"Point the QrCode at the camera","invalid-qrcode-message":"Invalid QrCode!","back-all-btn":"Return to login","invalid-fullname":"Enter a valid name!","guest-suffix":"- Guest","session-expired":"Your session has expired. Please login again to continue.","title-session-expired":"Session expired","text-button-session-expired":"Sign in again",remove:"Remove","remove-collaboration-requests":"Are you sure you want to remove all collaboration requests?"},Gd={hello:"OlÃ¡","you-were-invited":"VocÃª foi convidado para participar desta sala de conferÃªncia",username:"UsuÃ¡rio",password:"Senha",name:"Nome","guest-login":"Entrar como convidado","invalid-username-password":"UsuÃ¡rio e/ou senha invÃ¡lidos!","invite-expired":"O convite estÃ¡ expirado!",authError401:"UsuÃ¡rio ou senha incorretos!",authError403:"UsuÃ¡rio nÃ£o autorizado!",authErrorOther:"Desculpe, mas nÃ£o foi possÃ­vel autenticar seu usuÃ¡rio neste momento. Por favor, tente novamente mais tarde.",authErrorNoInternet:"Desculpe, mas nÃ£o foi possÃ­vel autenticar seu usuÃ¡rio neste momento. Verifique sua conexÃ£o com a internet e tente novamente.","internet-connection-instable":"ConexÃ£o instÃ¡vel.<br />A recepÃ§Ã£o de vÃ­deo serÃ¡ limitada.",enter:"Entrar",continue:"Continuar",forward:"Encaminhar","forward-contact":"Forward Contact",channel:"Canal",channels:"Canais",chats:"Conversas","chats-cap":"CONVERSAS",people:"Pessoas","people-cap":"PESSOAS","device-config":"ConfiguraÃ§Ã£o de Dispositivos","advanced-settings":"ConfiguraÃ§Ãµes avanÃ§adas","channel-link-copy":"Copiar Link","channel-link-copy-message":"Link copiado com sucesso!","channel-link-copy-error":"Erro ao copiar link!","audio-input":"Entrada de Ãudio","audio-output":"SaÃ­da de Ãudio","video-cam":"Captura de VÃ­deo","youtube-playlist":"Playlist Youtube","new-video":"Novo vÃ­deo",playlist:"Playlist",settings:"ConfiguraÃ§Ãµes","youtube-video-url":"URL do vÃ­deo do youtube",search:"Buscar","video-title":"TÃ³pico do VÃ­deo",title:"TÃ­tulo",preview:"Preview",cancel:"Cancelar","quit-channel":"Sair do Canal",update:"Atualizar",save:"Salvar",start:"Iniciar",all:"TODOS",options:"OpÃ§Ãµes",add:"Adicionar","insert-name":"Insira o seu nome:","you-were-invited-to-watch-channel":"VocÃª foi convidado a assitir o canal","you-do-not-have-permission-to-watch-channel":"VocÃª nÃ£o tem permissÃ£o para assitir o canal","invite-expired-to-watch-channel":"Convite expirado para assistir o canal","invite-already-expired":"Este convite expirou em","invite-not-started":"Este convite estarÃ¡ disponÃ­vel a partir de","video-sucessfuly-added-to-playlist":"VÃ­deo adicionado com sucesso a playlist!","add-new-video":"Adicionar novo vÃ­deo","auto-play":"Auto play","show-control":"Exibir controle",loop:"loop","tv-mode":"Modo TV","receiving-call":"Recebendo Chamada",confirm:"Confirmar",city:"Cidade","last-login":"Ãltimo login",following:"Seguindo",friend:"Amigo",friends:"Amigos",block:"Bloquear",message:"Mensagem","send-message":"Enviar Mensagem","group-data":"Dados do Grupo","silence-notifications":"Silenciar NotificaÃ§Ãµes",participants:"Participantes","sound-alert":"Alerta sonoro de novas Mensagens",ok:"OK",reply:"Responder",copy:"Copiar",edit:"Editar",delete:"Apagar","private-message":"Mensagem Privada","give-collaboration":"Dar ColaboraÃ§Ã£o","give-collaboration-to":"Dar ColaboraÃ§Ã£o a","remove-collaboration":"Retirar ColaboraÃ§Ã£o","remove-collaboration-from":"Retirar ColaboraÃ§Ã£o de","give-moderation":"Dar ModeraÃ§Ã£o","give-moderation-to":"Dar ModeraÃ§Ã£o a","remove-moderation":"Retirar ModeraÃ§Ã£o","remove-moderation-from":"Retirar ModeraÃ§Ã£o de","delegate-media-voice-to":"Delegar vez a","remove-media-voice-from":"Remover vez de","give-operator-to":"Dar operador a","remove-operator-from":"Remover operador de",kick:"Expulsar","kick-user":"Expulsar UsuÃ¡rio",silence:"Silenciar","silence-user":"Silenciar usuÃ¡rio","remove-silence":"Retirar Silenciar","remove-silence-from-user":"Retirar Silenciar do UsuÃ¡rio",ban:"Banir","ban-user":"Banir UsuÃ¡rio","delete-message":"Apagar Mensagem","broadcast-live":"Transmitir ao vivo",groups:"Turmas",rooms:"Salas",others:"Outros","google-classroom":"Google Classroom",quit:"Sair",filters:"Filtros:","enable-microphone":"Ativar Microfone","disable-microphone":"Desativar Microfone","enable-camera":"Ativar CÃ¢mera","disable-camera":"Desativar CÃ¢mera","webcam-bitrate":"Taxa de transferÃªncia de cÃ¢mera de vÃ­deo:","screen-bitrate":"Taxa de transferÃªncia de compartilhamento de tela:","screen-framerate":"Taxa de quadros por segundo de compartilhamento de tela:","no-limit":"Sem limite","congratulations-you-won":"ParabÃ©ns vocÃª venceu!","use-your-extra-life-and-keep-playing":"Utilize a sua vida extra e continue <br />jogando","use-extra-life":"Utilizar vida extra","keep-watching":"Continuar assistindo","stop-presentation":"Parar ApresentaÃ§Ã£o","share-screen":"Compartilhar Tela","block-chat":"Bloquear Chat","unblock-chat":"Desbloquear Chat","send-notification":"Enviar NotificaÃ§Ã£o","list-silenced":"Listar Silenciados","silenced-users":"UsuÃ¡rios silenciados","no-silenced-users":"Sem usuÃ¡rios silenciados!","list-banned":"Listar Banidos","banned-users":"UsuÃ¡rios banidos","no-banned-users":"Sem usuÃ¡rios banidos!","my-tasks":"Minhas Tarefas","tasks-delivered":"Tarefas Entregues","photos-and-videos":"Fotos e VÃ­deos","share-document":"Compartilhar Documento","share-audio":"Compartilhar Ãudio","share-contact":"Compartilhar Contato","collaboration-request":"Pedido de colaboraÃ§Ã£o",transmitting:"Transmitindo","list-of-users-in-session":"Lista de usuÃ¡rios em aula","maximum-number-of-messages-reached":"NÃºmero mÃ¡ximo de mensagens atingido. AmanhÃ£ vocÃª poderÃ¡ enviar mais mensagens.","chat-blocked-by-administrator":"Chat bloqueado pelo administrador","no-response-from-the-app":"Sem resposta do aplicativo!","check-your-connection":"Verifique a sua conexÃ£o e se o seu dispositivo estÃ¡ com o aplicativo aberto!","getting-data":"Obtendo dados...","keep-your-app-connected":"Mantenha seu aplicativo conectado Ã  internet","phone-is-not-connected":"Telefone nÃ£o estÃ¡ conectado","make-sure-your-phone-has-an-active-internet-connection":"Tenha certeza de que seu telefone possui uma conexÃ£o ativa com a internet.","connection-error":"Erro de conexÃ£o!","your-connection-to-the-server-was-unexpectedly-terminated":"Sua conexÃ£o ao servidor foi encerrada inesperadamente. Aguarde para reestabelecermos a conexÃ£o ou realize um novo login clicando aqui!","delete-conversation":"Apagar Conversa","do-you-want-to-start-transmission":"Deseja iniciar a transmissÃ£o?","you-are-presenting":"VocÃª estÃ¡ apresentando","choose-the-chat-you-want-to-access":"Escolha o chat que deseja acessar","quiz-you-are-eliminated":"VOCÃ ESTÃ ELIMINADO!","quiz-result":"RESULTADO","quiz-correct":"CORRETA","quiz-incorrect":"INCORRETA","quiz-there-were-no-winners":"NÃ£o houve vencedores!","quiz-you-were-the-winner":"VocÃª foi o vencedor!","quiz-you-lost":"VocÃª perdeu!","quiz-you-and":"VocÃª e mais","quiz-other-participants-were-winners":"participantes <br />foram vencedores!","quiz-participant-won":"participante venceu!","quiz-participants-won":"participantes venceram!",users:"UsuÃ¡rios","youtube-the-owner-does-not-allow-embedded":"O proprietÃ¡rio do vÃ­deo solicitado nÃ£o permite que este vÃ­deo seja incorporado!","youtube-invalid-parameter":"ParÃ¢metro invÃ¡lido!","youtube-the-requested-content-cannot-be-played":"O conteÃºdo solicitado nÃ£o pode ser reproduzido!","youtube-the-requested-video-was-not-found":"O vÃ­deo solicitado nÃ£o foi encontrado ou foi marcado como privado!","youtube-invalid-address":"EndereÃ§o invÃ¡lido!",close:"Fechar","transmission-start":"TransmissÃ£o",today:"Hoje",yesterday:"Ontem",sunday:"Domingo",monday:"Segunda-feira",tuesday:"TerÃ§a-feira",wednesday:"Quarta-feira",thusday:"Quinta-feira",friday:"Sexta-feira",saturday:"SÃ¡bado","session-start":"Iniciar Aula","session-initiating-recording":"Iniciando gravaÃ§Ã£o...","session-new":"Nova Aula","session-safari-not-supported":"O navegador utilizado ainda nÃ£o suporta o recurso de iniciar aula. Tente novamente em outro navegador!","session-firefox-not-supported":"O navegador utilizado ainda nÃ£o suporta o recurso de iniciar aula. Tente novamente em outro navegador!","session-continue":"Continuar Aula","session-finished":"SessÃ£o Finalizada!","session-stop":"Finalizar Aula","session-date-reference":"Data da aula","session-spare-select-here":"Selecione aqui","session-spare-spare":"ReposiÃ§Ã£o","session-spare-today":"Hoje","session-report":"Resumo da aula","session-insert-title":"Insira um tÃ­tulo...","session-insert-category":"Adicionar Categoria","session-error-insert-title":"NecessÃ¡rio inserir um tÃ­tulo!","session-error-select-class-type":"Selecione o tipo de aula!","session-error-select-date":"Selecione uma data!","session-error-insert-time":"NecessÃ¡rio indicar o horÃ¡rio de inÃ­cio da aula!","session-error-required-category":"NecessÃ¡rio indicar uma opÃ§Ã£o para a categoria ","session-error-required-notselected":"!","session-error-finish-selecting":"HÃ¡ uma categoria pendente de finalizaÃ§Ã£o!","session-error-finish":"NÃ£o foi possÃ­vel finalizar a aula!","session-need-for-transmission":"Para transmitir primeiro inicie a aula!","session-date-time":"HorÃ¡rio:","session-recording":"Gravando","session-time-remaining":"Faltam 2 minutos para o fim da aula","session-do-not-leave":'Para sair da turma Ã© preciso primeiro finalizar a aula. Clique no botÃ£o "Finalizar aula"',"session-do-not-leave-channel":"Para sair do canal Ã© preciso primeiro parar a gravaÃ§Ã£o!","session-is-active":"Aula em andamento","session-interrupted":"A sessÃ£o foi interrompida inesperadamente e poderÃ¡ ser retomada em atÃ©:","record-session":"Aulas Agendadas","rerecord-session":"Substituir Aula","record-start":"Iniciar GravaÃ§Ã£o","record-stop":"Parar GravaÃ§Ã£o","error-session-record-connection-failed":"A gravaÃ§Ã£o parou devido Ã  instabilidade na sua conexÃ£oÂ deÂ internet!","record-reconnecting":"A conexÃ£o com a internet estÃ¡ instÃ¡vel! Tentando reconectar...","display-define-layout":"Definir Layout","closed-caption":"Legendas","closed-caption-activated":"Ativado","closed-caption-deactivated":"Desativado","closed-caption-chrome-only":"Legendas apenas suportado pelo navegador Chrome","new-conference-room":"Nova sala de conferÃªncia",invite:"Convite","invite-public":"PÃºblico","invite-anyone":"Qualquer um com o link","invite-private":"Privado","invite-only-members":"Apenas para membros","invite-valid-since":"VÃ¡lido a partir de:","invite-to":"AtÃ©","invite-create":"Criar convite","invite-share-link":"Compartilhe o link a seguir com quem vocÃª deseja que participe desta Sala de ConferÃªncia","invite-share-link-copied":"Convite copiado para a Ã¡rea de transferÃªncia!","invite-share-link-copy-error":"Erro ao copiar o link para a Ã¡rea de transferÃªncia!","invite-anonymous-login":"Login anÃ´nimo","invite-allow-chat":"Permitir chat","invite-allow-media":"Permitir cÃ¢mera/microfone","invite-expiration-time":"Tempo de expiraÃ§Ã£o (HH:MM):","invite-generate-invite":"Convites","channel-joined":"entrou.","channel-join-error":"NÃ£o foi possÃ­vel entrar no canal. Verifique a sua conexÃ£o e tente novamente!","channel-leaved":"saiu.",attention:"AtenÃ§Ã£o!","error-session-start":"ImpossÃ­vel iniciar uma aula de gravaÃ§Ã£o pois jÃ¡ hÃ¡ uma aula em andamento!","error-session-create":"Erro na criaÃ§Ã£o da aula!","error-session-create-permission":"VocÃª nÃ£o possui permissÃ£o para iniciar uma aula gravada!","error-session-request-not-allowed":"RequisiÃ§Ã£o nÃ£o permitida!","error-session-transmiting":"A gravaÃ§Ã£o foi interrompida. Verifique sua conexÃ£o com a internet e tente novamente!","error-connection-lost":"A conexÃ£o com a internet estÃ¡ instÃ¡vel! RestabeleÃ§a a conexÃ£o e tente novamente.","error-cam-not-ready":"Falha ao capturar a cÃ¢mera! CÃ¢mera ativa em outro aplicativo!","error-csm-no-mobile":"A aplicaÃ§Ã£o nÃ£o estÃ¡ preparada para dispositivos mÃ³veis!","error-csm-wait":"Aguarde um pouco para iniciar nova sessÃ£o!","error-wrong-credentials":"VocÃª nÃ£o possui permissÃ£o!","room-tutorial":"Exibir tutorial","room-no-category":"Sem categoria","room-no-room":"Sem turmas",metaverse:"Metaverso","metaverse-idle-msg":"Deseja continuar no Metaverso?","metaverse-idle-quit":"SAIR","metaverse-idle-continue":"SIM, CONTINUAR",enabled:"Habilitado",disabled:"Desabilitado","error-publish":"CÃ¢mera indisponÃ­vel!","error-publish-timeout":" NÃ£o foi possÃ­vel iniciar a transmissÃ£o.<br /> Verifique e habilite a cÃ¢mera nas configuraÃ§Ãµes do seu navegador e tente novamente.","devices-webcam-not-allowed":"A cÃ¢mera estÃ¡ bloqueada! Clique no Ã­cone de cÃ¢mera bloqueada na barra de endereÃ§o do seu navegador e habilite-a!","devices-audio-not-allowed":"O microfone estÃ¡ bloqueado! Clique no Ã­cone de cÃ¢mera bloqueada na barra de endereÃ§o do seu navegador e habilite-a!","devices-no-webcam":"Nenhuma webcam detectada!","devices-no-audio":"Nenhum microfone detectado!","try-again":"Tentar de novo","devices-webcam-blocked-title":"A cÃ¢mera estÃ¡ bloqueada!","devices-webcam-blocked":"O aplicativo deve ter acesso a sua cÃ¢mera.<br />Clique no Ã­cone da cÃ¢mera bloqueada na barra de endereÃ§os do seu navegador e habilite-a!","devices-microphone-blocked-title":"O microfone estÃ¡ bloqueado!","devices-microphone-blocked":"O aplicativo deve ter acesso ao seu microfone.<br />Clique no Ã­cone da cÃ¢mera bloqueada na barra de endereÃ§os do seu navegador e habilite-o!","devices-blocked-title":"A cÃ¢mera e o microfone estÃ£o bloqueados!","devices-blocked":"O aplicativo deve ter acesso a cÃ¢mera e o microfone.<br />Clique no Ã­cone da cÃ¢mera bloqueada na barra de endereÃ§os do seu navegador e habilite-os!","devices-used-by-others":"O aplicativo deve ter acesso a cÃ¢mera e o microfone.<br />PorÃ©m os dispositivos estÃ£o sendo utilizados por outra aplicaÃ§Ã£o!","devices-not-found-title":"CÃ¢mera e microfone indisponÃ­veis!","devices-not-found":"NÃ£o foram encontrados dispositivos de webcam ou microfone!","devices-camera-not-found-title":"CÃ¢mera indisponÃ­vel!","devices-camera-not-found":"NÃ£o foi encontrado dispositivo de cÃ¢mera!","devices-microphone-not-found-title":"Microfone indisponÃ­vel!","devices-microphone-not-found":"NÃ£o foi encontrado dispositivo de microfone!","lang-en-AU":"InglÃªs (AustrÃ¡lia)","lang-en-GB":"InglÃªs (Reino Unido)","lang-en-US":"InglÃªs (Estados Unidos)","lang-fr-FR":"FrancÃªs","lang-de-DE":"AlemÃ£o","lang-it-IT":"Italiano","lang-ja-JP":"JaponÃªs","lang-ko-KR":"Coreano","lang-pt-BR":"PortuguÃªs (Brasil)","lang-es-US":"Espanhol (Estados Unidos)",activate:"Ativar",deactivate:"Desativar","select-the-language-to-be-spoken":"Selecione o idioma que serÃ¡ falado.","select-which-language-will-be-translated-to":"Selecione para qual idioma serÃ¡ traduzido.","subtitles-appeared-in-the-chosen-language":"As legendas aparecerÃ£o no idioma escolhido.",tests:"Provas",essay:"RedaÃ§Ã£o",tasks:"Atividades",recordings:"GravaÃ§Ãµes",conference:"Sala Virtual",mural:"Mural",details:"Detalhes","screen-saving":"Gravar Metaverso",default:"PadrÃ£o","screen-bottom":"Tela para baixo","screen-left":"Tela para a esquerda","create-rooms":"Criar Salas","breakout-rooms":"Salas simultÃ¢neas","breakout-rooms-create":"Criar salas simultÃ¢neas","breakout-rooms-manage":"Gerenciar salas simultÃ¢neas","breakout-rooms-manage2":"Gerenciar salas","breakout-rooms-quantity":"Quantidade de salas:","breakout-rooms-max-allowed":"NÃºmero mÃ¡ximo de salas permitidas:","breakout-rooms-move-to":"Mover para:","breakout-rooms-main":"Sala principal","breakout-rooms-return-main":"Retornar a Sala principal","breakout-rooms-finish":"Finalizar Salas SimultÃ¢neas","resource-unavailable-try-again-later":"Recurso indisponÃ­vel. Tente novamente mais tarde.","record-reminder":'Para que o conteÃºdo transmitido seja gravado Ã© necessÃ¡rio clicar em "Iniciar gravaÃ§Ã£o"!',"you-will-start-transmission":"VocÃª entrarÃ¡ ao vivo na transmissÃ£o!","your-rooms-will-be-here":"Em breve suas turmas estarÃ£o aqui!","error-getting-rooms":"NÃ£o foi possÃ­vel buscar suas turmas, tente novamente!","mute-mic":"Desativar Microfone","mute-cam":"Desativar CÃ¢mera","find-rooms":"Buscar Turmas","irm-nick-conflit":"Detectamos que outra pessoa acessou sua conta a partir de um novo dispositivo.","update-room-list":"Atualizar lista de turmas","scan-qrcode-text":"Para realizar o login, escaneie o QrCode que estÃ¡ no verso da sua carteirinha de estudante apontando ele para a cÃ¢mera.","start-button":"Ler com QrCode","back-login-panel-button":"Voltar","back-info-panel-button":"Voltar","point-message":"Aponte o QrCode para a cÃ¢mera","invalid-qrcode-message":"QrCode invÃ¡lido!","back-all-btn":"Voltar para o inÃ­cio","invalid-fullname":"Insira um nome vÃ¡lido!","guest-suffix":"- Convidado","session-expired":"Sua sessÃ£o expirou. Por favor, faÃ§a login novamente para continuar.","title-session-expired":"SessÃ£o expirada","text-button-session-expired":"Entrar novamente",remove:"Remover","remove-collaboration-requests":"VocÃª tem certeza que deseja remover todos os pedidos de colaboraÃ§Ã£o?"},qd={pt:"ptBr","pt-BR":"ptBr","en-US":"enUs"};function Hd(){let e=window.navigator.language,t=qd["en-US"],n={};function i(e){switch(e){case"ptBr":n=Gd;break;case"enUs":n=Vd;break;default:i(t)}return n}return i(qd[e]),{setLanguage:function(t){return e=qd[t],i(t),function(e){const t=window.i18n.update(jd[e]);Object.entries(t).forEach((([t,n])=>{const i=Ud(t,e);""!==i?l()(`.i18n-${t}`).html(i):l()(`.i18n-${t}`).html(n)}))}(t),!0},getLanguage:function(){return e},setFallbackLanguage:function(e){return t=e,!0},getFallbackLanguage:function(){return t},get:function(t){const i=Ud(t,e);return""!==i?i:!!n[t]&&n[t]},update:i,start:async function(){return!0}}}function zd(){return{getOldMessages:async function(e,t){const n=await window._channel.getChannelMessages2(e,50,t);let i=[];if(n&&(i=n.msgs||[]),i.length>0){const t=i.reverseSortBy("seq"),n=l()("#hp__Channel__ > .msg").attr("seq");let s=0,o=50;l()("#hp__Channel__ > .msg").length<5&&(o=0),t.forEach((function(i){zd().printMessage(e,i.user,i.text,i.ts/1e3,i.seq),s+=1;const r=l()("#hp__Channel__");if(0===o&&(r.scrollTop(r[0].scrollHeight),setTimeout((function(){r.scrollTop(r[0].scrollHeight)}),1e3),setTimeout((function(){r.scrollTop(r[0].scrollHeight)}),4e3)),s===t.length)if(0===o)r.scrollTop(r[0].scrollHeight);else if(n){const t=document.getElementById(`${e}Msg${n}`).offsetTop,i=r[0].offsetTop;l()("#hp__Channel__").scrollTop(t-i-o)}}))}else E(`[Channel] getChannelMessages for channel ${e}: No messages returned!`);return!1},getOldGroupMessages:async function(e,t){const n=await window._channel.getChannelMessages2(e,50,t);let i=[];if(n&&(i=n.msgs||[]),i.length>0){const t=i.reverseSortBy("seq"),n=l()("#hp__Group__ > .msg").attr("seq");let s=0,o=50;l()("#hp__Group__ > .msg").length<5&&(o=0),t.forEach((function(i){zd().printGroupMessage(e,i.user,i.text,i.ts/1e3,i.seq),s+=1;const r=l()("#hp__Group__");if(0===o&&(r.scrollTop(r[0].scrollHeight),setTimeout((function(){r.scrollTop(r[0].scrollHeight)}),1e3),setTimeout((function(){r.scrollTop(r[0].scrollHeight)}),4e3)),s===t.length)if(0===o)r.scrollTop(r[0].scrollHeight);else if(n){const t=document.getElementById(`${e}Msg${n}`).offsetTop,i=r[0].offsetTop;l()("#hp__Group__").scrollTop(t-i-o)}}))}else E(`[Group] getChannelMessages for channel ${e}: No messages returned!`);return!1},populateChatArea:function(e,t,n,i,s){!0===i&&(""===window._channel.getActiveRoom()?window._engine.requestSendPrivateMessage(`${String.fromCharCode(1)}PRIVMSGACKREAD ${s}${String.fromCharCode(1)}`,e,1):window._groupEngine.requestSendPrivateMessage(`${String.fromCharCode(1)}PRIVMSGACKREAD ${s}${String.fromCharCode(1)}`,e,1)),window._channel.printMsg(e,n,t,s),window.msgId+=1},printMessage:function(e,t,n,i,s){const o={};o.text=n,o.type=6,o.sequence=s;const r=l()("#hp__Channel__"),a=m[Math.abs(T(t))%m.length];if(l()(`#${e}Msg${s}`).length)return E(`MessageID ${s} already exists!`),!1;const c=D(i);let d="";if(d+=`<div id="${e}Msg${s}" class="msg ${c.replace(/\//g,"")}" d="2" seq="${s}" date="${c}"><div class="msgLeft"><div class="tailLeft"></div><div id="chnMsgId${s}"class="bor bubble bubbleLeft" style="max-width:100%">`,"Contact"===n.split("=")[0]||"contact"===n.split("=")[0]){const e=n.split("=")[1];d+=`<div class="msgText" style="padding-right:0;padding-bottom:15px"><span style="color:${a};font-weight:bold;" class="chnMsg chnu_op pt" from="${t}" seq="${s}">${t}</span> : <br /> <div class="frm targetInfo pt" t="${e}" group="false"><div><img src="___${e}" class="fic cp" style="width:40px;height:40px;margin-right:10px;" style="width:0px;height:0px;" onerror=""><img src="${window.files_base_url}avatars/user/${e}/thumb.jpeg" class="cp rphi" onerror="loadDefaultAvatar(this);"></div><div class="p10"><div class="toj contactname_${e}"></div><div>${e}</div></div></div>`,d+='<div class="msgMeta"><span class="msgTime">'}else{s>window._channel.getMsgSeq()&&window._channel.setMsgSeq(parseInt(s));let e=t;(window._channel.getOperators().includes(t)||window._channel.getOperators().includes(t.replace("-web","")))&&1===window._channel.getType()&&(e=`<span class="material-icons tw sxs" style="background-color:#FF8A30;border-radius:50%;padding:2px;">star</span> ${t}`),t===window.engineNick?(d+=`<div class="msgText" style="padding-right:0;padding-bottom:15px"><span style="color:${a};font-weight:bold;" class="chnMsg chnu_op pt" from="${t}" seq="${s}">${e}</span> : ${A(o)}</div>`,d+='<div class="msgMeta"><span class="msgTime">'):(d+=`<div class="msgText" style="padding-right:0;padding-bottom:15px"><span style="color:${a};font-weight:bold;" class="chnMsg chnUser chnu_op targetInfo pt" from="${t}" seq="${s}" t="${t}" group="false">${e}</span> : ${A(o)}</div>`,d+='<div class="msgMeta"><span class="msgTime">')}return d+=`${P(i).split(",")[0]}`,d+="</span></div></div>",d+="</div></div>",window.lastDate!==c&&(window.lastDate&&(d+=`<div class="dayBanner frm ts ${window.lastDate.replace(/\//g,"")}"><span class="msgd sxs pl10 pr10 pt5 pb5 tg">${window.lastDate}</span></div>`),window.lastDate=c),r.prepend(d),!1},printGroupMessage:function(e,t,n,i,s){const o={};o.text=n,o.type=6,o.sequence=s;const r=""!==window._channel.getActiveRoom()?window._channel.getActiveRoom():e,a=l()("#hp__Group__"),c=m[Math.abs(T(t))%m.length];if(l()(`#${r}Msg${s}`).length)return E(`MessageID ${s} already exists!`),!1;const d=D(i);let u=`<div id="${r}Msg${s}" class="msg" d="2" seq="${s}"><div class="msgLeft"><div class="tailLeft"></div><div id="chnMsgId${s}"class="bor bubble bubbleLeft" style="max-width:100%">`;if("Contact"===n.split("=")[0]||"contact"===n.split("=")[0]){const e=n.split("=")[1];u+=`<div class="msgText" style="padding-right:0;padding-bottom:15px"><span style="color:${c};font-weight:bold;" class="chnMsg chnu_op pt" from="${t}" seq="${s}">${t}</span> : <br /> <div class="frm targetInfo pt" t="${e}" group="false"><div><img src="___${e}" class="fic cp" style="width:40px;height:40px;margin-right:10px;" style="width:0px;height:0px;" onerror=""><img src="${window.files_base_url}avatars/user/${e}/thumb.jpeg" class="cp rphi" onerror="loadDefaultAvatar(this);"></div><div class="p10"><div class="toj contactname_${e}"></div><div>${e}</div></div></div>`,u+='<div class="msgMeta"><span class="msgTime">'}else{s>window._channel.getMsgSeq()&&window._channel.setMsgSeq(parseInt(s));let e=t;(window._channel.getRoomOperators().includes(t)||window._channel.getRoomOperators().includes(t.replace("-web","")))&&""!==window._channel.getActiveRoom()&&(e=`<span class="material-icons tw sxs" style="background-color:#FF8A30;border-radius:50%;padding:2px;">star</span> ${t}`),t===window.engineNick?(u+=`<div class="msgText" style="padding-right:0;padding-bottom:15px"><span style="color:${c};font-weight:bold;" class="chnMsg chnu_op pt" from="${t}" seq="${s}">${e}</span> : ${A(o)}</div>`,u+='<div class="msgMeta"><span class="msgTime">'):(u+=`<div class="msgText" style="padding-right:0;padding-bottom:15px"><span style="color:${c};font-weight:bold;" class="chnMsg chnUser chnu_op targetInfo pt" from="${t}" seq="${s}" t="${t}" group="false">${e}</span> : ${A(o)}</div>`,u+='<div class="msgMeta"><span class="msgTime">')}return u+=P(i).split(",")[0],u+="</span></div></div>",u+="</div></div>",window.lastDate!==d&&(window.lastDate&&(u+=`<div class="dayBanner frm ts ${window.lastDate.replace(/\//g,"")}"><span class="msgd sxs pl10 pr10 pt5 pb5 tg">${window.lastDate}</span></div>`),window.lastDate=d),a.prepend(u),!1},toMarker:function(e){const t=String.fromCharCode(64);return`${t}${e}${t}:`}}}class Wd{constructor(e,t,n,i,s,o){this.mStream=e,this.mMediaId=t,this.mScreen=n,this.mOwner=i,this.mMe=s,this.mMediaEl=window.customSelectedMedia?window.customSelectedMedia(o,t):o,this.mCanvas=!!this.mMediaEl&&this.mMediaEl.is("canvas"),this.mVideo=!!this.mMediaEl&&this.mMediaEl.is("video");const r=e?e.getVideoTracks().length:0,a=e?e.getAudioTracks().length:0;Di.g.log(3,`SelectedMedia : mediaId:${t}, screen:${n} me:${s}, video:${this.mVideo}, canvas:${this.mCanvas}, videoTracks:${r}, audioTracks:${a}`)}stream(){return this.mStream}mediaId(){return this.mMediaId}screen(){return this.mScreen}owner(){return this.mOwner}isMe(){return this.mMe}isVideo(){return this.mVideo}isCanvas(){return this.mCanvas}mediaEl(){return this.mMediaEl[0]}setAudioTrack(e){const t=new MediaStream;t.addTrack(e);const n=this.mStream.getVideoTracks()[0];n&&t.addTrack(n),this.mStream=t}}function Jd(e,t,n,i,s,o){const r=new Wd(e,t,n,i,s,o);return{stream:()=>r.stream(),mediaId:()=>r.mediaId(),screen:()=>r.screen(),owner:()=>r.owner(),isMe:()=>r.isMe(),isVideo:()=>r.isVideo(),isCanvas:()=>r.isCanvas(),mediaEl:()=>r.mediaEl(),setAudioTrack:e=>{r.setAudioTrack(e)}}}class Yd{static rect(e,t,n,i){return{x:e,y:t,width:n,height:i}}static getAspectSize(e,t,n,i){if(e>n){const i=e/n;e=n,t/=i}if(t>i){const n=t/i;t=i,e/=n}return{width:e,height:t}}static getAspectSizeFill(e,t,n,i){const s=n/e;let o=e*s,r=t*s;if(r>i){const n=i/t;o=e*n,r=t*n}const a=(n-o)/2,c=(i-r)/2;return Yd.rect(a,c,o,r)}static videoWidth(e){return e?null!=e.videoWidth?e.videoWidth:e.width:0}static videoHeight(e){return e?null!=e.videoHeight?e.videoHeight:e.height:0}static getCanvas(e,t,n){const i=$("<canvas/>"),s=i[0];s.width=e,s.height=t;const o=s.getContext("2d");return n&&(o.fillStyle=n,o.fillRect(0,0,e,t)),{jEl:i,el:s,ctx:o,width:e,height:t}}static getCanvasTextWidth(e,t){return Yd.getCanvasTextSize(e,t).width}static getCanvasTextSize(e,t){const n=e.ctx.measureText(t),i=n.actualBoundingBoxAscent+n.actualBoundingBoxDescent;return{width:Math.floor(n.width),height:Math.floor(i)}}}class Kd{constructor(e,t,n=0){this.mId=e,this.mLayoutCtrl=t,this.mMaxVideos=n,this.mVideoMap=new Map,this.mVideoIdList=[],this.mLayoutInfo=null,this.setRect(0,0,0,0)}id(){return this.mId}layoutCtrl(){return this.mLayoutCtrl}setRect(e,t,n,i){this.mX=e,this.mY=t,this.mWidth=n,this.mHeight=i}getVideoEl(e){let t=null;if(this.mVideoIdList.length>e){const n=this.mVideoIdList[e];t=this.mVideoMap.get(n)}return t}getVideoInfo(e){const t=this.getVideoEl(e);return{el:t,width:Yd.videoWidth(t),height:Yd.videoHeight(t)}}pushObj(e,t,n,i,s,o){const r=this.mX+n,a=this.mY+i;e.push({video:t,offsetX:r,offsetY:a,dstVideoW:s,dstVideoH:o})}update(e){this.mLayoutCtrl.getSelected(((t,n)=>{this.mVideoMap.clear(),this.mVideoIdList=[],this.setLayoutInfo(n);let i=!1;for(let e=0;e<t.length;e++){const n=t[e],s=n.mediaId(),o=n.isVideo()||n.isCanvas();Di.g.log(3,`RecorderLayout : update : mediaId:${s}, screen:${n.screen()}, hasImage:${o}`),o&&(!this.mMaxVideos||this.mVideoIdList.length<this.mMaxVideos?this.mVideoMap.has(s)?Di.g.log(3,`RecorderLayout : update : media ${s} already set, ignoring...`):(this.mVideoMap.set(s,n.mediaEl()),this.mVideoIdList.push(s)):i||(Di.g.log(3,`RecorderLayout : update : layout do not support more than ${this.mMaxVideos} videos, ignoring...`),i=!0))}e(t)}))}stop(){this.mLayoutCtrl.stop()}width(){return this.mWidth}height(){return this.mHeight}rect(){return Yd.rect(this.mX,this.mY,this.mWidth,this.mHeight)}setLayoutInfo(e){this.mLayoutInfo=e}frameInfo(e,t,n){return{r:e,maxW:t,maxH:n}}setVideo(e,t,n,i,s=0,o=0){const r=this.getVideoInfo(t);let a=Yd.getAspectSizeFill(r.width,r.height,n,i);const c=s<0?-s:s+a.x,l=o<0?-o:o+a.y;return a=Yd.rect(c,l,a.width,a.height),this.pushObj(e,r.el,a.x,a.y,a.width,a.height),a}}function Xd(e){return{id:()=>e.id(),layoutCtrl:()=>e.layoutCtrl(),setRect:(t,n,i,s)=>{e.setRect(t,n,i,s)},update:t=>{e.update(t)},stop:()=>{e.stop()},width:()=>e.width(),height:()=>e.height(),rect:()=>e.rect(),videoFrames:()=>e.videoFrames()}}class Zd extends Kd{constructor(e,t){super(e,t,2)}videoFrames(){const e=[],t=this.getVideoInfo(0);if(t){const n=this.pushMain(e,t),i=this.getVideoInfo(1);n?this.pushPip(e,i):this.pushMain(e,i)}return e}pushMain(e,t){if(t&&t.width>0&&t.height>0){const n=Yd.getAspectSizeFill(t.width,t.height,this.mWidth,this.mHeight);return this.pushObj(e,t.el,n.x,n.y,n.width,n.height),!0}return!1}pushPip(e,t){if(t&&t.width>0&&t.height>0){const n=Math.round(this.mWidth/5),i=Math.round(this.mHeight/5),s=Yd.getAspectSizeFill(t.width,t.height,n,i),o=this.mWidth-s.width,r=this.mHeight-s.height;return this.pushObj(e,t.el,o,r,s.width,s.height),!0}return!1}}class Qd extends Kd{constructor(e,t){super(e,t),this.mDefSpacingX=16,this.mDefSpacingY=10,this.mSidebarWFactor=0,this.mSidebarMinHFactor=.7,this.mSidebarWndXOffset=0,this.mSidebarMinWndSlots=3,this.mSidebarWndSlots=0}setLayoutInfo(e){super.setLayoutInfo(e);let t=e.extra.sidebarWnds;t<this.mSidebarMinWndSlots&&(t=this.mSidebarMinWndSlots,Di.g.log(3,`RecorderLayoutGrid : setLayoutInfo : sidebarWnds must be >= ${this.mSidebarMinWndSlots}`)),this.mSidebarWndSlots=t,this.mMaxVideos=this.mSidebarWndSlots+1,Di.g.log(3,`RecorderLayoutGrid : setLayoutInfo : maxVideos:${this.mMaxVideos}, sidebar slots:${this.mSidebarWndSlots}`)}videoFrames(){const e=[],t=this.mVideoIdList.length;if(t>0){const n={count:t,ret:e};switch(n.count){case 1:this.drawFrames_1(n);break;case 2:this.drawFrames_2(n);break;case 3:this.drawFrames_3(n);break;case 4:this.drawFrames_4(n);break;case 5:this.drawFrames_5(n);break;case 6:this.drawFrames_6(n);break;case 7:this.drawFrames_7(n);break;case 8:this.drawFrames_8(n);break;case 9:this.drawFrames_9(n)}}return e}drawFrames_1(e){if(e.count>1)switch(this.mSidebarWndSlots){case 3:this.mSidebarWFactor=.26;break;case 4:this.mSidebarWFactor=.2;break;case 5:this.mSidebarWFactor=.17;break;case 6:this.mSidebarWFactor=.15;break;case 7:this.mSidebarWFactor=.13;break;case 8:this.mSidebarWFactor=.12;break;case 9:this.mSidebarWFactor=.11;break;default:this.mSidebarWFactor=.1}const t=1==e.count?this.mWidth:this.mWidth*(1-this.mSidebarWFactor)-this.mDefSpacingX,n=this.mHeight,i=1==e.count?0:this.mDefSpacingX,s=this.setVideo(e.ret,0,t,n,i);return this.frameInfo(s,t,n)}drawFrames_2(e){const t=this.drawFrames_1(e),n=t.r.height,i=this.mWidth*this.mSidebarWFactor-2*this.mDefSpacingX,s=this.mHeight*this.mSidebarMinHFactor,o=((n>=s?n:s)-(this.mSidebarWndSlots-1)*this.mDefSpacingY)/this.mSidebarWndSlots,r=t.r.x+t.r.width+this.mDefSpacingX,a=t.r.y,c=this.setVideo(e.ret,1,i,o,r,-a);return this.mSidebarWndXOffset=r,this.frameInfo(c,i,o)}drawFrame3_9(e,t,n){const i=e.r.y+e.maxH+this.mDefSpacingY,s=this.setVideo(t.ret,n-1,e.maxW,e.maxH,this.mSidebarWndXOffset,-i);return this.frameInfo(s,e.maxW,e.maxH)}drawFrames_3(e){return this.drawFrame3_9(this.drawFrames_2(e),e,3)}drawFrames_4(e){return this.drawFrame3_9(this.drawFrames_3(e),e,4)}drawFrames_5(e){return this.drawFrame3_9(this.drawFrames_4(e),e,5)}drawFrames_6(e){return this.drawFrame3_9(this.drawFrames_5(e),e,6)}drawFrames_7(e){return this.drawFrame3_9(this.drawFrames_6(e),e,7)}drawFrames_8(e){return this.drawFrame3_9(this.drawFrames_7(e),e,8)}drawFrames_9(e){return this.drawFrame3_9(this.drawFrames_8(e),e,9)}}class eu extends Kd{constructor(e,t){super(e,t)}videoFrames(){const e=[],t=this.mVideoIdList.length;if(t>0){const n={count:t,ret:e};1==t?this.drawFrames(n,1,1):t<=2?this.drawFrames(n,2,1):t<=4?this.drawFrames(n,2,2):t<=9?this.drawFrames(n,3,3):t<=16?this.drawFrames(n,4,4):t<=25?this.drawFrames(n,5,5):t<=36?this.drawFrames(n,6,6):t<=49?this.drawFrames(n,7,7):t<=64?this.drawFrames(n,8,8):this.drawFrames(n,9,9)}return e}drawFrames(e,t,n){const i=(this.mWidth-2*(t+1))/t,s=(this.mHeight-2*(n+1))/n;let o=0;for(let r=0;r<n;r++){const n=2*(r+1)+r*s;for(let r=0;r<t;r++){const t=2*(r+1)+r*i;if(this.setVideo(e.ret,o,i,s,t,n),++o==e.count)return}}}}class tu extends Kd{constructor(e,t){super(e,t)}videoFrames(){const e=[];return this.setVideo(e,0,this.mWidth,this.mHeight),e}}class nu{constructor(e,t,n){this.setSize(e,t,n)}sortColor(){const e=["aqua","blue","fuchsia","green","lime","maroon","navy","olive","orange","purple","red","silver","teal"];return e[sr(0,e.length-1)]}redraw(e,t,n,i){this.mInitials||e||(e="XX"),this.mInitialsColor||t||(t="white"),this.mCircleColor||n||(n=this.sortColor()),this.mBackgroundColor||i||(i="black"),e&&(this.mInitials=e),t&&(this.mInitialsColor=t),n&&(this.mCircleColor=n),i&&(this.mBackgroundColor=i);const s=this.mCanvas.ctx;s.fillStyle=this.mBackgroundColor,s.fillRect(0,0,this.mCanvas.width,this.mCanvas.height),s.beginPath();const o=this.mCanvas.width/2,r=this.mCanvas.height/2,a=this.mCircleDiameter/2;s.arc(o,r,a,0,2*Math.PI,!1),s.fillStyle=this.mCircleColor,s.fill(),s.fillStyle=this.mInitialsColor,s.font=`bold ${Math.floor(a)}px Roboto`;const c=Yd.getCanvasTextSize(this.mCanvas,this.mInitials),l=o-c.width/2,d=r+c.height/2;s.fillText(this.mInitials,l,d)}setSize(e,t,n){this.mCanvas&&this.mCanvas.width==e&&this.mCanvas.height==t||(this.mCanvas=Yd.getCanvas(e,t));const i=e<t?e:t;this.mCircleDiameter=n&&n<=i?n:i/2}canvas(){return this.mCanvas}}function iu(e,t,n){const i=new nu(e,t,n);return{canvas:()=>i.canvas(),redraw:(e,t,n,s)=>{i.redraw(e,t,n,s)},setSize:(e,t,n)=>{i.setSize(e,t,n)}}}function su(e,t,n,i){const s=l()("#media_wnds");window._mediaWndsMap=new Map,window._mediaWndsArray=[];const o=2,r=2;let a=-1,c=-1;function d(e,t){a>0&&(g(a),t||(a=-1),e&&S())}function u(e,t){c>0&&(g(c),t||(c=-1),e&&S())}function h(e){let t=n();t&&(t=!e.metadata.videoMuted),e.stream&&e.stream.getVideoTracks().length>0&&e.stream.getVideoTracks()[0].muted&&(t=!1);const i=e.metadata.mediaId,s=!(!e.stream||j.isEnded(e.stream)),o=s?e.stream.getVideoTracks():[],r=s?e.stream.getAudioTracks():[],a=!(!e.streamRec||j.isEnded(e.streamRec)),c=a?e.streamRec.getVideoTracks():[],d=a?e.streamRec.getAudioTracks():[],u=!!(e.metadata.screen||s&&t&&o.length>0),h=k(i);if(E(`WindowCtrl -> setMediaWnd: mediaId:${i}, newTrack:${e.newTrack}, video:${u}, screen:${e.metadata.screen}, me:${e.metadata.me}, active:${e.metadata.active}, streamExist:${!!e.stream}, streamHasData:${s}, streamVidTracks:${o.length}, streamAudTracks:${r.length}, streamRecExist:${!!e.streamRec}, streamRecHasData:${a}, streamRecVidTracks:${c.length}, streamRecAudTracks:${d.length}`),!e.newTrack&&h&&h.stream()&&h.video()==u){const t=h.stream().getVideoTracks(),n=h.stream().getAudioTracks();if(h.metadata.active==e.metadata.active&&t.length==o.length&&n.length==r.length)return E("WindowCtrl -> setMediaWnd : ignoring : since stream is the same"),!1}h&&(E("WindowCtrl -> setMediaWnd : removing previous window"),g(i));let m="",w="";null!=e.metadata.owner?(m=e.metadata.owner,w=e.metadata.owner,"-b"===m.slice(-2)&&(w=m.slice(0,-2)),"-web"===m.slice(-4)&&(w=m.slice(0,-4)),"-is"===w.slice(-3)&&(w=w.slice(0,-3))):(m=window.engineNick,"-web"===m.slice(-4)&&(w=m.slice(0,-4)),"-is"===w.slice(-3)&&(w=w.slice(0,-3))),void 0!==e.metadata.fullname&&(window.user?window.user[e.metadata.owner]=e.metadata.fullname.trim():window.user={},w=e.metadata.fullname.trim());let f,v,b="autoplay playsinline=true";1==mobile&&(b+=" defaultMuted muted");const _=Xr(m);u?(f=m!==p.ENGINE_NICK?l()(`<div class="mediabox" style="position:relative;overflow:hidden;"><div class="mediahover w100 h100 fc bor" style="position:absolute;z-index:9;border-color:#101010;" t="video" mediaid="${i}"><div class="fig"></div><div class="frm w100" style="background:rgba(0,0,0,0.45);flex-wrap:wrap;"><div class="mediasound mediasound${i} sxxl p10 tw material-icons" mediaId="${i}">&#xE050;</div><div class="mediaowner fig tw" style="text-overflow:ellipsis;white-space:nowrap;overflow:hidden;width:30%;">${w}</div><div class="audio_${i}" style="right:10px;width:38px;height:48px;display:flex;padding:2px;margin-left:10px;justify-content:center;align-items:center;" bar="1"><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px;"></div><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px"></div><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px"></div><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px"></div><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px"></div></div><div id="mediaexpand${i}" class="mediaexpand mediaexpand${i} sxxl p10 tw material-icons" style="display:none;position:absolute;right:0px;background-color:#000000;" mediaid="${i}">&#xE56B;</div></div></div><video id=${i} ${b} class="bor bgb" style="width:100%;max-width:100%;padding:1px;border-color:#101010;" owner="${m}"></video><div class="sl tw tbor p5" style="position:absolute;text-align:center;width:100%;top:0px;"></div></div>`):e.metadata.screen?l()(`<div class="mediabox" style="position:relative;overflow:hidden;"><div class="mediahover w100 h100 fc bor" style="position:absolute;z-index:9;border-color:#101010;" t="video" mediaid="${i}"><div class="fig"></div><div class="frm w100" style="background:rgba(0,0,0,0.45);flex-wrap:wrap;"><div style="width:10px;height:48px;"></div><div class="mediaowner fig tw" style="text-overflow:ellipsis;white-space:nowrap;overflow:hidden;width:30%;">${w}</div><div class="audio_${i}" style="right:10px;width:38px;height:48px;display:flex;padding:2px;margin-left:10px;justify-content:center;align-items:center;" bar="1"><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px;"></div><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px"></div><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px"></div><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px"></div><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px"></div></div><div id="mediaexpand${i}" class="mediaexpand mediaexpand${i} sxxl p10 tw material-icons" style="display:none;position:absolute;right:0px;background-color:#000000;" mediaid="${i}">&#xE56B;</div></div></div><video id=${i} ${b} class="bor bgb" style="width:100%;max-width:100%;padding:1px;border-color:#101010;" owner="${m}" volume="0"></video><div class="sl tw tbor p5" style="position:absolute;text-align:center;width:100%;top:0px;"></div></div>`):l()(`<div class="mediabox" style="position:relative;overflow:hidden;"><div class="mediahover w100 h100 fc bor" style="position:absolute;z-index:9;border-color:#101010;" t="video" mediaid="${i}"><div class="fig"></div><div class="frm w100" style="background:rgba(0,0,0,0.45);flex-wrap:wrap;"><div style="width:10px;height:48px;"></div><div class="mediaowner fig tw" style="text-overflow:ellipsis;white-space:nowrap;overflow:hidden;width:30%;">${w}</div><div class="audio_${i}" style="right:10px;width:38px;height:48px;display:flex;padding:2px;margin-left:10px;justify-content:center;align-items:center;" bar="1"><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px;"></div><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px"></div><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px"></div><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px"></div><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px"></div></div><div id="mediaexpand${i}" class="mediaexpand mediaexpand${i} sxxl p10 tw material-icons" style="display:none;position:absolute;right:0px;background-color:#000000;" mediaid="${i}">&#xE56B;</div></div></div><video id=${i} ${b} class="bor bgb" style="width:100%;max-width:100%;padding:1px;border-color:#101010;" owner="${m}"></video><div class="sl tw tbor p5" style="position:absolute;text-align:center;width:100%;top:0px;"></div></div>`),v=f.children("video")):m!==p.ENGINE_NICK?(f=l()(`<div class="mediabox bgb" style="position:relative;"><div class="mediahover w100 h100 fc bor" style="position:absolute;z-index:9;border-color:#101010;" t="audio" mediaid="${i}"><div class="fig"></div><div class="frm w100" style="background:rgba(0,0,0,0.45);flex-wrap:wrap;"><div class="mediasound mediasound${i} sxxl p10 tw material-icons" mediaId="${i}">&#xE050;</div><div class="mediaowner fig tw" style="text-overflow:ellipsis;white-space:nowrap;overflow:hidden;width:30%;">${w}</div><div class="audio_${i}" style="right:10px;width:38px;height:48px;display:flex;padding:2px;margin-left:10px;justify-content:center;align-items:center;" bar="1"><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px;"></div><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px"></div><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px"></div><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px"></div><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px"></div></div><div id="mediaexpand${i}" class="mediaexpand mediaexpand${i} sxxl p10 tw material-icons" style="display:none;position:absolute;right:0px;background-color:#000000;" mediaid="${i}">&#xE56B;</div></div></div><audio id=${i} ${b} class="p0 bor" style="position:absolute;width:100%;max-width:100%;top:0px;border-color:#101010;" owner="${m}"></audio><div></div><div id="audioImg" class="frm h100 w100">${_}</div><div class="sl tw tbor p5 w100" style="position:absolute;text-align:center;top:0px;"></div></div>`),v=f.children("audio")):(f=l()(`<div class="mediabox bgb" style="position:relative;"><div class="mediahover w100 h100 fc bor" style="position:absolute;z-index:9;border-color:#101010;" t="audio" mediaid="${i}"><div class="fig"></div><div class="frm w100" style="background:rgba(0,0,0,0.45);flex-wrap:wrap;"><div style="width:10px;height:48px;"></div><div class="mediaowner fig tw" style="text-overflow:ellipsis;white-space:nowrap;overflow:hidden;width:30%;">${w}</div><div class="audio_${i}" style="right:10px;width:38px;height:48px;display:flex;padding:2px;margin-left:10px;justify-content:center;align-items:center;" bar="1"><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px;"></div><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px"></div><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px"></div><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px"></div><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px"></div></div><div id="mediaexpand${i}" class="mediaexpand mediaexpand${i} sxxl p10 tw material-icons" style="display:none;position:absolute;right:0px;background-color:#000000;" mediaid="${i}">&#xE56B;</div></div></div><audio id=${i} ${b} class="p0 bor" style="position:absolute;width:100%;max-width:100%;top:0px;border-color:#101010;" owner="${m}"></audio><div></div><div id="audioImg" class="frm h100 w100">${_}</div><div class="sl tw tbor p5 w100" style="position:absolute;text-align:center;top:0px;"></div></div>`),v=f.children("audio")),e.metadata.fullname||(e.metadata.fullname=w);const y={_container:void 0,_wnd:f,_mediaEl:v,metadata:e.metadata,_stream:s?e.stream:void 0,_streamRec:a?e.streamRec:void 0,_video:u,_avatar:h?h.avatar():void 0,_avatarVisible:!1,container:()=>y._container,wnd:()=>y._wnd,mediaEl:()=>y._mediaEl,info:()=>y.metadata,stream:()=>y._stream,streamRec:()=>y._streamRec,video:()=>y._video,avatar:()=>y._avatar,avatarVisible:()=>y._avatarVisible,setMediaEl:e=>{y._mediaEl=e},setAvatar:e=>{y._avatar=e},setAvatarVisible:e=>{y._avatarVisible=e}};return window._mediaWndsMap.set(i,y),window._mediaWndsArray.push(i),window._channel.setChannelMedia(i,0),window._channel.mediasUpdatedEvent(),1==e.metadata.mediaVoice?(window._channel.setMediaVoice(e.metadata.mediaId,{wnd:f,metadata:e.metadata,stream:e.stream,video:u}),window._channel.getMediaVoiceUsers().includes(e.metadata.owner)||(window._channel.unsetMediaVoiceUser(e.metadata.owner),window._channel.setMediaVoiceUser({owner:e.metadata.owner,mediaId:e.metadata.mediaId}))):(window._channel.setVoice(e.metadata.mediaId,{wnd:f,metadata:e.metadata,stream:e.stream,video:u}),window._channel.getVoiceUsers().includes(e.metadata.owner)||window._channel.setVoiceUser({owner:e.metadata.owner,mediaId:e.metadata.mediaId})),f.on("pause",(e=>{const t=parseInt(e.target.id);console.debug(`WindowCtrl -> wnd.on pause : ${t}`),l()("#boxesArea").click()})),f.on("play",(e=>{const t=parseInt(e.target.id);null!=k(t)?console.debug(`WindowCtrl -> wnd.on play : ${t}`):console.debug(`WindowCtrl -> wnd.on play : could not find media ${t}`)})),!0}function w(e=!0){return window._channel.getMyMedia().forEach((e=>{e.metadata.screen?c=e.metadata.mediaId:a=e.metadata.mediaId})),window._mediaWndsMap.get(e?a:c)}function g(e){let t=!1;const n=k(e);if(window.webAudio&&window.webAudio.isStarted()&&window.webAudio.stopMedia(e),null!=n){E(`WindowCtrl -> removeWindowModel  : ${e}`),-2==e&&l()("#youtube-area").html('<div id="player" class="h100 w100"></div><div class="w100 bgb fr fic"><div class="p10 tw sx" style="min-height:48px;">Youtube</div><div class="fig"></div><div><div id="mediaexpand-2" class="mediaexpand mediaexpand-2 sxxl p10 tw material-icons" style="display: none;" mediaid="-2" mediaexpandon="0">&#xE56B;</div></div>'),window._channel.unsetMedia(e);const i=window._mediaWndsArray.indexOf(e);window._mediaWndsArray.splice(i,1),window._mediaWndsMap.delete(e),function(e){const t=e.container()?e.container().children(":first"):e.wnd().children(":first");t.parent().remove(),(e.metadata.mediaId===a||e.metadata.mediaId===c)&&(j.stopStreamVideo(e.stream()),j.stopStreamAudio(e.stream())),t[0]&&(t[0].srcObject=null)}(n),t=!0,window._channel.mediasUpdatedEvent()}else E(`WindowCtrl -> removeWindowModel: ${e} not found`);return t}function f(e,t,n,i,s){if(!e)return console.log("WindowCtrl: drawWindow - undefined m"),!1;if(E(`WindowCtrl : drawWindow : owner:${e.metadata.owner}, id:${e.metadata.mediaId}, screen:${e.metadata.screen} pos:[x:${t}, y:${n} ${i}x${s}]`),e.video()&&e.stream()&&(e.metadata.screen||e.metadata.active&&!e.stream().getVideoTracks()[0].muted))e.setAvatarVisible(!1);else{const o=300,r=300;function a(e){return m[Math.abs(I(e))%m.length]}e.avatar()?e.avatar().setSize(o,r):e.setAvatar(iu(o,r)),-2===e.metadata.mediaId&&(e.metadata.fullname="Youtube",e.metadata.owner="youtube");const c=e.metadata.fullname&&e.metadata.fullname.length>0?e.metadata.fullname.trim():e.metadata.owner,l=c.split(" ");let d=l.length>1?l[0].substring(0,1)+l[1].substring(0,1):c.substring(0,2);d=d.toUpperCase();const u=void 0,h=a(e.metadata.owner),p=void 0;e.avatar().redraw(d,u,h,p);const w=e.avatar().canvas();e.setAvatarVisible(!0),w.jEl.position({of:e.container(),my:"left+0 top+0",at:"left top"}),console.debug(`WindowCtrl -> drawWindow : setting avatar to ${c} mediaId:${e.metadata.mediaId}`)}}function v(e,t){f(x(0),0,0,e,t)}function b(e,t){const n=(t-r)/2,i=e;f(x(0),0,0,i,n),f(x(1),0,n+r,i,n)}function _(e,t){const n=(t-r)/2,i=(e-o)/2;f(x(0),0,0,i,n),f(x(1),i+o,0,i,n),f(x(2),0,n+r,e,n)}function y(e,t){const n=(t-r)/2,i=(e-o)/2;f(x(0),0,0,i,n),f(x(1),i+o,0,i,n),f(x(2),0,n+r,i,n),f(x(3),i+o,n+r,i,n)}function C(e,t){const n=window._mediaWndsArray.length;let i=0,s=0;for(let e=0;e<n;e++)e%5==0?(i=0,e>0&&(s+=90+r)):i+=120+o,f(x(e),i,s,120,90)}async function S(){const e=s.width(),t=.9*s.height(),n=window._mediaWndsArray.length;if(window._recorderCtrl.isStarted()){switch(n){case 1:v(e,t);break;case 2:b(e,t);break;case 3:_(e,t);break;case 4:y(e,t);break;default:C()}if(window._recorderCtrl.update(),p.CONFIG.allowNewScreenDisplay){const e=await window._medias.getScreenSharing();0===e.length?(window._medias.clearNewMedias(),setTimeout((function(){window._recorderCtrl.isStarted()&&window.Events.dispatch("record/start","grid")}),3e3)):setTimeout((function(){window._recorderCtrl.isStarted()&&e.length>0&&window.Events.dispatch("record/start","sidebar")}),3e3)}else setTimeout((function(){window._recorderCtrl.isStarted()&&window.Events.dispatch("record/start","main")}),3e3)}const i=window._channel.getCsmObject();if(0!==Object.keys(i).length&&!window._channel.getMedias().includes(i.owner)&&!window._channel.getMedias().includes(`${i.owner}-web`)&&i.recording){const e=window._engine.currentChannel();"meeting"!==window.breakoutRoom.getRoomType(e)&&l()("#session-recording").hide()}0===window._channel.getVoiceRequests().length&&l()("#channelRequestVoiceMark").hide(),window.metaverse.started?l()("#medias").html(""):async function(){let e=await async function(){const e=window._channel.getMedias(),t=[...new Set(e)];window._channel.getModes().U&&l()("#rpchnuserlist").is(":visible")&&window._engine.requestUserList();let n=0;return t.forEach((e=>{window._channel.getUserMedia(e)?1===window._channel.getUserMedia(e)[0].metadata.active&&(n+=window._channel.getUserMedia(e).length):n+=1,window._channel.getVoiceRequests().includes(e)&&window._channel.unsetVoiceRequests(e)})),n}(),t=window._channel.getMedias();const n=window._channel.getMedias().includes("youtube"),i=window._channel.getMyMedia();if(window._engine.currentChannel(),window.webAudio&&window.config.showVuMeter&&window.webAudio.start(),l()("#featuredImg").hide(),l()(".mediabox").remove(),n?l()("#youtube-area").show():l()("#youtube-area").hide(),window._channel.getWindows()){l()("#youtube-area").html(""),t=[],e=0;const n=window._channel.getWindows();if(n.pip){const e=window._channel.getUserMedia(n.pip);if(e&&e[0]){let t,n;if(t=e[0].metadata.mediaId,n=window._channel.getMedia(t),n){const e=n.container()?n.container():n.wnd();e.appendTo(l()("#medias")),e[0].style.position="absolute",e[0].style.width="auto",e[0].style.height="25%",e[0].style.maxHeight="",e[0].style.right="0px",e[0].style.bottom="0px",e[0].style.backgroundColor="#000000",e[0].style.zIndex="9",e[0].childNodes[1].style.width="auto",e[0].childNodes[1].style.height="100%",e[0].childNodes[1].style.maxHeight="",e[0].childNodes[1].play(),n.stream()!=e[0].childNodes[1].srcObject&&(e[0].childNodes[1].srcObject=n.stream()),l()("#medias").show()}}}n.main&&window._channel.getUserMedia(n.main)&&(t.push(n.main),e+=window._channel.getUserMedia(n.main).length),n.users&&n.users.forEach((i=>{i!==n.main&&window._channel.getUserMedia(i)&&(t.push(i),e+=window._channel.getUserMedia(i).length)}))}if(0===e&&!window._channel.getWindows())return l()("#user-media-cc").hide(),l()("#media-cc").hide(),window._channel.setClosedCaption(!1),window.webSpeech.isActive()&&window.webSpeech.stop(),l()("#selfMediaControl").hide(),l()("#user-media-control").hide(),!window._channel.isFeatured()||l()("#youtube-area").is(":visible")||window.metaverse.started||l()("#featuredImg").show(),!0;if(window._channel.getWindows()){if(0===e)return window.webSpeech.isActive()&&window.webSpeech.stop(),!0}else E(`Redrawing media windows (${e})`);if(i||window._channel.getMedias().includes(p.NICK)?(window._channel.isAudioMuted()?(l()("#audioOn").hide(),l()("#audioOff").show()):(l()("#audioOn").show(),l()("#audioOff").hide()),window._channel.isVideoMuted()?(l()("#videoOn").hide(),l()("#videoOff").show()):(l()("#videoOn").show(),l()("#videoOff").hide()),l()("#selfMediaControl").hide(),l()("#channelAdmShareScreen").hide(),l()("#control-screensharing-area").show(),l()("#user-media-control").show()):(l()("#chn-session-btn").hide(),window.webSpeech.stop(),l()("#selfMediaControl").hide(),l()("#control-screensharing-area").hide(),l()("#user-media-control").hide()),l()("#medias").show(),window.resizeMedia.update(),p.CONFIG.allowNewScreenDisplay){E(`[Redraw Windows] displayType: ${window._medias.displayType}`),window._medias.wnd=window._mediaWndsMap,window._medias.wndArray=window._mediaWndsArray;const e=await window._medias.getScreenSharing(),t=document.getElementById("medias-view-config-btn");let n=!1;if(0!==e.length?(e[0].mediaId&&window._mediaWndsMap.get(e[0].mediaId)&&(n=1===window._mediaWndsMap.get(e[0].mediaId).metadata.active),"none"===t.style.display&&n&&(window._medias.displayType="bottom",window.Events.dispatch("medias/display-config-options-icon-show"))):window.Events.dispatch("medias/display-config-options-icon-hide"),"grid"!==window._medias.displayType)return window._medias.clearOldMedias(),window._medias.redrawWindows(),!1;window._medias.clearNewMedias()}switch(e){case 1:return t.forEach((e=>{const t=window._channel.getUserMedia(e),n=window._channel.getUser(e)?.fullname;if(t)t.forEach((e=>{const t=e.container()?e.container():e.wnd(),n=e.metadata.mediaId;if(-2==n)l()("#youtube-area").width("100%"),l()("#youtube-area").css({maxHeight:"100%"});else{if(window.webAudio&&window.webAudio&&window.webAudio.isStarted()&&(window.webAudio.startMedia(n),l()(`.audio_${n}`).height(30)),t.appendTo(l()("#medias")),l()(".mediaexpand").hide(),t[0].style.position="relative",t[0].style.width="100%",t[0].style.height="inherit",t[0].style.maxHeight="inherit",t[0].style.right="",t[0].style.bottom="",t[0].style.backgroundColor="",t[0].style.zIndex="",t[0].childNodes[1].style.height="100%",t[0].childNodes[1].style.width="100%",t[0].childNodes[1].style.maxHeight="100%",n){const e=window._channel.getMediaState(n);e&&(e.muted?(t[0].childNodes[1].muted=!0,l()(`.mediasound${n}`).attr("mediaaudioon","0"),l()(`.mediasound${n}`).html("&#xE04F;"),l()(`.mediasound${n}`).addClass("tr")):(t[0].childNodes[1].muted=!1,l()(`.mediasound${n}`).attr("mediaaudioon","1"),l()(`.mediasound${n}`).html("&#xE050;"),l()(`.mediasound${n}`).removeClass("tr")),e.expanded?(t[0].style.position="absolute",t[0].style.width="100%",t[0].style.maxHeight="100%",t[0].style.zIndex="10",l()(`.mediaexpand${n}`).attr("mediaexpandon","1"),l()(`.mediaexpand${n}`).html("&#xE5D1;")):(l()(`.mediaexpand${n}`).attr("mediaexpandon","0"),l()(`.mediaexpand${n}`).html("&#xE56B;")))}t[0].childNodes[2]&&(t[0].childNodes[2].style.maxHeight="100%"),e.stream()!=t[0].childNodes[1].srcObject&&(t[0].childNodes[1].srcObject=e.stream());try{t[0].childNodes[1].paused&&t[0].childNodes[1].play().catch((e=>{}))}catch(e){}}}));else{const t=Xr(e),i=n||e,s=l()(`<div class="mediabox bor" style="position:relative;border-color:#101010;"><div class="frm h100 w100 bor" style="border-color:#101010;">${t}</div><div class="sn pl10 tw tbor p5 w100" style="position:absolute;text-align:left;bottom:10px;">${i}</div></div>`);s.appendTo(l()("#medias")),s[0].style.position="relative",s[0].style.width="100%",s[0].style.height="inherit",s[0].style.maxHeight="inherit",s[0].style.right="",s[0].style.bottom="",s[0].style.backgroundColor="",s[0].style.zIndex="",s[0].childNodes[1].style.width="100%",s[0].childNodes[1].style.maxHeight="100%"}})),!0;case 2:return t.forEach((function(e){const t=window._channel.getUserMedia(e),n=window._channel.getUser(e)?.fullname;if(t)t.forEach((e=>{const t=e.container()?e.container():e.wnd(),n=e.metadata.mediaId;if(-2==n)l()("#youtube-area").width("50%"),l()("#youtube-area").css({maxHeight:"100%"});else{if(window.webAudio&&window.webAudio.isStarted()&&(window.webAudio.startMedia(n),l()(`.audio_${n}`).height(30)),t.appendTo(l()("#medias")),t[0].style.position="relative",t[0].style.width="50%",t[0].style.height="inherit",t[0].style.maxHeight="100%",t[0].style.padding="0px",t[0].style.right="",t[0].style.bottom="",t[0].style.backgroundColor="",t[0].style.zIndex="",t[0].childNodes[1]&&(t[0].childNodes[1].style.height="100%",t[0].childNodes[1].style.width="100%",t[0].childNodes[1].style.maxHeight="100%"),n){const e=window._channel.getMediaState(n);e&&(t[0].childNodes[1]&&(e.muted?(t[0].childNodes[1].muted=!0,l()(`.mediasound${n}`).attr("mediaaudioon","0"),l()(`.mediasound${n}`).html("&#xE04F;"),l()(`.mediasound${n}`).addClass("tr")):(t[0].childNodes[1].muted=!1,l()(`.mediasound${n}`).attr("mediaaudioon","1"),l()(`.mediasound${n}`).html("&#xE050;"),l()(`.mediasound${n}`).removeClass("tr"))),e.expanded?(t[0].style.position="absolute",t[0].style.width="100%",t[0].style.maxHeight="100%",t[0].style.zIndex="10",l()(`.mediaexpand${n}`).attr("mediaexpandon","1"),l()(`.mediaexpand${n}`).html("&#xE5D1;")):(l()(`.mediaexpand${n}`).attr("mediaexpandon","0"),l()(`.mediaexpand${n}`).html("&#xE56B;")))}t[0].childNodes[2]&&(t[0].childNodes[2].style.maxHeight="70%"),t[0].childNodes[1]&&e.stream()!=t[0].childNodes[1].srcObject&&(t[0].childNodes[1].srcObject=e.stream());try{t[0].childNodes[1].paused&&t[0].childNodes[1].play().catch((e=>{}))}catch(e){}}}));else{const t=Xr(e),i=n||e,s=l()(`<div class="mediabox bor" style="position:relative;border-color:#101010;"><div class="frm h100 w100 bor" style="border-color:#101010;">${t}</div><div class="sn pl10 tw tbor p5 w100" style="position:absolute;text-align:left;bottom:10px;">${i}</div></div>`);s.appendTo(l()("#medias")),s[0].style.position="relative",s[0].style.width="50%",s[0].style.height="inherit",s[0].style.maxHeight="100%",s[0].style.padding="0px",s[0].style.right="",s[0].style.bottom="",s[0].style.backgroundColor="",s[0].style.zIndex="",s[0].childNodes[1].style.width="100%",s[0].childNodes[1].style.maxHeight="100%"}})),!0;case 3:return t.forEach((function(e){const t=window._channel.getUserMedia(e),n=window._channel.getUser(e)?.fullname;if(t)t.forEach((e=>{const t=e.container()?e.container():e.wnd(),n=e.metadata.mediaId;if(-2==n)l()("#youtube-area").width("33.33333%"),l()("#youtube-area").css({maxHeight:"100%"});else{if(window.webAudio&&window.webAudio.isStarted()&&(window.webAudio.startMedia(n),l()(`.audio_${n}`).height(30)),t.appendTo(l()("#medias")),t[0].style.position="relative",t[0].style.width="33.33333%",t[0].style.height="inherit",t[0].style.maxHeight="100%",t[0].style.padding="0px",t[0].style.right="",t[0].style.bottom="",t[0].style.backgroundColor="",t[0].style.zIndex="",t[0].childNodes[1].style.height="100%",t[0].childNodes[1].style.width="100%",t[0].childNodes[1].style.maxHeight="100%",n){const e=window._channel.getMediaState(n);e&&(e.muted?(t[0].childNodes[1].muted=!0,l()(`.mediasound${n}`).attr("mediaaudioon","0"),l()(`.mediasound${n}`).html("&#xE04F;"),l()(`.mediasound${n}`).addClass("tr")):(t[0].childNodes[1].muted=!1,l()(`.mediasound${n}`).attr("mediaaudioon","1"),l()(`.mediasound${n}`).html("&#xE050;"),l()(`.mediasound${n}`).removeClass("tr")),e.expanded?(t[0].style.position="absolute",t[0].style.width="100%",t[0].style.maxHeight="100%",t[0].style.zIndex="10",l()(`.mediaexpand${n}`).attr("mediaexpandon","1"),l()(`.mediaexpand${n}`).html("&#xE5D1;")):(l()(`.mediaexpand${n}`).attr("mediaexpandon","0"),l()(`.mediaexpand${n}`).html("&#xE56B;")))}t[0].childNodes[2]&&(t[0].childNodes[2].style.maxHeight="50%"),e.stream()!=t[0].childNodes[1].srcObject&&(t[0].childNodes[1].srcObject=e.stream());try{t[0].childNodes[1].paused&&t[0].childNodes[1].play().catch((e=>{}))}catch(e){}}}));else{const t=Xr(e),i=n||e,s=l()(`<div class="mediabox bor" style="position:relative;border-color:#101010;"><div class="frm h100 w100 bor" style="border-color:#101010;">${t}</div><div class="sn pl10 tw tbor p5 w100" style="position:absolute;text-align:left;bottom:10px;">${i}</div></div>`);s.appendTo(l()("#medias")),s[0].style.position="relative",s[0].style.width="33.33333%",s[0].style.height="inherit",s[0].style.maxHeight="100%",s[0].style.padding="0px",s[0].style.right="",s[0].style.bottom="",s[0].style.backgroundColor="",s[0].style.zIndex="",s[0].childNodes[1].style.width="100%",s[0].childNodes[1].style.maxHeight="100%"}})),!0;case 4:case 5:case 6:return t.forEach((function(e){const t=window._channel.getUserMedia(e),n=window._channel.getUser(e)?.fullname;if(t)t.forEach((e=>{const t=e.container()?e.container():e.wnd(),n=e.metadata.mediaId;if(-2==n)l()("#youtube-area").width("33.33333%"),l()("#youtube-area").css({maxHeight:"50%"});else{if(window.webAudio&&window.webAudio.isStarted()&&(window.webAudio.startMedia(n),l()(`.audio_${n}`).height(30)),t.appendTo(l()("#medias")),t[0].style.position="relative",t[0].style.width="33.33333%",t[0].style.height="inherit",t[0].style.maxHeight="50%",t[0].style.padding="0px",t[0].style.zIndex="",t[0].style.right="",t[0].style.bottom="",t[0].style.backgroundColor="",t[0].childNodes[1].style.height="100%",t[0].childNodes[1].style.width="100%",t[0].childNodes[1].style.maxHeight="100%",n){const e=window._channel.getMediaState(n);e&&(e.muted?(t[0].childNodes[1].muted=!0,l()(`.mediasound${n}`).attr("mediaaudioon","0"),l()(`.mediasound${n}`).html("&#xE04F;"),l()(`.mediasound${n}`).addClass("tr")):(t[0].childNodes[1].muted=!1,l()(`.mediasound${n}`).attr("mediaaudioon","1"),l()(`.mediasound${n}`).html("&#xE050;"),l()(`.mediasound${n}`).removeClass("tr")),e.expanded?(t[0].style.position="absolute",t[0].style.width="100%",t[0].style.maxHeight="100%",t[0].style.zIndex="10",l()(`.mediaexpand${n}`).attr("mediaexpandon","1"),l()(`.mediaexpand${n}`).html("&#xE5D1;")):(l()(`.mediaexpand${n}`).attr("mediaexpandon","0"),l()(`.mediaexpand${n}`).html("&#xE56B;")))}t[0].childNodes[2]&&(t[0].childNodes[2].style.maxHeight="100%"),e.stream()!=t[0].childNodes[1].srcObject&&(t[0].childNodes[1].srcObject=e.stream());try{t[0].childNodes[1].paused&&t[0].childNodes[1].play().catch((e=>{}))}catch(e){}}}));else{const t=Xr(e),i=n||e,s=l()(`<div class="mediabox bor" style="position:relative;border-color:#101010;"><div class="frm h100 w100 bor" style="border-color:#101010;">${t}</div><div class="sn pl10 tw tbor p5 w100" style="position:absolute;text-align:left;bottom:10px;">${i}</div></div>`);s.appendTo(l()("#medias")),s[0].style.position="relative",s[0].style.width="33.33333%",s[0].style.height="inherit",s[0].style.maxHeight="50%",s[0].style.padding="0px",s[0].style.right="",s[0].style.bottom="",s[0].style.backgroundColor="",s[0].style.zIndex="",s[0].childNodes[1].style.width="100%",s[0].childNodes[1].style.maxHeight="100%"}})),!0;case 7:case 8:return t.forEach((function(e){const t=window._channel.getUserMedia(e),n=window._channel.getUser(e)?.fullname;if(t)t.forEach((e=>{const t=e.container()?e.container():e.wnd(),n=e.metadata.mediaId;if(-2==n)l()("#youtube-area").width("25%"),l()("#youtube-area").css({maxHeight:"50%"});else{if(window.webAudio&&window.webAudio.isStarted()&&window.webAudio.startMedia(n),t.appendTo(l()("#medias")),t[0].style.position="relative",t[0].style.width="25%",t[0].style.height="inherit",t[0].style.maxHeight="50%",t[0].style.padding="0px",t[0].style.right="",t[0].style.bottom="",t[0].style.backgroundColor="",t[0].style.zIndex="",t[0].childNodes[1].style.height="100%",t[0].childNodes[1].style.width="100%",t[0].childNodes[1].style.maxHeight="100%",n){const e=window._channel.getMediaState(n);e&&(e.muted?(t[0].childNodes[1].muted=!0,l()(`.mediasound${n}`).attr("mediaaudioon","0"),l()(`.mediasound${n}`).html("&#xE04F;"),l()(`.mediasound${n}`).addClass("tr")):(t[0].childNodes[1].muted=!1,l()(`.mediasound${n}`).attr("mediaaudioon","1"),l()(`.mediasound${n}`).html("&#xE050;"),l()(`.mediasound${n}`).removeClass("tr")),e.expanded?(t[0].style.position="absolute",t[0].style.width="100%",t[0].style.maxHeight="100%",t[0].style.zIndex="10",l()(`.mediaexpand${n}`).attr("mediaexpandon","1"),l()(`.mediaexpand${n}`).html("&#xE5D1;")):(l()(`.mediaexpand${n}`).attr("mediaexpandon","0"),l()(`.mediaexpand${n}`).html("&#xE56B;")))}t[0].childNodes[2]&&(t[0].childNodes[2].style.maxHeight="100%"),e.stream()!=t[0].childNodes[1].srcObject&&(t[0].childNodes[1].srcObject=e.stream());try{t[0].childNodes[1].paused&&t[0].childNodes[1].play().catch((e=>{}))}catch(e){}}}));else{const t=Xr(e),i=n||e,s=l()(`<div class="mediabox bor" style="position:relative;border-color:#101010;"><div class="frm h100 w100 bor" style="border-color:#101010;">${t}</div><div class="sn pl10 tw tbor p5 w100" style="position:absolute;text-align:left;bottom:10px;">${i}</div></div>`);s.appendTo(l()("#medias")),s[0].style.position="relative",s[0].style.width="25%",s[0].style.height="inherit",s[0].style.maxHeight="50%",s[0].style.padding="0px",s[0].style.right="",s[0].style.bottom="",s[0].style.backgroundColor="",s[0].style.zIndex="",s[0].childNodes[1].style.width="100%",s[0].childNodes[1].style.maxHeight="100%"}})),!0;case 9:case 10:case 11:case 12:return t.forEach((function(e){const t=window._channel.getUserMedia(e),n=window._channel.getUser(e)?.fullname;if(t)t.forEach((e=>{const t=e.container()?e.container():e.wnd(),n=e.metadata.mediaId;if(-2==n)l()("#youtube-area").width("25%"),l()("#youtube-area").css({maxHeight:"33.33333%"});else{if(window.webAudio&&window.webAudio.isStarted()&&window.webAudio.startMedia(n),t.appendTo(l()("#medias")),t[0].style.position="relative",t[0].style.width="25%",t[0].style.height="inherit",t[0].style.maxHeight="33.33333%",t[0].style.padding="0px",t[0].style.right="",t[0].style.bottom="",t[0].style.backgroundColor="",t[0].style.zIndex="",t[0].childNodes[1].style.height="100%",t[0].childNodes[1].style.width="100%",t[0].childNodes[1].style.maxHeight="100%",n){const e=window._channel.getMediaState(n);e&&(e.muted?(t[0].childNodes[1].muted=!0,l()(`.mediasound${n}`).attr("mediaaudioon","0"),l()(`.mediasound${n}`).html("&#xE04F;"),l()(`.mediasound${n}`).addClass("tr")):(t[0].childNodes[1].muted=!1,l()(`.mediasound${n}`).attr("mediaaudioon","1"),l()(`.mediasound${n}`).html("&#xE050;"),l()(`.mediasound${n}`).removeClass("tr")),e.expanded?(t[0].style.position="absolute",t[0].style.width="100%",t[0].style.maxHeight="100%",t[0].style.zIndex="10",l()(`.mediaexpand${n}`).attr("mediaexpandon","1"),l()(`.mediaexpand${n}`).html("&#xE5D1;")):(l()(`.mediaexpand${n}`).attr("mediaexpandon","0"),l()(`.mediaexpand${n}`).html("&#xE56B;")))}t[0].childNodes[2]&&(t[0].childNodes[2].style.maxHeight="100%"),e.stream()!=t[0].childNodes[1].srcObject&&(t[0].childNodes[1].srcObject=e.stream());try{t[0].childNodes[1].paused&&t[0].childNodes[1].play().catch((e=>{}))}catch(e){}}}));else{const t=Xr(e),i=n||e,s=l()(`<div class="mediabox bor" style="position:relative;border-color:#101010;"><div class="frm h100 w100 bor" style="border-color:#101010;">${t}</div><div class="sn pl10 tw tbor p5 w100" style="position:absolute;text-align:left;bottom:10px;">${i}</div></div>`);s.appendTo(l()("#medias")),s[0].style.position="relative",s[0].style.width="25%",s[0].style.height="inherit",s[0].style.maxHeight="33.33333%",s[0].style.padding="0px",s[0].style.right="",s[0].style.bottom="",s[0].style.backgroundColor="",s[0].style.zIndex="",s[0].childNodes[1].style.width="100%",s[0].childNodes[1].style.maxHeight="100%"}})),!0;case 13:case 14:case 15:return t.forEach((function(e){const t=window._channel.getUserMedia(e),n=window._channel.getUser(e)?.fullname;if(t)t.forEach((e=>{const t=e.container()?e.container():e.wnd(),n=e.metadata.mediaId;if(-2==n)l()("#youtube-area").width("20%"),l()("#youtube-area").css({maxHeight:"33.33333%"});else{if(window.webAudio&&window.webAudio.isStarted()&&window.webAudio.startMedia(n),t.appendTo(l()("#medias")),t[0].style.position="relative",t[0].style.width="20%",t[0].style.height="inherit",t[0].style.maxHeight="33.33333%",t[0].style.padding="0px",t[0].style.right="",t[0].style.bottom="",t[0].style.backgroundColor="",t[0].style.zIndex="",t[0].childNodes[1].style.height="100%",t[0].childNodes[1].style.width="100%",t[0].childNodes[1].style.maxHeight="100%",n){const e=window._channel.getMediaState(n);e&&(e.muted?(t[0].childNodes[1].muted=!0,l()(`.mediasound${n}`).attr("mediaaudioon","0"),l()(`.mediasound${n}`).html("&#xE04F;"),l()(`.mediasound${n}`).addClass("tr")):(t[0].childNodes[1].muted=!1,l()(`.mediasound${n}`).attr("mediaaudioon","1"),l()(`.mediasound${n}`).html("&#xE050;"),l()(`.mediasound${n}`).removeClass("tr")),e.expanded?(t[0].style.position="absolute",t[0].style.width="100%",t[0].style.maxHeight="100%",t[0].style.zIndex="10",l()(`.mediaexpand${n}`).attr("mediaexpandon","1"),l()(`.mediaexpand${n}`).html("&#xE5D1;")):(l()(`.mediaexpand${n}`).attr("mediaexpandon","0"),l()(`.mediaexpand${n}`).html("&#xE56B;")))}t[0].childNodes[2]&&(t[0].childNodes[2].style.maxHeight="100%"),e.stream()!=t[0].childNodes[1].srcObject&&(t[0].childNodes[1].srcObject=e.stream());try{t[0].childNodes[1].paused&&t[0].childNodes[1].play().catch((e=>{}))}catch(e){}}}));else{const t=Xr(e),i=n||e,s=l()(`<div class="mediabox bor" style="position:relative;border-color:#101010;"><div class="frm h100 w100 bor" style="border-color:#101010;">${t}</div><div class="sn pl10 tw tbor p5 w100" style="position:absolute;text-align:left;bottom:10px;">${i}</div></div>`);s.appendTo(l()("#medias")),s[0].style.position="relative",s[0].style.width="20%",s[0].style.height="inherit",s[0].style.maxHeight="33.33333%",s[0].style.padding="0px",s[0].style.right="",s[0].style.bottom="",s[0].style.backgroundColor="",s[0].style.zIndex="",s[0].childNodes[1].style.width="100%",s[0].childNodes[1].style.maxHeight="100%"}})),!0;case 16:case 17:case 18:return t.forEach((function(e){const t=window._channel.getUserMedia(e),n=window._channel.getUser(e)?.fullname;if(t)t.forEach((e=>{const t=e.container()?e.container():e.wnd(),n=e.metadata.mediaId;if(-2==n)l()("#youtube-area").width("16.66666%"),l()("#youtube-area").css({maxHeight:"33.33333%"});else{if(window.webAudio&&window.webAudio.isStarted()&&window.webAudio.startMedia(n),t.appendTo(l()("#medias")),t[0].style.position="relative",t[0].style.width="16.66666%",t[0].style.height="inherit",t[0].style.maxHeight="33.33333%",t[0].style.padding="0px",t[0].style.right="",t[0].style.bottom="",t[0].style.backgroundColor="",t[0].style.zIndex="",t[0].childNodes[1].style.height="100%",t[0].childNodes[1].style.width="100%",t[0].childNodes[1].style.maxHeight="100%",n){const e=window._channel.getMediaState(n);e&&(e.muted?(t[0].childNodes[1].muted=!0,l()(`.mediasound${n}`).attr("mediaaudioon","0"),l()(`.mediasound${n}`).html("&#xE04F;"),l()(`.mediasound${n}`).addClass("tr")):(t[0].childNodes[1].muted=!1,l()(`.mediasound${n}`).attr("mediaaudioon","1"),l()(`.mediasound${n}`).html("&#xE050;"),l()(`.mediasound${n}`).removeClass("tr")),e.expanded?(t[0].style.position="absolute",t[0].style.width="100%",t[0].style.maxHeight="100%",t[0].style.zIndex="10",l()(`.mediaexpand${n}`).attr("mediaexpandon","1"),l()(`.mediaexpand${n}`).html("&#xE5D1;")):(l()(`.mediaexpand${n}`).attr("mediaexpandon","0"),l()(`.mediaexpand${n}`).html("&#xE56B;")))}t[0].childNodes[2]&&(t[0].childNodes[2].style.maxHeight="100%"),e.stream()!=t[0].childNodes[1].srcObject&&(t[0].childNodes[1].srcObject=e.stream());try{t[0].childNodes[1].paused&&t[0].childNodes[1].play().catch((e=>{}))}catch(e){}}}));else{const t=Xr(e),i=n||e,s=l()(`<div class="mediabox bor" style="position:relative;border-color:#101010;"><div class="frm h100 w100 bor" style="border-color:#101010;">${t}</div><div class="sn pl10 tw tbor p5 w100" style="position:absolute;text-align:left;bottom:10px;">${i}</div></div>`);s.appendTo(l()("#medias")),s[0].style.position="relative",s[0].style.width="16.66666%",s[0].style.height="inherit",s[0].style.maxHeight="33.33333%",s[0].style.padding="0px",s[0].style.right="",s[0].style.bottom="",s[0].style.backgroundColor="",s[0].style.zIndex="",s[0].childNodes[1].style.width="100%",s[0].childNodes[1].style.maxHeight="100%"}})),!0;case 19:case 20:case 21:case 22:case 23:case 24:return t.forEach((function(e){const t=window._channel.getUserMedia(e),n=window._channel.getUser(e)?.fullname;if(t)t.forEach((e=>{const t=e.container()?e.container():e.wnd(),n=e.metadata.mediaId;if(-2==n)l()("#youtube-area").width("16.66666%"),l()("#youtube-area").css({maxHeight:"25%"});else{if(window.webAudio&&window.webAudio.isStarted()&&window.webAudio.startMedia(n),t.appendTo(l()("#medias")),t[0].style.position="relative",t[0].style.width="16.66666%",t[0].style.height="inherit",t[0].style.maxHeight="25%",t[0].style.padding="0px",t[0].style.right="",t[0].style.bottom="",t[0].style.backgroundColor="",t[0].style.zIndex="",t[0].childNodes[1].style.height="100%",t[0].childNodes[1].style.width="100%",t[0].childNodes[1].style.maxHeight="100%",n){const e=window._channel.getMediaState(n);e&&(e.muted?(t[0].childNodes[1].muted=!0,l()(`.mediasound${n}`).attr("mediaaudioon","0"),l()(`.mediasound${n}`).html("&#xE04F;"),l()(`.mediasound${n}`).addClass("tr")):(t[0].childNodes[1].muted=!1,l()(`.mediasound${n}`).attr("mediaaudioon","1"),l()(`.mediasound${n}`).html("&#xE050;"),l()(`.mediasound${n}`).removeClass("tr")),e.expanded?(t[0].style.position="absolute",t[0].style.width="100%",t[0].style.maxHeight="100%",t[0].style.zIndex="10",l()(`.mediaexpand${n}`).attr("mediaexpandon","1"),l()(`.mediaexpand${n}`).html("&#xE5D1;")):(l()(`.mediaexpand${n}`).attr("mediaexpandon","0"),l()(`.mediaexpand${n}`).html("&#xE56B;")))}t[0].childNodes[2]&&(t[0].childNodes[2].style.maxHeight="100%"),e.stream()!=t[0].childNodes[1].srcObject&&(t[0].childNodes[1].srcObject=e.stream());try{t[0].childNodes[1].paused&&t[0].childNodes[1].play().catch((e=>{}))}catch(e){}}}));else{const t=Xr(e),i=n||e,s=l()(`<div class="mediabox bor" style="position:relative;border-color:#101010;"><div class="frm h100 w100 bor" style="border-color:#101010;">${t}</div><div class="sn pl10 tw tbor p5 w100" style="position:absolute;text-align:left;bottom:10px;">${i}</div></div>`);s.appendTo(l()("#medias")),s[0].style.position="relative",s[0].style.width="16.66666%",s[0].style.height="inherit",s[0].style.maxHeight="25%",s[0].style.padding="0px",s[0].style.right="",s[0].style.bottom="",s[0].style.backgroundColor="",s[0].style.zIndex="",s[0].childNodes[1].style.width="100%",s[0].childNodes[1].style.maxHeight="100%"}})),!0;case 25:case 26:case 27:case 28:return t.forEach((function(e){const t=window._channel.getUserMedia(e),n=window._channel.getUser(e)?.fullname;if(t)t.forEach((e=>{const t=e.container()?e.container():e.wnd(),n=e.metadata.mediaId;if(-2==n)l()("#youtube-area").width("14.285714%"),l()("#youtube-area").css({maxHeight:"25%"});else{if(window.webAudio&&window.webAudio.isStarted()&&window.webAudio.startMedia(n),t.appendTo(l()("#medias")),t[0].style.position="relative",t[0].style.width="14.285714%",t[0].style.height="inherit",t[0].style.maxHeight="25%",t[0].style.padding="0px",t[0].style.right="",t[0].style.bottom="",t[0].style.backgroundColor="",t[0].style.zIndex="",t[0].childNodes[1].style.height="100%",t[0].childNodes[1].style.width="100%",t[0].childNodes[1].style.maxHeight="100%",n){const e=window._channel.getMediaState(n);e&&(e.muted?(t[0].childNodes[1].muted=!0,l()(`.mediasound${n}`).attr("mediaaudioon","0"),l()(`.mediasound${n}`).html("&#xE04F;"),l()(`.mediasound${n}`).addClass("tr")):(t[0].childNodes[1].muted=!1,l()(`.mediasound${n}`).attr("mediaaudioon","1"),l()(`.mediasound${n}`).html("&#xE050;"),l()(`.mediasound${n}`).removeClass("tr")),e.expanded?(t[0].style.position="absolute",t[0].style.width="100%",t[0].style.maxHeight="100%",t[0].style.zIndex="10",l()(`.mediaexpand${n}`).attr("mediaexpandon","1"),l()(`.mediaexpand${n}`).html("&#xE5D1;")):(l()(`.mediaexpand${n}`).attr("mediaexpandon","0"),l()(`.mediaexpand${n}`).html("&#xE56B;")))}t[0].childNodes[2]&&(t[0].childNodes[2].style.maxHeight="100%"),e.stream()!=t[0].childNodes[1].srcObject&&(t[0].childNodes[1].srcObject=e.stream());try{t[0].childNodes[1].paused&&t[0].childNodes[1].play().catch((e=>{}))}catch(e){}}}));else{const t=Xr(e),i=n||e,s=l()(`<div class="mediabox bor" style="position:relative;border-color:#101010;"><div class="frm h100 w100 bor" style="border-color:#101010;">${t}</div><div class="sn pl10 tw tbor p5 w100" style="position:absolute;text-align:left;bottom:10px;">${i}</div></div>`);s.appendTo(l()("#medias")),s[0].style.position="relative",s[0].style.width="14.285714%",s[0].style.height="inherit",s[0].style.maxHeight="25%",s[0].style.padding="0px",s[0].style.right="",s[0].style.bottom="",s[0].style.backgroundColor="",s[0].style.zIndex="",s[0].childNodes[1].style.width="100%",s[0].childNodes[1].style.maxHeight="100%"}})),!0;case 29:case 30:case 31:case 32:case 33:case 34:case 35:return t.forEach((function(e){const t=window._channel.getUserMedia(e),n=window._channel.getUser(e)?.fullname;if(t)t.forEach((e=>{const t=e.container()?e.container():e.wnd(),n=e.metadata.mediaId;if(-2==n)l()("#youtube-area").width("14.285714%"),l()("#youtube-area").css({maxHeight:"20%"});else{if(window.webAudio&&window.webAudio.isStarted()&&window.webAudio.startMedia(n),t.appendTo(l()("#medias")),t[0].style.position="relative",t[0].style.width="14.285714%",t[0].style.height="inherit",t[0].style.maxHeight="20%",t[0].style.padding="0px",t[0].style.right="",t[0].style.bottom="",t[0].style.backgroundColor="",t[0].style.zIndex="",t[0].childNodes[1].style.height="100%",t[0].childNodes[1].style.width="100%",t[0].childNodes[1].style.maxHeight="100%",n){const e=window._channel.getMediaState(n);e&&(e.muted?(t[0].childNodes[1].muted=!0,l()(`.mediasound${n}`).attr("mediaaudioon","0"),l()(`.mediasound${n}`).html("&#xE04F;"),l()(`.mediasound${n}`).addClass("tr")):(t[0].childNodes[1].muted=!1,l()(`.mediasound${n}`).attr("mediaaudioon","1"),l()(`.mediasound${n}`).html("&#xE050;"),l()(`.mediasound${n}`).removeClass("tr")),e.expanded?(t[0].style.position="absolute",t[0].style.width="100%",t[0].style.maxHeight="100%",t[0].style.zIndex="10",l()(`.mediaexpand${n}`).attr("mediaexpandon","1"),l()(`.mediaexpand${n}`).html("&#xE5D1;")):(l()(`.mediaexpand${n}`).attr("mediaexpandon","0"),l()(`.mediaexpand${n}`).html("&#xE56B;")))}t[0].childNodes[2]&&(t[0].childNodes[2].style.maxHeight="100%"),e.stream()!=t[0].childNodes[1].srcObject&&(t[0].childNodes[1].srcObject=e.stream());try{t[0].childNodes[1].paused&&t[0].childNodes[1].play().catch((e=>{}))}catch(e){}}}));else{const t=Xr(e),i=n||e,s=l()(`<div class="mediabox bor" style="position:relative;border-color:#101010;"><div class="frm h100 w100 bor" style="border-color:#101010;">${t}</div><div class="sn pl10 tw tbor p5 w100" style="position:absolute;text-align:left;bottom:10px;">${i}</div></div>`);s.appendTo(l()("#medias")),s[0].style.position="relative",s[0].style.width="14.285714%",s[0].style.height="inherit",s[0].style.maxHeight="20%",s[0].style.padding="0px",s[0].style.right="",s[0].style.bottom="",s[0].style.backgroundColor="",s[0].style.zIndex="",s[0].childNodes[1].style.width="100%",s[0].childNodes[1].style.maxHeight="100%"}})),!0;case 36:case 37:case 38:case 39:case 40:return t.forEach((function(e){const t=window._channel.getUserMedia(e),n=window._channel.getUser(e)?.fullname;if(t)t.forEach((e=>{const t=e.container()?e.container():e.wnd(),n=e.metadata.mediaId;if(-2==n)l()("#youtube-area").width("12.5%"),l()("#youtube-area").css({maxHeight:"20%"});else{if(window.webAudio&&window.webAudio.isStarted()&&window.webAudio.startMedia(n),t.appendTo(l()("#medias")),t[0].style.position="relative",t[0].style.width="12.5%",t[0].style.height="inherit",t[0].style.maxHeight="20%",t[0].style.padding="0px",t[0].style.right="",t[0].style.bottom="",t[0].style.backgroundColor="",t[0].style.zIndex="",t[0].childNodes[1].style.height="100%",t[0].childNodes[1].style.width="100%",t[0].childNodes[1].style.maxHeight="100%",n){const e=window._channel.getMediaState(n);e&&(e.muted?(t[0].childNodes[1].muted=!0,l()(`.mediasound${n}`).attr("mediaaudioon","0"),l()(`.mediasound${n}`).html("&#xE04F;"),l()(`.mediasound${n}`).addClass("tr")):(t[0].childNodes[1].muted=!1,l()(`.mediasound${n}`).attr("mediaaudioon","1"),l()(`.mediasound${n}`).html("&#xE050;"),l()(`.mediasound${n}`).removeClass("tr")),e.expanded?(t[0].style.position="absolute",t[0].style.width="100%",t[0].style.maxHeight="100%",t[0].style.zIndex="10",l()(`.mediaexpand${n}`).attr("mediaexpandon","1"),l()(`.mediaexpand${n}`).html("&#xE5D1;")):(l()(`.mediaexpand${n}`).attr("mediaexpandon","0"),l()(`.mediaexpand${n}`).html("&#xE56B;")))}t[0].childNodes[2]&&(t[0].childNodes[2].style.maxHeight="100%"),e.stream()!=t[0].childNodes[1].srcObject&&(t[0].childNodes[1].srcObject=e.stream());try{t[0].childNodes[1].paused&&t[0].childNodes[1].play().catch((e=>{}))}catch(e){}}}));else{const t=Xr(e),i=n||e,s=l()(`<div class="mediabox bor" style="position:relative;border-color:#101010;"><div class="frm h100 w100 bor" style="border-color:#101010;">${t}</div><div class="sn pl10 tw tbor p5 w100" style="position:absolute;text-align:left;bottom:10px;">${i}</div></div>`);s.appendTo(l()("#medias")),s[0].style.position="relative",s[0].style.width="12.5%",s[0].style.height="inherit",s[0].style.maxHeight="20%",s[0].style.padding="0px",s[0].style.right="",s[0].style.bottom="",s[0].style.backgroundColor="",s[0].style.zIndex="",s[0].childNodes[1].style.width="100%",s[0].childNodes[1].style.maxHeight="100%"}})),!0;case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 48:t.forEach((function(e){const t=window._channel.getUserMedia(e),n=window._channel.getUser(e)?.fullname;if(t)t.forEach((e=>{const t=e.container()?e.container():e.wnd(),n=e.metadata.mediaId;if(-2==n)l()("#youtube-area").width("12.5%"),l()("#youtube-area").css({maxHeight:"16.666666%"});else{if(window.webAudio&&window.webAudio.isStarted()&&window.webAudio.startMedia(n),t.appendTo(l()("#medias")),t[0].style.position="relative",t[0].style.width="12.5%",t[0].style.height="inherit",t[0].style.maxHeight="16.666666%",t[0].style.padding="0px",t[0].style.right="",t[0].style.bottom="",t[0].style.backgroundColor="",t[0].style.zIndex="",t[0].childNodes[1].style.height="100%",t[0].childNodes[1].style.width="100%",t[0].childNodes[1].style.maxHeight="100%",n){const e=window._channel.getMediaState(n);e&&(e.muted?(t[0].childNodes[1].muted=!0,l()(`.mediasound${n}`).attr("mediaaudioon","0"),l()(`.mediasound${n}`).html("&#xE04F;"),l()(`.mediasound${n}`).addClass("tr")):(t[0].childNodes[1].muted=!1,l()(`.mediasound${n}`).attr("mediaaudioon","1"),l()(`.mediasound${n}`).html("&#xE050;"),l()(`.mediasound${n}`).removeClass("tr")),e.expanded?(t[0].style.position="absolute",t[0].style.width="100%",t[0].style.maxHeight="100%",t[0].style.zIndex="10",l()(`.mediaexpand${n}`).attr("mediaexpandon","1"),l()(`.mediaexpand${n}`).html("&#xE5D1;")):(l()(`.mediaexpand${n}`).attr("mediaexpandon","0"),l()(`.mediaexpand${n}`).html("&#xE56B;")))}t[0].childNodes[2]&&(t[0].childNodes[2].style.maxHeight="100%"),e.stream()!=t[0].childNodes[1].srcObject&&(t[0].childNodes[1].srcObject=e.stream());try{t[0].childNodes[1].paused&&t[0].childNodes[1].play().catch((e=>{}))}catch(e){}}}));else{const t=Xr(e),i=n||e,s=l()(`<div class="mediabox bor" style="position:relative;border-color:#101010;"><div class="frm h100 w100 bor" style="border-color:#101010;">${t}</div><div class="sn pl10 tw tbor p5 w100" style="position:absolute;text-align:left;bottom:10px;">${i}</div></div>`);s.appendTo(l()("#medias")),s[0].style.position="relative",s[0].style.width="12.5%",s[0].style.height="inherit",s[0].style.maxHeight="16.666666%",s[0].style.padding="0px",s[0].style.right="",s[0].style.bottom="",s[0].style.backgroundColor="",s[0].style.zIndex="",s[0].childNodes[1].style.width="100%",s[0].childNodes[1].style.maxHeight="100%"}}))}}()}function x(e){const t=window._medias.getOwners(),n=[];for(let e=0;e<t.length;e+=1){const i=t[e],s=window._channel.getUserMedia(i);for(let e=0;e<s.length;e+=1){const t=s[e].metadata.mediaId;n.push(t)}}return window._mediaWndsMap.get(n[e])}function k(e){return window._mediaWndsMap.get(e)}return{update:function(e){let t=!1;if(null!=e&&e.state.size>0){const i=[];for(let t=0;t<window._mediaWndsArray.length;t++){const s=(n=t,window._mediaWndsArray[n]);if(-2!=s){const t=e.state.get(s);t?t.metadata.txEnabled||(E(`WindowCtrl -> update: mediaid ${s} is not enabled anymore (no voice/mediavoice) in the current set, so remove it`),i.push(s)):s!=e.myMediaId&&s!=e.myMediaIdScreen&&(E(`WindowCtrl -> update: did not find mediaid ${s} in the current set, so remove it`),i.push(s))}}if(i.length>0){for(let e=0;e<i.length;e++)g(i[e]);t=!0}e.state.forEach(((n,i)=>{n.newTrack&&(1==n.metadata.mediaVoice?window._channel.setMediaVoiceUser({owner:n.metadata.owner,mediaId:i,mediaVoice:!0}):window._channel.setVoiceUser({owner:n.metadata.owner,mediaId:i,mediaVoice:!1})),i!=e.myMediaId&&i!=e.myMediaIdScreen&&n.metadata.txEnabled&&h(n)&&(t=!0)}))}else{E("WindowCtrl -> update : removing irm windows");const e=[];for(let t=0;t<window._mediaWndsArray.length;t++){const n=x(t);n&&-2!=n.metadata.mediaId&&e.push(n)}for(let t=0;t<e.length;t++){const n=e[t];n&&g(n.metadata.mediaId)}t=!0}var n;t&&S()},startMirror:function(e,t,n){E(`WindowCtrl : startMirror : ${t} ${n}`),"pub"===n?window._channel.setMirror(t):"screen"==n&&(window._channel.setScreen(t),l()("#control-screensharing").css("background-color","#38B2F1"),l()("#control-screensharing-icon").css("color","#00CCFB"),l()("#control-screensharing-label").css("color","#00CCFB"),l()("#control-screensharing-icon").html("&#xE0DF;"),l()("#control-screensharing-label").html(window.i18n.get("you-are-presenting")));const i=e.clone();if(j.stopStreamAudio(i),window._engine.isTxTypeAVConf(n))a=t;else{if(!window._engine.isTxTypeScreen(n))return void E(`WindowCtrl : startMirror : invalid type ${n}`);c=t}h({metadata:{owner:p.ENGINE_NICK,fullname:p.NAME.trim(),mediaId:t,mediaVoice:window._engine.isMediaVoice(),active:window._engine.isTxEnabled(),screen:window._engine.isTxTypeScreen(n),me:!0},stream:i,streamRec:e,newTrack:!0}),S()},stopMirror:function(){E("WindowCtrl : stopMirror"),window._channel.unsetMirror(),d(!1),u(!1),S()},stopMirrorMain:function(e){d(!0,e)},stopMirrorScreen:function(e){window._channel.unsetScreen(),l()("#control-screensharing-icon").css("color","#FFFFFF"),l()("#control-screensharing-label").css("color","#FFFFFF"),l()("#control-screensharing-icon").html("&#xE071;"),l()("#control-screensharing-label").html(window.i18n.get("share-screen")),u(!0,e),S()},muteTxVideo:function(e,t){const n=w(window._engine.isTxTypeAVConf(e));return E(`[muteTxVideo] _txTypeAvconf: ${e} - mediaId: ${n.metadata.mediaId} - screen: ${n.metadata.screen} - mute: ${t}`),n?void 0===n.stream()||null===n.stream()?(E("WindowCtrl : muteTxVideo : Invalid local MediaStream"),!1):null===n.stream().getVideoTracks()||void 0===n.stream().getVideoTracks()||0===n.stream().getVideoTracks().length?(E("WindowCtrl : muteTxVideo : No video track"),!1):(n.stream().getVideoTracks()[0].enabled=!t,!0):(E("no wnd!"),!1)},setMediaWndYoutube:function(e){const t=-2;if(window._channel.setChannelMedia(t),null!=k(-2)&&g(t),window._channel.unsetYoutube(),e){const e=l()('<div id="-2-container"/>');l()('<div id="player"></div>').appendTo(e);const n={container:()=>e,metadata:{mediaId:t,active:1},info:()=>({mediaId:t})};window._mediaWndsMap.set(t,n),window._mediaWndsArray.push(t),window._channel.setYoutube({container:()=>e,metadata:{mediaId:t,active:1},info:()=>({mediaId:t})}),window._channel.mediasUpdatedEvent()}S()},redrawWindows:S,getTxWnd:w,getWnd:x,getWndById:k,onSpeechTextRx:function(e,t){l()(`#${t.id}-cc-overlay`).text(t.text)},redrawWindows_1:v,redrawWindows_2:b,redrawWindows_3:_,redrawWindows_4:y,redrawWindows_n:C}}function ou(e,t){e.prop("disabled",!t)}const ru={CMD:"cmd",SESSIONID:"sessionId",BLOBID:"blobId",TAGACK:"tagAck",MEDIA:"media",SEQ:"seq",TYPE:"type",SIZE:"size",DATA:"data",LIST:"list",COMPLEMENT:"compl"},au={START_REC:"startRec",STOP_REC:"stopRec",MEDIA:"media",NOTIFY:"notify",PING:"ping"};function cu(e){return null!=e&&null!=e}class lu{static messageObj(e,t,n,i,s,o,r,a,c,l){const d={};return d[ru.CMD]=e,d[ru.SESSIONID]=t,cu(n)&&(d[ru.SEQ]=n),cu(i)&&(d[ru.TAGACK]=i),cu(s)&&(d[ru.BLOBID]=s),cu(o)&&(d[ru.TYPE]=o),cu(r)&&(d[ru.SIZE]=r),cu(a)&&(d[ru.DATA]=a),cu(c)&&(d[ru.LIST]=c),cu(l)&&(d[ru.COMPLEMENT]=l),d}static str(e){return JSON.stringify(e)}static strMessage(e,t,n,i,s,o,r,a,c,l){const d=lu;return d.str(d.messageObj(e,t,n,i,s,o,r,a,c,l))}}class du{static startRecMessage(e,t,n,i){return lu.strMessage(au.START_REC,e,t,n,null,null,null,null,null,i)}static stopRecMessage(e,t,n,i,s){return lu.strMessage(au.STOP_REC,e,t,n,i,null,null,null,null,s)}static mediaMessage(e,t,n,i,s,o,r){const a=new FileReader;a.readAsDataURL(e),a.onloadend=()=>{const c=a.result.indexOf("base64");if(c<0)return void console.log("Could not parse base64");const l=a.result.substring(c+6+1),d=lu.strMessage(au.MEDIA,t,i,s,n,e.type,e.size,l,null,o);r(d)}}static notifyMessage(e,t,n,i){return lu.strMessage(au.NOTIFY,t,n,i,null,null,null,e)}static pingMessage(e,t){return lu.strMessage(au.PING,e,t)}}const uu={CMD_ACK:"cmd_ack",MEDIA_LOST_CHUNKS:"media_lost_chunks",MEDIA_RECORDED:"media_recorded",SRV_NOTIFY:"srv_notify"};class hu{static ackMessage(e,t,n,i,s,o,r){const a={cmd:e,code:o||0,msg:r||"ok"};return lu.strMessage(uu.CMD_ACK,t,n,i,s,null,null,a)}static mediaLostChunksMessage(e,t,n){return lu.strMessage(uu.MEDIA_LOST_CHUNKS,e,null,null,t,null,null,null,n)}static mediaRecordedMessage(e,t,n){return lu.strMessage(uu.MEDIA_RECORDED,e,null,null,t,null,null,n)}static srvNotifyMessage(e,t){return lu.strMessage(uu.SRV_NOTIFY,e,null,null,null,null,null,t)}}const pu={Builder:function(){return{startRecMessage:(e,t,n,i)=>du.startRecMessage(e,t,n,i),stopRecMessage:(e,t,n,i,s)=>du.stopRecMessage(e,t,n,i,s),mediaMessage:(e,t,n,i,s,o,r)=>du.mediaMessage(e,t,n,i,s,o,r),notifyMessage:(e,t,n,i)=>du.notifyMessage(e,t,n,i),pingMessage:(e,t)=>du.pingMessage(e,t)}},Types:au},mu={Builder:function(){return{ackMessage:(e,t,n,i,s,o,r)=>hu.ackMessage(e,t,n,i,s,o,r),mediaLostChunksMessage:(e,t,n)=>hu.mediaLostChunksMessage(e,t,n),mediaRecordedMessage:(e,t,n)=>hu.mediaRecordedMessage(e,t,n),srvNotifyMessage:(e,t)=>hu.srvNotifyMessage(e,t)}},Types:uu};class wu{constructor(e,t,n){this.mTimer=null,this.mTag=e,this.mIntervalMs=t,this.mMaxIdleMs=n||this.mIntervalMs,this.mLastCmdSndPendingReplySeq=0,this.mLastCmdSndTs=0}start(e,t){null!=this.mTimer&&(Di.g.log(3,`CmdTimer::start : ${this.mTag} : already started, stopping...`),this.stop()),Di.g.log(3,`CmdTimer::start : ${this.mTag}, intervalMs:${this.mIntervalMs}, maxIdleMs:${this.mMaxIdleMs}`),this.mTimer=setInterval((()=>{const n=e(this.mLastCmdSndTs,this.mLastCmdSndPendingReplySeq),i=Date.now();if(n&&this.mLastCmdSndPendingReplySeq!=n.seq&&(this.mLastCmdSndPendingReplySeq=n.seq,this.mLastCmdSndTs=n.now?n.now:i,Di.g.log(3,`CmdTimer : ${this.mTag} : Sent ts:${this.mLastCmdSndTs}, seq:${this.mLastCmdSndPendingReplySeq}`)),0!=this.mLastCmdSndTs){i<this.mLastCmdSndTs&&(Di.g.log(3,`CmdTimer : ${this.mTag} : now:${i} < mLastCmdSndTs:${this.mLastCmdSndTs}`),this.mLastCmdSndTs=i);const e=i-this.mLastCmdSndTs;e>0&&(Di.g.log(3,`CmdTimer : ${this.mTag} : No response since last cmd:${e} ms (max:${this.mMaxIdleMs} ms)`),e>=this.mMaxIdleMs&&(Di.g.log(3,`CmdTimer : ${this.mTag} : timeout, disconnecting...`),t()))}}),this.mIntervalMs)}stop(){this.mTimer&&(Di.g.log(3,`CmdTimer::stop : ${this.mTag}`),clearInterval(this.mTimer),this.mTimer=null),this.mLastCmdSndPendingReplySeq=0,this.mLastCmdSndTs=0}notifySeq(e){Di.g.log(3,`CmdTimer::notifySeq : ${this.mTag} : seq:${e}, pendingSeq:${this.mLastCmdSndPendingReplySeq}`),e==this.mLastCmdSndPendingReplySeq?(this.mLastCmdSndPendingReplySeq=0,this.mLastCmdSndTs=0):Di.g.log(3,`CmdTimer::notifySeq : ${this.mTag} : Warning seq:${e} other than pending seq:${this.mLastCmdSndPendingReplySeq}`)}}class gu{constructor(e,t,n,i,s,o,r,a,c,l,d,u,h,p,m,w){this.mUrl=t?`wss://${e}:${t}`:`wss://${e}`,this.mConnectedCB=i,this.mDisconnectedCB=s,this.mRecStartedCB=o,this.mRecStoppedCB=r,this.mRecCompleteCB=a,this.mRecNotifyAckCB=c,this.mSrvNotifyCB=l,this.mAckErrorCB=d,this.mPingTimeoutCB=u,this.mLostChunksCB=h,this.mStartRecFailedCB=p,this.mFlagSend=1,this.mFlagResendNotAck=2,this.mFlagResendLost=4,this.mReconnectTimer=null,this.mPingCtrl=new wu("Ping",w),this.mStartRecCtrl=new wu("StartRec",w),this.mWS=null,this.mConnecting=!1,this.mConnected=!1,this.mStartRecMinRetryMs=1e3,this.setRecState(!0),this.mSeqCtrl=0,this.mDisconnectedByUser=!1,this.mPendingRecStartSessionId=null,this.mConnFails=0,this.mMaxConnRetries=m&&m>=0?m:0,this.mMsgBuilder=pu.Builder(),this.mStartRecExtraInfo=null,this.mStopRecExtraInfo=null,n&&this.connect()}cancelReconnect(){this.mReconnectTimer&&(clearTimeout(this.mReconnectTimer),this.mReconnectTimer=null)}handleConnected(){Di.g.log(3,"StreamerWS::handleConnected"),this.stopTimers(),this.mConnecting=!1,this.mConnected=!0,this.mConnFails=0,this.connectedCB&&this.mConnectedCB(),this.mPendingRecStartSessionId&&(this.sendStartRec(this.mPendingRecStartSessionId),this.mPendingRecStartSessionId=null)}sendMedia(e,t,n,i,s,o){this.mMsgBuilder.mediaMessage(e,t,n,i,null,s,(e=>{this.sendWS(e),o&&o()}))}handleMessage(e){const t=JSON.parse(e.data);switch(t.cmd){case mu.Types.CMD_ACK:{const e=0==t.data.code;switch(e||(Di.g.log(3,`StreamerWS::handleMessage : ACK ERROR : request seq:${t.seq}, msg:${t.data.msg} (code:${t.data.code})`),this.mAckErrorCB(t.seq,t.data.msg,t.data.code)),t.data.cmd){case pu.Types.PING:this.mPingCtrl.notifySeq(t.seq);break;case pu.Types.START_REC:const n=1==(1&t.tagAck);this.setRecState(!e,e),this.mRecStartedCB&&this.mRecStartedCB(t.sessionId,t.data.code,n),this.mStartRecCtrl.stop(),this.mPingCtrl.stop(),e&&(Di.g.log(3,`StreamerWS::handleMessage : StartRec ACK : sessionId:${t.sessionId}, seq:${t.seq}, reconnect:${n}`),this.mPingCtrl.start(((e,n)=>0==n?(this.sendPing(t.sessionId),{seq:this.mSeqCtrl}):null),(()=>{Di.g.log(3,"StreamerWS : Ping timeout, disconnecting..."),this.mPingTimeoutCB(),this.disconnectWS()})));break;case pu.Types.STOP_REC:this.mRecStoppedCB&&this.mRecStoppedCB(t.sessionId,t.data.code),this.mPingCtrl.stop();break;case pu.Types.NOTIFY:this.mRecNotifyAckCB&&this.mRecNotifyAckCB(t.sessionId,t.seq,t.data.code);case pu.Types.MEDIA:}}break;case mu.Types.MEDIA_LOST_CHUNKS:this.mLostChunksCB();break;case mu.Types.MEDIA_RECORDED:this.mRecCompleteCB&&this.mRecCompleteCB(t.sessionId,t.blobId,t.data);break;case mu.Types.SRV_NOTIFY:this.mSrvNotifyCB&&this.mSrvNotifyCB(t.sessionId,t.data)}}handleError(e){Di.g.log(3,"StreamerWS::handleError")}handleDisconnected(){if(Di.g.log(3,`StreamerWS::handleDisconnected : byUser:${this.mDisconnectedByUser}`),!this.mDisconnectedByUser){const e=this.mMaxConnRetries-this.mConnFails;if(e>0){this.mConnFails++;let e=2*this.mConnFails;e>10&&(e=10),Di.g.log(3,`StreamerWS::handleDisconnected : connection closed, reconnecting ${this.mConnFails}/${this.mMaxConnRetries} in ${e} seconds...`),this.mReconnectTimer=setTimeout((()=>{this.connect()}),1e3*e)}this.mDisconnectedCB&&this.mDisconnectedCB(e)}this.mConnecting=!1,this.mConnected=!1,this.setRecState(!1)}setRecState(e,t=!1,n=null){this.mStopped=e,this.mStartRecAck=t,this.mStartRecCmdTs=n,this.mStopped&&(this.mStartRecAck=!1,this.mStartRecCmdTs=null)}sendStartRec(e,t=!1){const n=t?1:0,i=this.mMsgBuilder.startRecMessage(e,++this.mSeqCtrl,n,this.mStartRecExtraInfo);this.sendWS(i);const s=Date.now(),o=this.mSeqCtrl;this.setRecState(!1,!1,s),this.mStartRecCtrl.start(((e,t)=>({now:s,seq:o})),(()=>{Di.g.log(3,"StreamerWS : StartRec timeout, disconnecting..."),this.mStartRecFailedCB(),this.disconnectWS()})),Di.g.log(3,`StreamerWS::sendStartRec : ${i}`)}sendStopRec(e,t){const n=this.mMsgBuilder.stopRecMessage(e,++this.mSeqCtrl,null,t,this.mStopRecExtraInfo);this.sendWS(n),this.setRecState(!0),Di.g.log(3,`StreamerWS::sendStopRec : ${n}`)}sendPing(e){const t=this.mMsgBuilder.pingMessage(e,++this.mSeqCtrl);this.sendWS(t)}sendWS(e){this.mWS&&this.mWS.send(e)}connect(){Di.g.log(3,`StreamerWS::connect : connecting to ${this.mUrl}`),this.stopTimers(),this.mConnecting=!0,this.mDisconnectedByUser=!1,this.mWS=new WebSocket(this.mUrl),this.mWS.onopen=e=>{this.handleConnected()},this.mWS.onmessage=e=>{this.handleMessage(e)},this.mWS.onerror=e=>{this.handleError(e)},this.mWS.onclose=e=>{this.handleDisconnected()}}startRec(e,t){this.mStartRecExtraInfo=t,this.mConnected?this.sendStartRec(e):(this.mConnecting||this.connect(),this.mPendingRecStartSessionId=e)}stopRec(e,t){this.mStopRecExtraInfo=t,this.mConnected?this.sendStopRec(e):Di.g.log(3,"StreamerWS::stopRec : not started, ignoring...")}media(e,t,n,i){this.mStopped?Di.g.log(3,"StreamerWS::media : stopped, ignoring..."):this.mConnected?this.mStartRecAck?this.sendMedia(e.data,t,n,i,this.mFlagSend,(()=>{e.last&&this.stopRec(t,e.extraInfo)})):(null==this.mStartRecCmdTs||Date.now()-this.mStartRecCmdTs>=this.mStartRecMinRetryMs)&&(Di.g.log(3,"StreamerWS::media : StartRec not ack, resending cmd..."),this.sendStartRec(t,!0)):Di.g.log(3,`StreamerWS::media : not connected, ignoring (sessionId:${t}, blobId:${n}, seq:${i})`)}notify(e,t){const n=++this.mSeqCtrl,i=this.mMsgBuilder.notifyMessage(e,t,n,null);return this.sendWS(i),n}disconnect(){Di.g.log(3,"StreamerWS::disconnect"),this.mDisconnectedByUser=!0,this.disconnectWS(),this.mConnecting=!1,this.mConnected=!1,this.setRecState(!0)}disconnectWS(){this.stopTimers(),this.mWS&&(this.mWS.close(),this.mWS=null)}stopTimers(){this.cancelReconnect(),this.mPingCtrl.stop(),this.mStartRecCtrl.stop()}}function fu(e,t,n,i,s,o,r,a,c,l,d,u,h,p,m,w){const g=new gu(e,t,n,i,s,o,r,a,c,l,d,u,h,p,m,w);return{startRec:(e,t)=>{g.startRec(e,t)},media:(e,t,n,i)=>{g.media(e,t,n,i)},notify:(e,t)=>g.notify(e,t),disconnect:()=>{g.disconnect()}}}class vu{constructor(e,t,n,i,s){this.mChunkCB=e,this.mSegmentLenMs=t,this.mBitrateKbps=i,this.mMimeType=n||null,this.mRecId=ir(),Di.g.log(3,`Recorder : creating (recId:${this.mRecId}, segmentLenMs:${t}, bitrateKbps:${i})`),this.updateStream(s)}updateStream(e){this.mStarted=!1,this.mBlobId=ir(),this.mSeq=0;const t=null!=this.mMimeType;if(!t){const e=["video/webm;codecs=h264,opus","video/webm;codecs=vp9,opus","video/webm;codecs=vp8,opus","video/webm","video/mp4"];for(var n in e)if(MediaRecorder.isTypeSupported(e[n])){this.mMimeType=e[n];break}}const i=this.mMimeType;Di.g.log(3,`Recorder : updateStream : mimeType:${i}, requested by client:${t}`),this.mRecorder=new MediaRecorder(e,{mimeType:i,videoBitsPerSecond:1024*this.mBitrateKbps}),this.mRecorder.ondataavailable=e=>{const t=++this.mSeq,n=!this.mStarted;Di.g.log(3,`Recorder : Chunk Received : ${e.data.size} bytes, recId:${this.mRecId}, blobId:${this.mBlobId}, seq:${t}, stopped:${n}, mimeType:${i}`),this.mChunkCB(e,this.mRecId,this.mBlobId,t,n,i)}}start(){if(this.mStarted)return Di.g.log(3,"Recorder : start : already started"),!1;Di.g.log(3,"Recorder : start");const e=this.mSegmentLenMs&&this.mSegmentLenMs>0?this.mSegmentLenMs:void 0;this.mRecorder.start(e),this.mStarted=!0}stop(){this.mRecorder&&(this.mRecorder.stop(),this.mRecorder=null),this.mStarted=!1}started(){return this.mStarted}recId(){return this.mRecId}mimeType(){return this.mMimeType}}function bu(e){return{update:t=>{e.update(t)},clear:()=>{e.clear()},release:()=>{e.release()},getStream:()=>e.getStream()}}class _u{constructor(e,t,n,i,s){this.mSourceId=e,this.mStream=t,this.mSource=n.createMediaStreamSource(t),i&&this.mSource.connect(i),this.mSource.connect(s),Di.g.log(3,`AudioSourceInfo : audio source ${this.mSourceId} connected`)}release(){this.mSource&&(this.mSource.disconnect(),this.mSource=null),this.mStream=null,Di.g.log(3,`AudioSourceInfo : release : audio source ${this.mSourceId} disconnected`)}match(e){const t=e.getAudioTracks(),n=this.mStream.getAudioTracks();if(t.length!=n.length)return!1;for(let e=0;e<t.length;e++){const i=n[e],s=t[e];if(i!=s||i.id!=s.id)return!1}return!0}id(){return this.mSourceId}}class yu{constructor(){const e=window.AudioContext||window.webkitAudioContext;this.mAudioContext=new e,this.mAudioDestination=this.mAudioContext.createMediaStreamDestination(),this.mUseGainNode=!0,this.mGainNode=null,this.mAudioSources=[],this.mAudioStream=null,this.mCapturingAudioStream=!1,!0===this.mUseGainNode&&(this.mGainNode=this.mAudioContext.createGain(),this.mGainNode.connect(this.mAudioContext.destination),this.mGainNode.gain.value=0)}getStream(){return this.mAudioDestination.stream}update(e){Di.g.log(3,"AudioMixer : update");let t=!1;for(let n=0;n<e.length;n++){const i=e[n].stream();if(i&&i.getAudioTracks().length>0){t=!0;break}}t||this.mAudioStream?(t&&this.mAudioStream&&(Di.g.log(3,"AudioMixer : update : audio included in selected set, stopping owned audio stream..."),this.stopOwnedAudioStream()),this.updateInternal(e)):this.mCapturingAudioStream?Di.g.log(3,"AudioMixer : update : waiting audio stream..."):(this.mCapturingAudioStream=!0,Di.g.log(3,"AudioMixer : update : no audio track, requesting..."),navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((t=>{this.mAudioStream=Jd(t,0),this.mCapturingAudioStream?(this.mCapturingAudioStream=!1,Di.g.log(3,"AudioMixer : update : got audio stream"),t.getAudioTracks()[0].enabled=!1,this.updateInternal(e)):(Di.g.log(3,"AudioMixer : update : got audio stream, not necessary anymore..."),this.stopOwnedAudioStream())})).catch((e=>{this.mCapturingAudioStream=!1,Di.g.log(3,`AudioMixer : update : Error :getUserMedia msg:${e.message}, stack:${e.stack}`)})))}updateInternal(e){Di.g.log(3,"AudioMixer : updateInternal");const t=[],n=[],i=this.mAudioStream?[...e,this.mAudioStream]:e;for(let e=0;e<i.length;e++){const s=i[e],o=s.stream();if(o&&o.getAudioTracks().length>0){Di.g.log(3,`AudioMixer : updateInternal : checking selected media : mediaId:${s.mediaId()}, me:${s.isMe()}`);let e=!1;for(let t=0;t<this.mAudioSources.length;t++){const i=this.mAudioSources[t];if(i.match(o)){e=!0,n.push(i),Di.g.log(3,`AudioMixer : updateInternal : selected media matches old audioSource : id:${i.id()}`);break}}if(!e){const e=new _u(s.mediaId(),o,this.mAudioContext,this.mGainNode,this.mAudioDestination);t.push(e)}}else Di.g.log(3,`AudioMixer : updateInternal : mediaId:${s.mediaId()}, me:${s.isMe()}, selectedMediaStream:${o} (no stream / audio tracks)`)}for(let e=0;e<this.mAudioSources.length;e++){const t=this.mAudioSources[e];let i=!1;for(let e=0;e<n.length;e++)if(n[e]===t){i=!0;break}i||t.release()}this.mAudioSources=[...n,...t]}release(){Di.g.log(3,"AudioMixer : release"),this.mAudioSources.forEach((e=>{e.release()})),this.mAudioSources=[],this.mGainNode&&(this.mGainNode.disconnect(),this.mGainNode=null),this.mAudioDestination&&(this.mAudioDestination.disconnect(),this.mAudioDestination=null),this.mAudioContext&&(this.mAudioContext.close(),this.mAudioContext=null),this.stopOwnedAudioStream()}stopOwnedAudioStream(){if(this.mAudioStream){Di.g.log(3,"AudioMixer : stopOwnedAudioStream : stopping owned audio...");const e=this.mAudioStream.stream();er.stopStreamAudio(e),this.mAudioStream=null}this.mCapturingAudioStream=!1}}class Cu{constructor(e,t,n,i,s){Di.g.log(3,`VideoMixer : fps:${e}, width:${t}, height:${n}`),this.mFirstRedraw=!0,this.mPullVideoFramesCB=i,this.mCanvas=Yd.getCanvas(t,n),this.mGTimer=s;const o=1e3/e;this.mGTimer.addListener(this,(e=>{this.onTimer(e,o)})),this.mNextRender=0}onTimer(e,t){0===this.mNextRender&&(this.mNextRender=e),e>=this.mNextRender&&(this.redraw(),this.mNextRender+=t)}redraw(){const e=this.mPullVideoFramesCB();this.mCanvas.ctx.clearRect(0,0,this.mCanvas.width,this.mCanvas.height),e.forEach((e=>{this.mCanvas.ctx.drawImage(e.video,e.offsetX,e.offsetY,e.dstVideoW,e.dstVideoH)}))}getStream(){if(!this.mCanvasCaptureStream){let e=null,t=null;const n=this.mCanvas.el;"captureStream"in n?t=n.captureStream():"mozCaptureStream"in n?t=n.mozCaptureStream():Di.g.log(3,"VideoMixer : Error : captureStream : unsupported"),t&&(e=new MediaStream,t.getTracks().filter((function(e){return"video"===e.kind})).forEach((function(t){e.addTrack(t)}))),this.mCanvasCaptureStream=e}return this.mCanvasCaptureStream}update(e){this.mFirstRedraw&&(this.mFirstRedraw=!1,this.redraw())}release(){Di.g.log(3,"VideoMixer : release"),this.mCanvasCaptureStream&&(er.stopStream(this.mCanvasCaptureStream),this.mCanvasCaptureStream=null),this.mCanvas=null,this.mGTimer.removeListener(this)}}class Su{constructor(e,t,n,i,s){this.mVideoMixer=function(e,t,n,i,s){return bu(new Cu(e,t,n,i,s))}(e,t,n,i,s),this.mAudioMixer=bu(new yu)}getStream(){const e=this.mVideoMixer.getStream(),t=this.mAudioMixer.getStream();return t&&t.getTracks().filter((function(e){return"audio"===e.kind})).forEach((function(t){e.addTrack(t)})),e}update(e){this.mVideoMixer.update(e),this.mAudioMixer.update(e)}release(){Di.g.log(3,"MixerCtrl : release"),this.mAudioMixer.release(),this.mVideoMixer.release()}}class Eu{constructor(){this.mLayoutManager=null,this.mMixer=null,this.mStarted=!1}setParams(e,t,n){if(!e||!e.isOk()||!t)return Di.g.log(3,"StreamMixerLayout::setParams : invalid input params"),!1;const i=e.width(),s=e.height();return Di.g.log(3,`StreamMixerLayout::setParams : ${i}x${s} @ ${t}fps`),null!=this.mMixer?(Di.g.log(3,"StreamMixerLayout::setParams : cannot set rec params after mixer is created"),!1):(this.mLayoutManager=e,this.mMixer=function(e,t,n,i,s){return bu(new Su(e,t,n,i,s))}(t,i,s,(()=>this.mLayoutManager.frames()),n),!0)}initOk(){return this.mLayoutManager&&this.mLayoutManager.isOk()}update(){this.started()?(Di.g.log(3,"StreamMixerLayout::update"),this.mLayoutManager.selectedAll((e=>{this.mMixer.update(e)}))):Di.g.log(3,"StreamMixerLayout::update : not started")}start(e){Di.g.log(3,"StreamMixerLayout : start"),null!=this.mMixer?(this.mStarted=!0,this.mLayoutManager.selectedAll((t=>{this.mMixer.update(t);const n=this.mMixer.getStream();n?(Di.g.log(3,"StreamMixerLayout : start : received stream..."),e&&e(n)):Di.g.log(3,"StreamMixerLayout : start : stream is null, not starting...")}))):Di.g.log(3,"StreamMixerLayout : start : not ready")}started(){return this.mStarted}stop(){this.mMixer&&(this.mMixer.release(),this.mMixer=null),this.mLayoutManager&&(this.mLayoutManager.reset(),this.mLayoutManager=null),this.mStarted=!1}}class xu{constructor(e,t,n,i,s,o,r,a,c,l,d,u,h,p,m,w,g){this.mWorker=new rl(g,(e=>{switch(e.type){case"connected":this.handleResponseConnected(e);break;case"disconnected":this.handleResponseDisconnected(e);break;case"recstarted":this.handleResponseRecStarted(e);break;case"recstopped":this.handleResponseRecStopped(e);break;case"reccomplete":this.handleResponseRecComplete(e);break;case"recnotifyack":this.handleResponseRecNotifyAck(e);break;case"srvnotify":this.handleResponseSrvNotify(e);break;case"ackerror":this.handleResponseAckError(e);break;case"pingtimeout":this.handleResponsePingTimeout(e);break;case"lostchunks":this.handleResponseLostChunks(e);break;case"startrecfailed":this.handleResponseStartRecFailed(e)}})),this.mConnectedCB=i,this.mDisconnectedCB=s,this.mRecStartedCB=o,this.mRecStoppedCB=r,this.mRecCompleteCB=a,this.mRecNotifyAckCB=c,this.mSrvNotifyCB=l,this.mAckErrorCB=d,this.mPingTimeoutCB=u,this.mLostChunksCB=h,this.mStartRecFailedCB=p,this.mWorker.post({type:"init",domain:e,port:t,autoConnect:n,maxConnRetries:m,maxCmdIdleMs:w})}request(e,t={}){this.mWorker.post({type:e,...t})}notify(e,t){this.request("notify",{dataObj:e,sessionId:t})}startRec(e,t){this.request("startrec",{sessionId:e,extraInfo:t})}media(e,t,n,i){this.request("media",{blob:e,sessionId:t,blobId:n,seq:i})}disconnect(){this.request("disconnect")}handleResponseConnected(){this.mConnectedCB()}handleResponseDisconnected({attemptsRemaining:e}){this.mDisconnectedCB(e)}handleResponseRecStarted({sessionId:e,code:t,reconnect:n}){this.mRecStartedCB(e,t,n)}handleResponseRecStopped({sessionId:e,code:t}){this.mRecStoppedCB(e,t)}handleResponseRecComplete({sessionId:e,blobId:t,suffix:n}){this.mRecCompleteCB(e,t,n)}handleResponseRecNotifyAck({sessionId:e,seq:t,code:n}){this.mRecNotifyAckCB(e,t,n)}handleResponseSrvNotify({sessionId:e,data:t}){this.mSrvNotifyCB(e,t)}handleResponseAckError({seq:e,msg:t,code:n}){this.mAckErrorCB(e,t,n)}handleResponsePingTimeout(){this.mPingTimeoutCB()}handleResponseLostChunks(){this.mLostChunksCB()}handleResponseStartRecFailed(){this.mStartRecFailedCB()}}function ku(e,t,n,i,s,o,r,a,c,l,d,u,h,p,m,w,g){const f=new xu(e,t,n,i,s,o,r,a,c,l,d,u,h,p,m,w,g);return{notify:(e,t)=>{f.notify(e,t)},startRec:(e,t)=>{f.startRec(e,t)},media:(e,t,n,i)=>{f.media(e,t,n,i)},disconnect:()=>{f.disconnect()}}}class Mu{constructor(){this.mMixer=new Eu,this.mRecorder=null,this.mDisconnectTimer=null,this.mSendStopRecOnLastBlob=!0,this.mBitrateKbps=0,this.mSegmentLenMs=1e3,this.mChunks=[],this.mSessionId=null,this.mRecStartExtraInfoCB=null,this.mRecStopExtraInfoCB=null,this.mStreamer=null,this.mLocalRecSave=!1,this.mLocalRecCompleteCB=null,this.mMimeType=null}setRecParams(e,t,n,i,s){return n?(this.mMixer.setParams(e,t,s),this.mBitrateKbps=n,this.mMimeType=i||null,!0):(Di.g.log(3,"RecorderCtrl::setRecParams : invalid input params"),!1)}startRecorder(){this.mMixer.start((e=>{this.startRecorderInternal(e)}))}startRecorderInternal(e){Di.g.log(3,"RecorderCtrl : startRecorderInternal"),this.mSendStopRecOnLastBlob=!0;const t=this.mSessionId;this.mRecorder=function(e,t,n,i,s){const o=new vu(e,t,n,i,s);return{start:()=>{o.start()},stop:()=>{o.stop()},started:()=>o.started(),recId:()=>o.recId(),mimeType:()=>o.mimeType()}}(((e,n,i,s,o,r)=>{if(this.mSaveLocalRec&&this.mChunks.push(e.data),o){if(Di.g.log(3,"RecorderCtrl : stopped recording"),this.mLocalRecCompleteCB&&this.mLocalRecSave&&this.mChunks.length>0)if(this.mChunks.length>1){const e=new Blob(this.mChunks,{type:r});this.mLocalRecCompleteCB(e)}else this.mLocalRecCompleteCB(this.mChunks[0]);this.mRecorder&&n==this.mRecorder.recId()&&(Di.g.log(3,`RecorderCtrl : setting this.mRecorder (recId:${n}) to null`),this.mRecorder=null)}if(this.mStreamer){const n={data:e.data,last:o,extraInfo:o&&this.mSendStopRecOnLastBlob?this.mRecStopExtraInfoCB():null};this.mStreamer.media(n,t,i,s)}}),this.mSegmentLenMs,this.mMimeType,this.mBitrateKbps,e),this.mRecorder.start()}disconnect(e){if(e)this.mDisconnectTimer&&(clearTimeout(this.mDisconnectTimer),this.mDisconnectTimer=null),this.mStreamer&&(Di.g.log(3,"RecorderCtrl : disconnect : disconnecting now"),this.mStreamer.disconnect(),this.mStreamer=null,this.mRecStartExtraInfoCB=null,this.mRecStopExtraInfoCB=null);else if(this.mStreamer&&null==this.mDisconnectTimer){const e=1e4;Di.g.log(3,`RecorderCtrl : disconnect : disconnecting in ${e/1e3} seconds`),this.mDisconnectTimer=setTimeout((()=>{this.disconnect(!0)}),e)}}stopRecorder(e){Di.g.log(3,"RecorderCtrl : stopRecorder");let t=!1;this.mRecorder&&(e&&(Di.g.log(3,`RecorderCtrl : stopRecorder : not sending 'StopRec' command due to application request (recId:${this.mRecorder.recId()})`),this.mSendStopRecOnLastBlob=!1),this.mRecorder.stop(),t=!0),this.mMixer.stop(),this.disconnect(e||!t)}setLocalRec(e,t){this.mLocalRecSave=!0===e,this.mLocalRecCompleteCB=t}setRemoteRec(e,t,n,i,s,o,r,a,c,l,d,u,h,p,m,w,g,f){if(this.disconnect(!0),e&&n){this.mSessionId=n,this.mRecStartExtraInfoCB=o,this.mRecStopExtraInfoCB=r;const v=!0,b=f?ku:fu,_=f?"/js/streamer-worker-script.js":null;this.mStreamer=b(e,t,v,(()=>{Di.g.log(3,"RecorderCtrl : recording connected")}),(e=>{Di.g.log(3,`RecorderCtrl : recording disconnected (reconnect attempts remaining:${e})`),0==e&&this.stopRecorder(!0),d&&d(0===e)}),((e,t,n)=>{Di.g.log(3,`RecorderCtrl : received backend --- START REC --- reply : sessionId:${e}, code:${t}, reconnect:${n}`),this.startRecorder(),i&&i(e,t,n)}),((e,t)=>{Di.g.log(3,`RecorderCtrl : received backend --- STOP REC --- reply : sessionId:${e}, code:${t}`),s&&s(e,t)}),((e,t,n)=>{a&&a(e,t,n)}),((e,t,n)=>{c&&c(e,t,n)}),((e,t)=>{l&&l(e,t)}),((e,t,n)=>{u&&u(e,t,n)}),(()=>{h&&h()}),(()=>{p&&p()}),(()=>{m&&m()}),w,g,_)}else Di.g.log(3,"RecorderCtrl::setRemoteRec : invalid input parameters, ignoring...")}remoteRecNotify(e){return this.started()?this.mStreamer.notify(e,this.mSessionId):0}start(){this.mMixer.initOk()?(Di.g.log(3,`RecorderCtrl::start : segmentLenMs:${this.mSegmentLenMs}, bitrateKbps:${this.mBitrateKbps} (${this.mStreamer?this.mLocalRecSave?"remote/local":"remote":"local"})`),this.mStreamer?this.mStreamer.startRec(this.mSessionId,this.mRecStartExtraInfoCB()):this.startRecorder()):Di.g.log(3,"RecorderCtrl::start : cannot start, layout manager not initialized...")}stop(e){Di.g.log(3,"RecorderCtrl::stop"),this.stopRecorder(e)}update(){this.started()?(Di.g.log(3,"RecorderCtrl::update"),this.mMixer.update()):Di.g.log(3,"RecorderCtrl::update : not started")}started(){return this.mRecorder&&this.mRecorder.started()}mixer(){return this.mMixer}}class Tu{constructor(e){for(var t in this.mIds=e,this.mWidth=0,this.mHeight=0,this.mLayoutList=[],this.mLayoutMap=new Map,this.mUpdateCB=null,this.mIds)if(Object.prototype.hasOwnProperty.call(this.mIds,t)){const e=this.mIds[t],n={id:e,rect:null,layout:null};this.mLayoutMap.set(e,n),this.mLayoutList.push(n)}}init(e,t){return 0!=this.mWidth||0!=this.mHeight?(Di.g.log(3,"LayoutManager : init : already initialized"),!1):(this.mWidth=e,this.mHeight=t,!0)}setUpdateCB(e){this.mUpdateCB=e}reset(){this.mWidth=0,this.mHeight=0,this.mLayoutList.forEach((e=>{e.layout&&(e.layout.stop(),e.layout=null,e.rect=null)}))}isOk(){return 0!=this.mWidth&&0!=this.mHeight&&this.mLayoutList.length>0}selectedAll(e){const t=[],n=this.mLayoutList.slice();let i=0;for(let s=0;s<n.length;s++){const o=n[s];o.layout?o.layout.update((s=>{t.push(...s),++i==n.length&&e(t)})):++i==n.length&&e(t)}}frames(){const e=[];return this.mLayoutList.forEach((t=>{t.layout&&e.push(...t.layout.videoFrames())})),e}width(){return this.mWidth}height(){return this.mHeight}updateRect(e){const t=e.layout,n=e.rect;if(t&&n){const e=t.rect();n.x==e.x&&n.y==e.y&&n.width==e.width&&n.height==e.height||t.setRect(n.x,n.y,n.width,n.height)}}setLayout(e,t){Di.g.log(3,`LayoutManager : setLayout : layoutId:${e}, layout:${t?"on":"off"}`);const n=this.layoutInfo(e);if(n){let i=!1;t!=n.layout&&(n.layout&&n.layout.stop(),n.layout=t,i=!0),this.updateRect(n);for(let n=0;n<this.mLayoutList.length;n++)if(this.mLayoutList[n].id==e){this.mLayoutList[n].layout=t;break}this.updateLayout(),i&&this.mUpdateCB()}else Di.g.log(3,`LayoutManager : setLayout : layoutId:${e} not found`)}setLayoutRect(e,t,n,i,s){const o=this.layoutInfo(e);o?(o.rect=Yd.rect(t,n,i,s),this.updateRect(o)):Di.g.log(3,`LayoutManager : setLayoutRect : layoutId:${e} not found`)}layoutInfo(e){return this.mLayoutMap.get(e)}layout(e){const t=this.layoutInfo(e);return t?t.layout:null}updateLayout(){}}class Iu{constructor(e,t,n,i,s=1e3){this.mLayoutManager=e,this.mLayoutId=t,this.mModel=i,this.mCanvas=null,this.mRedrawIntervalMs=s,this.mTimerRedraw=null,this.mLayout=Xd(new tu(n,this))}update(){const e=this.mLayoutManager.layout(this.mLayoutId),t=e.width(),n=e.height();return null!=this.mCanvas&&this.mCanvas.width==t&&this.mCanvas.height==n||(this.mCanvas=Yd.getCanvas(t,n)),null==this.mTimerRedraw&&this.mRedrawIntervalMs&&this.mRedrawIntervalMs>0&&(this.mTimerRedraw=setInterval((()=>{this.redraw()}),this.mRedrawIntervalMs)),this.redraw(),Jd(null,null,null,null,null,this.mCanvas.jEl)}notify(e){this.isReady()&&this.mModel.notify(e)}stop(){this.mCanvas=null,this.mTimerRedraw&&(clearInterval(this.mTimerRedraw),this.mTimerRedraw=null)}isReady(){return null!=this.mCanvas}enableLayout(e){this.mLayoutManager.setLayout(this.mLayoutId,e?this.mLayout:null)}getSelected(e){e([this.update()])}clear(){this.mModel.clear()}redraw(){}}class Ru{constructor(e=100,t){this.mMessagesMax=e,this.mMessages=[],this.mDefDuration=t}notify(e){if(this.mDefDuration){for(;this.mMessages.length>0;){const e=this.mMessages[0];if(!(Date.now()>e.expiration))break;Di.g.log(3,"MessageQueue : notify : removing expired message"),this.mMessages.shift()}const t=e.duration?e.duration:this.mDefDuration;t&&(e.expiration=Date.now()+t)}this.mMessages.push(e),this.mMessages.length>this.mMessagesMax&&this.mMessages.shift()}loopReverse(e){const t=this.mMessages.length;if(t>0)for(let n=t-1;n>=0&&e(this.mMessages[n]);n--);}clear(){this.mMessages=[]}}class Au extends Iu{constructor(e,t,n,i){super(e,t,n,i),this.mXMin=0,this.mXMax=0,this.mYMin=0,this.mCentered=!1,this.mRows=[],this.mRowWords=[],this.mCurrRow="",this.mCurrRowWidth=0,this.mMsgRows=0,this.mAddedRowsHeight=0,this.mTextH=0,this.mMessageSpacing=0,this.mMaxSourceWidth=0,this.mBGColor="black",this.mTextColor="white"}redraw(){this.setCanvasParams(),this.mCanvas.ctx.fillStyle=this.mBGColor,this.mCanvas.ctx.fillRect(0,0,this.mCanvas.width,this.mCanvas.height),this.mCanvas.ctx.fillStyle=this.mTextColor,this.mRows=[],this.mRowWords=[],this.mAddedRowsHeight=0,this.mModel.loopReverse((e=>{this.mData=e,this.mWords=this.mModel.text(this.mData).split(" "),this.mMsgRows=0,this.mWordsRead=0,this.mContinueLoop=!0,this.setFont(this.font(e)),this.setLabel(),this.setCurrRow();for(let e=0;e<this.mWords.length;e++)this.setRows(this.mWords[e]);return this.mContinueLoop})),this.mRows.length>0&&(this.mY=this.mCanvas.height-this.mTextH-this.mYMin,this.mRows.every((e=>{for(let t=e.length-1;t>=0;t--)if(!this.drawRow(e[t]))return!1;return this.mY-=this.mMessageSpacing,!0})))}setLabel(){let e=this.mData.source;const t=this.txtWidth(e);t>this.mMaxSourceWidth&&(e=`${this.substringToFit(e,this.mMaxSourceWidth,t).substr}...`);const n=this.mModel.label(this.mData,e);this.mLabel=n||"",this.mLabelWidth=this.txtWidth(this.mLabel)}drawRow(e){if(this.mY-this.mTextH-this.mYMin>=0){this.setFont(e.font);const t=`${e.label}${e.text}`;return this.mCanvas.ctx.fillText(t,e.x,this.mY),this.onRowDrawn(t,this.mY,e),this.mY-=this.mTextH,!0}return!1}onRowDrawn(e,t,n){}addRow(){if(0==this.mCurrRow.length&&0==this.mLabel.length)return void Di.g.log(3,"TextViewScroller : addRow : no row content add");0==this.mCurrRow.length&&Di.g.log(3,"TextViewScroller : addRow : Warning : mCurrRow empty"),0==this.mMsgRows&&this.mRows.push([]),this.mAddedRowsHeight+=this.mTextH,this.mAddedRowsHeight>=this.mCanvas.height-this.mYMin&&(this.mContinueLoop=!1);let e=this.mXMin;const t=0==this.mMsgRows?this.mLabel:"",n=this.mCurrRow,i=this.mCanvas.ctx.font;this.mCentered&&(e+=((0!=Math.floor(this.mXMax)?this.mXMax:this.mCanvas.width)-e-(t.length>0?this.mLabelWidth:0)-this.mCurrRowWidth)/2),this.mRows[this.mRows.length-1].push({label:t,text:n,x:e,font:i,width:this.mCurrRowWidth,data:this.mData,msgRows:this.mMsgRows}),this.mMsgRows++,this.setCurrRow()}txtWidth(e){return Yd.getCanvasTextWidth(this.mCanvas,e)}setRows(e){this.mWordsRead++;const t=this.mWordsRead==this.mWords.length,n=this.calcRowPreview(e),i=this.calcMaxRowWidth();if(n.width<=i)return this.setCurrRow(n.str),void(t&&this.addRow());this.mCurrRow.length>0&&this.addRow(),this.setCurrRow(e);let s={};do{s=this.substringToFit(this.mCurrRow,this.calcMaxRowWidth(),this.mCurrRowWidth),s.remainder.length>0&&(this.setCurrRow(s.substr),this.addRow(),this.setCurrRow(s.remainder))}while(s.remainder.length>0);t&&(this.mCurrRow.length>0&&this.addRow(),this.mAddedRowsHeight+=this.mMessageSpacing)}calcMaxRowWidth(){const e=this.mCanvas.width;let t=e-this.mXMin;return 0!=Math.floor(this.mXMax)&&(this.mXMax>e&&(Di.g.log(3,`TextViewScroller : calcMaxRowWidth : xMax:${this.mXMax} > totalWidth:${e}`),this.mXMax=e),t-=e-this.mXMax),t-(0==this.mMsgRows?this.mLabelWidth:0)}calcRowPreview(e){const t=this.mCurrRow.length>0?this.mCurrRow+` ${e}`:e;return{str:t,width:this.txtWidth(t)}}setFont(e){this.mCanvas.ctx.font=e}substringToFit(e,t,n=null){const i={substr:e,remainder:""},s=null!=n?n:this.txtWidth(e);if(s>t){let n=Math.floor(e.length*t/s),o=e.substring(0,n),r=this.txtWidth(o);if(r>t)do{n--,o=e.substring(0,n)}while(this.txtWidth(o)>t);else if(r<t){let i=o,s=0;do{n++,o=e.substring(0,n),s=this.txtWidth(o),s<t&&(i=o)}while(s<t);o=i}i.substr=o,i.remainder=e.substring(o.length)}return i}setCurrRow(e){this.mCurrRow=e||"",this.mCurrRowWidth=this.mCurrRow.length>0?this.txtWidth(this.mCurrRow):0}}class $u extends Tu{constructor(){super({ID_Main:1,ID_Left:2,ID_Right:3,ID_Bottom:4})}init(e,t,n,i,s){return!!super.init(e,t)&&(this.mLeftWPerc=n,this.mRightWPerc=i,this.mBottomHPerc=s,this.updateLayout(),!0)}updateLayout(){if(0!=this.mWidth&&0!=this.mHeight){const e=this.layoutInfo(this.mIds.ID_Left).layout?Math.floor(this.mWidth*this.mLeftWPerc/100):0,t=this.mHeight,n=this.layoutInfo(this.mIds.ID_Right).layout?Math.floor(this.mWidth*this.mRightWPerc/100):0,i=this.mHeight,s=this.layoutInfo(this.mIds.ID_Bottom).layout?Math.floor(this.mHeight*this.mBottomHPerc/100):0,o=this.mWidth-e-n,r=this.mHeight-s;this.setLayoutRect(this.mIds.ID_Left,0,0,e,t),this.setLayoutRect(this.mIds.ID_Right,e+o,0,n,i),this.setLayoutRect(this.mIds.ID_Main,e,0,o,r),this.setLayoutRect(this.mIds.ID_Bottom,e,r,o,s)}}mainId(){return this.mIds.ID_Main}main(){return this.layout(this.mainId())}setMain(e){this.setLayout(this.mainId(),e)}leftId(){return this.mIds.ID_Left}left(){return this.layout(this.leftId())}setLeft(e){this.setLayout(this.leftId(),e)}rightId(){return this.mIds.ID_Right}right(){return this.layout(this.rightId())}setRight(e){this.setLayout(this.rightId(),e)}bottomId(){return this.mIds.ID_Bottom}bottom(){return this.layout(this.bottomId())}setBottom(e){this.setLayout(this.bottomId(),e)}}class Lu{constructor(e,t,n,i,s){this.mWndCtrl=e,this.mUpdateCB=t,this.mErrorCB=n,this.mMainUserCB=i,this.mMainUser=null,this.mMixOtherUsersAudio=s,this.mSelected=[],this.mLayoutInfo={}}select(e,t){const n=t?e.avatar()&&e.avatarVisible()?e.avatar().canvas().jEl:e.mediaEl():void 0,{mediaId:i,screen:s,owner:o,me:r}=e.info();return Jd(e.streamRec()?e.streamRec():e.stream(),i,s,o,r,n)}checkMainUser(e){let t=!1,n=!1,i=null;return this.mMainUserCB(e)&&(t=!0,this.mMainUser!=e&&(Di.g.log(3,`RecorderLayoutCtrl : checkMainUser : setting main user to ${e} (previous ${this.mMainUser})`),n=!0,i=this.mMainUser,this.mMainUser=e)),{main:t,changed:n,prev:i}}pushWnd(e){const{main:t}=this.checkMainUser(e.owner());if(t)if(e.screen())this.mSelected.unshift(e);else if(this.mSelected.length>0){const t=this.mSelected[0];if(t.isMe()&&t.screen()){const t=1;this.mSelected.splice(t,0,e)}else this.mSelected.unshift(e)}else this.mSelected.push(e);else this.mSelected.push(e)}processWnd(e){const t=this.select(e,!0);this.pushWnd(t)}processSelectedBegin(){}processSelectedEnd(){}getSelected(e){this.mSelected=[],this.processSelectedBegin();let t,n=0;do{t=this.mWndCtrl.getWnd(n),t&&(this.processWnd(t),n++)}while(t);this.processSelectedEnd(),this.mSelected.length||Di.g.log(3,"RecLayoutCtrl : getSelected : no media selected"),this.updateSelected(e)}stop(){}error(e,t){const n={};n.key=e,n.value=t,this.mErrorCB(n)}updateSelected(e){e(this.mSelected,this.mLayoutInfo)}setWndCtrl(e){this.mWndCtrl=e,this.mUpdateCB()}}class Pu extends Lu{constructor(e,t,n,i,s,o){super(e,t,n,i,o),this.mPipTx=null,this.mMainTx=null,this.mShowPip=s}processWnd(e){const{owner:t,screen:n}=e.info(),{main:i,changed:s}=this.checkMainUser(t);if(i)Di.g.log(3,`RecMainPipTxLayoutCtrl : processWnd : MainPip User:${t} (screen wnd:${n})`),s&&(this.mPipTx=null,this.mMainTx=null),n||(Di.g.log(3,"RecMainPipTxLayoutCtrl : processWnd : setting PIP"),this.mPipTx=this.select(e,this.mShowPip)),this.mMainTx&&!n||(Di.g.log(3,"RecMainPipTxLayoutCtrl : processWnd : setting Main"),this.mMainTx=this.select(e,!0));else if(this.mMixOtherUsersAudio&&e.stream()&&e.stream().getAudioTracks().length>0){const t=this.select(e,!1);this.mSelected.push(t)}}processSelectedBegin(){Di.g.log(3,"RecMainPipTxLayoutCtrl : processSelectedBegin"),this.mPipTx=null,this.mMainTx=null}processSelectedEnd(){Di.g.log(3,"RecMainPipTxLayoutCtrl : processSelectedEnd"),this.mMainTx||this.mSelected.length?(this.mPipTx&&(this.mPipTx.mediaId()!=this.mMainTx.mediaId()?this.mSelected.unshift(this.mPipTx):this.mPipTx=null),this.mSelected.unshift(this.mMainTx)):Di.g.log(3,"RecMainPipTxLayoutCtrl : getSelected : no media selected")}setShowPip(e){this.mShowPip!=e&&(Di.g.log(3,`RecMainPipTxLayoutCtrl : setShowPip : ${e}`),this.mShowPip=e,this.mUpdateCB())}getShowPip(){return this.mShowPip}}function Du(e){const t=e.layoutTypes().LAYOUT_TYPE_MAIN_PIP,n=$("#record_main_btn"),i=$("#record_main_pip_btn");function s(n){Di.g.log(3,`RecorderMainPip : setup : showPip:${n}`);const i=e.layoutManager(),s=i.main(),o=e.started();if(s&&s.id()==t)o&&i.main().layoutCtrl().setShowPip(n);else{const s=!0,o=function(e,t,n,i,s,o){const r=new Pu(e,t,n,(e=>window._channel.getRecorderFeaturedUser()===e),s,o);return{getSelected:e=>{r.getSelected(e)},stop:()=>{r.stop()},setShowPip:e=>{r.setShowPip(e)},getShowPip:()=>r.getShowPip(),setWndCtrl:e=>{r.setWndCtrl(e)}}}(e.windowCtrl(),e.update(),e.error(),0,n,s),r=function(e,t){return Xd(new Zd(e,t))}(t,o);i.setMain(r)}o?e.update()():e.start()}return n.on("click",(()=>{s(!1),e.updateUI(n)})),i.on("click",(()=>{s(!0),e.updateUI(i)})),{updateUI:function(){}}}function Nu(e,t,n=640,i=360,s=0){Di.g.log(3,`MockupWndCtrl : count:${e}, useScreen:${t}`);let o=null,r=null,a=n,c=i;function l(){null==r&&s>0&&(r=setInterval((()=>{l()}),s)),null!=o&&o.canvas().width==a&&o.canvas().height==c||(o=iu(a,c));const e=nr(2).toUpperCase();o.redraw(e)}return{getWnd:n=>{if(n>=e)return null;const i={me:!1,screen:!1,mediaId:n};return 0==n?i.me=!0:1==n&&t&&(i.me=!0,i.screen=!0),l(),{wnd:o.canvas().jEl,metadata:i,stream:new MediaStream,video:!0}},stop:()=>{Di.g.log(3,"MockupWndCtrl : stop"),r&&(clearInterval(r),r=null)},setSize:(e,t)=>{a=e,c=t},width:()=>a,height:()=>c}}class Ou extends Lu{constructor(e,t,n,i,s){super(e,t,n,i,!0),this.setSidebarSlots(s,!1)}setSidebarSlots(e,t){this.mLayoutInfo.extra={sidebarWnds:e},t&&this.mUpdateCB()}}class Bu extends Ru{constructor(){super(100,1e3)}label(e,t){return`(${t})-`}text(e){return e.cc.text}notify(e){Di.g.log(3,`CCModel : notify : source:${e.source}, text:${this.text(e)}`),super.notify(e)}}class Fu extends Au{constructor(e,t,n){super(e,t,n,new Bu)}font(e){return"15px Courier"}setCanvasParams(){this.mTextH=18,this.mMessageSpacing=15,this.mYMin=15,this.mXMin=20,this.mXMax=this.mCanvas.width-this.mXMin,this.mMaxSourceWidth=.65*(this.mXMax-this.mXMin),this.mCentered=!0,this.mBGColor="#101010",this.mTextColor="white"}}function Uu(e){return{onCCMockupSpeakerMessage:t=>{e.onCCMockupSpeakerMessage(t)},onCCMockupQuerySortVariance:()=>e.onCCMockupQuerySortVariance()}}class ju{constructor(e,t,n,i,s,o,r,a){this.mDelegate=a,this.mSpeakers=[],this.mProbs=[],this.mStarted=!1,this.createVarianceArray();for(let a=0;a<=e-1;a++){const e=nr(Math.floor(t*this.sortVariance())),c=new Vu(a+1,e,"",n,i,s,o,r,Uu(this));this.mSpeakers.push(c)}}start(){Di.g.log(3,"CCMockupGenerator::start : (CC)"),this.mStarted=!0,this.mSpeakers.forEach((e=>{e.start()}))}started(){return this.mStarted}stop(){Di.g.log(3,"CCMockupGenerator::stop : (CC)"),this.mStarted=!1,this.mSpeakers.forEach((e=>{e.stop()}))}onCCMockupSpeakerMessage(e){this.mDelegate.onCCMockup(e)}onCCMockupQuerySortVariance(){return this.sortVariance()}appendVariance(e,t){this.mProbs.push(function(e,t){return{n1:e,n2:t}}(e,t))}createVarianceArray(){for(let e=0;e<=99;e++)e<=10?this.appendVariance(50,95):e<=30?this.appendVariance(25,70):e<=50?this.appendVariance(0,20):e<=99&&this.appendVariance(0,10)}sortVariance(){let e=1==sr(0,1),t=sr(0,this.mProbs.length-1),n=this.mProbs[t],i=sr(n.n1,n.n2)/100;return e?1+i:1-i}}class Vu{constructor(e,t,n,i,s,o,r,a,c){this.SPEAKER_MIN_INTERVAL_SEC=.2,this.SPEAKER_DURATION_MS_PER_CHAR=90,this.SPEAKER_MIN_TEXT_SIZE=3,this.SPEAKER_MIN_WORDS=1,this.SPEAKER_MAX_WORD_SIZE=20,this.SPEAKER_REPLAY_MIN=2,this.PERCENT_MAX=100,this.mMediaId=e,this.mName=t,this.mLang=n;let l=this.SPEAKER_MIN_INTERVAL_SEC;this.mSpeakerIntervalSec=i>=l?i:l,this.mSpeakerAvgChars=s,this.mSpeakerAvgWords=o,this.mReplayMax=r>this.SPEAKER_REPLAY_MIN?r:this.SPEAKER_REPLAY_MIN+1,this.mReplayProbabilityPerc=a<=this.PERCENT_MAX?a:this.PERCENT_MAX,this.mDelegate=c,this.mTimer=null,this.mReplayCounter=1,this.mReplayInterval=0,this.mReplayExpiration=0}start(){Di.g.log(3,`CCMockupSpeaker::start : (CC) ID:${this.mMediaId}, Name:${this.mName}`),this.mTimer=setTimeout((()=>{this.onTimerEvent()}),1e3*this.mSpeakerIntervalSec)}stop(){Di.g.log(3,`CCMockupSpeaker::stop : (CC) ID:${this.mMediaId}, Name:${this.mName}`),this.mTimer&&(clearTimeout(this.mTimer),this.mTimer=null)}generateCC(){var e=Math.floor(this.mSpeakerAvgChars*this.mDelegate.onCCMockupQuerySortVariance());e<this.SPEAKER_MIN_TEXT_SIZE&&(e=this.SPEAKER_MIN_TEXT_SIZE);var t=Math.floor(this.mSpeakerAvgWords*this.mDelegate.onCCMockupQuerySortVariance());t<this.SPEAKER_MIN_WORDS&&(t=this.SPEAKER_MIN_WORDS),t>e/2&&(t=e/2)<this.SPEAKER_MIN_WORDS&&(t=this.SPEAKER_MIN_WORDS);let n=t-1;for(var i=Math.floor((e-n)/t);i<this.SPEAKER_MIN_TEXT_SIZE&&t>1;)i=Math.floor((e-n)/t),t-=1;for(;i>this.SPEAKER_MAX_WORD_SIZE;)i=Math.floor((e-n)/t),t+=2;Di.g.log(3,`CCMockupSpeaker::generateCC : (CC) ID:${this.mMediaId}, Name:${this.mName}, textSize:${e}, words:${t}, spaces:${n}, wordSize:${i}`);var s="";for(let e=0;e<=t-1;e++)s+=nr(i),e!=t-1&&(s+=" ");let o=s.length*this.SPEAKER_DURATION_MS_PER_CHAR,r=function(e,t,n,i,s){return{mediaId:e,name:t,text:n,lang:i,duration:s}}(this.mMediaId,this.mName,s,this.mLang,Math.floor(o));return r}onTimerEvent(){var e=this.generateCC(),t=0,n=!1,i=this.mReplayCounter>1;let s=Date.now()/1e3;if(1==this.mReplayCounter){let n=e.duration/1e3;t=n;var o=!1;this.mReplayMax>0&&this.mReplayProbabilityPerc>0&&(o=sr(1,this.PERCENT_MAX)>this.PERCENT_MAX-this.mReplayProbabilityPerc),o?(this.mReplayCounter=sr(this.SPEAKER_REPLAY_MIN,this.mReplayMax),this.mReplayInterval=t/this.mReplayCounter,this.mReplayExpiration=s+n+this.mReplayInterval+this.mSpeakerIntervalSec,t=this.mReplayInterval,i=!0):t+=this.mSpeakerIntervalSec}else this.mReplayCounter=this.mReplayCounter-1,1==this.mReplayCounter?(t=this.mReplayExpiration>s?this.mReplayExpiration-s:0,n=!0,this.mReplayExpiration=0,this.mReplayInterval=0):t=this.mReplayInterval,e.duration=Math.floor(1e3*t*.7);clearTimeout(this.mTimer),this.mTimer=setTimeout((()=>{this.onTimerEvent()}),1e3*t),Di.g.log(3,`CCMockupSpeaker::onTimerEvent : (CC) ID:${this.mMediaId}, Name:${this.mName}, ---- REPLAY_COUNTER:${i?this.mReplayCounter:0} ---- intervalSec:${t}, now:${s}, replayExpiration:${this.mReplayExpiration}, replayExpired:${n}, speakerInterval:${this.mSpeakerIntervalSec}, CC:[duration:${e.duration}, text:${e.text}]`),this.mDelegate.onCCMockupSpeakerMessage(e)}}class Gu extends Ru{constructor(){super(100)}label(e,t){return e.userActivity?"":`${t}: `}text(e){return e.message}timestamp(e){return e.ts}isUserActivity(e){return e.userActivity}notify(e){if(!e.ts){const t=new Date,n=t.getHours(),i=t.getMinutes();e.ts={hour:n,min:i}}Di.g.log(3,`ChatModel : notify : source:${e.source}, message:${this.text(e)}, userActivity:${e.userActivity}, hour:${e.ts.hour}, min:${e.ts.min}`),super.notify(e)}}class qu extends Au{constructor(e,t,n){super(e,t,n,new Gu),this.mFontName="Courier"}font(e){return this.mModel.isUserActivity(e)?this.fontParams(16,!0):this.fontParams(14)}fontParams(e,t){return`${t?"italic":""} ${e}px ${this.mFontName}`}setCanvasParams(){this.mTextH=16,this.mMessageSpacing=15,this.mYMin=15,this.mXMin=10,this.mXMax=this.mCanvas.width-80,this.mMaxSourceWidth=.65*(this.mXMax-this.mXMin),this.mCentered=!1,this.mBGColor="#101010",this.mTextColor="white"}onRowDrawn(e,t,n){if(this.mModel.isUserActivity(n.data)&&this.mCanvas.ctx.fillRect(n.x,Math.floor(t+this.mTextH/4),n.width,2),0==n.msgRows){const e=this.mModel.timestamp(n.data);let i=`${e.min}`;1==i.length&&(i=`0${i}`);const s=`${e.hour}:${i}`,o=this.mCanvas.ctx.font;this.mCanvas.ctx.font=this.fontParams(11);const r=this.mCanvas.width-45;this.mCanvas.ctx.fillText(s,r,t),this.mCanvas.ctx.font=o}}}class Hu{constructor(e,t,n,i,s=1500){this.mMessages=e,this.mChatCB=t,this.mJoinCB=n,this.mPartCB=i,this.mIntervalMs=s,this.mTimer=null}start(){return this.mMessages&&0!=this.mMessages.length&&this.mChatCB?this.started()?(Di.g.log(3,"SimpleChatMockup : start : already started"),!1):void(this.mTimer=setInterval((()=>{const e=sr(0,12),t=sr(0,this.mMessages.length-1),n=this.mMessages[t];switch(e){case 0:this.mPartCB(n.source);break;case 1:this.mJoinCB(n.source);break;default:this.mChatCB(n.source,n.message)}}),this.mIntervalMs)):(Di.g.log(3,"SimpleChatMockup : start : invalid paraters"),!1)}stop(){this.mTimer&&(clearInterval(this.mTimer),this.mTimer=null)}started(){return null!=this.mTimer}}function zu(e){const t=e.layoutTypes().LAYOUT_TYPE_GRID,n=$("#record_grid_btn"),i=$("#record_grid_mockup_checkbox"),s=$("#record_grid_mockup_total_wnds_combo");for(let e=1;e<=81;e++)s.append(`<option value="${e}">${e}</option>`);function o(){Di.g.log(3,"RecorderGrid : setup");const n=r(),i=n.checked?Nu(n.totalWnds,!1):e.windowCtrl(),s=e.layoutManager(),o=s.main(),a=e.started();if(o&&o.id()==t)a&&o.layoutCtrl().setWndCtrl(i);else{const n=function(e,t,n,i){return function(e,t,n,i,s=!0){const o=new Lu(e,t,n,i,s);return{getSelected:e=>{o.getSelected(e)},stop:()=>{o.stop()},setWndCtrl:e=>{o.setWndCtrl(e)}}}(e,t,n,i)}(i,e.update(),e.error(),(e=>window._channel.getRecorderFeaturedUser()===e)),o=function(e,t){return Xd(new eu(e,t))}(t,n);s.setMain(o)}a?e.update()():e.start()}function r(){return{checked:i.is(":checked"),totalWnds:Number(s.val())}}function a(){const e=r();V.enableCtrl(s,e.checked)}return n.on("click",(()=>{o(),e.updateUI(n)})),i.on("change",(()=>{a(),e.started(t)&&o()})),s.on("change",(()=>{e.started(t)&&o()})),{updateUI:a}}function Wu(e){window.customSelectedMedia=(e,t)=>e&&e.is("video")&&"local_screen_video"!=e[0].id?$(document.getElementById(`${t}`)):e;const t=window.websocket_url||`${p.REALM}-api.ip.tv/csm-ws`,n=function(){const e=new Mu;return{setRecParams:(t,n,i,s,o)=>{e.setRecParams(t,n,i,s,o)},setLocalRec:t=>{e.setLocalRec(t)},setRemoteRec:(t,n,i,s,o,r,a,c,l,d,u,h,p,m,w,g,f,v)=>{e.setRemoteRec(t,n,i,s,o,r,a,c,l,d,u,h,p,m,w,g,f,v)},remoteRecNotify:t=>e.remoteRecNotify(t),start:t=>e.start(t),stop:(t=!1)=>{e.stop(t)},started:()=>e.started(),update:()=>{e.update()},mixer:()=>e.mixer()}}(),i=function(){const e=new $u;return{init:(t,n,i,s,o)=>{e.init(t,n,i,s,o)},setUpdateCB:t=>{e.setUpdateCB(t)},reset:()=>{e.reset()},isOk:()=>e.isOk(),selectedAll:t=>{e.selectedAll(t)},frames:()=>e.frames(),width:()=>e.width(),height:()=>e.height(),setLayout:(t,n)=>{e.setLayout(t,n)},layout:t=>e.layout(t),mainId:()=>e.mainId(),main:()=>e.main(),setMain:t=>{e.setMain(t)},leftId:()=>e.leftId(),left:()=>e.left(),setLeft:t=>{e.setLeft(t)},rightId:()=>e.rightId(),right:()=>e.right(),setRight:t=>{e.setRight(t)},bottomId:()=>e.bottomId(),bottom:()=>e.bottom(),setBottom:t=>{e.setBottom(t)}}}();i.setUpdateCB((()=>{A()}));const s={LAYOUT_TYPE_NONE:0,LAYOUT_TYPE_MAIN_PIP:1,LAYOUT_TYPE_MAIN_SIDEBAR:2,LAYOUT_TYPE_GRID:3,LAYOUT_TYPE_CHAT:4,LAYOUT_TYPE_CC:5};let o=!1,r=!1,a=null,c=null;const l=$("#record_status_text"),d=$("#record_resolution_combo"),u=$("#record_fps_combo"),h=$("#record_bitrate_kbps_combo"),m=$("#record_mime_type_checkbox"),w=$("#record_mime_type_combo"),g=$("#recording_btn"),f=$("#record_close_dialog_btn"),v=$("#record_stop_btn");v.hide();const b={started:e=>e?r&&i.main().id()==e:r,start:()=>{I()},updateUI:e=>{M(e)},windowCtrl:()=>e,layoutTypes:()=>s,layoutManager:()=>i,update:()=>A,error:()=>P},_=Du(b),y=function(e){const t=e.layoutTypes().LAYOUT_TYPE_MAIN_SIDEBAR,n=$("#record_main_sidebar_btn"),i=$("#record_main_sidebar_mockup_checkbox"),s=$("#record_main_sidebar_mockup_total_wnds_combo"),o=$("#record_main_sidebar_slots_combo");function r(){Di.g.log(3,"RecorderMainSidebar : setup");const n=a(),i=n.checked?Nu(n.totalWnds,n.screen):e.windowCtrl(),s=e.layoutManager(),o=s.main(),r=e.started();if(o&&o.id()==t){if(r){const e=o.layoutCtrl();e.setWndCtrl(i),e.setSidebarSlots(c())}}else{const n=function(e,t,n,i,s=3){const o=new Ou(e,t,n,i,s);return{getSelected:e=>{o.getSelected(e)},stop:()=>{o.stop()},setWndCtrl:e=>{o.setWndCtrl(e)},setSidebarSlots:e=>{o.setSidebarSlots(e,!0)}}}(i,e.update(),e.error(),(e=>window._channel.getRecorderFeaturedUser()===e),c()),o=function(e,t){return Xd(new Qd(e,t))}(t,n);s.setMain(o)}r?e.update()():e.start()}function a(){return{checked:i.is(":checked"),totalWnds:Number(s.val()),screen:!0}}function c(){return Number(o.val())}function l(){const e=a();V.enableCtrl(s,e.checked);const t=c()+1,n=e.totalWnds,i=n<=t?n:t;s.empty();for(let e=1;e<=t;e++){const t=e==i?`<option value="${e}" selected="selected">${e}</option>`:`<option value="${e}">${e}</option>`;s.append(t)}}return n.on("click",(()=>{r(),e.updateUI(n)})),i.on("change",(()=>{l(),e.started(t)&&r()})),s.on("change",(()=>{e.started(t)&&r()})),o.on("change",(()=>{l(),e.started(t)&&r()})),{updateUI:l}}(b),C=zu(b),S=function(e){const t=function(e,t,n){const i=new qu(e,t,n);return{enableLayout:e=>{i.enableLayout(e)},notify:e=>{i.notify(e)},clear:()=>{i.clear()}}}(e.layoutManager(),e.layoutManager().rightId(),e.layoutTypes().LAYOUT_TYPE_CHAT),n=$("#record_chat_checkbox"),i=$("#record_chat_mockup_checkbox"),s=new Hu([{source:"Shirla30",message:"Bom dia"},{source:"Shirla30",message:"Acabei de chegar"},{source:"Shirla30",message:"AlguÃ©m pode me explicar"},{source:"Juliananeces",message:"Bom dia POVOOOO"},{source:"mateus0411",message:"Bom dia JUUU"},{source:"mateus0411",message:"Oiaa"},{source:"mateus0411",message:"To com dÃºvida no mÃ³dulo 6"},{source:"Michel",message:"Te passo mais tarde sim, manda mensagem!"},{source:"waltinho09",message:"AlguÃ©m anotou a liÃ§Ã£o de casa ?"},{source:"marizinha",message:"Estou com dois cachorrinhos para adoÃ§Ã£o, alguÃ©m interessado :)"},{source:"profnatanael",message:"Pessoal bom dia, coloquei no sistema a aula de histÃ³ria do Brasil. Quem tiver dÃºvida pode postar aqui mesmo."},{source:"fernanda97",message:"Estou com dÃºvida no mÃ³dulo 6 de matemÃ¡tica. Onde posso assistir novamente a aula ?"},{source:"jogador",message:"Pessoal estou jogando um novo jogo muito MASSA Batte Royalle PVP. Quem puder me add que posso dar dicas novas e colocar na minha equipe. Manda mensagem que dou mais informaÃ§Ãµes. Valeu GALERINHA, AQUELE ABRAÃO !!!"},{source:"monitoramento357",message:"OlÃ¡ a todos sejam bem-vindos a aula de Literatura. Estou a disposiÃ§Ã£o para esclarecimentos sobre o uso da plataforma. Obrigado."}],((e,t)=>{r({source:e,message:t})}),(e=>{a(e)}),(e=>{c(e)}));function o(){const e=n.is(":checked");t.enableLayout(e),V.enableCtrl(i,e),d()}function r(e){l(e.source,e.message,e.ts)}function a(e,t){l(e,window.i18n.get("channel-joined"),t,!0)}function c(e,t){l(e,window.i18n.get("channel-leaved"),t,!0)}function l(e,n,i,s=!1){d(),t.notify(function(e,t,n,i){return{source:e,message:i?`${e} ${t}`:t,ts:n,userActivity:i}}(e,n,i,s))}function d(){const n=e.started(),o=s.started();if(n){const e=i.is(":checked");e!=o&&(e?s.start():s.stop())}else o&&s.stop(),t.clear()}return n.on("change",(()=>{o()})),i.on("change",(()=>{d()})),{updateUI:o,notifyChat:r,notifyJoin:a,notifyPart:c}}(b),x=function(e){const t=function(e,t,n){const i=new Fu(e,t,n);return{enableLayout:e=>{i.enableLayout(e)},notify:e=>{i.notify(e)},clear:()=>{i.clear()}}}(e.layoutManager(),e.layoutManager().bottomId(),e.layoutTypes().LAYOUT_TYPE_CC),n=$("#record_cc_checkbox"),i=$("#record_cc_mockup_checkbox"),s=function(e,t,n,i,s,o,r,a){const c=new ju(1,20,1,200,10,0,0,a);return{start:()=>{c.start()},started:()=>c.started(),stop:()=>{c.stop()}}}(0,0,0,0,0,0,0,{onCCMockup:e=>{r(e.name,e)}});function o(){const e=n.is(":checked");t.enableLayout(e),V.enableCtrl(i,e),a()}function r(e,n){a(),t.notify({source:e,cc:n})}function a(){const n=e.started(),o=s.started();if(n){const e=i.is(":checked");e!=o&&(e?s.start():s.stop())}else o&&s.stop(),t.clear()}return n.on("change",(()=>{o()})),i.on("change",(()=>{a()})),{updateUI:o,notifyCC:r}}(b);function k(){const e=V.checkBoxVal(m);return{checked:e,value:e?V.comboSelectedVal(w):null}}function M(e=null){c&&V.enableCtrl(c,!0),e&&V.enableCtrl(e,!r),V.enableCtrl(d,!r),V.enableCtrl(u,!r),V.enableCtrl(h,!r),V.enableCtrl(m,!r),V.enableCtrl(w,!r&&k().checked),_.updateUI(),y.updateUI(),C.updateUI(),S.updateUI(),x.updateUI(),c=e,r?l.text(`Recording... Layout:${c.text()}`):l.text("Not Recording. Waiting User...")}function T(){o=!o,V.enableCtrl(g,!o),$("#recorder_popup").fadeToggle()}function I(){if(window.hideVuMeter=!0,r=!0,t.length>0){const e=window.websocket_url||`${p.apiServer.replace("https://","")}/csm-ws`,t=null,i=window.session_id,s=0,o=6e4;n.setRemoteRec(e,t,i,((e,t,n)=>{}),((e,t)=>{window.countdown.stop(),window.softCountdown&&window.softCountdown.stop(),$("#alert-time-remaining").hide(),window.session.hideTimer(),$("#media-cc").hide(),1!==window._channel.getType()||window.session.isReconnecting||"m"!==window._channel.getSuffix()&&(E("[Recording] Stop all transmission!"),window._channel.stopAllTransmissions())}),(()=>({auth_token:`${window.auth_token}`,browser:window.navigatorData})),(()=>null),((e,t,n)=>{}),((e,t,n)=>{Di.g.log(3,`RecorderCtrlPanel : Notify Ack : sessionId:${e}, seq:${t}, code:${n}`)}),((e,t)=>{Di.g.log(3,`RecorderCtrlPanel : Srv Notify : sessionId:${e}, PAYLOAD:${JSON.stringify(t)}`)}),(e=>{$("#media-cc").hide(),z({errors:[{field:"streamerws",cause:"disconnect error",status:400,value:"error",message:"disconnect error",place:"headers"}]}),e&&(Di.g.log(3,"RecorderCtrlPanel : Disconnect Timeout."),R(),window.session.isReconnecting||"m"!==window._channel.getSuffix()&&(E("[Recording] Stop all transmission!"),window._channel.stopAllTransmissions()))}),((e,t,n)=>{z({errors:[{field:"streamerws",cause:"ack error",status:400,value:"error",message:"ack error",place:"headers"}]})}),(()=>{z({errors:[{field:"streamerws",cause:"ping error",status:400,value:"error",message:"ping timeout",place:"headers"}]})}),(()=>{z({errors:[{field:"streamerws",cause:"Chuncks lost error",status:400,value:"error",message:"chunks lost",place:"headers"}]})}),(()=>{z({errors:[{field:"streamerws",cause:"StartRec timeout error",status:400,value:"error",message:"startrec timeout",place:"headers"}]})}),s,o,!0)}const e={width:1280,height:720};let s=15,o=1024;"edupa"!==window.realm&&"edusp"!==window.realm&&"school"!==window.realm&&"staging"!==window.realm||(e.width=window.RESWIDTH||1280,e.height=window.RESHEIGHT||720,s=window.FPS||30,o=window.BITRATE||256),Di.g.log(3,`RecorderCtrlPanel : startRecord : ${e.width}x${e.height} @ ${s} fps (${o} kbps)`),i.init(e.width,e.height,0,30,20),n.setRecParams(i,s,o,k().value,window.gtimer),n.start(),v.show()}function R(e=!1){window.Events.dispatch("record/stop",e),Di.g.log(3,"RecorderCtrlPanel : stopRecord"),window.timerWorker&&(window.timerWorker.stopTimers("session-"),window.Events.dispatch("session/timer-control","stopTimers")),window.hideVuMeter=!1,r=!1,n.stop(e),i.reset(),v.hide(),a&&(clearInterval(a),a=null),M()}function A(){L()&&n.update()}function L(){return n.started()}function P(e){const t=`RecorderCtrlPanel : error : ${e.key}`;Di.g.log(3,t)}return M(),g.on("click",(()=>{T()})),f.on("click",(()=>{T()})),v.on("click",(()=>{R(),M()})),m.on("change",(()=>{M()})),{enable:function(e){V.enableCtrl(g,e)},update:A,started:L,reset:function(){R(),o&&T()},notifyCC:function(e,t){x.notifyCC(e,t)},notifyChat:function(e){S.notifyChat(e)},notifyJoin:function(e){S.notifyJoin(e)},notifyPart:function(e){S.notifyPart(e)},startRecord:I,stopRecord:R,isStarted:function(){return r},disconnect:function(){return n.disconnect()},forceDisc:function(){return n.forceDisc(),!1}}}class Ju{constructor(e,t){this.mWindowCtrl=e,this.mLocalScreen=t}getWnd(e){return this.mLocalScreen.started()?this.mLocalScreen.getWnd(e):this.mWindowCtrl.getWnd(e)}}class Yu{constructor(e,t,n,i){this.mNickCB=e,this.mStartingCB=t,this.mStartedCB=n,this.mErrorCB=i,this.mLocalScreenBtn=$("#local_screen_btn"),this.mLocalScreenBtn.on("click",(()=>{this.start()})),this.mStream=null,this.mMediaEl=null,this.set()}set(e=15,t=1280,n=720,i=!0){this.mFramerate=e,this.mWidth=t,this.mHeight=n,this.mAudio=i}enable(e){V.enableCtrl(this.mLocalScreenBtn,e)}getWnd(e){if(!this.started()||0!=e)return null;const t={_mediaEl:this.mMediaEl,metadata:{mediaId:0,screen:!0,me:!0,mediaVoice:!0,owner:this.mNickCB()},_stream:this.mStream,_video:!0,mediaEl:()=>t._mediaEl,info:()=>t.metadata,stream:()=>t._stream,streamRec:()=>null,video:()=>t._video,avatar:()=>null,avatarVisible:()=>!1};return t}started(){return null!=this.mStream}async start(){if(this.mStream?.active)console.log("LocalScreenCapture : start : already started");else{this.mStartingCB();try{this.mStream=await navigator.mediaDevices.getDisplayMedia({video:{framerate:this.mFramerate,width:this.mWidth,height:this.mHeight},audio:this.mAudio,preferCurrentTab:!0}),this.mMediaEl=$("#local_screen_video"),this.mMediaEl[0].srcObject=this.mStream,this.mStartedCB()}catch(e){console.error(`LocalScreenCapture : start : Error: ${e}`),this.stop(),this.mErrorCB()}}}stop(){this.mMediaEl&&(this.mMediaEl[0].srcObject=null,this.mMediaEl=null),this.mStream&&(er.stopStream(this.mStream),this.mStream=null)}}function Ku(){let e=0;window.cc.startCb=e=>{Ke(e.text,e.lang,e.ts,e.duration,e.delay)},window.cc.stopCb=()=>{E("[CC] stopCb called!")};const t=xl(),n=l()("#channel_name"),i=l()("#channel_topic"),s=l()("#channel_usercount"),o=(l()("#publisher_status"),l()("#leave_channel_btn")),r=l()("#toggle_screensharing_btn"),a=l()("#toggle_mute_audio_btn"),c=l()("#toggle_mute_video_btn"),d=l()("#toggle_drop_audio_btn"),u=l()("#toggle_drop_video_btn"),h=l()("#toggle_camera_quality_btn"),w=l()("#toggle_cc_btn"),g=l()("#tx_opts_btn"),f=l()("#tx_opts_close_btn"),v=l()("#rx_opts_btn"),b=l()("#rx_opts_close_btn"),_=l()("#toggle_audio_rx_btn"),y=l()("#toggle_video_rx_btn"),C=null,S=!1,x=!1;let k=!0,M=!0;Xe();const I="screen";let R=!1,A=!1;const L=!1,P=!1;let D=null,N=null,O=!1;const B=!1;function F(){const e=window._engine.txInfoAvconf(!0)?.mediaId,t=window._channel.isAudioMuted();t?window._engine.muteAudio(e):window._engine.unmuteAudio(e),E(`ChannelCtrl::updateAudioMute : muted:${t}`)}function U(){E("ChannelCtrl : setMediaRxTimer"),G(),V.enableCtrl(_,!1),V.enableCtrl(y,!1),C=setTimeout((()=>{E("ChannelCtrl : setMediaRxTimer : timeout"),G()}),2e3)}function G(){C&&(clearTimeout(C),C=null),V.enableCtrl(_,!0),V.enableCtrl(y,!0)}function q(){x&&H(),S=!S,V.enableCtrl(g,!S),l()("#tx_opts_popup").fadeToggle()}function H(){S&&q(),x=!x,V.enableCtrl(v,!x),l()("#rx_opts_popup").fadeToggle()}function z(){h.html(B?"Change Quality to SD ":"Change Quality to HD")}Ve(!1),Ge(!1),z(),a.click((function(e){R=!R,We(),ou(a,!1),A&&(R?D=setTimeout((function(){ou(a,!0),D=null}),500):qe(window._engine.isTxEnabled(),window._engine.isMediaVoice(),!0,!1)),Ve(R),e.stopPropagation()})),c.click((function(e){A=!A,We(),J.muteTxVideo("pub",A),ou(c,!1),R&&(A?N=setTimeout((function(){ou(c,!0),N=null}),500):qe(window._engine.isTxEnabled(),window._engine.isMediaVoice(),!0,!1)),Ge(A),e.stopPropagation()})),d.on("click",(function(e){He()?(P=!P,setToggleDropAudioState(P),engine.requestDropTxMedia(L,P)):E("app -> ChannelCtrl::_toggleDropAudioBtn.onClick : not inside a channel"),e.stopPropagation()})),u.on("click",(function(e){He()?(L=!L,setToggleDropVideoState(L),engine.requestDropTxMedia(L,P)):E("app -> ChannelCtrl::_toggleDropVideoBtn.onClick : not inside a channel"),e.stopPropagation()})),h.on("click",(function(e){V.enableCtrl(h,!1),B=!B,z(),engine.isTxEnabled()&&(window._engine.unpublish(),J.stopMirrorMain(!0),window._engine.publishRestart(void 0,void 0,void 0,void 0,B))})),w.on("click",(function(e){_speechRecognitionCapture.started()?(_speechRecognitionCapture.stop(),w.html("Enable CC")):(_speechRecognitionCapture.start(_speechLang),w.html("Disable CC"))})),g.on("click",(function(e){q()})),f.on("click",(()=>{q()})),v.on("click",(function(e){H()})),_.on("click",(function(e){engine.requestSetAudioRx(!k),U()})),y.on("click",(function(e){engine.requestSetVideoRx(!M),U()})),b.on("click",(()=>{H()}));const W=Od(window._engine),J=su(window._engine,0,(()=>M));window.localScreen=function(e,t,n,i){const s=new Yu((()=>window._engine.nick()),(()=>{window.localScreen.enable(!1)}),(()=>{l()("#screen-saving-status").html(window.i18n.get("enabled")),window._channel.startDefaultRecording("main"),window._recorderCtrl.update()}),(()=>{l()("#screen-saving-status").html(window.i18n.get("disabled")),window.localScreen?.started()&&(window.localScreen.stop(),window._channel.stopDefaultRecording()),window.localScreen.enable(!0)}));return{enable:e=>{s.enable(e)},getWnd:e=>s.getWnd(e),started:()=>s.started(),stop:()=>{s.stop()}}}();const Y=function(e,t){const n=new Ju(e,t);return{getWnd:e=>n.getWnd(e)}}(J,window.localScreen);window._recorderCtrl=Wu(Y);const K=zd();window._youtubeCtrl=function(){let e=null,t=null,n=[],i=0,s=-1,o=0,r=0,a=null,c=-1,l=-1,d=null,u=null,h=null,p=!1,m=!1,w=!1,g=!0,f=0,v=0,b=1,_=8,y=4,C="si",S={"@":"http://www.youtube.com/watch?v=","#":"http://www.youtube.com/","!":"https://www.youtube.com/watch?v=",$:"https://www.youtube.com/","*":"https://www.youtu.be/"},E=null,x=null,k=null,M=null;function T(){if(0==n.length)return Di.g.log(3,"YoutubeCtrl::resyncTvMode : Error: no videos published"),null;let e=null,t=tr(),i=t>v?t-v:0,s=f+i,o=[],a=n;for(let e=0;e<a.length;e++){let t=a[e],n=o.length,i=n>0?o[n-1]:0;o.push(i+t.duration+y)}let c=o[o.length-1],l=(s+r)%c,d=0;for(let n=0;n<o.length;n++){let u=o[n];if(u>l){let h=n,p=l-d;e={forcedIndex:h,forcedOffsetSec:p},Di.g.log(3,`YoutubeCtrl::resyncTvMode : setting playlist index to ${h} [Name:${a[h].name}, URL:${a[h].url}, curTime:${t}, DurationSec:${a[h].duration}] forcedOffsetSec:${p}, _playlistPublishedOffsetSec:${r}, videos:${o.length}, playlistTotalDurationSec:${c}, offsetSec:${l} [${d}, ${u}], timeElapsed:${s} = (timeElapsedSinceModePublicationSec:${f} + timeElapsedSinceModeRcv:${i}), laps:${s/c}`);break}d=u}return e}function I(t,n){e?(t<=0?e.playVideo():e.playVideoAt(t),n||o>0&&(e.seekTo(o,!0),o=0)):Di.g.log(3,"YoutubeCtrl::playIndex : error _player is null")}function R(){if(Di.g.log(3,"YoutubeCtrl::play"),n.length>0&&s>=0){let t=n[s];if(t.ytInfo=function(e){let t=null,n=new URL(e);if(n){let e=!1,i=null;for(const[t,s]of n.searchParams)"v"===t&&(i=s),"list"===t&&(e=!0,i=s);if(null==i){let e=n.pathname;e&&e.length>0&&("/"==e[0]&&(e=e.substring(1)),i=e)}i&&(t={youtubeId:i,playlist:e})}return t}(t.url),t.ytInfo){x();let n=p||!V(),i={events:{onReady:A,onError:L,onStateChange:D,onPlaybackQualityChange:N},height:"100%",width:"100%",playerVars:{origin:new URL(window.location.href).origin,modestbranding:1,autoplay:1,autohide:1,playsinline:1,controls:n?1:0,fs:0}};t.ytInfo.playlist?(i.playerVars.listType="playlist",i.playerVars.list=t.ytInfo.youtubeId):i.videoId=t.ytInfo.youtubeId,e=new YT.Player("player",i),n||$("#player").css("pointer-events","none"),k()}}}function A(e){Di.g.log(3,`YoutubeCtrl::onYoutubePlayerVideoReady : offset:${o}, subindex:${l}`),I(0,l>0)}function L(e){Di.g.log(3,`YoutubeCtrl::onYoutubePlayerError : ${e.data}`)}function P(){return n[s]}function D(t){switch(t.data){case YT.PlayerState.UNSTARTED:Di.g.log(3,"YoutubeCtrl::onYoutubePlayerStateChange : unstarted");break;case YT.PlayerState.ENDED:{let t=V();p&&(p=!1,t&&(w=!0));let n=P();Di.g.log(3,`YoutubeCtrl::onYoutubePlayerStateChange : ended : Url:${n.url}, resyncPending:${w}, tvMode:${t}`),n.ytInfo.playlist&&!V()?e.getPlaylistIndex()==n.ytInfo.playlistLength-1&&O(!1):O(!1);break}case YT.PlayerState.PLAYING:{Di.g.log(3,"YoutubeCtrl::onYoutubePlayerStateChange : playing"),j();let t=P();if(t.ytInfo.playlist&&null==t.ytInfo.playlistIndex){if(t.ytInfo.playlistIndex=e.getPlaylistIndex(),t.ytInfo.playlistLength=e.getPlaylist().length,p)break;let n=t.ytInfo.playlistIndex,i=V();0==n&&s==c&&l>0||0==n&&s!=c&&i&&o>0||n>0&&n!=l&&i&&(Di.g.log(3,`YoutubeCtrl::onYoutubePlayerStateChange : index:${n}, going to next video`),O(!1))}break}case YT.PlayerState.PAUSED:Di.g.log(3,"YoutubeCtrl::onYoutubePlayerStateChange : paused"),!V()||p||m||null==u&&g&&(Di.g.log(3,"YoutubeCtrl::onYoutubePlayerStateChange : paused : creating play timer"),h=!0,u=setInterval((function(){h?(Di.g.log(3,"YoutubeCtrl::onPlayTimer : resuming playback"),I(0,!1)):(Di.g.log(3,"YoutubeCtrl::onPlayTimer : no pending play"),j())}),1e3));break;case YT.PlayerState.BUFFERING:Di.g.log(3,"YoutubeCtrl::onYoutubePlayerStateChange : buffering");break;case YT.PlayerState.CUED:Di.g.log(3,"YoutubeCtrl::onYoutubePlayerStateChange : cued");break;default:Di.g.log(3,`app -> YoutubeCtrl::onPlaybackQualityChange : ${t.data}`)}}function N(e){Di.g.log(3,`YoutubeCtrl::onPlaybackQualityChange : ${e.data}`)}function O(e){if(n.length>0){let t=s+1,o=0;if(w){if(V()){let e=T();t=e.forcedIndex,o=e.forcedOffsetSec,Di.g.log(3,`YoutubeCtrl::next : tv mode resync : index:${t}, offsetSec:${o}`)}w=!0}let r=!1;t<n.length?U(t,o):r=!0,e||!r||G(b)?(r&&U(0),Di.g.log(3,`YoutubeCtrl::next : userCmd:${e}, index:${s}, total:${n.length}, flags:${i}, looped:${r}`),R()):(Di.g.log(3,"YoutubeCtrl::next : no next video, loop is off"),U(-1))}else Di.g.log(3,"YoutubeCtrl::next : no videos in playlist")}function B(e){let t=e,n=S[e[0]];return null!=n&&(t=n+e.substring(1)),t}function F(e){let t,n=null,i=e.n,s=e.u;return t=e.d?e.d:0,null!=i&&null!=s&&null!=t&&(n={name:i,url:B(s),duration:t}),n}function U(e,i=0){Di.g.log(3,`YoutubeCtrl::setPlaylistPublishedIndex : setting index: ${s} to ${e}, offsetSec: ${i}, total: ${n.length}`),e<0?(s=-1,a=null,c=-1,l=-1,o=0,n=[],M()):(s=e,o=i,n.length>s?t=n[s]:(t=null,Di.g.log(3,`YoutubeCtrl::setPlaylistPublishedIndex : Error invalid index ${s}`)))}function j(){null!=u&&(clearInterval(u),u=null,h=!1)}function V(){return G(_)}function G(e){return function(e,t){return(e&t)==t}(i,e)}return{setCallbacks:function(e,t,n,i){E=e,x=t,k=n,M=i},init:function(e){if(Di.g.log(3,`YoutubeCtrl::init : ${JSON.stringify(e)}`),n=[],U(-1),r=0,i=0,f=0,v=0,w=!1,e){let s=0;null!=e.f&&(s=e.f);let o=-1;null!=e.i?o=e.i:Di.g.log(3,"YoutubeCtrl::init : Warning key: i not found");let u=-1;null!=e[C]?u=e[C]:Di.g.log(3,`YoutubeCtrl::init : Warning key: ${C} not found`);let h=0;null!=e.o?h=e.o:Di.g.log(3," YoutubeCtrl::init : Warning key: o not found"),Di.g.log(3,`YoutubeCtrl::init : flags:${s}, forcedIndex:${o}, forcedOffsetSec:${h}`),i=s;let p=[],m=null,w=[],g=-1;if(d){m=d.v;for(let e=0;e<m.length;e++){let n=F(m[e]);if(!n){Di.g.log(3,"YoutubeCtrl::init : Error reading prevPlaylistUrl");break}if(w.push(n.url),n.url==t){Di.g.log(3,`YoutubeCtrl::init : found playing video (Index:${e}, Name:${n.name}, Url:${n.url})`),g=e;break}}}let b=!0,_=e.v;if(null!=_){let e=0,t=0;for(let n=0;n<_.length;n++){let i=F(_[n]);if(i){g>=0&&_.length>g&&n<=g&&(prevPlaylistUrl[n]!=i.url&&(Di.g.log(3,`YoutubeCtrl::init : playlist changed [$(index)]: Url:$(prevPlItemUrl) -> Url:${curPlItemUrl}`),e+=1),n==g&&0==e&&(b=!1));let s=i;o>=0&&n==o&&(r=t+h,a=s,c=o,l=u,b=!1,Di.g.log(3,`YoutubeCtrl::init : forcedIndex:${o}, forcedSubIndex:${u}, Name:${s.name}, Url:${s.url}, PlaylistOffsetSec:${r}`)),t+=i.duration+y,p.push(s)}else Di.g.log(3,"YoutubeCtrl::init : Error : url not found")}}if(Di.g.log(3,`YoutubeCtrl::init : setting playlist published (${p.length}) items`),n=p,V()){f=e.timeElapsed,v=tr();let t=T();o=t.forcedIndex,h=t.forcedOffsetSec,b=!1}n.length>0&&(U(b?0:o>=0?o:g,h),d=e,G(2)&&R())}},isAccessAllowed:function(){let e=E(),t=G(4);return e||t&&n.length>0},playLocal:function(e){p=!0;let t=!1,i=n.find((t=>t.url===e));for(let i=0;i<n.length;i++)if(n[i].url==e){U(i),R(),t=!0;break}t||Di.g.log(3,`YoutubeCtrl::playLocal : Error item ${i.url} not found`)},playlist:function(){return n},reset:function(){Di.g.log(3,"YoutubeCtrl::reset"),U(-1),r=0,i=0,d=null,p=!1,m=!1,w=!1,f=0,v=0,e&&e.stopVideo(),M(),j()}}}();let X=!1;Ze(!1);const Z="+",Q="-",ee="o",te="v",ne="y",ie="p",se="s",oe="m",re="N",ae="I",ce="n",le="k",de="b",ue="l",he="c",pe="C",me="A",we="x",ge="h",fe="V",ve="S",be="u",_e="d",ye="a",Ce="B",Se="P",Ee="H",xe="O",ke="M",Me="z",Te="w",Ie="g",Re="G",Ae="X",$e="T",Le="f",Pe="q",De="U",Ne="F";function Oe(e){l().each(e,(function(t){const n=e[t];n.mode==De&&window._engine.requestUserList(ze),n.mode==pe&&_youtubeCtrl.setChannelModeCommerce(n.add,n.modeParam,n.timeElapsed),n.mode==ee&&Qe(n.modeParam)&&(X=!!n.add),E(`app -> ChannelCtrl::processChannelModes: add:${n.add}, mode:${n.mode}, modeParam: ${n.modeParam}`)}))}function Be(){window._engine.unpublish(),window._engine.unpublishScreen(),J.stopMirror(),Ue(!1),window._channel.setSharingState(!1)}function Fe(){E("[channelCtrl] reset() called"),J.update(null),W.clear(),n.text(""),i.text(""),s.text(""),Be(),navigator.onLine&&window._recorderCtrl.reset(),ou(o,!1),Ue(!1),je(!1),window._captureCtrl.stop(),X=!1,_youtubeCtrl.reset(),document.fullscreen&&document.exitFullscreen(),A=!1,R=!1,D&&(clearTimeout(D),D=null),N&&(clearTimeout(N),N=null),window.cc.stop(),Ze(!1)}function Ue(e){ou(r,e),ou(a,e),ou(c,e),je(e),Ve(e),Ge(e),window._recorderCtrl.enable(e)}function je(e){e&&O?r.html("Transmit Screensharing"):r.html(e?"Stop Screensharing":"Start Screensharing")}function Ve(e){a.html(e?"Unmute Audio":"Mute Audio")}function Ge(e){c.html(e?"Unmute Video":"Mute Video")}function qe(e,t,n,i){if(E(`[channelCtrl] setTx - txEnabled: ${e} - mediaVoice: ${t} - avconf: ${n} - screen: ${i}`),e){if(ou(r,!0),ou(a,!0),ou(c,!0),window._recorderCtrl.enable(!0),n){const e="hires";We((()=>{window._engine.publish(256e3,void 0,void 0,e)}))}if(i){const e=window.screenFramerate||5,t=window.screenBitrate||256e3;window._engine.publishScreen(t,e,void 0,!0),je(!0),window._channel.setSharingState(!0)}}else J.stopMirror(),window._captureCtrl.stop(),Ue(!1),Ze(!1)}function He(){return ze().length>0}function ze(){return n.val()}function We(e){window._captureCtrl.update((()=>{Je(),e&&e()}))}async function Je(){E("ChannelCtrl : updateEngineCaptureSource");const e=null===window._captureCtrl.audioSource()?"":window._captureCtrl.audioSource(),t=null===window._captureCtrl.videoSource()?"":window._captureCtrl.videoSource(),n=window._channel.isVideoMuted();n&&window._engine.txInfoAvconf().extStream&&window._captureCtrl.stop(),window._engine.setCaptureSource(e,n?void 0:t,n?void 0:window._captureCtrl.effectStream())}function Ye(e,t,n){const i=m[Math.abs(T(e))%m.length];let s=n<3e3?3e3:n;s>1e4&&(s=1e4),E(`[Closed Caption] Show user: ${e}, text: ${t}, duration: ${s}`),window.ccId?window.ccId++:window.ccId=1,window._channel.getMedias()&&l()("#media-cc-body").append(`<div id="cc${window.ccId}" class="tw fic sl" style="background-color:rgba(0,0,0,0.8);text-align:center;"><span style="color:${i}">${e}</span>: ${t}</div>`);const o=window.ccId;window.timeout.set(`cc${o}`,s,(()=>{l()(`#cc${o}`).remove(),l()("#media-cc-body").children().length})),l()("#media-cc-body-area")[0].scrollTo(0,l()("#media-cc-body")[0].scrollHeight)}function Ke(n,i,s,o,r){if(window._channel.isAudioMuted())return!1;if(n){const a=window._engine.txInfoAvconf(!0)?.mediaId;e+=1;const c={id:a,lang:i,text:n,ts:s,duration:o,delay:r,seq:e},l=[JSON.stringify(c)],d="CC",u=t.CTCP().format(d,l);E(`ChannelCtrl : onSpeechTextTx : ctcp: ${u}`),window._engine.requestSendPublicMessage(u,t.modes().privmsg),window._recorderCtrl.notifyCC(p.NAME,c);let h=o;0===h&&(h=1e3),Ye(p.NAME,n,h)}}function Xe(e,t){k=null==e||e,M=null==t||t,_.html(k?"Disable Audio":"Enable Audio"),y.html(M?"Disable Video":"Enable Video"),G()}function Ze(e){E("[Publisher State] "+(e?"Connected":"Not Connected"))}return window._youtubeCtrl.setCallbacks((function(){let e=!1;return window._engine.currentChannel()&&(e=X),e}),(function(){window._windowCtrl.setMediaWndYoutube(!0),document.fullscreen&&document.exitFullscreen()}),(function(){}),(function(){window._windowCtrl.setMediaWndYoutube(!1)})),r.click((function(){if(window._engine.isTxEnabled())if(O){O=!1,je(!0);const e=window.screenFramerate||5,t=window.screenBitrate||256e3;window._engine.publishScreen(t,e,void 0,!0)}else{const e=window._engine.toggleScreen();e||J.stopMirrorScreen(),je(e)}else E("cannot toggle screen state since user tx is off")})),o.on("click",(function(){E(`ChannelCtrl -> leaving channel ${window._engine.currentChannel()}`),window._engine.requestLeaveChannel(),channelLeftCB(),Fe()})),o.click((function(){E(`ChannelCtrl -> leaving channel ${_engine.currentChannel()}`),window._engine.requestLeaveChannel(),ou(_createChannelBtn,!0),Fe()})),W.setEventHandlers((function(e,t){e.preventDefault(),K.privateChat(t)}),(function(e){window._engine.requestTransmission(e,!0,!0)}),(function(e){window._engine.requestTransmission(e,!1,!0),Qe(e)&&Be()}),(function(e){window._engine.requestTransmission(e,!0,!1)}),(function(e){window._engine.requestTransmission(e,!1,!1),Qe(e)&&Be()}),(function(e){}),(function(e){window._engine.requestKickUser(e,"")}),(function(e){window._engine.requestChannelSetChatMuteUsers(window._engine.currentChannel(),[e],!0)}),(function(e){window._engine.requestChannelSetChatMuteUsers(window._engine.currentChannel(),[e],!1)}),(function(e){window._engine.requestSetChannelMode(window._engine.currentChannel(),"+b",e)}),(function(e){window._engine.requestSetChannelMode(window._engine.currentChannel(),"-b",e)})),{onEnterChannel:function(e,t){window._channel.getModes().U&&window._engine.requestUserList(e),t&&(n.text(e),i.text("")),window._engine.requestSendPrivateMessage(`GETMESSAGES #${e} 0`,"PPCS",CHAT_MODE_PRIVMSG),e.toLowerCase()==="".toLowerCase()&&window._engine.requestSetChannelMode(e,"+MU",""),ou(o,!0),K.enable(!0)},onChannelModes:function(e,t,n,i,s){if(E(`app -> ChannelCtrl::onChannelModes : channel: ${e}, mode: ${t}, modeParam: ${n}, flags: ${i}`),t&&t.length>0){const e=function(e){const t=e.split(" ");if(t.length>0){const n=[];let i=null;const s=t[0],o=t.length-1;let r=0,a=0,c=!0,l=!0,d=!1,u=s[a];for(;!d&&null!=u;){l&&(l=!1,r<o?(r+=1,i=t[r]):i=null);const h=u;let p=!1,m=!1;switch(h){case Z:c=!0;break;case Q:c=!1;break;case ce:case se:case ae:case ie:case fe:case _e:case oe:case ke:case Re:case Me:case ye:case Ce:case Se:case xe:case Ee:case $e:case De:case he:case Pe:case re:p=!0;break;case de:d=!0;case ee:case te:case Ie:p=!0,m=!0;break;case Te:case le:case ue:case ge:case we:case Ae:case ve:case be:case ne:case me:case Le:case Ne:p=!0,m=c;break;case pe:p=!0,m=c,m&&(i=e.slice(t[0].length).trim())}p&&(m?i&&i.length>0&&(l=!0,n.push({mode:h,modeParam:i,timeElapsed:0,add:c})):n.push({mode:h,modeParam:null,timeElapsed:0,add:c})),a+=1,u=s[a]}if(n.length>0)return n}return null}(t);if(e)Oe(e);else if(t.length>=2){const e=t[1],n=s.find((t=>t.mode===e));Oe([{mode:e,modeParam:null!=n?n.modeParam:"",timeElapsed:0,add:null!=n}])}}else Oe(s);!function(){const e=_youtubeCtrl.isAccessAllowed();if(e){const e=l()("#youtube-playlist-dropdown").find(".jq-dropdown-menu");e.empty();const t=_youtubeCtrl.playlist();for(let n=0;n<t.length;n++){const i=t[n];e.append(`<li><a href="#" id="${i.url}">${i.name}</a></li>`)}}l()("#youtube-playlist-dropdown a").click((function(e){const t=e.currentTarget.id;_youtubeCtrl.playLocal(t)})),ou(_youtubePlaylistBtn,e)}()},setInfo:function(e,t,n){s.text(n)},setLocalStream:function(e,t,n,i){if(i)n==I&&(window._engine.unpublishScreen(),window._windowCtrl.stopMirrorScreen(),je(!1),window._channel.setSharingState(!1));else if(window.localStream=e,window._engine.isTxEnabled()){ou(a,!0),ou(c,!0);const i=e.getVideoTracks().length,s=e.getAudioTracks().length;E(`app -> ChannelCtrl::setLocalStream : mediaid:${t}, type:${n}, videoTracks:${i}, audioTracks:${s}`),s>0&&R&&F(),i>0&&A&&window._engine.isTxTypeAVConf(n)&&j.stopStreamVideo(e),i>0||s>0?J.startMirror(e,t,n):J.stopMirrorMain(!0)}},setLocalStreamTrackEnded:function(e,t,n,i){"video"==t.kind&&i==I&&(window._engine.unpublishScreen(),J.stopMirrorScreen(),je(!1),window._channel.setSharingState(!1))},reset:Fe,setTx:qe,setTopic:function(e){i.text(e)},setRemoteMute:function(e){window._engine.requestSetUserMode(e?"+T":"-T"),R!=e&&(R=!R,F(),Ve(R))},onUserJoin:function(e,t){W.add(e,0,t)},onUserLeave:function(e){W.remove(e)},onMediaState:function(e,t,n){e.forEach(((e,t)=>{const n=e.stream?e.stream.getVideoTracks():null,i=n&&n.length>0?n[0].id:"null",s=e.stream?e.stream.getAudioTracks():null,o=s&&s.length>0?s[0].id:"null";E(`ChannelCtrl : onMediaState : owner:${e.metadata.owner}, me:${e.metadata.me}, mediaId:${e.metadata.mediaId}, vidTracks:${n?n.length:0}, vidTrackId:${i}, audTracks:${s?s.length:0}, audTrackId:${o}, active:${e.metadata.active}`)})),J.update({state:e,myMediaId:t,myMediaIdScreen:n})},onUserList:function(e){l().each(e,(function(t){const n=e[t];W.add(n.name,n.mode,n.umode)}))},onChatMessage:function(e,t,n,i,s,o){E(o),K.populateChatArea(e,o,n?window._engine.currentChannel():null,!0)},isInChannel:He,channel:ze,updateConnectionState:function(e){e?(ou(r,window._engine.isMediaVoice()),window._engine.isScreenPublished()&&je(!0)):Ue(!1)},updateCapture:We,updateEngineCaptureSource:Je,setPublishResponse:function(e,t,n){return n?(E(`[setPublishResponse] Error: ${n}`),window._channel.showTemporaryMessage(window.i18n.get("error-publish"),4),!1):(ou(c,!0),t||(A=!e,Ge(A)),!1)},screenSharingReady:function(){return O=!1,window._channel.setScreenSharingWaitingUserStart(!1),"safari"!=tl.webRTCAdapter.browserDetails.browser||(O=!0,window._channel.setScreenSharingWaitingUserStart(!0),je(!0),!1)},screenSharingPublished:function(){},screenSharingUnpublished:function(){l()("#control-screensharing").css("background-color","rgb(112,112,112)")},updateAudioMute:F,onSpeechTextTx:Ke,onSpeechTextRx:function(e,t){J.onSpeechTextRx(e,t),window._recorderCtrl.notifyCC(e,t)},onStatusMediaRx:function(e){Xe(e.includes("A"),e.includes("V")),E(`ChannelCtrl -> onStatusMediaRx : status:${e}, audioRxEnabled:${k}, videoRxEnabled:${M}`),window._engine.getMediaState()},speechRecognitionStart:function(){window.cc.start()},speechRecognitionStop:function(){window.cc.stop()},getSpeechRecognitionStatus:function(){return window.cc.started},showClosedCaption:Ye,publisherState:Ze,publisherConnecting:function(){E("[Publisher State] Connecting...")}};function Qe(e){return e===_nickTextField.val()}}function Xu(){let e=null;const t={};function n(){return(new Date).getTime()}function i(){for(const e in t)return!1;return!0}function s(){clearInterval(e)}function o(){if(!i()){const e=n();Object.keys(t).forEach((n=>{t[n].timeout<e&&((0,t[n].cb)(),delete t[n],i()&&s())}))}}function r(){e=setInterval(o,200)}return{start:r,stop:s,reset:function(){s(),r()},set:function(e,i,s){const o=n();t[e]||(t[e]={name:e,timeout:i+o,cb:s},r())},unset:function(e){t[e]&&(delete t[e],i()&&s())},get:function(e){return t[e]},getAll:function(){return t}}}var Zu=n(9824),Qu=n.n(Zu);function eh(){new Map;let e=0,t=0,n=0,i=0,s=0,o="",r=[],a=0,c=0,l=0,d=0,u=!1,h=5e3,p=!1,m="",w=!1,g=-1,f=!1,v=!1,b="";const _=1e4;function y(e){return w=e,!0}return{start:async function(n){e=n.poll_id||0,t=n.quiz_id||0,h=n.lifes_timeout||5e3,w=!1;const i=JSON.stringify({action:"pollStart",data:{pollId:e,quizId:t}}),s={method:"POST",timeout:_,headers:{"content-type":"application/json"},data:i,url:"/g/pollStart"+window.location.search};return await Qu()(s)},setQuestion:async function(t){if(n=t.question_id||0,i=t.seq||0,s=t.ts||0,o=t.text||"",r=t.options||[],a=t.duration||0,c=t.players||0,p=t.lifes_disallowed||!1,0===n)return Promise.reject("Poll start: No questionId received!");if(0===i)return Promise.reject("Poll start: No seq received!");if(0===s)return Promise.reject("Poll start: No ts received!");if(""===o)return Promise.reject("Poll start: No text received!");if(0===r.length)return Promise.reject("Poll start: No options received!");if(0===a)return Promise.reject("Poll start: No duration received!");const l={pollId:e,questionId:n,seq:i,ts:s,text:o,options:r,duration:a,players:c,lifesDisallowed:p};return Promise.resolve(l)},setSkey:function(e){m=e},getSkey:function(){return m},getPollId:function(){return e},getQuizId:function(){return t},getQuestion:function(c){const l={pollId:e,quizId:t,questionId:n,seq:i,ts:s,text:o,options:r,duration:a};return Promise.resolve(l)},answerQuestion:async function(n){const i=n.questionId||"";let s;if(w)return Promise.reject(`Poll question already answered! (${i})`);if(y(!0),0!==n.option&&1!==n.option&&2!==n.option)return Promise.reject("Poll answer question: No option received!");if(s=n.option,""===i)return Promise.reject("Poll answer question: No questionId received!");if(""===m)return Promise.reject("Poll answer question: No skey received!");const o=JSON.stringify({action:"pollAnswer",data:{pollId:e,quizId:t,skey:m,questionId:i,option:s}}),r={method:"POST",timeout:_,headers:{"content-type":"application/json"},url:"/g/pollAnswer"+window.location.search,data:o};return await Qu()(r)},useLife:async function(){const e=JSON.stringify({action:"pollUseLife",data:{skey:m}}),t={method:"POST",timeout:_,headers:{"content-type":"application/json"},url:"/g/pollUseLife"+window.location.search,data:e};return await Qu()(t)},getResult:async function(e){if(""===m)return Promise.reject("Quiz result: No skey received!");if(0===e.quiz_id)return Promise.reject("Quiz result: No quiz_id received!");const t=JSON.stringify({action:"pollResult",data:{quizId:e.quiz_id,skey:m}}),n={method:"POST",timeout:_,headers:{"content-type":"application/json"},url:"/g/pollResult"+window.location.search,data:t};return await Qu()(n)},setAnswered:y,getAnswered:function(){return w},setChoice:function(e){g=e},getChoice:function(){return g},setLifes:function(e){return l=e,!0},getLifes:function(){return l},setPoints:function(e){return d=e,!0},getPoints:function(){return d},setUsedLifes:function(e){return u=e,!0},getUsedLifes:function(){return u},getLifesTimeout:function(){return h},setPlaying:function(e){f=e},getPlaying:function(){return f},setContinueWatching:function(e){v=e},getContinueWatching:function(){return v},setLastPoll:function(e){return b=e,!0},getLastPoll:function(){return b},reset:function(){e=0,t=0,n=0,i=0,s=0,o="",r=[],a=0,c=0,l=0,d=0,u=!1,h=5e3,p=!1,m="",w=!1,g=-1,f=!1,v=!1,b=""}}}function th(){let e=()=>!1,t="",n=!1,i=!1,s="",o="",r=!1,a=null,c=!1,d="",u=!1,h="",p={};async function m(e){return(await navigator.mediaDevices.enumerateDevices()).filter((t=>t.kind===e))}async function w(){if(a){const e=await a.getVideoTracks();if(e.length>0){const t=e[0];a.removeTrack(t),t.stop()}const t=await a.getAudioTracks();if(t.length>0){const e=t[0];a.removeTrack(e),e.stop()}}return!1}async function g(){if(!((await m("audioinput")).length>0))return{error:"NoAudioInputError",message:"No audio input found"};{const e={audio:{deviceId:void 0}};try{a=await navigator.mediaDevices.getUserMedia(e)}catch(e){return E(`[devices] Audio Input Error found: ${e.name} - ${e.message}`),{error:e.name,message:e.message}}}return await w(),{}}async function f(){if(!((await m("videoinput")).length>0))return{error:"NoVideoInputError",message:"No video input found"};{const e={video:{deviceId:void 0}};try{a=await navigator.mediaDevices.getUserMedia(e)}catch(e){return E(`[devices] Video Input Error found: ${e.name} - ${e.message}`),{error:e.name,message:e.message}}}return await w(),{}}return{getConnectedDevices:m,getAudioInputDevices:function(){return m("audioinput")},setAudioInputDevice:async function(e){return t=e,t},getAudioInputDevice:function(){return t},muteAudioDevice:function(){return n=!0,!1},unmuteAudioDevice:function(){return n=!1,!1},isAudioDeviceMuted:function(){return n},muteAudioOutputDevice:function(){return i=!0,!1},unmuteAudioOutputDevice:function(){return i=!1,!1},isAudioOutputDeviceMuted:function(){return i},getAudioOutputDevices:function(){return m("audiooutput")},setAudioOutputDevice:async function(e){return s=e,!1},getAudioOutputDevice:function(){return s},getVideoInputDevices:function(){return m("videoinput")},setVideoInputDevice:function(e){return o=e,!1},getVideoInputDevice:function(){return o},muteVideoDevice:function(){return r=!0,!1},unmuteVideoDevice:function(){return r=!1,!1},isVideoDeviceMuted:function(){return r},setDeviceChangeCB:function(t){e=t},getDeviceChangeCB:function(){return e},updateAudioOutput:function(){const e=window._mediaWndsArray;if(e.length>0)for(let t=0;t<e.length;t+=1){const n=document.getElementById(`${e[t]}`),o=window._mediaWndsMap.get(parseInt(e[t]))?._stream;if(n)try{if(o&&0!==o.getAudioTracks().length){n.sinkId!==s&&n.setSinkId(s);const o=window._channel.getMediaState(e[t]);o.muted?n.muted=o.muted:n.muted=i}}catch(e){}}},startDefaultAudioStream:g,startDefaultWebcamStream:f,getDefaultStream:async function(){return a},stopDefaultStream:w,getPermissions:async function(){return{videoCapture:(await navigator.permissions.query({name:"camera"})).state,audioCapture:(await navigator.permissions.query({name:"microphone"})).state}},checkPermissions:async function(){const e=await f();c=!e.error,d=c?"":e.error;const t=await g();return u=!t.error,h=u?"":t.error,p={webcamAllowed:c,webcamError:d,audioAllowed:u,audioError:h,hasAudioInput:"NoAudioInputError"!==h,hasVideoInput:"NoVideoInputError"!==d},p},setStreamSrc:function(e){l()("#webcam_preview")[0].srcObject=e||window.devicesStream}}}function nh(){let e,t,n={},i=!1;function s(){Object.keys(n).forEach((e=>{try{n[e].context.close()}catch(e){console.log(e)}delete n[e]})),n={}}function o(){return i}return t=e=>{const t=e.mediaId,n=e.dataArray;if(!n)return E(`No data found for audioObject (${t})!`),!1;let i=0;i=128-n[0]>=0?128-n[0]:-(128-n[0]);let s=8*i;s>24&&(s=24);let o=e.order;o>3?o=0:o+=1,e.order=o,e.bar[o]=s,e.bar[0]+e.bar[1]+e.bar[2]+e.bar[3]+e.bar[4]>8&&0===s?s=4:e.bar[0]+e.bar[1]+e.bar[2]+e.bar[3]+e.bar[4]>4&&0===s&&(s=1),e.bar[0]+e.bar[1]+e.bar[2]+e.bar[3]+e.bar[4]>24?l()(`.audio_${t} > .bar`).css("background-color","rgb(0,255,0)"):l()(`.audio_${t} > .bar`).css("background-color","rgb(152,164,152,0.5)"),l()(`.audio_${t} > .bar`).eq(`${o}`).height(s)},{reset:s,isStarted:o,start:function(){return o()||(s(),i=!0,e=setInterval((()=>{t&&!window.hideVuMeter?Object.keys(n).forEach((e=>{if(n[e].analyser&&window._channel.getMedias().includes(n[e].owner))try{n[e].analyser.getByteTimeDomainData(n[e].dataArray),t(n[e])}catch(e){E(e)}else E(`[VuMeter] Audio object: removing for mediaId ${e}!`),n[e]=null,delete n[e]})):Object.keys(n).forEach((e=>{l()(`.audio_${e} > .bar`).height(0)}))}),400)),!1},stop:function(){return e&&clearInterval(e),s(),i=!1,!1},setRefreshCallback:async function(e){return t=e,!1},startMedia:function(e){if(!o())return E(`[VuMeter] not started${e}`),!1;if(n[e])return!1;const t=window._mediaWndsMap.get(e);if(!t)return E(`[VuMeter] No media found for ${e}! Could not start!`),!1;let i;if(i=t.stream(),!i){if(!t.streamRec())return E(`[VuMeter] No stream found for ${e}! Could not start!`),!1;i=t.streamRec()}let s=!1;if(window._channel.getMyMedia()){if(window._channel.getMyMedia()[0].metadata.mediaId===e&&(i=window.localStream,s=!0,0===i.getAudioTracks().length))return E(`[VuMeter] No audio tracks found on ${e}`),!1}else if(0===i.getAudioTracks().length)return E(`[VuMeter] No audio tracks found on ${e}! Could not start!`),!1;if(0===i.getAudioTracks().length&&!s)return E(`[VuMeter] No audio tracks found on ${e}`),!1;setTimeout((()=>(n[e]||(n[e]={},n[e].owner=t.metadata.owner,n[e].mediaId=e,n[e].context=new AudioContext,n[e].analyser=n[e].context.createAnalyser(),n[e].source=n[e].context.createMediaStreamSource(i),n[e].source.connect(n[e].analyser),n[e].analyser.fftSize=32,n[e].bufferLength=n[e].analyser.frequencyBinCount,n[e].dataArray=new Uint8Array(n[e].bufferLength),n[e].order=0,n[e].bar=[0,0,0,0,0]),!1)),2e3)},stopMedia:function(e){try{n[e]&&n[e].context.close()}catch(e){E(e)}delete n[e]},getAudioObject:function(){return n}}}const ih="MEMORY",sh="LOCALSTORAGE",oh="CREATE",rh="READ",ah="UPDATE",ch="DELETE";class lh{constructor(e,t,n,i,s){switch(this._storageType=sh,this._operator=e||"",this._set=t,this._key=n,this._value=i,this._timeout=s,this._operator){case oh:return this.create(this._set,this._key,this._value);case rh:return this.read(this._set,this._key);case ah:return this.update(this._set,this._key,this._value);case ch:return this.delete(this._set,this._key);default:throw new Error(`[${this.storageType}]: Invalid Operator!`)}}async setSetKey(e,t){const n=await this.getSet(e);return n.includes(`${t}`)||n.push(`${t}`),await this.set(e,JSON.stringify(n)),await this.getSet(e)===n||(this.error(),!1)}async delSetKey(e,t){const n=(await this.getSet(e)).filter((function(e){return e!==t}));return await this.set(e,JSON.stringify(n)),!0}async getSet(e){const t=await this.get(e);let n=[];if(null!==t)try{if(n=JSON.parse(t),!Array.isArray(n))return this.error(),!1}catch(e){return E(e),this.error(),!1}return n}async setItem(e,t){return!(!await this.set(e,t)||await this.get(e)!==t)||(this.error(),!1)}async set(e,t){return localStorage.setItem(e,t),!0}async get(e){return localStorage.getItem(e)}async del(e){return localStorage.removeItem(e),!0}async error(){return E(`[${this._storageType}]: Operation=${this._operator} Set=${this._set} Key=${this._key} Value=${this._value} Error!`),!0}async create(e,t,n){const i=await this.getSet(e);0===i.length&&await this.setItem(e,JSON.stringify([])),i.includes(t)||await this.setSetKey(e,`${t}`);const s=await this.set(`${e}.${t}`,n),o=await this.get(`${e}.${t}`);return!(!s||o!==n)||(await this.error(),!1)}async read(e,t=null){const n=await this.getSet(e);return t&&n.includes(`${t}`)?await this.get(`${e}.${t}`):null===t&&n}async update(e,t,n){return this.create(e,t,n)}async delete(e,t=null){const n=await this.getSet(e);if(null!==t)return await this.delSetKey(e,t),await this.del(`${e}.${t}`),!0;const i=this.del;return n.forEach((async function(t){await i(`${e}.${t}`)})),await this.del(e),0===(await this.getSet(e)).length||(await this.error(),!1)}}class dh{constructor(e,t,n,i,s){switch(this._storageType=ih,this._operator=e||"",this._set=t,this._key=n,this._value=i,this._timeout=s,this._operator){case oh:return this.create(this._set,this._key,this._value);case rh:return this.read(this._set,this._key);case ah:return this.update(this._set,this._key,this._value);case ch:return this.delete(this._set,this._key);default:throw new Error(`[${this.storageType}]: Invalid Operator!`)}}async setSet(e){return!window.memoryStorage[e]&&(window.memoryStorage[e]={},!0)}async getSet(e){return window.memoryStorage[e]||(window.memoryStorage[e]={}),window.memoryStorage[e]}async setSetKey(e,t,n){return window.memoryStorage[e]||await this.setSet(e),window.memoryStorage[e][t]=n,!1}async delSetKey(e,t){return window.memoryStorage[e]&&window.memoryStorage[e][t]?(delete window.memoryStorage[e][t],!0):(this.error(),!1)}async delSet(e){return window.memoryStorage[e]?(delete window.memoryStorage[e],!0):(this.error(),!1)}async error(){return E(`[${this._storageType}]: Operation=${this._operator} Set=${this._set} Key=${this._key} Value=${this._value} Error!`),!0}async create(e,t,n){return await this.setSetKey(e,t,n),!0}async read(e,t=null){return window.memoryStorage[e]||await this.setSet(e),null===t?Object.keys(window.memoryStorage[e]):window.memoryStorage[e][t]}async update(e,t,n){return this.create(e,t,n)}async delete(e,t=null){return null!==t?(await this.delSetKey(e,t),!0):(await this.delSet(e),!0)}}class uh{static async create(e,t,n,i,s=0){let o=!1;switch(e){case sh:o=new lh(oh,t,n,i,s);break;case ih:o=new dh(oh,t,n,i)}return o}static async read(e,t,n){let i=!1;switch(e){case sh:i=new lh(rh,t,n);break;case ih:i=new dh(rh,t,n)}return i}static async update(e,t,n,i){let s=!1;switch(e){case sh:s=new lh(ah,t,n,i);break;case ih:s=new dh(ah,t,n,i)}return s}static async delete(e,t,n){let i=!1;switch(e){case sh:i=new lh(ch,t,n);break;case ih:i=new dh(ch,t,n)}return i}}class hh{constructor(e){this._memory=ih,this._storageType=sh,this._sessionId=e}async setUserTime(e,t){return await uh.create(this._memory,`${this._sessionId}.time`,`${e}`,JSON.stringify(t))}async getUserTime(e){return await uh.read(this._memory,`${this._sessionId}.time`,`${e}`)}async clearUserTime(e){return await uh.delete(this._memory,`${this._sessionId}.time`,`${e}`)}async getAllUserTime(){const e=[],t=await uh.read(this._memory,`${this._sessionId}.time`),n=t.filter((e=>/^session-\d+$/.test(e)));let i="m"!==window._channel.getSuffix()&&"l"!==window._channel.getSuffix()?[_channel.getCsmObject().owner,...n]:t;i=i.filter((e=>!/^-?\d+(\.\d+)?$/.test(e)));const s=this._sessionId;return await async function(){for(const t of i){const n=t,i=window._channel.getUser(n);let o=t;i&&i.fullname&&(o=i.fullname);const r=await new hh(s).getUserTime(n);if(r){const t={};t.time=r,t.fullname=o,t.nick=n,e.push(t)}}return e}()}async clearAllUserTime(){return await uh.delete(this._storageType,`${this._sessionId}.time`)}async setUserJoin(e,t){E(`[Session Statistics] [setUserJoin] nick: ${e} - ts: ${t}`);let n=[];const i=JSON.stringify({nick:e,ts:t}),s=await this.getUserJoin(e);let o;if(s)try{if(o=JSON.parse(s),!Array.isArray(o))return E(`[setUserJoin]: ${e} stored value ${o} is not array!`),!1;n=o}catch(e){return E(`[setUserJoin] Error: ${e}`),!1}return n.push(i),await uh.create(this._storageType,`${this._sessionId}.join`,`${e}`,JSON.stringify(n))}async getUserJoin(e){return await uh.read(this._storageType,`${this._sessionId}.join`,`${e}`)}async clearUserJoin(e,t){return await uh.delete(this._storageType,`${this._sessionId}.join`,`${e},${t}`)}async getAllUserJoin(){const e=[],t=await uh.read(this._storageType,`${this._sessionId}.join`),n=this._sessionId;return await async function(){for(const i of t){const t=i,s=await new hh(n).getUserJoin(t);if(s){const t=JSON.parse(s);for(const n of t){const t=JSON.parse(n),s=i,o=window._channel.getUser(s);let r=s;o.fullname&&(r=o.fullname),t.fullname=r,t.nick=s,t.action="join",e.push(t)}}}return e}()}async clearAllUserJoin(){return await uh.delete(this._storageType,`${this._sessionId}.join`)}async setUserLeft(e,t){E(`[Session Statistics] [setUserLeft] nick: ${e} - ts: ${t}`);let n=[];const i=JSON.stringify({nick:e,ts:t}),s=await this.getUserLeft(e);let o;if(s)try{if(o=JSON.parse(s),!Array.isArray(o))return E(`[setUserLeft]: ${e} stored value ${o} is not array!`),!1;n=o}catch(e){return E(`[setUserLeft] Error: ${e}`),!1}return n.push(i),await uh.create(this._storageType,`${this._sessionId}.left`,`${e}`,JSON.stringify(n))}async getUserLeft(e){return await uh.read(this._storageType,`${this._sessionId}.left`,`${e}`)}async clearUserLeft(e){return await uh.delete(this._storageType,`${this._sessionId}.left`,`${e}`)}async getAllUserLeft(){const e=[],t=await uh.read(this._storageType,`${this._sessionId}.left`),n=this._sessionId;return await async function(){for(const i of t){const t=i.split(",")[0],s=i.split(",")[1],o=await new hh(n).getUserLeft(t,s);if(o){const t=JSON.parse(o);for(const n of t){const t=i,s=window._channel.getUser(t);let o=t;s.fullname&&(o=s.fullname);const r=JSON.parse(n);r.fullname=o,r.nick=t,r.action="part",e.push(r)}}}return e}()}async clearAllUserLeft(){return await uh.delete(this._storageType,`${this._sessionId}.left`)}async setUserTxStart(e,t=1e3){await window.timerWorker.getTimer(`${this._sessionId},${e}`)?await window.timerWorker.startTimer(`${this._sessionId},${e}`):await window.timerWorker.startTimer(`${this._sessionId},${e}`,t)}async setUserTxEnd(e){await window.timerWorker.stopTimer(`${this._sessionId},${e}`)}async setUsersTxEnd(){await window.timerWorker.stopTimers(`${this._sessionId},`)}async getUserTxTime(e){const t=await window.timerWorker.getTimer(`${this._sessionId},${e}`);return t?(t.ts+=6e3,t):t}async getUsersTxTime(){return window.timerWorker.getTimers(`${this._sessionId},`)}async clearAllUsersTxTime(){return window.timerWorker.reset(`${this._sessionId},`)}async setUserMessageSendCounter(e){let t=1;const n=await uh.read(this._memory,`${this._sessionId}.messageCounter`,`${e}`);n&&(t=parseInt(n)+1),await uh.create(this._memory,`${this._sessionId}.messageCounter`,`${e}`,JSON.stringify(t))}async getUserMessageSendCounter(e){return await uh.read(this._memory,`${this._sessionId}.messageCounter`,`${e}`)}async setUserAttachmentCounter(e){let t=1;const n=await uh.read(this._memory,`${this._sessionId}.attachmentCounter`,`${e}`);n&&(t=parseInt(n)+1),await uh.create(this._memory,`${this._sessionId}.attachmentCounter`,`${e}`,JSON.stringify(t))}async getUserAttachmentCounter(e){return await uh.read(this._memory,`${this._sessionId}.attachmentCounter`,`${e}`)}async clearAllUserAttachmentCounter(){return await uh.delete(this._memory,`${this._sessionId}.attachmentCounter`)}async setUserRaiseHandCounter(e,t){if(t)await uh.create(this._memory,`${this._sessionId}.raiseHandCounter`,`${e}`,t);else{let t=1;const n=await uh.read(this._memory,`${this._sessionId}.raiseHandCounter`,`${e}`);n&&(t=n+1),await uh.create(this._memory,`${this._sessionId}.raiseHandCounter`,`${e}`,t)}}async getUserRaiseHandCounter(e){return await uh.read(this._memory,`${this._sessionId}.raiseHandCounter`,`${e}`)}async clearAllUserRaiseHandCounter(){return await uh.delete(this._memory,`${this._sessionId}.raiseHandCounter`)}async clearAllSessionData(){return await this.clearAllUserTime(),await this.clearAllUserJoin(),await this.clearAllUserLeft(),await this.clearAllUserRaiseHandCounter(),await this.clearAllUserAttachmentCounter(),await this.clearAllUsersTxTime(),!0}}const ph=new Blob(['\n/**\n * Class representing a TimerWorker webworker.\n * Date: 2024-04-04\n * Author: ip.tv\n*/\nclass TimerWorker {\n    constructor() {\n        this.timeoutMap = new Map();\n        this.loop = null;\n        this.timersObject = {};\n        if (self.performance) {\n            this.tsDiff = 0;\n            if (self.performance.timeOrigin) {\n                this.timeOrigin = self.performance.timeOrigin;\n            } else {\n                this.timeOrigin = null;\n            }\n        }\n        this.startLoop();\n    }\n\n    getUserTs() {\n        let userTs;\n        if (this.timeOrigin) {\n            userTs = this.timeOrigin + performance.now();\n        } else {\n            userTs = new Date().getTime();\n        }\n        return userTs;\n    }\n\n    setServerTs(serverTs) {\n        const userTs = this.getUserTs();\n        this.tsDiff = serverTs - userTs;\n        return this.tsDiff;\n    }\n\n    getServerTs() {\n        const userTs = this.getUserTs();\n        return userTs + this.tsDiff;\n    }\n\n    now() {\n        return this.getServerTs();\n    }\n\n    getFormDate(ts) {\n        const date = new Date(ts);\n        const day =\n            date.getDate() < 10 ? "0"+date.getDate() : date.getDate();\n        const month =\n            date.getMonth() < 9\n                ? "0" + (date.getMonth() + 1)\n                : date.getMonth() + 1;\n        const year = date.getFullYear();\n        const hours =\n            date.getHours() < 10 ? "0" + date.getHours() : date.getHours();\n        const minutes =\n            date.getMinutes() < 10\n                ? "0" + date.getMinutes()\n                : date.getMinutes();\n        const result = year + "-" + month + "-" + day + "T" + hours + ":" + minutes;\n        return result;\n    }\n\n    toString(ts) {\n        const d = new Date(ts);\n        const date = d.toLocaleDateString();\n        const hours =\n            d.getHours() < 10 ? "0" + d.getHours() : d.getHours();\n        const minutes =\n            d.getMinutes() < 10 ? "0" + d.getMinutes() : d.getMinutes();\n        const dTime = hours + ":" + minutes;\n        const result = date + " " + dTime;\n        return result;\n    }\n\n    startLoop() {\n        this.loop = setInterval(() => {\n            if (this.timeoutMap.size !== 0) {\n                this.timeoutMap.forEach((obj, id) => {\n                    const timeoutTs = obj.timeoutTs;\n                    if (self.performance.now() > timeoutTs) {\n                        postMessage({ type: "setTimeout", id: obj.id, seq: obj.seq });\n                        this.timeoutMap.delete(id);\n                    }\n                });\n            }\n        }, 1000);\n    }\n\n    stopLoop() {\n        if (this.loop) {\n            clearInterval(this.loop);\n        }\n    }\n\n    setTimeout(id, ts, seq) {\n        const timeoutTs = self.performance.now() + ts;\n        this.timeoutMap.set(id, { id, timeoutTs, seq });\n    }\n\n    clearTimeout(id) {\n        this.timeoutMap.delete(id);\n    }\n\n    getTimeout() {\n        return this.timeoutMap;\n    }\n\n    startTimer(_timer, _ts) {\n        const ts = _ts || 0;\n        const lastTs = this.now();\n\n        if (!this.timersObject[_timer]) {\n            this.timersObject[_timer] = {\n                totalTs: ts,\n                lastTs,\n                started: true,\n            };\n        }\n        if (this.timersObject[_timer].started) {\n            return this.timersObject[_timer];\n        }\n        this.timersObject[_timer].lastTs = lastTs - ts;\n        this.timersObject[_timer].started = true;\n        return this.timersObject[_timer];\n    }\n\n    stopTimer(_timer) {\n        const nowTs = this.now();\n        if (this.timersObject[_timer]?.started) {\n            if (this.timersObject[_timer]) {\n                this.timersObject[_timer].started = false;\n                this.timersObject[_timer].totalTs +=\n                    nowTs - this.timersObject[_timer].lastTs;\n            }\n        }\n        return this.timersObject[_timer];\n    }\n\n    removeTimer(_timer) {\n        if (this.timersObject[_timer]) {\n            delete this.timersObject[_timer];\n            return true;\n        }\n        return false;\n    }\n\n    stopTimers(category) {\n        if (category) {\n            for (let id in this.timersObject) {\n                if (id.includes(category)) {\n                    this.stopTimer(id);\n                }\n            }\n        } else {\n            Object.keys(this.timersObject).forEach((_timer) => {\n                this.stopTimer(_timer);\n            });\n        }\n\n        return this.timersObject;\n    }\n\n    getTimer(_timer) {\n        const ret = {};\n        if (this.timersObject[_timer]) {\n            const nowTs = this.now();\n            ret.name = _timer;\n            if (this.timersObject[_timer]?.started) {\n                ret.ts =\n                    this.timersObject[_timer].totalTs +\n                    nowTs -\n                    this.timersObject[_timer].lastTs;\n                ret.started = this.timersObject[_timer].started;\n                return ret;\n            }\n            if (this.timersObject[_timer]) {\n                ret.ts = this.timersObject[_timer].totalTs;\n                ret.started = this.timersObject[_timer].started;\n                return ret;\n            }\n            return false;\n        }\n        return false;\n    }\n\n    getTimers(category) {\n        const timers = {};\n        if (category) {\n            for (let id in this.timersObject) {\n                if (id.includes(category)) {\n                    const timer = this.getTimer(id);\n                    timers[id] = timer.ts;\n                }\n            }\n        } else {\n            Object.keys(this.timersObject).forEach((_timer) => {\n                const timer = this.getTimer(_timer);\n                timers[_timer] = timer.ts;\n            });\n        }\n        return timers;\n    }\n\n    reset(category) {\n        if (category) {\n            for (let id in this.timersObject) {\n                if (id.includes(category)) {\n                    delete this.timersObject[id];\n                }\n            }\n        } else {\n            this.timersObject = {};\n        }\n        return true;\n    }\n\n}\n\nconst timerWorker = new TimerWorker();\n\nonmessage = function (e) {\n    const data = e.data;\n    const type = data.type;\n    const seq = data.seq;\n    if (type === "getUserTs") {\n        postMessage({\n            type,\n            userTs: timerWorker.getUserTs(),\n            seq,\n        });\n    } else if (type === "setServerTs") {\n        const tsDiff = timerWorker.setServerTs(data.serverTs);\n        postMessage({\n            type,\n            tsDiff: tsDiff,\n            seq,\n        });\n    } else if (type === "getServerTs") {\n        postMessage({\n            type,\n            serverTs: timerWorker.getServerTs(),\n            seq,\n        });\n    } else if (type === "now") {\n        postMessage({\n            type,\n            now: timerWorker.now(),\n            seq,\n        });\n    } else if (type === "getFormDate") {\n        postMessage({\n            type,\n            formDate: timerWorker.getFormDate(data.ts),\n            seq,\n        });\n    } else if (type === "toString") {\n        postMessage({\n            type,\n            string: timerWorker.toString(data.ts),\n            seq,\n        });\n    } else if (type === "setTimeout") {\n        timerWorker.setTimeout(data.id, data.ts, data.seq);\n    } else if (type === "clearTimeout") {\n        timerWorker.clearTimeout(data.id);\n        postMessage({\n            type,\n            id: data.id,\n            seq,\n        });\n    } else if (type === "startTimer") {\n        postMessage({\n            type,\n            timer: timerWorker.startTimer(data._timer, data._ts),\n            seq,\n        });\n    } else if (type === "stopTimer") {\n        postMessage({\n            type,\n            timer: timerWorker.stopTimer(data._timer),\n            seq,\n        });\n    } else if (type === "removeTimer") {\n        postMessage({\n            type,\n            success: timerWorker.removeTimer(data._timer),\n            seq,\n        });\n    } else if (type === "stopTimers") {\n        postMessage({\n            type,\n            timers: timerWorker.stopTimers(data.category),\n            seq,\n        });\n    } else if (type === "getTimer") {\n        postMessage({\n            type,\n            timer: timerWorker.getTimer(data._timer),\n            seq,\n        });\n    } else if (type === "getTimers") {\n        postMessage({\n            type,\n            timers: timerWorker.getTimers(data.category),\n            seq,\n        });\n    } else if (type === "reset") {\n        postMessage({\n            type,\n            success: timerWorker.reset(data.category),\n            seq,\n        });\n    } else {\n        console.error("[TimeWorker] Invalid message type: " + data.type);\n    }\n}\n'],{type:"application/javascript"}),mh=URL.createObjectURL(ph),wh=new Worker(mh);function gh(){let e={},t=!0,n=0,i=[],s=[],o={},r=[],a=[],c=[],d="",u="",h=!1,m=!1,w=!1,g={},f="",v="",b=null,_=!1,y=4,C=0,S=!0,x=!1;const k=new Map;async function M(e){return await Z(e)}async function T(e){const t=e;return await new Promise((e=>{i.forEach((n=>{if(n.id===t)return e(n),!1;n.categories&&n.categories.forEach((n=>{if(n.id===t)return e(n),!1;n.categories&&n.categories.forEach((async n=>{if(n.id===t)return e(n),!1;n.categories&&n.categories.forEach((n=>{if(n.id===t)return e(n),!1}))}))}))}))}))||!1}async function I(){return n}async function R(){return n+=1,n}function A(){return a}async function $(){const e={},t=await window.session.statistics(window.session_id).getAllUserTime();for(let n=0;n<t.length;n+=1){const i=parseFloat(t[n].time)+5e3;Number.isNaN(parseFloat(t[n].time))||/^session-\d+$/.test(t[n].nick)||(e[`${t[n].nick}`]=`${i}`)}return Object.entries(e)}async function L(){const e=window.session_id,t={},n=[],i=await $(),s=window.session_max_duration;window.live_duration=0;for(const[e,t]of i){const i=e;let o=e;const r=window._channel.getUser(i);r&&r.fullname&&(o=r.fullname);let a=parseInt(t/1e3)>s?s:parseInt(t/1e3);a||(a=0);let c=await window.session.statistics(window.session_id).getUserTxTime(i);c=parseInt(c.ts/1e3),c||(c=0);const l=await window.session.statistics(window.session_id).getUserAttachmentCounter(i),d=await window.session.statistics(window.session_id).getUserMessageSendCounter(i),u=await window.session.statistics(window.session_id).getUserRaiseHandCounter(i);n.push({nick:i,user_name:o,duration:a,tx_duration:c,attachment_count:l,text_count:d,raise_hands_count:u}),a>window.live_duration&&(window.live_duration=a)}return t.report={presence:n},t.live_duration=window.live_duration,ie(e,t)}function P(){window.Events.dispatch("session/timer-hide")}async function D(e){return q([...await new hh(e).getAllUserJoin(),...await new hh(e).getAllUserLeft()],"ts")}return{getSessionInfo:M,getActiveSessionInfo:async function(){return await Q(window._engine.currentChannel())},getSessionsListInfo:async function(e){return await ee(e)},getRootCategories:async function(){0===i.length&&(i=await mi({parent_id:"null",root_tree:!0}));const e=i.filter((e=>(k.set(e.id,e),e.required&&(s.includes(e.id)||s.push(e.id)),!c.includes(e.id))));return e},getCategories:async function(e){const t=(await T(parseInt(e))).categories.filter((e=>(k.set(e.id,e),!c.includes(e.id))));return t},insertCategory:async function(n){const i=n;let s=await I();return t?(s=await R(),e[s]=[],e[s].push(i)):e[s].push(i),t=!!i.selectable,i.allow_multi_selection||c.push(i.id),r.includes(i.id)||r.push(i.id),i.selectable&&a.push(i.id),i.selectable},getSessions:function(){return e},removeSession:function(n){const i=e[n];return e[n]=[],i.forEach((e=>{r=B(r,e.id),a=B(a,e.id),c=B(c,e.id),t=!0})),!1},getSessionId:I,increaseSessionId:R,getCategory:function(e){return k.get(e)},getRootRequiredCategories:function(){return s},getSelectedCategories:function(){return r},setSelectableCategory:function(e){return!a.includes(e)&&(a.push(e),!0)},getSelectableCategories:A,setTitle:async function(e){return d=e,d},getTitle:function(){return d},setReferenceDate:async function(e){return u=new Date(e).toISOString(),u},getReferenceDate:function(){return u},getReferenceDateString:function(){const e=new Date(u);return`${e.getDate()<10?`0${e.getDate()}`:e.getDate()}/${e.getMonth()+1<10?`0${e.getMonth()+1}`:`${e.getMonth()+1}`}/${e.getFullYear()} - ${e.getHours()<10?`0${e.getHours()}`:e.getHours()}:${e.getMinutes()<10?`0${e.getMinutes()}`:e.getMinutes()}`},create:async function(e={}){const t={};t.title=d,t.reference_date=u,t.realm=window.realm,t.owner=p.NICK,t.channel=window._channel.getName(),t.channel_topic=window._channel.getTopic()||t.channel,t.category_ids=A(),t.extras=e,E(`[recording create session] Request body: ${JSON.stringify(t)}`);const n=await J(t);return E(`[recording create session] Response result: ${JSON.stringify(n)}`),n},start:async function(e={},t){const n={};n.title=d,n.reference_date=u,n.channel=window._channel.getName(),n.channel_topic=window._channel.getTopic()||n.channel,n.category_ids=A(),n.irm_server=window.irmServer,n.extras=e,E(`[recording start session] Request body: ${JSON.stringify(n)}`);const i=await K(n,t);return window.sessionFinishedAt=new Date(i.finished_at).getTime(),window.sessionMaxDuration=i.max_duration,E(`[recording start session] Start result: ${JSON.stringify(i)}`),i&&(h=!0),m=!1,i},stop:async function(){return h=!1,!1},continueSession:async function(e){return E(`[recording session] Continuing session: ${JSON.stringify(e)}`),window.session_id=e.id,window.sessionFinishedAt=new Date(e.finished_at).getTime(),window.sessionMaxDuration=e.max_duration,d=e.title,u=e.reference_date,v="record",b=e.id,h=!0,m=!1,!0},startUserListUpdate:async function(){let e=0,t=0;if(window.timerWorker.clearInterval("updateUserList"),window.stopUserListUpdate)return console.log("[startUserListUpdate] UserListUpdate: disabled!"),!1;const n=await window.session.getSessionInfo(window.session_id);window.session_max_duration=n.max_duration;const i=n.reports||[],s={};for(const e of i){s[e.nick]=e;const t=e.nick,n=(e.user_name,e.live_transmitted_time||0),i=e.live_chat_attachment_count||0,o=e.live_chat_text_count||0,r=e.live_raise_hands_count||0,a=1e3*e.live_watched_time||0;if(a){let e;const n=await window.timerWorker.getTimer(`session-${t}`);e=n?n.ts+5e3:a+6e4,await window.timerWorker.removeTimer(`session-${t}`),await window.timerWorker.startTimer(`session-${t}`,e),window.Events.dispatch("session/timer-control",{event:"startTimer",nick:`session-${t}`,watchedTime:e}),window.timerWorker.stopTimer(`session-${t}`),window.Events.dispatch("session/timer-control",{event:"stopTimer",nick:`session-${t}`})}n&&(await window.session.statistics(window.session_id).setUserTxStart(t,1e3*(n+65)),await window.session.statistics(window.session_id).setUserTxEnd(t)),i&&window.session.statistics(window.session_id).setUserAttachmentCounter(t,i),o&&window.session.statistics(window.session_id).setUserMessageSendCounter(t,o),r&&window.session.statistics(window.session_id).setUserRaiseHandCounter(t,r)}return await window.timerWorker.setInterval("userListUpdate",(async()=>{let n;if((await window.breakoutRoom.rooms).length>0?(0===e&&await window.breakoutRoom.getUsers((e=>{window.breakoutRoomUsers=e;const t=document.querySelector(".bkr_rooms_area");if(t){t.innerHTML="";const e=window.breakoutRoom.rooms;let n="";for(let t=0;t<e.length;t+=1){n+=`<div id="bkr_room_${e[t].c}" class="bkr_room fc w100 pt5 pb5 pl10 pr10 bor br" room="${e[t].c}" style="border: 1px solid #AAA;margin-top:5px;">`,n+='<div class="fr w100">',n+=`<div class="bkr_expand toj pr5 pt material-icons" room="${e[t].c}">expand_more</div>`,n+=`<div id="bkr_room${e[t].c}_name" class="bkr_room_label sl fic toj pt" room="${e[t].c}">${e[t].n}</div>`,n+='<div class="fig"></div>',n+=`<div id="bkr_add_users_${e[t].c}" class="bkr_add_users sn fic pt toj pr10" room="${e[t].c}">${window.i18n.get("add")}</div>`,n+=`<div class="bkr_more material-icons"room="${e[t].c}">more_vert</div>`,n+="</div>",n+='<div class="bkr_expand_area">';const i=e[t].u;if(i)for(let s=0;s<i.length;s+=1){const o=i[s],r=o.nick,a=o.name;n+=`<div class="fr"><div class="bkr_room_remove bkr_room_move pt pr10" name="${r}" room="${e[t].c}" style="position:relative;">${a}</div><div id="move-${r}" room="${e[t].c}"></div></div>`}n+="</div>",n+="</div>"}t.innerHTML=n}})),e+=1,e>15&&(e=0)):window.breakoutRoomUsers=[],window.breakoutRoomUsers||(window.breakoutRoomUsers=[]),0===window.breakoutRoomUsers.length)n=window._channel.getUsers();else{n=[];for(let e=0;e<window.breakoutRoomUsers.length;e+=1)n.push(window.breakoutRoomUsers[e].name)}7===t?(window.navigator.onLine&&L(),t=1):t+=1;let i=null;return n.forEach((async e=>{const t=e.replace("-web","");i=await window.timerWorker.getTimers("session-");const s=await window.timerWorker.getTimer(`session-${t}`);if(window.Events.dispatch("session/timer-control",{event:"getTimer",user:`session-${t}`,userTimer:s,sessionUser:!0}),s&&s.started?p.CONFIG.alwaysRecordSessions&&(window._recorderCtrl.isStarted()?l()("#session-recording").show():(l()("#session-recording").show(),window.Events.dispatch("session/timer-control",{event:"stopTimer",user:`session-${t}`}),console.log(`Stopped timer for user ${t}`),p.AUDIO_SESSION_ERROR.play(),l()("#session-recording").hide())):p.CONFIG.alwaysRecordSessions&&(window._recorderCtrl.isStarted()?(l()("#session-recording").show(),E(`[Session] Started Timer for ${t}`),window.Events.dispatch("session/timer-control",{event:"startTimer",user:`session-${t}`}),window.timerWorker.startTimer(`session-${t}`)):(window.Events.dispatch("session/timer-control",{event:"stopTimer",user:`session-${t}`}),l()("#session-recording").hide())),i){const e=Object.keys(i);for(let t=0;t<e.length;t+=1){const i=await window.timerWorker.getTimer(e[t])||{};window.Events.dispatch("session/timer-control",{event:"getTimer",user:e[t],userTimer:i});const s=i?.name?i.name.replace("session-",""):"",o=i?.ts||0;if(i.started&&(n.includes(s)||n.includes(`${s}-web`)||(E(`[Session] Stoped Timer for ${s}`),window.timerWorker.stopTimer(s),window.Events.dispatch("session/timer-control",{event:"stopTimer",name:s}))),(window._channel.getMedias().includes(s)||window._channel.getMedias().includes(`${s}-web`))&&window.session.isStarted()){i.started||window._recorderCtrl.isStarted()&&(l()("#session-recording").show(),window.timerWorker.startTimer(e[t]),window.Events.dispatch("session/timer-control",{event:"startTimer",user:e[t]}));const n=window._channel.getSuffix(),o=channel.getUserList().map((e=>e.name)),r=window._channel.getMedias();!0===(r.includes(e[t])||r.includes(`${e[t]}-web`)||"l"===n&&(o.includes(e[t])||o.includes(`${e[t]}-web`)))?(i.started||window._recorderCtrl.isStarted()&&(l()("#session-recording").show(),window.timer.startTimer(e[t]),window.Events.dispatch("session/timer-control",{event:"startTimer",user:e[t]})),window.session.statistics(window.session_id).setUserTxStart(e[t])):(i.started&&(window.timer.stopTimer(e[t]),window.Events.dispatch("session/timer-control",{event:"stopTimer",user:e[t]})),window.session.statistics(window.session_id).setUserTxEnd(e[t])),window.session.statistics(window.session_id).setUserTxStart(s)}else window.timerWorker.getTimer(`${window.session_id},${s}`)&&window.session.statistics(window.session_id).setUserTxEnd(s);window.session.statistics(window.session_id).setUserTime(s,o)}}})),!0}),1e4),!0},stopUserListUpdate:async function(){await window.timerWorker.clearInterval("userListUpdate"),E("[StopDefaultRecording] Reset Timer"),await window.timerWorker.reset("session-")},finishSession:async function(e,t){const n=h;h=!1;const i=te(e,t);return i?(window.session.statistics(window.session_id).setUsersTxEnd(),await window.timerWorker.clearInterval("userListUpdate"),await window.timerWorker.reset("session-"),await window.timerWorker.reset(`${window.session_id}`),i):(n&&(h=!0),!1)},sendPartialData:L,getUserListReport:$,setStarted:function(e){return h=e,e&&window._recorderCtrl.isStarted()&&(l()("#session-recording").show(),window.Events.dispatch("session/timer-show")),!1},isStarted:function(){return h&&window._recorderCtrl.isStarted()&&(l()("#session-recording").show(),window.Events.dispatch("session/timer-show")),h},setRunning:function(e){return m=e,!1},isRunning:function(){return m},startNeeded:function(e){w=e},isStartNeeded:function(){return w},setExtras:async function(e){return g=e,!1},getExtras:async function(){return g},setFinishAt:async function(e){return f=e,!1},getFinishAt:async function(){return f},reset:function(){h=!1,w=!1,m=!1,k.clear(),e={},n=0,t=!0,i=[],s=[],o={},r=[],a=[],c=[],d="",u="",g={},f="",v="",b=null,_=!1,y=4,C=0,S=!0,x=!1},findCategory:T,statistics:function(e){return new hh(e)},getSessionUserJoinLeaveReport:D,getSessionUserJoinLeaveReportCSV:async function(e){const t=await D(e),n=[];for(const e of t){const t=new Date(e.ts),i=t.toLocaleDateString(),s=`${t.getHours()<10?`0${t.getHours()}`:`${t.getHours()}`}:${t.getMinutes()<10?`0${t.getMinutes()}`:`${t.getMinutes()}`}`,o={};o.nick=e.nick,o.fullname=e.nick;const r=window._channel.getUser(e.nick);r&&r.fullname&&(o.fullname=r.fullname),o.action=e.action,o.date=i,o.time=s,n.push(o)}const i=await async function({rows:e,headers:t}){let n="";return n+=t.map((e=>e.label||e.id)).join(","),n+="\r\n",e.forEach((e=>{const i=t.map((({id:t})=>`${e[t]}`??0)).join(",");n+=`${i}\r\n`})),n}({rows:n,headers:[{id:"fullname",label:"Nome Completo"},{id:"nick",label:"Apelido"},{id:"action",label:"Acao"},{id:"date",label:"Data"},{id:"time",label:"Horario"}]});return i},setType:function(e){return v=e,e},getType:function(){return v},setId:function(e){return b=e,e},getId:function(){return b},reconnect:async function e(){if(!window._engine.currentChannel())return E("[Reconnect CSM] Not in channel! Impossible to reconnect recording session!"),window.Events.dispatch("session/reconnect","Not in channel"),!1;if(void 0===window.session_id)return E("[Reconnect CSM] No session id to reconnect! Exiting!"),window.Events.dispatch("session/reconnect","No session id to reconnect"),"m"!==window._channel.getSuffix()&&window._channel.stopAllTransmissions(),window._channel.hideTemporaryMessage(),!1;if(_=!0,C+=1,window.Events.dispatch("session/reconnect",{reconnecting:_,reconnectTry:C}),C>y){if(console.log("[Reconnect CSM] No more reconnect tries, fail to reconnect"),window.Events.dispatch("session/reconnect","No more reconnect tries, fail to reconnect"),window._channel.hideTemporaryMessage(),"m"!==window._channel.getSuffix()&&window.session.isReconnecting()&&"p"===window._channel.getSuffix()){const e=await window.session.getActiveSessionInfo();if(e.session_id){const t=e.session.live_duration?e.session.live_duration:0;await session.finishSession(e.session_id,{live_duration:t}),l()("#record-option-stop").hide(),l()("#record-option-start").show(),l()("#record-option-icon").css("color","")}}return window.softCountdown&&window.softCountdown.stop(),window.countdown.isStarted()&&(window.countdown.stop(),P(),window.sessionTimerShowed=!1),l()("#chn-session-start-btn").hide(),l()("#chn-session-stop-btn").hide(),l()("#chn-session-continue-btn").show(),window.session&&window.session.stopUserListUpdate(),z({errors:[{field:"session-record-failed",cause:"session-record connection failed",status:400,value:"error",message:"Session Record: connection failed",place:"headers"}]}),!1}E(`[Reconnect CSM] Trying to Reconnect! (${C}/${y})`),console.log(`[Reconnect CSM] Trying to Reconnect! (${C}/${y})`);const t=await M(window.session_id);if(!t){if(E("[Reconnect CSM] There is no session information, retrying in 10 seconds..."),window.Events.dispatch("session/reconnect","[Reconnect CSM] There is no session information, retrying in 10 seconds..."),C<y)return setTimeout(e,1e4),!1;if(C>=y)return E("[Reconnect CSM] No more reconnect tries, fail to reconnect"),window.Events.dispatch("session/reconnect","[Reconnect CSM] No more reconnect tries, fail to reconnect"),window._channel.hideTemporaryMessage(),!1}if("finished"===t.status)return E(`[Reconnect CSM] Session ${window.session_id} is already finished!`),window.Events.dispatch("session/reconnect",`[Reconnect CSM] Session ${window.session_id} is already finished!`),l()("#chn-session-stop-btn").hide(),C=0,window._channel.hideTemporaryMessage(),!1;if(E(`Got session information: ${JSON.stringify(t)}`),await window.session.continueSession(t),window._engine.txInfoAvconf(!0).stream){let e=window._channel.getRecordingDisplay();""===e?e="main":"lateral"===e&&(e="main_sidebar"),E(`[Session] Selected display record mode: "${e}"`),setTimeout((function(){E(window._engine.txInfoAvconf(!0).stream),window._engine.txInfoAvconf(!0).stream||window._engine.requestTransmission(p.ENGINE_NICK,!0,!0),window._channel.hideTemporaryMessage(),window._recorderCtrl.isStarted()||l()(`#record_${e}_btn`).click(),_=!1}),5e3)}else setTimeout((function(){window._channel.hideTemporaryMessage(),_=!1,window._engine.requestTransmission(p.ENGINE_NICK,!0,!0)}),2e3);return!1},isReconnecting:function(){return _},setRecordTabShow:function(e){S=!0===e},getRecordTabShow:function(){return S},setReRecordTabShow:function(e){x=!0===e},getReRecordTabShow:function(){return x},setReconnectTry:function(e){return C=e,!1},showTimer:function(){const e=window._engine.currentChannel(),t=window.breakoutRoom.getRoomType(e);window.Events.dispatch("session/timer-hide"),p.CONFIG.alwaysRecordSessions&&"nested"!==t&&window.Events.dispatch("session/timer-show")},hideTimer:P}}const fh="close",vh="user-click",bh="open-link",_h={};_h[fh]=function(e){E(`[Metaverse Iframe] Processing close notification with reason ${e}`),l()("#medias").html(""),l()("#medias").show(),l()("#metaverse-area").html(""),l()("#metaverse-area").hide(),"0"!==window._channel.getMetaverseFixedId()&&Jr()},_h[vh]=function(){E("[Metaverse Iframe] Processing user-click"),window.metaverse.setIdleTimeout((function(){window.Events.dispatch("metaverse/idle-timeout")}),p.METAVERSE_IDLE_TIMEOUT)},_h[bh]=function(e){E(`[Metaverse Iframe] Processing open-link: ${e}`),window.metaverse.showMetaverseModal(e)};const yh=_h;class Ch{show(e){if(!e)return E("[MetaverseModal] no URL found!"),!1;if(E(`[MetaverseModal] opening: ${e}`),!document.getElementById("metaverse-modal")){const t=document.getElementById("channelBody"),n=document.createElement("div");n.setAttribute("id","metaverse-modal"),n.className="fc h100 w100",n.style.backgroundColor="rgba(0,0,0,.5)",n.style.position="absolute",n.style.zIndex="99";const i=document.createElement("div");i.setAttribute("id","metaverse-modal-area"),i.className="fc fic",i.style.borderRadius="10px",i.style.width="100%",i.style.height="90%",i.style.marginTop="10px",i.style.marginBottom="auto",i.style.border="0px",i.innerHTML=`<div id="metaverse-modal-close-btn" class="bgbl tw pl20 pr20 pt10 pb10 br pt" style="position:absolute;right:20px;bottom:10px;">${window.i18n.get("close")}</div><iframe src="${e}" width="100%" height="100%" style="border:0px;margin:0px;padding:0px;" allow="microphone; clipboard-write;"></iframe>`,n.append(i),t.append(n)}return!0}hide(){const e=document.getElementById("metaverse-modal");window.speechSynthesis.cancel(),e&&e.remove()}}class Sh{constructor(){this._config={},this._permissions={},this._started=!1,this._channel=null,this._channelType="room",this._rooms=[],this._id=null,this._name="",this._url=null,this._xMode=null,this._interfaceLoaded=!1,this._selectedId=null,this._owner="",this._finishAt=0,this._allowCreate=!1,this._allowEdit=!1,this._allowStart=!1,this._maxRooms=0,this._timeout=null,this._idleTimeout=null,this._audioMuted=!1,this._videoMuted=!1,this._medias=[],this.loadInterface(),this._metaverseModal=new Ch}set config(e){this._config=e}get config(){return this._config}set permissions(e){this._permissions=e}get permissions(){return this._permissions}set started(e){this._started=!0===e}get started(){return this._started}get rooms(){return this._config.rooms}set channelType(e){return this._channelType="room"===e?"room":"channel",this._channelType}get channelType(){return this._channelType}set channel(e){this._channel=e}get channel(){return this._channel=this._channel||window._engine.currentChannel(),this._channel}set id(e){this._id=e}get id(){return this._id}set name(e){this._name=e}get name(){return this._name}set url(e){this._url=e}get url(){return this._url}set selectedId(e){this._selectedId=e}get selectedId(){return this._selectedId}async join(e,t){const n=await async function(e,t){if(!e)return z({field:"metaverse_room",cause:"undefined",status:404,value:"metaverse_room",message:"action: joinMetaverse - undefined metaverse_room"}),!1;if(!t)return z({field:"metaverse_id",cause:"undefined",status:404,value:"metaverse_id",message:"action: joinMetaverse - undefined metaverse_id"}),!1;const n=e,i=t,s={room:n,metaverse_room_id:i},o=W(),r=`${window.apiServer}/room/${n}/metaverse/${i}/join`;let a;o.body=JSON.stringify(s),E(`[Metaverse] Join Metaverse with body: ${JSON.stringify(s)}`);try{a=await fetch(r,o).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`[Metaverse] join error: ${JSON.stringify(e.errors)}`),!1):e)).catch((e=>(e.json().then((e=>{z(e)})),!1)))}catch(e){return!1}return a}(e,t);return n&&(this._url=n.metaverse_url,this._started=!0),n}async getActiveMetaverse(){this._channelType="room"===this._channelType?"room":"channel",this._channel=this._channel||window._engine.currentChannel();let e=!1;return this._channel?e=await async function(e,t="room"){const n=e||window._engine.currentChannel(),i="room"===t?"room":"channel",s=X(),o=`${window.apiServer}/${i}/${n}/metaverse/active`;let r;try{return r=await fetch(o,s).then((async e=>{const t=await e.json();return e.ok?t:Promise.reject(t)})).catch((e=>(z(e),!1))),r}catch(e){return!1}}(this._channel,this._channelType):E("[Metaverse] getActiveMetaverse error: invalid channel!"),e}async getBusyMetaverses(){return this._channelType="room"===this._channelType?"room":"channel",await async function(e,t="room"){const n="room"===t?"room":"channel",i=X(),s=`${window.apiServer}/${n}/metaverse/busy`;let o;try{return o=await fetch(s,i).then((async e=>{const t=await e.json();return e.ok?t:Promise.reject(t)})).catch((e=>(z(e),!1))),o}catch(e){return!1}}(this._channelType)}async startChannelMetaverse(){return this._id?(this._channelType="room"===this._channelType?"room":"channel",this._channel=this._channel||window._engine.currentChannel(),this._started=!0,await async function(e,t,n="room"){const i=t||window._engine.currentChannel(),s=window.irmServer;if(!e)return z({field:"metaverse_id",cause:"undefined",status:404,value:"metaverse_id",message:"action: startMetaverse - undefined metaverse_id"}),!1;const o=e,r={irm_server:s},a=W(),c=`${window.apiServer}/room/${i}/metaverse/${o}/start`;let l;a.body=JSON.stringify(r),E(`[Metaverse] Setting start metaverse with body: ${JSON.stringify(r)}`);try{l=await fetch(c,a).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`startMetaverse error: ${JSON.stringify(e.errors)}`),!1):e)).catch((e=>(e.json().then((e=>{z(e)})),!1)))}catch(e){return!1}return l}(this._id,this._channel,this._channelType)):(E("[Metaverse] startChannelMetaverse: undefined id!"),!1)}async finishChannelMetaverse(){return this._id?(this._channelType="room"===this._channelType?"room":"channel",this._channel=this._channel||window._engine.currentChannel(),await async function(e,t,n="room"){if(!e)return z({field:"metaverse_id",cause:"undefined",status:404,value:"metaverse_id",message:"action: finishMetaverse - undefined metaverse_id"}),!1;const i=e,s=t||window._engine.currentChannel(),o={irm_server:window.irmServer},r=W(),a=`${window.apiServer}/room/${s}/metaverse/${i}/finish`;let c;r.body=JSON.stringify(o),E(`[Metaverse] Finishing session with body: ${JSON.stringify(o)}`);try{c=await fetch(a,r).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`[Metaverse] finish error: ${JSON.stringify(e.errors)}`),!1):e)).catch((e=>(console.log(e),e.json().then((e=>{z(e)})),!1)))}catch(e){return!1}return c}(this._id,this._channel,this._channelType)):(E("[Metaverse] finishChannelMetaverse: undefined id!"),!1)}set xMode(e){try{this._xMode=JSON.parse(e)}catch(t){E(`[Metaverse] xMode error parsing ${e}!`)}}get xMode(){return this._xMode}set owner(e){this._owner=e}get owner(){return this._owner}set finishAt(e){this._finishAt=e}get finishAt(){return this._finishAt}set allowCreate(e){this._allowCreate=e}get allowCreate(){return this._allowCreate}set allowEdit(e){this._allowEdit=e}get allowEdit(){return this._allowEdit}set allowStart(e){this._allowStart=e}get allowStart(){return this._allowStart}set maxRooms(e){this._maxRooms=e}get maxRooms(){return this._maxRooms}set audioMuted(e){this._audioMuted=!0===e}get audioMuted(){return this._audioMuted}set videoMuted(e){this._videoMuted=!0===e}get videoMuted(){return this._videoMuted}set medias(e){this._medias=e}get medias(){return this._medias}room(e){const t={};if(e){for(let n=0;n<this.rooms.length;n++){const i=this.rooms[n];i.id===e&&(t.name=i.name,t.bannerUrl=i.banner_url,t.description=i.description)}return t}return t}setTimeout(e,t){window.time.clearTimeout("metaverse"),this._timeout=window.time.setTimeout("metaverse",e,t)}clearTimeout(){this._timeout=null,window.time.clearTimeout("metaverse")}setIdleTimeout(e,t){this._idleTimeout=window.time.setTimeout("metaverse-idle",e,t)}clearIdleTimeout(){this._idleTimeout=null,window.time.clearTimeout("metaverse-idle")}processXMode(){const e=this.xMode;return e.now=window.time.now(),e.started=this.started,e.channelType=this.channelType,e.channel=this.channel,e.permissions=this.permissions,e.config=this.config,async function(e){const t=e.channelType,n=e.channel;let i=parseInt(e.config?.maxRooms);Number.isNaN(i)&&(i=0);const s=e.config?.rooms,o=e.now,r=e.finish_at,a=r>o,c=r-o,l=e.finished,d={started:a,channelType:t,channel:n,maxRooms:i,rooms:s,finishAt:r,now:o,id:e.metaverse_room_id,name:e.metaverse_room_name,url:e.metaverse_room_url,owner:e.owner};return d.started&&!l?(window.metaverse.started=d.started,window.metaverse.channelType=d.channelType,window.metaverse.channel=d.channel,window.metaverse.maxRooms=d.maxRooms,window.metaverse.finishAt=d.finishAt,window.metaverse.id=d.id,window.metaverse.name=d.name,window.metaverse.url=d.url,window.metaverse.owner=d.owner,window.metaverse.allowCreate=d.allowCreate,window.metaverse.allowEdit=d.allowEdit,window.metaverse.allowStart=d.allowStart,window.Events.dispatch("metaverse/start-metaverse-view"),window.metaverse.setTimeout((()=>{window.Events.dispatch("metaverse/finish-metaverse-view")}),c)):(window.Events.dispatch("metaverse/finish-metaverse-view"),window._windowCtrl.redrawWindows()),!0}(e)}loadInterface(){this._interfaceLoaded||(window.onmessage=e=>{if(e.data&&e.data.IFrameInterface){E(`[Metaverse IFrame] Message : ${JSON.stringify(e.data)}`);const t=e.data.IFrameInterface;switch(t.type){case fh:yh[fh](t.params.reason);break;case vh:yh[vh]();break;case bh:yh[bh](t.params.src);break;default:E("[Metaverse IFrame] Unknown message")}}},l()("#rpchnconficon").on("click",(async function(){const e=window._channel.getType(),t=window._engine.currentChannel(),n=window.engine.configChannel();if((n.enable_metaverse?n.enable_metaverse:n.enableMetaverse)&&window._channel.isOperator(p.ENGINE_NICK)?l()("#rpchnmetaverse").show():l()("#rpchnmetaverse").hide(),1===e&&!window.metaverse.config.roomEnabled||0===e&&!window.metaverse.config.channelEnabled||2===e&&!p.METAVERSE_EPHEMERAL_ENABLE)return!1;window.metaverse.channelType="room",l()("#rpchnmetaverselist").hide();let i={};1===e?i=await window.rooms.getRoom(t):0===e?i=window._channel.getChannel(t)||{}:2===e&&(i={enable_metaverse:p.METAVERSE_EPHEMERAL_ENABLE});const s=window._engine.currentChannel(),o="nested"===window.breakoutRoom.getRoomType(s),r="room"===window.breakoutRoom.getRoomType(s),a="meeting"===window.breakoutRoom.getRoomType(s);if(window._channel.isOperator(p.ENGINE_NICK)&&window.metaverse.started||!window._channel.isOperator(p.ENGINE_NICK)?l()(".rpchnyt").hide():o||r||a||l()(".rpchnyt").show(),!i.enable_metaverse||!window._channel.isOperator(p.ENGINE_NICK))return l()("#rpchnmetaverse").hide(),!1;if(!(1===e&&!0===window.metaverse.config.roomEnabled||0===e&&!0===window.metaverse.config.channelEnabled||2===e&&p.METAVERSE_EPHEMERAL_ENABLE))return l()("#rpchnmetaverse").hide(),!1;"0"!==window._channel.getMetaverseFixedId()?(l()("#rpchnmetaverse").hide(),l()("#metaverse-status").html("")):(l()("#rpchnmetaverse").show(),l()("#metaverse-status").html("")),window.metaverse.selectedId=null,window.metaverse.channel=window._engine.currentChannel();let c={};window.metaverse.channelType="room",c=await window.metaverse.getActiveMetaverse(),E(`[Metaverse] Active Metaverse: ${JSON.stringify(c)}`),c.active?(l()("#metaverse-status").html(window.i18n.get("enabled")),window.metaverse.url=c.metaverse.metaverse_room_url,window.metaverse.owner=c.metaverse.owner):l()("#metaverse-status").html(window.i18n.get("disabled"))})),l()("#rpchnmetaverse").on("click",(async function(){window.metaverse.channel=window._engine.currentChannel(),window.metaverse.channelType="room";const e=await window.metaverse.getActiveMetaverse(),t=await window.metaverse.getBusyMetaverses(),n=!0===e.active,i=p.NICK;if(l()("#channelAdmChat").removeClass("ic_channel_chat_ON"),n){l()("#rpchnconf").hide(),l()(".rpb").hide(),l()("#channelInputArea").hide(),l()("#rpchnmetaverselist").show();const t=e.metaverse.metaverse_room_id;window.metaverse.selectedId=t;const n=window.metaverse.room(t),s=n.name,o=n.bannerUrl,r=n.description;e.metaverse.metaverse_room_url,e.metaverse.owner,e.metaverse.finish_at;let a="";a=window.metaverse.owner!==i||window.session.isStarted()?`<div class="w100 frm pr10" style="height:60px;"><div><span id="metaverse-back" class="material-icons sxxl p10">arrow_back</span></div><div class="fig sxl toj b">${window.i18n.get("metaverse")}</div><div><div id="btn-deactive-metaverse-disabled" class="btn p10 bgdg br ss tw b">Desativar Metaverso</div></div></div>`:`<div class="w100 frm pr10" style="height:60px;"><div><span id="metaverse-back" class="material-icons sxxl p10">arrow_back</span></div><div class="fig sxl toj b">${window.i18n.get("metaverse")}</div><div><div id="btn-deactive-metaverse" class="btn p10 bgr br ss tw b pt">Desativar Metaverso</div></div></div>`;const c=`${a}<div class="metaverse-label w100 pt10 pl10 ss b" style="background-color:#f5f5f5">CenÃ¡rio ativado</div><div class="fig w100 p10" style="background-color:#f5f5f5"><div id="metaverse-${t}" class="metaverse-item fr br bor sha" style="margin-bottom:5px;border-color:#47b32e"><div style="background-image:url(${o});border-top-left-radius:7.5px;border-bottom-left-radius:7.5px;width:150px;height:100px;background-size: cover;"></div><div class="fc fig pl20 pr10" style="margin-top:auto;margin-bottom:auto;"><div class="fr sxxs b pb5 w100"><div class="fig" style="color:#47b32e;">Em andamento</div></div><div class="toj ss b pb5">${s}</div><div class="sxs">${r}</div></div> </div></div>`;return l()("#rpchnmetaverselist").html(c),!1}l()("#rpchnconf").hide(),l()(".rpb").hide(),l()("#channelInputArea").hide(),l()("#rpchnmetaverselist").show();const s=window.metaverse.rooms;let o="";for(let e=0;e<s.length;e+=1){const n=s[e].id,i=s[e].banner_url,r=s[e].description,a=s[e].name;t.includes(n)?o+=`<div id="metaverse-${n}" class="metaverse-item fr br bor sha" style="margin-bottom:5px;"><div style="background-image:url(${i});border-top-left-radius:7.5px;border-bottom-left-radius:7.5px;width:150px;height:100px;background-size: cover;"></div><div class="fc fig pl20 pr10" style="margin-top:auto;margin-bottom:auto;"><div class="fr sxxs b pb5 w100"><div class="fig">Ocupado</div><div><input type="radio" name="selected-metaverse" disabled mid="${n}"/></div></div><div class="toj ss b pb5">${a}</div><div class="sxs">${r}</div></div> </div>`:o+=`<div id="metaverse-${n}" class="metaverse-item fr br bor sha" style="margin-bottom:5px;" mid="${n}"><div style="background-image:url(${i});border-top-left-radius:7.5px;border-bottom-left-radius:7.5px;width:150px;height:100px;background-size: cover;"></div><div class="fc fig pl20 pr10" style="margin-top:auto;margin-bottom:auto;"><div class="fr sxxs b pb5 w100"><div class="fig" style="color:#47b32e;">DisponÃ­vel</div><div><input id="sel-${n}" type="radio" class="pt" name="selected-metaverse" mid="${n}"/></div></div><div class="toj ss b pb5">${a}</div><div class="sxs">${r}</div></div> </div>`}const r=`<div class="w100 frm pr10" style="height:60px;"><div><span id="metaverse-back" class="material-icons sxxl p10">arrow_back</span></div><div class="fig sxl toj b">${window.i18n.get("metaverse")}</div><div><div id="btn-active-metaverse" class="btn p10 bgdg br ss tw b">Ativar Metaverso</div></div></div><div class="metaverse-label w100 pt10 pl10 ss b" style="background-color:#f5f5f5;">Escolha um metaverso que deseja iniciar</div><div class="fig w100 p10" style="background-color:#f5f5f5;overflow:auto;">${o}</div>`;return l()("#rpchnmetaverselist").html(r),!1})),l()("#rpchni").on("click",(function(){if(!window.metaverse.permissions.roomStart)return!1})),l()("#rpchnmetaverselist").on("click","input[name='selected-metaverse']",(function(e){e.stopPropagation();const t=l()(this).attr("mid");l()(".metaverse-item").css("border-color",""),l()(`#metaverse-${t}`).css("border-color","#21affa"),l()("#btn-active-metaverse").removeClass("bgdg"),l()("#btn-active-metaverse").removeClass("pt"),l()("#btn-active-metaverse").addClass("bgbl"),l()("#btn-active-metaverse").addClass("pt"),window.metaverse.selectedId=t})),l()("#rpchnmetaverselist").on("click",".metaverse-item",(function(e){e.stopPropagation();const t=l()(this).attr("mid");l()(`#sel-${t}`).click()})),l()("#rpchnmetaverselist").on("click","#btn-active-metaverse",(async function(){const e=window.metaverse.selectedId;if(!e)return!1;window.metaverse.id=e,window.metaverse.channel=window._engine.currentChannel();const t=await window.metaverse.startChannelMetaverse();return l()("#channelAdmUserList").click(),t})),l()("#rpchnmetaverselist").on("click","#btn-deactive-metaverse",(async function(){const e=window.metaverse.selectedId;if(!e)return!1;window.metaverse.id=e;const t=await window.metaverse.finishChannelMetaverse();return 2===window._channel.getType()&&(l()(".channelAdmChat").show(),l()("#channelAdmChat").removeClass("ic_channel_chat_ON")),l()("#channelAdmUserList").click(),t})),l()("#rpchnmetaverselist").on("click","#metaverse-back",(function(){l()("#channelAdmUserList").click()})),l()("#channelBody").on("click","#metaverse-modal-close-btn",(function(){window.metaverse.hideMetaverseModal()})),this.interfaceLoaded=!0)}hideDevices(e,t){this._audioMuted=e,this._videoMuted=t,this._medias=window._channel.getMyMedia(),this._medias.length>0&&(Zr(),window._channel.muteVideo(),window.devices.muteVideoDevice(),window._channelCtrl.updateCapture(),l()("#user-media-control").hide(),l()("#medias").html("")),window._windowCtrl.redrawWindows()}showDevices(){this._medias.length>0&&(this._audioMuted?Zr():Qr(),this._videoMuted?(window._channel.muteVideo(),window.devices.muteVideoDevice(),window._channelCtrl.updateCapture()):(window._channel.unmuteVideo(),window.devices.unmuteVideoDevice(),window._channelCtrl.updateCapture()),l()("#user-media-control").show()),window._windowCtrl.redrawWindows()}showMetaverseModal(e){this._metaverseModal.show(e)}hideMetaverseModal(){this._metaverseModal.hide()}reset(){E("============= METAVERSE RESET CALLED"),this._started=!1,this._channel=null,this._channelType="room",this._id=null,this._url=null,this._xMode=null,this._selectedId=null,this._owner="",this._finishAt=0,this._allowCreate=!1,this._allowEdit=!1,this._allowStart=!1,this._maxRooms=0,this._audioMuted=!1,this._videoMuted=!1,this._medias=[],this._timeout=null,window.time.clearTimeout("metaverse"),this._idleTimeout=null,window.time.clearTimeout("metaverse-idle"),this._metaverseModal.hide(),this._metaverseModal=null}}class Eh{constructor(){this._rooms={},this._config={},this._server=""}set config(e){this._config=e}get config(){return this._config}set rooms(e){this._rooms=e}get rooms(){return this._rooms}async getRoom(e){let t={};for(let n=0;n<this._rooms.length;n+=1)e===this._rooms[n].name&&(t=this._rooms[n]);return t}}class xh{constructor(){this.timeoutMap=new Map,this.intervalMap=new Map,this.loop=null,window.performance&&(this.tsDiff=0,window.performance.timeOrigin?this.timeOrigin=window.performance.timeOrigin:(E("[Time] Navigator does not support window.performance.timeOrigin"),this.timeOrigin=null)),this.startLoop()}getUserTs(){let e;return e=this.timeOrigin?this.timeOrigin+performance.now():(new Date).getTime(),e}setServerTs(e){E(`[Time] Setting server timestamp: ${e}`);const t=this.getUserTs();return this.tsDiff=e-t,E(`[Time] Delta timestamp: ${this.tsDiff}`),this.tsDiff}getServerTs(){return this.getUserTs()+this.tsDiff}now(){return this.getServerTs()}getFormDate(e){const t=new Date(e),n=t.getDate()<10?`0${t.getDate()}`:`${t.getDate()}`,i=t.getMonth()<9?`0${t.getMonth()+1}`:`${t.getMonth()+1}`;return`${t.getFullYear()}-${i}-${n}T${t.getHours()<10?`0${t.getHours()}`:`${t.getHours()}`}:${t.getMinutes()<10?`0${t.getMinutes()}`:`${t.getMinutes()}`}`}toString(e){const t=new Date(e);return`${t.toLocaleDateString()} ${t.getHours()<10?`0${t.getHours()}`:`${t.getHours()}`}:${t.getMinutes()<10?`0${t.getMinutes()}`:`${t.getMinutes()}`}`}startLoop(){this.loop=setInterval((()=>{0!==this.timeoutMap.size&&this.timeoutMap.forEach(((e,t)=>{const n=e.timeoutTs,i=e.fn;window.performance.now()>n&&(i(),this.timeoutMap.delete(t))})),0!==this.setInterval.size&&this.intervalMap.forEach(((e,t)=>{const n=e.fn,i=e.tsObj[0],s=e.tsObj[1];window.performance.now()>s&&(n(),this.intervalMap.set(t,{fn:n,tsObj:[i,s+i]}))}))}),300)}stopLoop(){this.loop&&clearInterval(this.loop)}setTimeout(e,t,n){const i=window.performance.now()+n;return this.timeoutMap.set(e,{fn:t,timeoutTs:i}),t}clearTimeout(e){this.timeoutMap.delete(e)}getTimeout(){return this.timeoutMap}setInterval(e,t,n){const i=n,s=window.performance.now()+i;return this.intervalMap.set(e,{fn:t,tsObj:[i,s]}),t}clearInterval(e){this.intervalMap.delete(e)}getInterval(){return this.intervalMap}}function kh(e){let t,n,i,s,o=null;return o||(o=new ResizeObserver((function(o){t=o[0].contentRect,n=o[0],i=t.width,s=t.height,e(n,i,s)}))),{insert:function(e){try{o.observe(document.getElementById(e))}catch(e){return!1}},remove:function(e){o.unobserve(document.getElementById(e))},reset:function(){o.disconnect()},update:function(){e(n,i,s)}}}function Mh(e){let t,n=[],i=[];const s=e.checkTimeout?e.checkTimeout:9e5;t=e.initialTs?e.initialTs:(new Date).getTime();const o=e.validateSession?e.validateSession:()=>!0;return e.logout&&e.logout,{getLastTs:function(){return t},update:function(e){const i=e||"",s=new Date,o=`[${s.getYear()+1900}/${s.getMonth()+1}/${s.getDate()} ${s.getHours()}:${s.getMinutes()}:${s.getSeconds()}]`;n.length>1e3&&n.shift(),n.push(`${o} ${i}`),t=s.getTime()},clearLog:function(){n=[]},getActivities:function(){return n},insertDebug:function(e){const t=e||"",n=new Date,s=`[${n.getYear()+1900}/${n.getMonth()+1}/${n.getDate()} ${n.getHours()}:${n.getMinutes()}:${n.getSeconds()}]`;i.length>1e4&&i.shift(),i.push(`${s} ${t}`)},clearDebug:function(){i=[]},getDebug:function(){return i},check:async function(){const e=(new Date).getTime();let n=!0;if(e>t+s){try{1!==(await o()).result&&(n=!1)}catch(e){E("Error validating user session!"),n=!1}t=e}return!!n||(E("[Activity] Error: no valid session found!"),!1)}}}class Th{constructor(e={}){this.hideJanus=!0===e.hideJanus,l()("#dbadvh .material-icons").on("click",(()=>{window.log.getFile()}))}async getActivityLog(){return window.activity.getDebug()}async getFile(){const e=await this.getActivityLog();let t="";for(let n=0;n<e.length;n+=1)t+=`${e[n]}\n`;const n=new Blob([t],{type:"text/plain"}),i=window.URL.createObjectURL(n),s=document.createElement("a");s.href=i,s.download="activity-log.txt",s.click()}}const Ih=["a7ibweukd8ad53dem1-l","qfxkz87lvztbop8w6a-l","lvztbop8w6aqfxkz87-l"],Rh=[{name:"a7ibweukd8ad53dem1-l",nusers:1,users:["kenjischool-web"]},{name:"qfxkz87lvztbop8w6a-l",nusers:2,users:["kenzo-web","igor-web"]},{name:"lvztbop8w6aqfxkz87-l",nusers:0,users:[]}];class Ah{constructor(){this._cmd={NESTED_NULL:0,NESTED_CREATE:1,NESTED_CLOSE:2,NESTED_INFO:3,NESTED_LIST:4,NESTED_NAMES:5},this._cmdId={0:"NESTED_NULL",1:"NESTED_CREATE",2:"NESTED_CLOSE",3:"NESTED_INFO",4:"NESTED_LIST",5:"NESTED_NAMES"},this._xMode=null,this._rooms=[],this._roomId=0,this._started=!1,this._channel=null,this._main=null,this._mainTopic=null,this._allow_return=!1,this._allow_change=!1,this._timeoutAt=0,"pt-BR"===navigator.language?this._roomName="Sala":this._roomName="Room",this._myRoom=0,this._myRoomName="",this._users=[],this._usersCB=null,this._nestedRooms=[],this._nestedNames=[],this._seq={}}get cmd(){return this._cmd}get cmdId(){return this._cmdId}formatMessage(e){const t=e,n=[JSON.stringify(t)];return xl().CTCP().format("nested",n)}sendPrivateMessage(e,t){console.log(`[BreakoutRoom] sendPrivateMessage: message "${JSON.stringify(e)}" target "${JSON.stringify(t)}"`);const n=this.formatMessage(e),i=t,s=xl().modes().notice;return window._engine.requestSendPrivateMessage(n,i,s),!0}sendPublicMessage(e){const t=this.formatMessage(e),n=xl().modes().notice;return window._engine.requestSendPublicMessage(t,n),!0}generateRoomId(){return this._roomId+=1,this._roomId}async createRooms(e){const t=e,n=t.length,i={};if(0!==this._rooms.length)return i.errors=[{message:"[BreakoutRooms] create error: rooms list is not empty!"}],z(i),!1;for(let e=0;e<n;e+=1){const n={},i=this.generateRoomId();n.c=t[e],n.n=`${this._roomName} ${i}`,n.u=[],this._rooms.push(n)}return this._channel=window._channel.getName(),this._myRoomName=window._channel.getTopic(),this._rooms}set channel(e){const t=e.trim();this._channel=t}get channel(){return this._channel}set main(e){const t=e.trim();this._main=t}get main(){return this._main}set mainTopic(e){const t=e;this._mainTopic=t}get mainTopic(){return this._mainTopic}get rooms(){return this._rooms}set rooms(e){return this._rooms=e,this._rooms}async getRoom(e){const t=e,n=this._rooms;for(let e=0;e<n.length;e+=1)if(n[e].c===t)return n[e];return!1}async removeRoom(e){const t=e,n=this._rooms,i=[];for(let e=0;e<n.length;e+=1)n[e].c!==t&&i.push(n[e]);return this._rooms=i,this._rooms}async removeRoomUser(e,t){E(`[BreakoutRoom] removeRoomUser: roomName "${e}" username "${t}"`);const n=e,i=t,s=this._rooms;for(let e=0;e<s.length;e+=1){const t=s[e],o=t.c,r=t.u;if(o===n&&r){const t=[];for(let e=0;e<r.length;e+=1){const n=r[e];n.nick!==i&&t.push(n)}this._rooms[e].u=t}}return!1}setRoomUsers(e,t){E(`[BreakoutRoom] setRoomUsers (${t}): ${JSON.stringify(e)}`);const n=e,i=t,s=this._rooms;for(let e=0;e<s.length;e+=1)if(s[e].c===i)return this._rooms[e].u=n,!0;return!1}set users(e){const t=e;return this._users=t,!0}get users(){return this._users}set usersCB(e){const t=e;this._usersCB=t}get usersCB(){return this._usersCB}async resetRoomUsers(){for(let e=0;e<this._rooms.length;e+=1)this._rooms[e].u=[];return!0}getUsers(e){const t=e;return this.usersCB=t,this.requestNames("",(async e=>{window.breakoutRoom.names=e;const t=[],n=window.breakoutRoom.rooms;await window.breakoutRoom.resetRoomUsers();for(let i=0;i<e.length;i+=1){const s=e[i].name,o=e[i].users;for(let e=0;e<n.length;e+=1)n[e].c===s&&window.breakoutRoom.setRoomUsers(o,s);if(o)for(let e=0;e<o.length;e+=1){const n={name:o[e].nick,fullname:o[e].name||o[e].nick,room:s};t.push(n)}}return this.users=t,window.breakoutRoom.usersCB&&(0,window.breakoutRoom.usersCB)(t),!0})),!1}getUser(e){const t=e.trim(),n=this._users;for(let e=0;e<n.length;e+=1)if(n[e].name===t)return n[e];return!1}get usersInRooms(){const e=this._rooms;let t=[];for(let n=0;n<e.length;n+=1){const i=e[n],s=i.u;s&&"nested"===this.getRoomType(i.c)&&(t=t.concat(s))}const n=[];for(let e=0;e<t.length;e+=1)n.push(t[e].nick);return n}async getUsersInRoom(e){const t=e,n=this._rooms;for(let e=0;e<n.length;e+=1)if(n[e].c===t)return n[e].u||[];return[]}get usersWithoutRoom(){const e=this.users,t=this.usersInRooms,n=[];for(let i=0;i<e.length;i+=1)t.includes(e[i].name)||n.push(e[i]);return n}async moveUserToRoom(e,t){const n=this._rooms,i=e,s=i.name,o=i.fullname,r=t;let a=!1;for(let e=0;e<n.length;e+=1)n[e].c===r&&(this._rooms[e].u||(this._rooms[e].u=[]),this._rooms[e].u.push({nick:s,name:o}),a=!0);return a}isRoomNameUsed(e,t){const n=e.trim(),i=t,s=this._rooms;for(let e=0;e<s.length;e+=1)if(s[e].n===n&&s[e].c!==i)return!0;return!1}changeRoomName(e,t){const n=e,i=t.trim();E(`[BreakoutRoom] changeRoomName: room "${e}" - name "${t}"`);const s=this._rooms,o={};if(""===i)return o.errors=[{message:"[BreakoutRooms] changeRoomName: not a valid name provided!"}],z(o),!1;if(this.isRoomNameUsed(i,n))return o.errors=[{message:`[BreakoutRooms] changeRoomName: ${i} is already used!`}],z(o),!1;for(let e=0;e<s.length;e+=1)if(s[e].c===n)return s[e].n=i,!0;return this.setXMode(),!1}async getRoomName(e){const t=e;return(await this.getRoom(t)).n}set allow_return(e){this._allow_return=e}get allow_return(){return this._allow_return}set allow_change(e){this._allow_change=e}get allow_change(){return this._allow_change}get status(){return{rooms:this._rooms,allow_return:this._allow_return,allow_change:this._allow_change}}set xMode(e){const t=e;this._xMode=t}get xMode(){return this._xMode}setXMode(){!function(){const e={},t=window.breakoutRoom.rooms,n=[],i=window.breakoutRoom.allow_return,s=window.breakoutRoom.allow_change,o=window.breakoutRoom.timeoutAt,r=window.breakoutRoom.main;for(let e=0;e<t.length;e+=1){const i=t[e].n,s=t[e].c;n.push({c:s,n:i})}r?(e.rooms=n,e.allow_return=i,e.allow_change=s,e.timeout_at=o,e.main=r,window._engine.requestSetChannelXMode(r,"nested",JSON.stringify(e)),window.breakoutRoom.xMode=e):E("[Breakout Room] Set XMode Error: breakout rooms not started!")}()}unsetXMode(){!function(){const e=window.breakoutRoom.main;e?window._engine.requestSetChannelXMode(e,"nested",""):console.log("[Breakout Room] Unset XMode Error: breakout rooms not started!")}()}set timeoutAt(e){this._timeoutAt=e}get timeoutAt(){return this._timeoutAt}set myRoom(e){const t=parseInt(e);this._myRoom=t}get myRoom(){return this._myRoom}set myRoomName(e){return!!e.trim()&&(0===this.myRoom?this._myRoomName=window._channel.getTopic():this._myRoomName=e,!1)}get myRoomName(){return this._myRoomName}set nestedRooms(e){const t=e;return t?(this._nestedRooms=t,!0):(this._nestedRooms=Ih,!1)}get nestedRooms(){return this._nestedRoomss}set nestedNames(e){const t=e;return t?(this._nestedNames=t,!0):(this._nestedNames=Rh,!1)}get nestedNames(){return this._nestedNames}setSeq(e,t){const n=parseInt(e),i=t;return Number.isNaN(n)?(console.log(`[BreakoutRoom] Set seq: not a number - ${n}`),!1):(this._seq[`s${n}`]=i,!0)}getSeq(e){const t=parseInt(e);if(Number.isNaN(t))return E(`[BreakoutRoom] Get seq: not a number - ${t}`),!1;return this._seq[`s${t}`]||(E(`[BreakoutRoom] Get seq: no sequence number found - ${t}`),!1)}unsetSeq(e){const t=parseInt(e);if(Number.isNaN(t))return console.log(`[BreakoutRoom] Unset seq: not a number - ${t}`),!1;const n=this._seq[`s${t}`];return n?(delete this._seq[`s${t}`],n):(console.log(`[BreakoutRoom] Unset seq: no sequence number found - ${t}`),!1)}requestCreate(e,t){const n=parseInt(e),i=t;if(Number.isNaN(n))return console.log(`[BreakoutRoom] Request Create: rooms quantity not a number - ${n}`),!1;if(!this._main){const e=window._engine.currentChannel();"room"===this.getRoomType(e)&&(this._main=e)}return async function(e,t){const n=window.breakoutRoom.cmd,i=t,s=parseInt(e);if(Number.isNaN(s))return console.log(`[BreakoutRooms] Request create failed: ${s} is not a number!`),!1;const o=p.ROOM[window._engine.currentChannel()];let r=!1;if(o&&(r=o.enable_nesting),!r)return console.log("[BreakoutRooms] Request create failed: channel does not support nesting!"),!1;const a=window._engine.currentChannel();window.breakoutRoom.main=a;const c=window.breakoutRoom.main;window._engine.requestNestedRoom(n.NESTED_CREATE,c,`${s}`);const l=window._engine.lastRequestSeq();window.breakoutRoom.setSeq(l,{type:n.NESTED_CREATE,cb:i})}(n,i),!1}async requestClose(e="",t){const n=`${e}`.trim(),i=t;if(!this._main){const e=window._engine.currentChannel();"room"===this.getRoomType(e)&&(this._main=e)}if(!this._main){const e=window._engine.currentChannel();"room"===this.getRoomType(e)&&(this._main=e)}return async function(e,t){const n=window.breakoutRoom.cmd,i=t,s=window.breakoutRoom.main,o=e;window._engine.requestNestedRoom(n.NESTED_CLOSE,s,`${o}`);const r=window._engine.lastRequestSeq();window.breakoutRoom.setSeq(r,{type:n.NESTED_CLOSE,cb:i})}(n,i),!1}requestInfo(e="",t){const n=`${e}`.trim(),i=t;if(!this._main){const e=window._engine.currentChannel();"room"===this.getRoomType(e)&&(this._main=e)}return async function(e,t){const n=window.breakoutRoom.cmd,i=t,s=window.breakoutRoom.main,o=e;window._engine.requestNestedRoom(n.NESTED_INFO,s,`${o}`);const r=window._engine.lastRequestSeq();window.breakoutRoom.setSeq(r,{type:n.NESTED_INFO,cb:i})}(n,i),!1}requestList(e){const t=e;if(!this._main){const e=window._engine.currentChannel();"room"===this.getRoomType(e)&&(this._main=e)}return async function(e){const t=window.breakoutRoom.cmd,n=e,i=window.breakoutRoom.main;window._engine.requestNestedRoom(t.NESTED_LIST,i,"");const s=window._engine.lastRequestSeq();window.breakoutRoom.setSeq(s,{type:t.NESTED_LIST,cb:n})}(t),!1}requestNames(e="",t){const n=`${e}`.trim(),i=t;if(!this._main){const e=window._engine.currentChannel();"room"===this.getRoomType(e)&&(this._main=e)}return async function(e,t){const n=window.breakoutRoom.cmd,i=t,s=window.breakoutRoom.main,o=e;window._engine.requestNestedRoom(n.NESTED_NAMES,s,`${o}`);const r=window._engine.lastRequestSeq();window.breakoutRoom.setSeq(r,{type:n.NESTED_NAMES,cb:i})}(n,i),!1}processRequest(e,t,n){!function(e,t,n){const i=parseInt(e),s="1"===t,o=`${n}`.trim(),r=window.breakoutRoom.cmd,a=window.breakoutRoom.getSeq(i),{type:c,cb:l}=a,d=parseInt(c),u=window.breakoutRoom.cmdId[d];let h=!1;switch(s?E(`[BreakoutRoom] statusCB success: seq: ${i} - result: ${o} - commandType: ${u}`):(E(`[BreakoutRoom] statusCB failed: seq: ${i} - result: ${o} - commandType: ${u}`),h=!0),d){case r.NESTED_CREATE:!function(e,t){if(e)return t&&t([]),!1;const n=o.split(" ");E(`[BreakoutRoom] statusCB cmd.NESTED_CREATED: ${JSON.stringify(n)}`),t&&t(n)}(h,l);break;case r.NESTED_CLOSE:!function(e,t){if(e)return t&&t([]),!1;const n=o.split(" Channel")[0].split(" ");E(`[BreakoutRoom] statusCB cmd.NESTED_CLOSED: ${JSON.stringify(n)}`),t&&t(n)}(h,l);break;case r.NESTED_INFO:!function(e,t){e?t&&t(""):(console.log("[BreakoutRoom] statusCB cmd.NESTED_INFO: __________"),t&&t(o))}(h,l);break;case r.NESTED_LIST:!function(e,t){if(e)return t&&t([]),!1;const n=o.split(" ");console.log(`[BreakoutRoom] statusCB cmd.NESTED_LIST: ${JSON.stringify(n)}`),t&&t(n)}(h,l);break;case r.NESTED_NAMES:!function(e,t){if(e){const e=window.breakoutRoom.rooms;for(let t=0;t<e.length;t+=1)window.breakoutRoom.rooms[t].u=[];return t&&t([]),!1}let n;E(`[BreakoutRoom] statusCB cmd.NESTED_NAMES: ${o}`);try{n=JSON.parse(o)}catch(e){return console.log(e),!1}const i=window.breakoutRoom.rooms;for(let e=0;e<i.length;e+=1){const t=i[e].c;for(let e=0;e<n.length;e+=1){const i=n[e],s=i.name,o=i.users;t===s&&window.breakoutRoom.setRoomUsers(o,t)}}t&&t(n)}(h,l);break;default:E("[BreakoutRoom] statusCB cmdId not found")}}(e,t,n)}changeRoom(e){!async function(e){const t=e;E(`[BreakoutRoom] bkrChangeRoom: ${t}`);const n=window._engine.currentChannel(),i=window.breakoutRoom.getRoomType(t);if("room"!==i&&"nested"!==i&&"meeting"!==i)return console.log(`[BreakoutRoom] bkrChangeRoom error: this room type "${i}" is not allowed!`),window.Events.dispatch("channel/close"),!1;if(t===n)return console.log(`[BreakoutRoom] bkrChangeRoom: target and current room is equal "${t}" do not need to change!`),!1;"nested"===i&&window._recorderCtrl.isStarted()&&(window._recorderCtrl.stopRecord(!0),window.session.hideTimer());const s=window.breakoutRoom.rooms;if(!s)return console.log("[BreakoutRoom] bkrChangeRoom error: rooms is undefined!"),!1;let o,r=!1;for(let e=0;e<s.length;e+=1){const n=s[e];n.c===t&&(o=n.n,r=!0)}if(!r&&t!==window.breakoutRoom.main)return console.log(`[BreakoutRoom] bkrChangeRoom error: room do not exist "${t}"`),!1;t===window.breakoutRoom.main&&(o=window.breakoutRoom.mainTopic);const a={channel:t,name:o,imgSrc:`${p.CONFIG.roomIcon}`};window.timerWorker&&"nested"===i&&(await window.timerWorker.stopTimers("session-"),window.Events.dispatch("session/timer-control","stopTimers")),window._channel.reset(),window._engine.stop(),setTimeout((()=>{l()("#chn-session-is-active-btn").hide(),window.session.hideTimer(),Wr(a)}),2e3)}(e)}get isNested(){const e=window._engine.currentChannel();return!!e&&"-n"===e.substr(-2)}getRoomType(e=""){let t=e;if(""===t)return console.log('[BreakoutRoom] getRoomType: room attribute is ""!'),!1;null===t&&(t=""),t=t.trim();let n="";switch(t.substr(-2)){case"-n":n="nested";break;case"-l":n="room";break;case"-m":n="meeting";break;case"-p":n="default";break;default:n="other"}return n}reset(){this._xMode=null,this._rooms=[],this._roomId=0,this._started=!1,this._channel=null,this._timeoutAt=0,this._myRoom=0,this._myRoomName="",this._users=[],this._usersCB=null,this._nestedRooms=[],this._nestedNames=[],this._seq={}}}class $h{static packTextData(e,t,n,i,s,o,r){const a={text:e,lang:t,ts:i,duration:s,delay:o,final:r};return n&&(a.targetLang=n),a}}class Lh{constructor(){this.mRecognition=null,this.mStarted=!1,this.mAutoRestart=!0,this.mLastResult=0,this.mTsi=0,this.mTsf=0,this.mTimerRestart=null,this.mTimerWatchdog=null,this.mWatchdogIntervalMs=1e4,this.mWatchdogIntervalMinMs=1e3,this.mWatchdogIntervalMaxMs=2e4}clearTimerRestart(){this.mTimerRestart&&(clearTimeout(this.mTimerRestart),this.mTimerRestart=null)}clearTimerWatchdog(){this.mTimerWatchdog&&(clearInterval(this.mTimerWatchdog),this.mTimerWatchdog=null)}start(e,t,n,i){if(this.mStarted)return void Di.g.log(3,"SpeechRecognition : already started, ignoring");if(Di.g.log(3,`SpeechRecognition : start : ${e.lang}`),window.SpeechRecognition=window.webkitSpeechRecognition||window.SpeechRecognition,void 0===window.SpeechRecognition)return Di.g.log(3,"This browser does not support Web Speech API!"),!1;this.mStarted=!0,this.mAutoRestart=null==e.autoRestart||e.autoRestart,this.mLastResult=Date.now(),this.mTsi=0,this.mTsf=0,this.mRecognition=new window.SpeechRecognition,this.mRecognition.continuous=null==e.continuous||e.continuous,this.mRecognition.interimResults=null==e.interimResults||e.interimResults,this.mRecognition.maxAlternatives=1,this.mRecognition.lang=e.lang,this.mRecognition.start();let s=this.mWatchdogIntervalMs/2;return s<this.mWatchdogIntervalMinMs&&(s=this.mWatchdogIntervalMinMs),this.mTimerWatchdog=setInterval((()=>{const e=Date.now();e<this.mLastResult&&(this.mLastResult=e);const t=e-this.mLastResult;t>this.mWatchdogIntervalMs&&(Di.g.log(3,`SpeechRecognition : no results for ${t} ms, calling watchdog callback...`),n(t),this.mLastResult=e)}),s),this.mRecognition.onstart=()=>{Di.g.log(3,"SpeechRecognition : callback onstart")},this.mRecognition.onend=()=>{Di.g.log(3,"SpeechRecognition : callback onend");let e=!1;this.mStarted&&this.mAutoRestart&&(this.mTimerRestart=setTimeout((()=>{this.mRecognition.start(),this.clearTimerRestart()})),e=!0),this.mLastResult=Date.now(),i&&i(e)},this.mRecognition.onresult=e=>{const n=Date.now();this.mLastResult=n,(0==this.mTsi||this.mTsf>0&&n>this.mTsf+3e3)&&(Di.g.log(3,`SpeechRecognition : reset time ref : this.mTsi:${this.mTsi}, this.mTsf:${this.mTsf}, ts:${n}`),this.mTsi=n,this.mTsf=n);let i="";for(let s=e.resultIndex;s<e.results.length;s+=1){if(e.results[s].isFinal){const i=e.results[s][0].transcript;return Di.g.log(3,"SpeechRecognition : callback onresult --------- FINAL --------"),this.mRecognition&&(this.notifyResult(t,n,i.trim(),!0),this.mTsi=0,this.mTsf=0),!0}i+=e.results[s][0].transcript}return this.mTsf=n,this.mRecognition&&this.notifyResult(t,n,i.trim(),!1),!0},this.mRecognition.onaudiostart=()=>{Di.g.log(3,"SpeechRecognition : callback onaudiostart")},this.mRecognition.onaudioend=()=>{Di.g.log(3,"SpeechRecognition : callback onaudioend")},this.mRecognition.onerror=e=>{switch(Di.g.log(3,`SpeechRecognition : callback onerror : ${e.error}`),e.error){case"network":break;case"not-allowed":case"service-not-allowed":this.mAutoRestart=!1}},this.mRecognition.onsoundstart=()=>{Di.g.log(3,"SpeechRecognition : callback onsoundstart")},this.mRecognition.onsoundend=()=>{Di.g.log(3,"SpeechRecognition : callback onsoundended")},this.mRecognition.onspeechstart=()=>{Di.g.log(3,"SpeechRecognition : callback onspeechstart")},this.mRecognition.onspeechend=()=>{Di.g.log(3,"SpeechRecognition : callback onspeechend")},!0}notifyResult(e,t,n,i){const s=this.mRecognition.lang,o=this.mTsi,r=this.mTsf-this.mTsi,a=i?t-this.mTsf:0;e($h.packTextData(n,s,null,o,r,a,i))}stop(){Di.g.log(3,"SpeechRecognition : stop"),this.mRecognition&&(this.mRecognition.stop(),this.mRecognition=null),this.mStarted=!1,this.mTsi=0,this.mTsf=0,this.clearTimerRestart(),this.clearTimerWatchdog()}started(){return this.mStarted}}class Ph{constructor(e,t){this.mTimeoutMs=e,this.mResetTimeoutMs=t,this.mLastDataReturned=null,this.mLastDataReceived=null,this.mLastTs=0,this.mSeq=0}packData(e,t,n,i,s,o,r,a){return{refText:e,text:t,lang:n,ts:i,seq:s,duration:o,delay:r,final:a}}process(e){Di.g.log(3,`SpeechRecognitionProcessor::process : ${e.text} : (final:${e.final}, ts:${e.ts}, duration:${e.duration}, delay:${e.delay})`);const t=Date.now(),n=this.packData(e.text,e.text,e.lang,e.ts,0,e.duration,e.delay,e.final);let i=this.packData();var s=!1;if(e.final)s=!0;else{0==this.mLastTs&&(this.mLastTs=t);let e=t-this.mLastTs;e>this.mTimeoutMs+this.mResetTimeoutMs?(Di.g.log(3,`SpeechRecognitionProcessor::process : reseting: lastts:${this.mLastTs}, elapsedMs:${e}, timeoutMs:${this.mTimeoutMs}, resetTimeoutMs:${this.mResetTimeoutMs}`),this.mLastDataReturned=null,this.mLastTs=0):e>this.mTimeoutMs&&(s=!0,this.mLastTs=t)}if(s){const s=e.final&&null!=this.mLastDataReceived?this.mLastDataReceived:n;let o=s.text;if(null!=this.mLastDataReturned&&this.mLastDataReturned.refText){let e=this.mLastDataReturned.refText.length;do{const t=this.mLastDataReturned.refText.substring(0,e);if(o.startsWith(t)){o=o.slice(e);break}e--}while(e>0)}if(o.length>0){const n=1e3,r=30;let a=o.length*r;a<n&&(a=n);let c=s.duration*(o.length/s.text.length);c<a&&(Di.g.log(3,`SpeechRecognitionProcessor::process : resTxt.length:${o.length}, resDurationMs:${c} < minDurationMs:${a}, setting min value..`),c=a),i=this.packData(s.text,o,e.lang,t,++this.mSeq,Math.floor(c),e.final?e.delay:0,e.final),Di.g.log(3,`SpeechRecognitionProcessor::process : Result : ${i.text} : (seq:${i.seq}, ts:${i.ts}, duration:${i.duration}, delay:${i.delay})`)}else Di.g.log(3,"SpeechRecognitionProcessor::process : empty text string... dropping");e.final?(this.mLastDataReturned=null,this.mLastDataReceived=null,this.mLastTs=0):i&&(this.mLastDataReturned=i)}return this.mLastDataReceived=n,i}}const Dh="cmd",Nh="sessionId",Oh="data",Bh="start",Fh="stop",Uh="data",jh=Bh,Vh=Fh,Gh=Uh;class qh{static data(e,t){const n={};return n[Dh]=Uh,n[Nh]=e,n[Oh]=t,JSON.stringify(n)}static processors(e){const t=[];return e.forEach((e=>{const n={};n.eng=e.engineId,n.cfg=e.engineConfiguration,t.push(n)})),t}}class Hh extends qh{static start(e){const t={};t[Dh]=Bh;const n={};return n.pipe=qh.processors(e),t[Oh]=n,JSON.stringify(t)}static stop(e){const t={};return t[Dh]=Fh,t[Nh]=e,JSON.stringify(t)}}class zh{static Prefix(){return"_ws:"}static MsgEnum(){return{Ping:"Ping",Pong:"Pong"}}static process(e,t,n){const i=zh.Prefix();if(Li.hasPrefix(e,i)){const n=Li.removeFirst(e,i.length);JSON.parse(n).cmd===zh.MsgEnum().Ping&&zh.send(t,zh.pong())}else n(e)}static send(e,t){e.send(t)}static ping(){return zh.message(zh.MsgEnum().Ping)}static pong(){return zh.message(zh.MsgEnum().Pong)}static message(e,t){const n={cmd:e};return t&&(n.params=t),`${zh.Prefix()}${JSON.stringify(n)}`}}class Wh{constructor(e,t){this.mIntervalMs=e,this.mMaxWaitMs=t,this.reset()}process(e,t){const n=Date.now();this.mWaitingData?n>this.mLastPingTs+this.mMaxWaitMs&&t():n>this.mLastDataTs+this.mIntervalMs&&(e(),this.mWaitingData=!0,this.mLastPingTs=Date.now())}onDataRcv(){this.mWaitingData=!1,this.mLastDataTs=Date.now()}reset(){const e=Date.now();this.mLastDataTs=e,this.mLastPingTs=e,this.mWaitingData=!1}}class Jh{constructor(e,t,n,i,s,o,r,a){this.mUrl=e,this.mConnectCB=t,this.mMessageCB=n,this.mDisconnectCB=i,this.mStoppedCB=s,this.StateEnum={Disconnected:0,Connecting:1,Connected:2,Stopped:3},this.mReconnect={nextTs:0,curRetries:0,maxRetries:o,intervalBaseMs:r,intervalStepMs:a},this.mConnect={ts:0,maxWaitMs:1e4},this.mPingCtrl=null,this.mWS=null,this.mState=this.StateEnum.Disconnected,this.mCheckStateIntervalMs=1e3,this.mCycleTimer=setInterval((()=>{this.checkState()}),this.mCheckStateIntervalMs),this.connect()}setPingCycle(e){this.mPingCtrl=e>0?new Wh(e,4e3):null}send(e){this.isConnected()?(Di.g.log(3,`WSClient : send : ${e}`),this.mWS.send(e)):Di.g.log(3,"WSClient : send : not connected")}stop(){Di.g.log(3,"WSClient : stop"),this.setStopped(!0)}isConnecting(){return this.mState==this.StateEnum.Connecting}isConnected(){return this.mState==this.StateEnum.Connected}isDisconnected(){return this.mState==this.StateEnum.Disconnected}isStopped(){return this.mState==this.StateEnum.Stopped}connect(){Di.g.log(3,`WSClient : connecting to ${this.mUrl}`),this.mState=this.StateEnum.Connecting,this.mConnect.ts=Date.now(),this.mWS=new WebSocket(this.mUrl),this.mWS.onopen=e=>{Di.g.log(3,"WSClient : onopen"),this.setConnected()},this.mWS.onmessage=e=>{Di.g.log(3,"WSClient : onmessage"),this.mPingCtrl&&this.mPingCtrl.onDataRcv(),zh.process(e.data,this.mWS,(()=>{this.mMessageCB(e.data)}))},this.mWS.onerror=e=>{Di.g.log(3,"WSClient : onerror"),this.setStopped()},this.mWS.onclose=e=>{Di.g.log(3,"WSClient : onclose"),this.isStopped()||this.setDisconnected()}}setNextReconnectTs(){if(this.mReconnect.maxRetries<0||this.mReconnect.curRetries<this.mReconnect.maxRetries){0==this.mReconnect.nextTs&&(this.mReconnect.nextTs=Date.now());const e=2*this.mReconnect.intervalBaseMs;let t=this.mReconnect.curRetries*this.mReconnect.intervalStepMs;t>e&&(t=e);const n=this.mReconnect.intervalBaseMs+t;Di.g.log(3,`WSClient : setNextReconnectTs : reconnecting ${this.mReconnect.curRetries+1}/${this.mReconnect.maxRetries>0?this.mReconnect.maxRetries:"infinite"} in ${n} ms...`),this.mReconnect.nextTs+=n,this.mReconnect.curRetries++,this.mDisconnectCB(n)}else Di.g.log(3,`WSClient : setNextReconnectTs : reached retry limit (${this.mReconnect.maxRetries}), stopping...`),this.setStopped()}closeWS(){this.mWS&&(this.mWS.close(),this.mWS=null)}setConnecting(){this.mState=this.StateEnum.Connecting}setConnected(){this.mState=this.StateEnum.Connected;const e=this.mReconnect.curRetries>0;this.mReconnect.curRetries=0,this.mReconnect.nextTs=0,this.mConnect.ts=0,this.mPingCtrl&&this.mPingCtrl.reset(),this.mConnectCB(e)}setDisconnected(){this.mState=this.StateEnum.Disconnected,this.closeWS(),this.setNextReconnectTs()}setStopped(e=!1){this.mState=this.StateEnum.Stopped,this.closeWS(),this.mCycleTimer&&(clearInterval(this.mCycleTimer),this.mCycleTimer=null),e||this.mStoppedCB()}checkState(){const e=Date.now();this.isConnected()?this.mPingCtrl&&this.mPingCtrl.process((()=>{this.send(zh.ping())}),(()=>{Di.g.log(3,"WSClient : checkState : ping timeout..."),this.setDisconnected()})):this.isConnecting()?e>this.mConnect.ts+this.mConnect.maxWaitMs&&(Di.g.log(3,"WSClient : checkState : connect timeout..."),this.setDisconnected()):this.mReconnect.nextTs>0&&e>=this.mReconnect.nextTs&&this.connect()}}function Yh(e){const t=new e;return{start:(e,n)=>{t.start(e,n)},stop:()=>{t.stop()},started:()=>t.started(),process:(e,n)=>{t.process(e,n)}}}class Kh{constructor(){this.State={Stopping:1,Stopped:2,Starting:3,Started:4},this.mState=this.State.Stopped,this.mConn={url:null,ws:null},this.mReconnectMs=1e3,this.mPingIntervalMs=5e3,this.mStopTimeout=null,this.mSessionId=null,this.mStartInfo=null,this.mResultCB=null,this.mTerminated=!1}started(){return this.mState==this.State.Started}starting(){return this.mState==this.State.Starting}stopped(){return this.mState==this.State.Stopped}start(e,t){Di.g.log(3,`SpeechProcessorCli : start : ${e.processors}`),this.started()?Di.g.log(3,"SpeechProcessorCli : start : already started"):(this.mTerminated=!1,this.mStartInfo=e,this.mResultCB=t,this.stopped()?this.init():Di.g.log(3,"SpeechProcessorCli : start : waiting stop"))}stop(){Di.g.log(3,"SpeechProcessorCli : stop"),this.mTerminated=!0,this.reset()}init(){this.shouldStart()?(Di.g.log(3,"SpeechProcessorCli : init"),this.startWS((()=>{const e=Hh.start(this.mStartInfo.processors);this.send(e)}))):Di.g.log(3,"SpeechProcessorCli : init : should not start, ignoring")}reset(){if(Di.g.log(3,"SpeechProcessorCli : reset"),this.mState==this.State.Stopped)return Di.g.log(3,"SpeechProcessorCli : reset : already stopped, initializing..."),void this.init();if(this.mState!=this.State.Stopping)if(Di.g.log(3,`SpeechProcessorCli : reset : stopping (currentState:${this.mState})`),this.mState==this.State.Started){const e=Hh.stop(this.mSessionId);this.send(e),this.mState=this.State.Stopping,this.mStopTimeout&&clearTimeout(this.mStopTimeout),this.mStopTimeout=setTimeout((()=>{this.setStopped()}),1e4)}else this.setStopped();else Di.g.log(3,"SpeechProcessorCli : reset : waiting stop to complete...")}setStopped(){Di.g.log(3,"SpeechProcessorCli : setStopped"),this.mStopTimeout&&(clearTimeout(this.mStopTimeout),this.mStopTimeout=null),this.mState=this.State.Stopped,this.mSessionId=null,this.mConn.ws.stop(),this.mConn.ws=null,this.init()}handleMessage(e){const t=JSON.parse(e);switch(Di.g.log(3,`SpeechProcessorCli : handleMessage : ${e}`),t[Dh]){case"status":{const e=t.code,n=t[Nh],i=t[Oh][Dh];if(0===e)switch(i){case jh:this.mState==this.State.Starting?(this.mSessionId=n,this.mState=this.State.Started):Di.g.log(3,"SpeechProcessorCli : not starting, ignoring...");break;case Vh:this.mSessionId==n?this.setStopped():Di.g.log(3,`SpeechProcessorCli : handleMessage : this.mSessionId:${this.mSessionId} != sessionId:${n}, ignoring...`)}else Di.g.log(3,`SpeechProcessorCli : handleMessage : Received error : code:${e}, sessionId:${n}, requestCmd:${i}, reseting...`),this.reset();break}case Gh:{const e=t[Oh];this.mResultCB(e);break}default:Di.g.log(3,`SpeechProcessorCli : handleMessage : unsupported message:${e}`)}}shouldStart(){return this.mState==this.State.Stopped&&!this.mTerminated}startWS(e){this.mState=this.State.Starting,this.mConn.url=this.mStartInfo.url,this.mConn.ws=function(e,t,n,i,s,o=0,r=1e3,a=0){const c=new Jh(e,t,n,i,s,o,r,a);return{setPingCycle:(e=5e3)=>{c.setPingCycle(e)},send:e=>{c.send(e)},stop:()=>{c.stop()},isConnecting:()=>c.isConnecting(),isConnected:()=>c.isConnected(),isDisconnected:()=>c.isDisconnected(),isStopped:()=>c.isStopped()}}(this.mStartInfo.url,(t=>{t||e()}),(e=>{this.handleMessage(e)}),(()=>{Di.g.log(3,"SpeechProcessorCli : disconnectedCB : reconnecting...")}),(()=>{Di.g.log(3,"SpeechProcessorCli : stoppedCB"),(this.mState!=this.State.Stopped||this.shouldStart())&&this.reset()}),-1,this.mReconnectMs,0),this.mConn.ws.setPingCycle()}process(e){if(this.mState==this.State.Started){const t=Hh.data(this.mSessionId,e);this.send(t)}else Di.g.log(3,"SpeechProcessorCli : process, not started, ignoring...")}send(e){Di.g.log(3,`SpeechProcessorCli : send : ${e}`),this.mConn.ws.send(e)}}class Xh{constructor(e){this.mEngineId=e,this.mProcessor=Yh(Kh)}start(e,t){this.mProcessor.start({url:e.url,processors:[{engineId:this.mEngineId,engineConfiguration:e.cfg}]},t)}stop(){this.mProcessor.stop()}started(){return this.mProcessor.started()}process(e){this.mProcessor.process(e)}}class Zh extends Xh{constructor(){super("gcp_translate")}}class Qh{constructor(e){this._started=!1,this._params=e,this._resultCb=null}set started(e){this._started=e}get started(){return this._started}set resultCb(e){this._resultCb=e}get resultCb(){return this._resultCb}start(){this._processor=Yh(Zh),this._processor.start(this._params,this._resultCb),this._started=!0}process(e){this._processor.process(e)}}class ep{constructor(){this._supportedLangCodes=["en-US","en-AU","en-GB","fr-FR","de-DE","it-IT","ja-JP","ko-KR","pt-BR","es-US"],this._processor=function(){const e=new Lh;return{start:(t,n,i,s)=>e.start(t,n,i,s),stop:()=>{e.stop()},started:()=>e.started()}}(),this._transcriptionProcessor=function(e=5e3,t=15e3){const n=new Ph(e);return{process:e=>n.process(e)}}(),window.location.href.includes("realmsweb"),this._translateProcessor=new Qh({url:`wss://${window.location.host}:443`,params:null}),this._started=!1,this._translate=!1,this._captureLanguage="",this._transcribeLanguage="",this._startCb=null,this._stopCb=null}get supportedLangCodes(){return this._supportedLangCodes}set translate(e){this._translate=e}get translate(){return this._translate}set startCb(e){this._startCb=e}get startCb(){return this._startCb}set stopCb(e){this._stopCb=e}get stopCb(){return this._stopCb}set captureLanguage(e){this._supportedLangCodes.includes(e)&&(this._captureLanguage=e)}get captureLanguage(){return this._captureLanguage}set transcribeLanguage(e){this._supportedLangCodes.includes(e)&&(this._transcribeLanguage=e)}get transcribeLanguage(){return this._transcribeLanguage}processResult(e){const t=this._processor.process(e);t.text&&this.startCb(t)}start(){this._started=!0;const e={lang:this.captureLanguage};this._processor.start(e,(e=>{const t=this._transcriptionProcessor.process(e);if(!t.text)return!1;const n=t.text,i=t.lang,s=this._transcribeLanguage,o=t.ts,r=t.duration,a=t.delay,c=t.final;if(E(`[CC] Result from Built in Processor: ${JSON.stringify(t)}`),i!==s&&window.config.allowTranslate?window.cc.translate=!0:window.cc.translate=!1,this._startCb&&!window._channel.isAudioMuted())if(this._translate){const e={text:n,lang:i,targetLang:s,ts:o,duration:r,delay:a,final:c};this._translateProcessor.started||(this._translateProcessor.resultCb=this._startCb,this._translateProcessor.start()),this._translateProcessor.process(e)}else this._startCb(t);else this._startCb||E("[CC] Processor start Callback not defined!")}),(e=>{E(`CCPanelBuiltInTranscribe : speech recognition service inactive for ${e} ms, reseting...`),this.stop(),this.start()}))}stop(){this._started&&(this._processor.stop(),this._stopCb&&this._stopCb()),this._started=!1}}const tp=[{"Etc/GMT-12":"-12:00"},{"Etc/GMT-11":"-11:00"},{"Pacific/Midway":"-11:00"},{"America/Adak":"-10:00"},{"America/Anchorage":"-09:00"},{"Pacific/Gambier":"-09:00"},{"America/Dawson_Creek":"-08:00"},{"America/Ensenada":"-08:00"},{"America/Los_Angeles":"-08:00"},{"America/Chihuahua":"-07:00"},{"America/Denver":"-07:00"},{"America/Belize":"-06:00"},{"America/Cancun":"-06:00"},{"America/Chicago":"-06:00"},{"Chile/EasterIsland":"-06:00"},{"America/Bogota":"-05:00"},{"America/Havana":"-05:00"},{"America/New_York":"-05:00"},{"America/Caracas":"-04:30"},{"America/Campo_Grande":"-04:00"},{"America/Glace_Bay":"-04:00"},{"America/Goose_Bay":"-04:00"},{"America/Santiago":"-04:00"},{"America/La_Paz":"-04:00"},{"America/Argentina/Buenos_Aires":"-03:00"},{"America/Montevideo":"-03:00"},{"America/Araguaina":"-03:00"},{"America/Godthab":"-03:00"},{"America/Miquelon":"-03:00"},{"America/Sao_Paulo":"-03:00"},{"America/St_Johns":"-03:30"},{"America/Noronha":"-02:00"},{"Atlantic/Cape_Verde":"-01:00"},{"Europe/Belfast":"00:00"},{"Africa/Abidjan":"00:00"},{"Europe/Dublin":"00:00"},{"Europe/Lisbon":"00:00"},{"Europe/London":"00:00"},{UTC:"00:00"},{"Africa/Algiers":"+01:00"},{"Africa/Windhoek":"+01:00"},{"Atlantic/Azores":"+01:00"},{"Atlantic/Stanley":"+01:00"},{"Europe/Amsterdam":"+01:00"},{"Europe/Belgrade":"+01:00"},{"Europe/Brussels":"+01:00"},{"Africa/Cairo":"+02:00"},{"Africa/Blantyre":"+02:00"},{"Asia/Beirut":"+02:00"},{"Asia/Damascus":"+02:00"},{"Asia/Gaza":"+02:00"},{"Asia/Jerusalem":"+02:00"},{"Africa/Addis_Ababa":"+03:00"},{"Asia/Riyadh89":"+03:00"},{"Europe/Minsk":"+03:00"},{"Asia/Tehran":"+03:30"},{"Asia/Dubai":"+04:00"},{"Asia/Yerevan":"+04:00"},{"Europe/Moscow":"+04:00"},{"Asia/Kabul":"+04:30"},{"Asia/Tashkent":"+05:00"},{"Asia/Kolkata":"+05:30"},{"Asia/Katmandu":"+05:45"},{"Asia/Dhaka":"+06:00"},{"Asia/Yekaterinburg":"+06:00"},{"Asia/Rangoon":"+06:30"},{"Asia/Bangkok":"+07:00"},{"Asia/Novosibirsk":"+07:00"},{"Etc/GMT+8":"+08:00"},{"Asia/Hong_Kong":"+08:00"},{"Asia/Krasnoyarsk":"+08:00"},{"Australia/Perth":"+08:00"},{"Australia/Eucla":"+08:45"},{"Asia/Irkutsk":"+09:00"},{"Asia/Seoul":"+09:00"},{"Asia/Tokyo":"+09:00"},{"Australia/Adelaide":"+09:30"},{"Australia/Darwin":"+09:30"},{"Pacific/Marquesas":"+09:30"},{"Etc/GMT+10":"+10:00"},{"Australia/Brisbane":"+10:00"},{"Australia/Hobart":"+10:00"},{"Asia/Yakutsk":"+10:00"},{"Australia/Lord_Howe":"+10:30"},{"Asia/Vladivostok":"+11:00"},{"Pacific/Norfolk":"+11:30"},{"Etc/GMT+12":"+12:00"},{"Asia/Anadyr":"+12:00"},{"Asia/Magadan":"+12:00"},{"Pacific/Auckland":"+12:00"},{"Pacific/Chatham":"+12:45"},{"Pacific/Tongatapu":"+13:00"},{"Pacific/Kiritimati":"+14:00"}];class np{constructor(){this._timezones=tp,this._timezone=(new Intl.DateTimeFormat).resolvedOptions().timeZone,this._data={},this._channelInvites=[],this._channelOpenInvites=[],this._channelCloseInvites=[]}async create(e){if(function(e){if(e.ephemeral){if(e.channel)return!1;if("close"===e.type)return!1}return!!e}(e)){const t=await async function(e){const t=e,n=W(),i=`${window.apiServer}/mas/invite`;let s;n.body=JSON.stringify(t),E(`[Invite] Creating invite with body: ${JSON.stringify(t)}`);try{s=await fetch(i,n).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`createSession error: ${JSON.stringify(e.errors)}`),!1):e)).catch((e=>(e.json().then((e=>{z(e)})),!1)))}catch(e){return!1}return s}(e);return E(`[Invite] Creation return: ${JSON.stringify(t)}`),t}return E(`[Invite] Create error with body: ${e}`),!1}set data(e){this._data=e}get data(){return this._data}set channelInvites(e){this._channelInvites=e,this._channelOpenInvites=[],this._channelCloseInvites=[];const t=window.time.now();for(let n=0;n<e.length;n+=1)"open"===e[n].type&&(this._channelOpenInvites.push(e[n]),e[n].end_at<t&&window.Events.dispatch("invite/channel-public-option-delete-click",{type:"open"})),"close"===e[n].type&&(this._channelCloseInvites.push(e[n]),e[n].end_at<t&&window.Events.dispatch("invite/channel-private-option-delete-click",{type:"close"}))}get channelInvites(){return this._channelInvites}get channelOpenInvites(){return this._channelOpenInvites}get channelCloseInvites(){return this._channelCloseInvites}get timezones(){const e=[];for(let t=0;t<this._timezones.length;t+=1){const n=Object.entries(this._timezones[t])[0][0];e.push(`${n}`)}return e}get timezonesFull(){return this._timezones}get timezonesWithGMT(){const e=[];for(let t=0;t<this._timezones.length;t+=1){const n=Object.entries(this._timezones[t]),i=n[0][0],s=n[0][1];e.push(`${i} (${s})`)}return e}get timezone(){return this._timezone}async getInvite(e){return await async function(e){const t=`${window.apiServer||window.login.realmConfig.apiServer}/mas/invite/${e}`,n=X();let i;try{i=await fetch(t,n).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`[Invite] Get invite error: ${JSON.stringify(e.errors)}`),!1):e)).catch((e=>{E(e)}))}catch(e){E(e)}return i}(e)}async getChannelInvites(e){let t=await ri(e),n=!1;for(let e=0;e<t.length;e++){const i=t[e];i.end_at<window.time.now()&&C.PERMISSIONS&&C.PERMISSIONS.invite_invite_delete&&(await this.delete(i.token),E(`Deleted expired invite: ${i.token}`),n=!0)}return n&&(t=await ri(e)),t}async delete(e){let t=!1;return C.PERMISSIONS&&C.PERMISSIONS.invite_invite_delete&&(t=await Y(e)),t}async showGuestLogin(){const e=await async function(e){const t=e,n=window.time.now();return l()("#top_menu").hide(),l()("#lpchcb").hide(),l()("#chnCategoriesMenu").hide(),l()(".dbuserinfo_buttons").hide(),l()(".dbuserinfo_sendmsg").hide(),l()(".rpma").hide(),l()("#nchi").hide(),l()("#chi").hide(),l()("#pei").hide(),l()("#channelChatTabIcon").hide(),l()(".channelChatTabIcon").hide(),l()("#chnCategoriesMenu").hide(),l()("#channelCategories").hide(),l()("#channelArea").show(),l()("#top_menu").hide(),e.end_at&&e.end_at<n?(l()("#db_inv_input_area").hide(),l()("#db_inv_msg").html(`${window.i18n.get("invite-expired-to-watch-channel")} <br><span class="sxl b">${t.channel}</span>`),l()("#db_inv_button").hide(),l()("#db_inv_area").height(150),l()("#db_invite").show(),l()("#lpchcb").show(),!1):"open"!==e.type?(l()("#guest_panel").hide(),l()("#db_inv_input_area").hide(),l()("#db_inv_msg").html(`${window.i18n.get("you-do-not-have-permission-to-watch-channel")} <br><span class="sxl b">${t.channel}</span>`),l()("#db_inv_button").hide(),l()("#db_inv_area").height(150),l()("#db_invite").show(),l()("#lpchcb").show(),!1):(l()("#db_inv_msg").html(`${window.i18n.get("you-were-invited-to-watch-channel")} <br><span class="sxl b">${t.channel}</span>`),l()("#db_invite").show(),l()("#db_inv_button").attr("new-invite","true"),l()("#lpchcb").show(),l()("#db_invite_name").focus(),!1)}(this._data);return e}async showTimeExpired(){return await async function(e){const t=e||{channel:""},n=window.Invite.data,i=window.time.toString(t.end_at);return l()("#lpchcb").hide(),l()("#chnCategoriesMenu").hide(),l()(".dbuserinfo_buttons").hide(),l()(".dbuserinfo_sendmsg").hide(),l()(".rpma").hide(),l()("#nchi").hide(),l()("#chi").hide(),l()("#pei").hide(),l()("#channelChatTabIcon").hide(),l()(".channelChatTabIcon").hide(),l()("#chnCategoriesMenu").hide(),l()("#channelCategories").hide(),l()("#channelArea").show(),l()("#db_inv_input_area").hide(),l()("#db_inv_msg").html(`${window.i18n.get("invite-expired-to-watch-channel")} <br><span class="sxl b">${t?.channel}</span>`),l()(".i18n-you-were-invited").hide(),n?l()("#invite_panel").html(`\n            <p class="frm w100 sxl b toj pb20">\n                ${window.i18n.get("invite-already-expired")}\n                <span class="pl5">${i}</span>\n            </p>\n        `):l()("#invite_panel").html(`\n            <p class="frm w100 sxl b toj pb20">\n                ${window.i18n.get("invite-expired")}\n            </p>\n        `),C.guest||l()("#inv_panel_close_btn").show(),l()("#db_inv_button").hide(),l()("#db_inv_area").height(150),l()("#db_invite").show(),l()("#lpchcb").show(),!1}(this._data)}async showCloseDenied(){return await async function(e){const t=e;return l()("#top_menu").hide(),l()("#lpchcb").hide(),l()("#chnCategoriesMenu").hide(),l()(".dbuserinfo_buttons").hide(),l()(".dbuserinfo_sendmsg").hide(),l()(".rpma").hide(),l()("#nchi").hide(),l()("#chi").hide(),l()("#pei").hide(),l()("#channelChatTabIcon").hide(),l()(".channelChatTabIcon").hide(),l()("#chnCategoriesMenu").hide(),l()("#channelCategories").hide(),l()("#channelArea").show(),l()("#top_menu").hide(),l()("#db_inv_input_area").hide(),l()("#db_inv_msg").html(`${window.i18n.get("you-do-not-have-permission-to-watch-channel")} <br><span class="sxl b">${t.channel}</span>`),l()("#db_inv_button").hide(),l()("#db_inv_area").height(150),l()("#db_invite").show(),l()("#lpchcb").show(),!1}(this._data)}async showNotStarted(){return await async function(e){const t=e,n=window.time.toString(t.start_at);return l()("#lpchcb").hide(),l()("#chnCategoriesMenu").hide(),l()(".dbuserinfo_buttons").hide(),l()(".dbuserinfo_sendmsg").hide(),l()(".rpma").hide(),l()("#nchi").hide(),l()("#chi").hide(),l()("#pei").hide(),l()("#channelChatTabIcon").hide(),l()(".channelChatTabIcon").hide(),l()("#chnCategoriesMenu").hide(),l()("#channelCategories").hide(),l()("#channelArea").show(),l()("#db_inv_input_area").hide(),l()("#db_inv_msg").html(`${window.i18n.get("invite-not-started")} <br><span class="sxl b">${n}</span>`),l()(".i18n-you-were-invited").hide(),l()("#invite_panel").html(`\n        <p class="frm w100 sxl b toj pb20">\n            ${window.i18n.get("invite-not-started")}\n            <span class="pl10">${n}</span>\n        </p>\n    `),C.guest||l()("#inv_panel_close_btn").show(),l()("#db_inv_button").hide(),l()("#db_inv_area").height(150),l()("#db_invite").show(),l()("#lpchcb").show(),!1}(this._data)}async update(e){return await async function(e){const t=e,n=t.token,i=ne(),s=`${window.apiServer}/mas/invite/${n}`;let o;i.body=JSON.stringify(t),E(`[Invite] Updating Invite with body: ${JSON.stringify(t)}`);try{o=await fetch(s,i).then((e=>e.ok?e.json():Promise.reject(e))).then((e=>e.errors?(E(`[Invite] Updating error: ${JSON.stringify(e.errors)}`),!1):e)).catch((e=>(e.json().then((e=>{z(e)})),!1)))}catch(e){return!1}return o}(e)}}const ip=document.getElementById("medias");const sp=document.getElementById("medias");sp&&sp.addEventListener("click",(async function(e){e.target.matches(".pagination-back")&&(E("[Medias Interface] Pagination back clicked!"),window._medias.clickBackButtonCB()),e.target.matches(".pagination-forward")&&(E("[Medias Interface] Pagination forward clicked!"),window._medias.clickForwardButtonCB())}));class op{constructor(){this._wnd=null,this._wndArray=[],this._lastWnd=null,this._lastWndArray=[],this._displayType="grid",this._lastScreenSharingId=null,this._screenSharingOwners=[],this._mutedVideoStreamMedias=[],this._startIndex=0,this._visibleMediasLength=4,this._visibleMedias=[],this._invisibleMedias=[],this._forwardButtonShow=!1,this._backButtonShow=!1,this._videoStreamLimitFlags=Ol}set startIndex(e){this._startIndex=e}get startIndex(){return this._startIndex}get visibleMediasLength(){return this._visibleMediasLength}updateControlButtons(){this.displayBackButton(),this.displayForwardButton()}clickForwardButtonCB(){this._startIndex+=this._visibleMediasLength,this._wndArray.length>this._startIndex+this.visibleMediasLength?this._forwardButtonShow=!0:this._forwardButtonShow=!1,this._backButtonShow=!0,this.updateControlButtons(),this.redrawWindows()}clickBackButtonCB(){this._startIndex-=this._visibleMediasLength,this._startIndex<=0&&(this._startIndex=0,this._backButtonShow=!1),this._forwardButtonShow=!0,this.updateControlButtons(),this.redrawWindows()}set visibleMediasLength(e){this._visibleMediasLength=e}set lastWnd(e){this._lastWnd=e}get lastWn(){return this._lastWnd}set lastWndArray(e){this._lastWndArray=e}get lastWndArray(){return this._lastWndArray}set wnd(e){this._wnd&&(this._lastWnd=this._wnd),this._wnd=e}set wndArray(e){this._wndArray&&(this._lastWndArray=this._wndArray),this._wndArray=e}get wndArray(){return this._wndArray}set displayType(e){return this._displayType!==e?(E(`[Medias] setting displayType: ${e}`),this._displayType=e,!0):(E(`[Medias] setting displayType: not changed type ${e}`),!1)}get displayType(){return this._displayType}getUsers(){const e={},t=[];for(let n=0;n<this._wndArray.length;n+=1){const i=this._wnd.get(this._wndArray[n]);let s=i?.metadata?.owner;const o=i?.metadata?.active;s&&(s=s.replace("-web",""));const r=i?.metadata?.fullname||s;e[s]||0!==o&&(e[s]=r,t.push({owner:s,fullname:r}))}return q(t,"fullname")}getOwners(){const e=this.getUsers(),t=Object.values(e),n=[];let i=this.getScreenSharingOwners();i=i.reverse();const s=[],o=[];for(let e=0;e<t.length;e+=1){const r=t[e].owner;i.includes(r)||n.includes(r)||(n.push(r),window._channel.isOperator(r)||this.getScreenSharingOwners().includes(r)?s.push(r):o.push(r))}return[...i,...s,...o]}async getOwnersMedias(){const e=this.getOwners(),t=[];for(let n=0;n<e.length;n+=1){const i=e[n],s=await this.getUserMedia(i);t.push(...s)}const n=[];for(let e=0;e<t.length;e+=1){const i=t[e].metadata?.mediaId;n.push(i)}return n}async getVisibleMedias(){const e=[],t=await this.getOwnersMedias(),n=this._lastScreenSharingId,i=t.filter((function(e){return e!==n}));for(let t=this._startIndex;t<this._startIndex+this._visibleMediasLength;t+=1)i[t]&&e.push(i[t]);return this._visibleMedias=e,e}getMyMedias(){const e=[],t=window._engine.nick(),n=this._wndArray;for(let i=0;i<n.length;i+=1){const s=this._wnd.get(n[i]),o=s?.metadata;if(o){const n=o.owner,i=o.mediaId;n===t&&e.push(i)}}return e}get visibleMedias(){return this._visibleMedias.length<=this._visibleMediasLength&&(this._forwardButtonShow=!1,this._backButtonShow=!1),this._visibleMedias}async getInvisibleMedias(){const e=[],t=await this.getVisibleMedias(),n=await this.getOwnersMedias(),i=this._lastScreenSharingId,s=n.filter((function(e){return e!==i}));for(let n=0;n<s.length;n+=1)t.includes(s[n])||e.push(s[n]);return this._invisibleMedias=e,e}get invisibleMedias(){return this._invisibleMedias}async updateVisibility(){await this.getVisibleMedias(),await this.getInvisibleMedias()}async getScreenSharing(){const e=[],t=this._wndArray;this._screenSharingOwners=[];for(let n=0;n<t.length;n+=1){const i=this._wnd.get(t[n])?.metadata;if(i&&i.screen&&1===i.active){const t=i.owner.replace("-web","");this._screenSharingOwners.includes(t)||this._screenSharingOwners.push(t),e.push(i)}}return e}getScreenSharingOwners(){return this._screenSharingOwners}async getMedia(e){let t=null;return this.wnd&&(t=this.wnd.get(e)||null),t}async getUserMedia(e){const t=e.replace("-web",""),n=[],i=this._wndArray;for(let e=0;e<i.length;e+=1){const s=this._wnd.get(i[e]),o=s?.metadata;if(o){const e=o.owner.replace("-web",""),i=o.active,r=o.mediaId;0===i?(E(`Removed Media for inactive state: ${r}`),this.removeMedia(r)):e===t&&n.push(s)}}return n}setMedia(e,t,n,i){!function(e,t,n,i,s){const o=e;if(!o)return E(`[getMediaWindow] Error getting media wnd: ${JSON.stringify(e)}`),!1;const r=o.metadata;if(!r)return E(`[getMediaWindow] Error getting media metadata: ${JSON.stringify(e)}`),!1;const{active:a,fullname:c,me:l,mediaId:d,owner:u,screen:h}=r,p=o.stream(),w=o.video();let g=!1;if([...window._medias.visibleMedias,i].includes(d)&&(g=!0),!p&&h)return E(`[getMediaWindow] Media without stream: ${d}`),!1;const f=document.getElementById(`m_${d}`),v=document.getElementById(`${d}`);let b,_;if(f)if(f.style.display=g?"flex":"none",w&&"AUDIO"===v.tagName)b=document.querySelector(`#m_${d}`),b.innerHTML="";else{if(w||"VIDEO"!==v.tagName)return"AUDIO"===v.tagName?(v.srcObject=p,v.play().then((e=>{})).catch((e=>{E(`[setMediaWindow] mediaId: ${d} - Error: ${e}`)})),!1):(p!==v.srcObject&&(E(`[setMediaWindow] Renewing stream for ${d}`),v.srcObject=p),v.play().then((e=>{})).catch((e=>{E(`[setMediaWindow] mediaId: ${d} - Error: ${e}`)})),!1);b=document.querySelector(`#m_${d}`),b.innerHTML=""}E(`[setMediaWindow]: ${u}, ${c}, ${d}, ${t} x ${n}`),b?(_=b,_.style.display=g?"flex":"none"):(_=document.createElement("div"),_.setAttribute("id",`m_${d}`),_.setAttribute("media_id",`${d}`),_.setAttribute("owner",`${u.replace("-web","")}`),_.setAttribute("class","media_wnd"),_.style.display=g?"flex":"none",_.style.flexDirection="row",_.style.justifyContent="center",_.style.overflow="hidden",_.style.position="relative",_.style.width=t||"100%",_.style.height=n||"56.2500246%");let y=null;const S=document.createElement("div");if(S.style.display="flex",S.style.flexDirection="column",S.style.justifyContent="center",S.style.position="absolute",d!==i&&(S.style.width="100%"),S.style.height="100%",w)y=document.createElement("video"),y.style.width="100%",y.style.height="100%",y.style.marginTop="auto",y.style.marginBottom="auto",C.IFRAME&&(y.controls=!0),o.setMediaEl($(y));else{y=document.createElement("audio");const e=document.createElement("div");e.setAttribute("class","audiobox");const t=!0;e.innerHTML=function(e,t){const n=m[Math.abs(I(e))%m.length];let i,s,o=window._channel.getUser(e).fullname;return o?(o=o.replace(/\s+/," "),i=Kr(o)):(o="",i=Kr(e)),s=t?`<svg width="100%" height="100%" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid meet" style="width:50%;height:50%;margin-top:auto;margin-bottom:auto;">\n        <foreignObject width="100%" height="100%" xmlns="http://www.w3.org/1999/xhtml" style="display:flex;align-items:center;border-radius:50%;height:100px;background-color:${n};opacity:0.7;justify-content:center">\n          <div style="display:flex;align-items:center;justify-content:center;width:100%;height:100%;font-size:50px;font-weight:500;color:#FFFFFF;background-color:${n};border-radius:50%">${i}</div>\n        </foreignObject>\n      </svg>`:`<svg width="30%" height="30%" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid meet" style="width:30%;height:30%">\n        <foreignObject width="100%" height="100%" xmlns="http://www.w3.org/1999/xhtml" style="display:flex;align-items:center;border-radius:50%;height:100px;background-color:${n};opacity:0.7;justify-content:center">\n          <div style="display:flex;align-items:center;justify-content:center;width:100%;height:100%;font-size:50px;font-weight:500;color:#FFFFFF;background-color:${n};border-radius:50%">${i}</div>\n        </foreignObject>\n      </svg>`,s}(r.owner,t),e.style.width="100%",e.style.height="90px",e.style.display="flex",e.style.justifyContent="center",e.style.marginTop="auto",e.style.marginBottom="auto",S.style.width="100%",S.style.height="auto",S.appendChild(e)}y.setAttribute("id",`${d}`),y.srcObject=p,y.play().then((e=>{})).catch((e=>{E(`[setMediaWindow] mediaId: ${d} - Error: ${e}`)}));const x=document.createElement("div");x.appendChild(y),S.appendChild(x),_.appendChild(S);const k=document.createElement("div");k.style.position="absolute",k.style.left="5px",k.style.bottom="5px",k.style.backgroundColor="rgba(0,0,0,0.5)",k.style.color="#ffffff",k.innerHTML=c,x.appendChild(k);const M=document.createElement("div");if(M.style.position="absolute",M.style.right="5px",M.style.bottom="5px",M.innerHTML=`<div class="audio_${d}" style="width:38px;height:30px;display:flex;padding:2px;justify-content:center;align-items:center;max-height:10px;overflow:hidden;" bar="1"><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px;"></div><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px"></div><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px"></div><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px"></div><div class="bar" style="width:3px;margin:1px;background-color:#00FF00;height:0px;border-radius:2px"></div></div>`,x.appendChild(M),window.webAudio&&window.webAudio.isStarted()&&window.webAudio.startMedia(d),ip.getAttribute("display")!==s)if(ip.setAttribute("display",`${s}`),"bottom"!==s){const e=document.getElementById("display_bottom");e&&(e.style.display="none")}else if("left"!==s){const e=document.getElementById("display_left");e&&(e.style.display="none")}if("bottom"===s){const e=document.getElementById("display_bottom");if(e){e.style.display="flex";const t=document.getElementById("display_bottom_users");if(t){if(!document.getElementById("display_bottom_users_back")){const e=document.createElement("div");e.setAttribute("id","display_bottom_users_back"),e.classList.add("pagination-back"),e.classList.add("material-icons"),e.textContent="arrow_back_ios",e.style.width="50px",e.style.height="100%",e.style.color="rgba(255, 255,255, 0.5)",e.style.position="absolute",e.style.left="0px",e.style.display="flex",e.style.justifyContent="center",e.style.alignItems="center",e.style.zIndex="2",t.append(e)}if(!document.getElementById("display_bottom_usersforward")){const e=document.createElement("div");e.setAttribute("id","display_bottom_usersforward"),e.classList.add("pagination-forward"),e.classList.add("material-icons"),e.textContent="arrow_forward_ios",e.style.width="50px",e.style.height="100%",e.style.color="rgba(255, 255,255, 0.5)",e.style.position="absolute",e.style.right="0px",e.style.display="flex",e.style.justifyContent="center",e.style.alignItems="center",e.style.zIndex="2",t.append(e)}window._medias.updateControlButtons()}}else{const e=document.createElement("div");e.setAttribute("id","display_bottom"),e.style.display="flex",e.style.flexDirection="column",e.style.justifyContent="center",e.style.width="100%",e.style.height="100%";const t=document.createElement("div");t.setAttribute("id","display_bottom_users"),t.style.width="100%",t.style.height="105px",t.style.padding="5px",t.style.display="flex",t.style.scrollbarWidth="thin",t.style.flexDirection="row",t.style.justifyContent="center",t.style.overflowX="auto",t.style.overflowY="hidden",t.style.position="relative";const n=document.createElement("div");n.setAttribute("id","display_bottom_users_back"),n.classList.add("pagination-back"),n.classList.add("material-icons"),n.textContent="arrow_back_ios",n.style.width="50px",n.style.height="100%",n.style.color="rgba(255, 255,255, 0.5)",n.style.position="absolute",n.style.left="0px",n.style.display="none",n.style.justifyContent="center",n.style.alignItems="center",n.style.zIndex="2",t.append(n);const i=document.createElement("div");i.setAttribute("id","display_bottom_usersforward"),i.classList.add("pagination-forward"),i.classList.add("material-icons"),i.textContent="arrow_forward_ios",i.style.width="50px",i.style.height="100%",i.style.color="rgba(255, 255,255, 0.5)",i.style.position="absolute",i.style.right="0px",i.style.display="none",i.style.justifyContent="center",i.style.alignItems="center",i.style.zIndex="2",t.append(i);const s=document.createElement("div");s.setAttribute("id","display_bottom_screen"),s.display="flex",s.style.flex="1",s.style.width="100%",s.style.height="100%",e.append(t),e.append(s),ip.appendChild(e),window._medias.updateControlButtons()}if(d!==i){const e=document.getElementById("display_bottom_users");e&&!b&&(_.style.borderRadius="5px",_.style.marginTop="auto",_.style.marginBottom="auto",_.style.marginLeft="2px",_.style.fontSize="10px",_.style.minWidth=t||"160px",_.style.maxHeight=n||"90px",e.appendChild(_))}else{const e=document.getElementById("display_bottom_screen");e.children.length>0&&(e.innerHTML=""),e&&e.appendChild(_)}}if("left"===s){const e=document.getElementById("display_left");if(e){e.style.display="flex";const t=document.getElementById("display_left_users");if(t){if(!document.getElementById("display_left_users_back")){const e=document.createElement("div");e.setAttribute("id","display_left_users_back"),e.classList.add("pagination-back"),e.classList.add("material-icons"),e.textContent="expand_less",e.style.width="100%",e.style.height="50px",e.style.color="rgba(255, 255,255, 0.5)",e.style.position="absolute",e.style.top="0px",e.style.display="flex",e.style.justifyContent="center",e.style.alignItems="center",e.style.zIndex="2",t.append(e)}if(!document.getElementById("display_left_usersforward")){const e=document.createElement("div");e.setAttribute("id","display_left_usersforward"),e.classList.add("pagination-forward"),e.classList.add("material-icons"),e.textContent="expand_more",e.style.width="100%",e.style.height="50px",e.style.color="rgba(255, 255,255, 0.5)",e.style.position="absolute",e.style.bottom="0px",e.style.display="flex",e.style.justifyContent="center",e.style.alignItems="center",e.style.zIndex="2",t.append(e)}window._medias.updateControlButtons()}}else{const e=document.createElement("div");e.setAttribute("id","display_left"),e.style.display="flex",e.style.flexDirection="row",e.style.flexFlow="row-reverse",e.style.justifyContent="center",e.style.width="100%",e.style.height="100%",e.style.position="relative";const t=document.createElement("div");t.setAttribute("id","display_left_users"),t.style.width="170px",t.style.maxWidth="170px",t.style.height="100%",t.style.padding="5px",t.style.display="flex",t.style.alignContent="center",t.style.scrollbarWidth="thin",t.style.flexDirection="row",t.style.flexWrap="wrap",t.style.overflowX="hidden",t.style.overflowY="auto",t.style.position="relative";const n=document.createElement("div");n.setAttribute("id","display_left_users_back"),n.classList.add("pagination-back"),n.classList.add("material-icons"),n.textContent="expand_less",n.style.width="100%",n.style.height="50px",n.style.color="rgba(255, 255,255, 0.5)",n.style.position="absolute",n.style.top="0px",n.style.display="none",n.style.justifyContent="center",n.style.alignItems="center",n.style.zIndex="2",t.append(n);const i=document.createElement("div");i.setAttribute("id","display_left_usersforward"),i.classList.add("pagination-forward"),i.classList.add("material-icons"),i.textContent="expand_more",i.style.width="100%",i.style.height="50px",i.style.color="rgba(255, 255,255, 0.5)",i.style.position="absolute",i.style.bottom="0px",i.style.display="none",i.style.justifyContent="center",i.style.alignItems="center",i.style.zIndex="2",t.append(i);const s=document.createElement("div");s.setAttribute("id","display_left_screen"),s.display="flex",s.style.flex="1",s.style.width="100%",s.style.height="100%",e.append(t),e.append(s),ip.appendChild(e),window._medias.updateControlButtons()}if(d!==i){const e=document.getElementById("display_left_users");e&&!b&&(_.style.borderRadius="5px",_.style.marginTop="2px",_.style.fontSize="10px",_.style.minWidth=t||"160px",_.style.maxHeight=n||"90px",e.appendChild(_))}else{const e=document.getElementById("display_left_screen");e.children.length>0&&(e.innerHTML=""),e&&e.appendChild(_)}}const T=document.querySelectorAll("#display_bottom_users .media_wnd"),R=document.getElementById("display_left_users");T?.length>0&&"left"===s&&R.appendChild(T)}(e,t,n,i,this._displayType)}removeMedia(e){const t=document.getElementById(`m_${e}`);t?t.remove():E(`[Medias] Remove Error: mediaId "${e}" not found!`)}checkAndRemoveMedias(){const e=document.querySelectorAll(".media_wnd")||[];for(let t=0;t<e.length;t+=1){const n=e[t].getAttribute("owner"),i=parseInt(e[t].getAttribute("media_id"));this._wndArray.includes(i)||(E(`[checkAndRemoveMedias] Removed ${i} ${n}`),e[t].remove())}}async clearOldMedias(){const e=document.querySelectorAll(".mediabox");for(let t=0;t<e.length;t+=1)e[t].remove();return!1}async clearNewMedias(){if("bottom"!==this._displayType){E("clearing bottom medias");const e=document.getElementById("display_bottom_users");e&&(e.innerHTML="");const t=document.getElementById("display_bottom_screen");t&&(t.innerHTML="");const n=document.getElementById("display_bottom");n&&(n.style.display="none")}if("left"!==this._displayType){E("clearing left medias");const e=document.getElementById("display_left_users");e&&(e.innerHTML="");const t=document.getElementById("display_left_screen");t&&(t.innerHTML="");const n=document.getElementById("display_left");n&&(n.style.display="none")}return!1}async redrawWindows(){const e=await this.getScreenSharing(),t=e.length>0;let n=null;if(0!==e.length&&(n=e.pop()),n&&this._lastScreenSharingId!==n.mediaId){const e=n.owner;if(window._recorderCtrl.isStarted()&&(window._channel.setRecorderFeaturedUser(e),window._recorderCtrl.update()),this._lastScreenSharingId){const e=document.getElementById(`m_${n.mediaId}`);if(e)try{E(`Removing screensharing: ${n.mediaId}`),e.remove()}catch(e){console.log(e)}}setTimeout((function(){window._medias.redrawWindows()}),1e4),window._medias.redrawWindows(),this._lastScreenSharingId=n.mediaId}async function i(e,t){const n=e,i=t;let s="main";"bottom"!==n&&"left"!==n||(s="sidebar");const o=window._mediaWndsArray.length;if(window._recorderCtrl.isStarted()){switch(o){case 1:window._windowCtrl.redrawWindows_1();break;case 2:window._windowCtrl.redrawWindows_2();break;case 3:window._windowCtrl.redrawWindows_3();break;case 4:window._windowCtrl.redrawWindows_4();break;default:window._windowCtrl.redrawWindows_n()}window._recorderCtrl.update(),E(`displayType: ${n} - recordingDisplay: ${s}`),i?window.Events.dispatch("record/start","sidebar"):window.Events.dispatch("record/start",s)}}this.checkAndRemoveMedias(),await this.clearOldMedias(),await this.clearNewMedias(),t?"bottom"===this._displayType?(await async function(e,t){let n,i={};if(t){let e;n=t.mediaId||null,n&&(e=window._mediaWndsMap.get(n)),e&&(i=e.metadata||{})}if(E(`display bottom: ${n}`),!t||0===i.active)return window._medias.displayType="grid",window._medias.redrawWindows(),!1;const s=window._medias.getOwners();await e.updateVisibility(),e.wndArray.length-1>e.visibleMediasLength&&0===e.startIndex&&(e._forwardButtonShow=!0,e._backButtonShow=!1),e.updateControlButtons();const o=e.getMyMedias(),r=[...e.visibleMedias,...o];await e.unmuteVideoStreamId(r);const a=e.invisibleMedias.filter((e=>!o.includes(e)));return await e.muteVideoStreamId(a),s.forEach((async e=>{const t=await window._medias.getUserMedia(e);if(t)for(let e=0;e<t.length;e+=1){const i=t[e].metadata,s=i.screen,o=i.mediaId;s&&o===n?window._medias.setMedia(t[e],"100%","100%",n):window._medias.setMedia(t[e],"160px","90px",n)}})),!0}(this,n),await i(this._displayType,t)):"left"===this._displayType?(await async function(e,t){let n,i={};if(t){let e;n=t.mediaId||null,n&&(e=window._mediaWndsMap.get(n)),e&&(i=e.metadata||{})}if(E(`display left: ${n}`),!t||0===i.active)return window._medias.displayType="grid",window._medias.redrawWindows(),!1;const s=window._medias.getOwners();await e.updateVisibility(),e.wndArray.length-1>e.visibleMediasLength&&0===e.startIndex&&(e._forwardButtonShow=!0,e._backButtonShow=!1),e.updateControlButtons();const o=e.getMyMedias(),r=[...e.visibleMedias,...o];await e.unmuteVideoStreamId(r);const a=e.invisibleMedias.filter((e=>!o.includes(e)));return await e.muteVideoStreamId(a),s.forEach((async e=>{const t=await window._medias.getUserMedia(e);if(t)for(let e=0;e<t.length;e+=1){const i=t[e].metadata,s=i.screen,o=i.mediaId;s&&o===n?window._medias.setMedia(t[e],"100%","100%",n):window._medias.setMedia(t[e],"160px","90px",n)}})),!0}(this,n),await i(this._displayType,t)):(this._displayType="grid",await this.clearNewMedias(),this.unmuteAllVideoStreams(),window._windowCtrl.redrawWindows()):(await this.clearNewMedias(),this._displayType="grid",this.unmuteAllVideoStreams(),window._windowCtrl.redrawWindows())}displayBackButton(){const e=document.querySelectorAll(".pagination-back");let t=!1;this._startIndex>=this._visibleMediasLength&&(t=!0),e.forEach((e=>{e.style.display=t?"flex":"none"}))}displayForwardButton(){const e=document.querySelectorAll(".pagination-forward");let t=!1;this._wndArray.length-1>this._startIndex+this.visibleMediasLength&&(t=!0),e.forEach((e=>{e.style.display=t?"flex":"none"}))}muteVideoStreamId(e=[]){const t=[];if(0!==e.length){for(let n=0;n<e.length;n+=1){const i=e[n];this._mutedVideoStreamMedias.includes(i)||t.push(i)}if(t.length>0){const e=Ol;window._engine.requestVideoStreamLimit(e.VIDEO_STREAM_LIMIT_FLAG_DENYREPLACE,t),this._mutedVideoStreamMedias=[...this._mutedVideoStreamMedias,...t],E("Muted video stream ids: ")}return!0}return!1}unmuteVideoStreamId(e=[]){const t=[];for(let n=0;n<e.length;n+=1){const i=e[n];this._mutedVideoStreamMedias.includes(i)&&t.push(i)}if(0!==t.length){const e=Ol;return window._engine.requestVideoStreamLimit(e.VIDEO_STREAM_LIMIT_FLAG_DENYREPLACE,[],t),this._mutedVideoStreamMedias=this._mutedVideoStreamMedias.filter((function(e){return!t.includes(e)})),E("Unmuted video stream ids: "),!0}return!1}setMuteVideoStream(e=[],t=[]){window._engine.requestVideoStreamLimit(0,e,t)}get mutedVideoStreamMedias(){return this._mutedVideoStreamMedias}unmuteAllVideoStreams(){const e=Ol;window._engine.requestVideoStreamLimit(e.VIDEO_STREAM_LIMIT_FLAG_DENYREPLACE,[],this._mutedVideoStreamMedias),this._mutedVideoStreamMedias=[]}}const rp=new EventTarget,ap=new class{constructor(e=Date.now()){this.date=new Date(e)}setTimestamp(e){return this.date=new Date(e),this.date}getLocalizedDateTime(e="en-US"){return this.date.toLocaleString(e)}addDays(e){return this.date.setDate(this.date.getDate()+e),this.date}subtractDays(e){return this.date.setDate(this.date.getDate()-e),this.date}addHours(e){return this.date.setHours(this.date.getHours()+e),this.date}addMinutes(e){return this.date.setMinutes(this.date.getMinutes()+e),this.date}addSeconds(e){return this.date.setSeconds(this.date.getSeconds()+e),this.date}getDay(){return this.date.getDate()}getMonth(){return this.date.getMonth()+1}getYear(){return this.date.getFullYear()}getHour(){return this.date.getHours()}getMinute(){return this.date.getMinutes()}getSecond(){return this.date.getSeconds()}getTimestamp(){return this.date.getTime()}},cp=function(e){let t;const n=e||window.engine.currentChannel();if(!n)return!1;switch(!0){case!!localStorage.getItem("channel_"+n):t=Dr(localStorage.getItem("channel_"+n));break;case!!localStorage.getItem("room_"+n):t=Dr(localStorage.getItem("room_"+n));break;default:return!1}return!t.error&&t.data},lp=(e,t,n,i,s,o)=>{const r=window._engine.statusCodes();switch(t){case r.STATUS_CODE_NESTED_ROOM:window.breakoutRoom&&window.breakoutRoom.processRequest(e,n,i);break;case r.STATUS_CODE_OK:((e,t)=>{const n=new CustomEvent(e,{detail:t});rp.dispatchEvent(n)})("channelStatusCodeOk",{seq:e,code:t,complement:n,complement2:i,complement3:s,complement4:o});break;case r.STATUS_CODE_USER_NOT_SIGNED_IN:case r.STATUS_CODE_PUBLIC_CHAT_FAILED:case r.STATUS_CODE_PRIVATE_CHAT_FAILED:case r.STATUS_CODE_REQTX_FAILED:case r.STATUS_CODE_ALREADY_SIGNED_IN:break;case r.STATUS_CODE_IRM_NEW_USER_STATUS:!function(e,t){const n=window._engine.irmPluginRetCodes();e!==n.IRM_PLUGIN_OK&&E(`app -> handleNewUserStatus: code:${e}, complement:${t}`);const i=`wss://${t}`;switch(parseInt(e)){case n.IRM_PLUGIN_OK:case n.IRM_PLUGIN_INVALID_PARAMETERS:case n.IRM_PLUGIN_SOCK_NOT_FOUND:case n.IRM_PLUGIN_INIT_USER:case n.IRM_PLUGIN_CHANNEL_JOIN:case n.IRM_PLUGIN_CREATE_USER:case n.IRM_PLUGIN_INVALID_CHANNEL:case n.IRM_PLUGIN_INVALID_NICK:case n.IRM_PLUGIN_INIT_CONN:break;case n.IRM_PLUGIN_MUST_REDIR:window._engine.stop(),E(`app -> handleNewUserStatus: redirect to ${i}`),window._app.startJanus(i);case n.IRM_PLUGIN_INVALID_PROTOCOL:case n.IRM_PLUGIN_SIGNIN_ERROR:}}(n,i);case r.STATUS_CODE_ADD_IM_USER_FAILED:case r.STATUS_CODE_DEL_IM_USER_FAILED:case r.STATUS_CODE_SET_TOPIC_FAILED:case r.STATUS_CODE_MEDIA_RX:case r.STATUS_CODE_IDLE_ACK:}},dp=()=>({method:"GET",headers:new Headers({"Content-Type":"application/json","x-api-key":window.auth_token})}),up=class{constructor(e){this._engine=e,this._srvClientId=null,this._serverName="",this._acsNick="",this._ppcsNick="",this._currentChannel="",window._engine.callbacks().statusCB(lp)}get currentChannel(){return this._engine.currentChannel}set srvClientId(e){this._srvClientId=e}get srvClientId(){return this._srvClientId}set serverName(e){this._serverName=e}get serverName(){return this._serverName}set acsNick(e){this._acsNick=e}get acsNick(){return this._acsNick}set ppcsNick(e){this._ppcsNick=e}get ppcsNick(){return this._ppcsNick}get getParams(){return dp}get configChannel(){return cp}reset(){this._srvClientId=null,this._serverName="",this._acsNick="",this._ppcsNick="",this._currentChannel=""}};window.channelData=Ra,window.timerWorker=new class{constructor(){this.timerWorker=wh,this.pendingPromises={},this.functionsMap={},this.seq=0,this.log=!1,this.timestampHandler=ap,this.timerWorker.onmessage=e=>{const t=e.data;this.showLog(`[TimerWorker] Received message from webworker: ${JSON.stringify(t)}`);const n=this.pendingPromises[`${t.type}-${t.seq}`];if(n){if("setTimeout"===t.type){const e=this.functionsMap[t.id];e&&(e(),delete this.functionsMap[t.id])}else if("clearTimeout"===t.type){const e=this.functionsMap[t.id];e&&(clearTimeout(e),delete this.functionsMap[t.id])}n(t),delete this.pendingPromises[`${t.type}-${t.seq}`]}else this.showLog(`[TimeWorker] Error: No pending promise for type: ${t.type} seq: ${t.seq}`)}}postMessage(e,t){this.seq+=1;const n=this.seq;return this.showLog(`[TimerWorker] Posting message to webworker - type: ${e} - ${JSON.stringify(t)} - seq: ${n}`),new Promise((i=>{this.pendingPromises[`${e}-${n}`]=i,this.timerWorker.postMessage({type:e,...t,seq:n})}))}setLog(e){this.log=e}showLog(e){this.log&&(window.showLog?E(e):console.log(e))}async getUserTs(){this.showLog("[TimerWorker] request: getUserTs");const e=await this.postMessage("getUserTs");return this.showLog(`[TimerWorker] response: ts: ${e.userTs}`),e.userTs}async setServerTs(e){this.showLog(`[TimerWorker] request: setServerTs: ${e}`);const t=await this.postMessage("setServerTs",{serverTs:e});return this.showLog(`[TimerWorker] response: tsDiff: ${t.tsDiff}`),t.tsDiff}async getServerTs(){this.showLog("[TimerWorker] request: getServerTs");const e=await this.postMessage("getServerTs");return this.showLog(`[TimerWorker] response: serverTs: ${e.serverTs}`),e.serverTs}async now(){this.showLog("[TimerWorker] request: now");const e=await this.postMessage("now");return this.showLog(`[TimerWorker] response: now: ${e.now}`),e.now}async getFormDate(e){this.showLog(`[TimerWorker] request: getFormDate - ts: ${e}`);const t=await this.postMessage("getFormDate",{ts:e});return this.showLog(`[TimerWorker] response: formDate: ${t.formDate}`),t.formDate}async toString(e){this.showLog(`[TimerWorker] request: toString - ts: ${e}`);const t=await this.postMessage("toString",{ts:e});return this.showLog(`[TimerWorker] response: toString - string: ${t.string}`),t.string}getLocalizedDateTime(e,t="en-US"){return this.timestampHandler.setTimestamp(e),this.timestampHandler.getLocalizedDateTime(t)}addDays(e,t){return this.timestampHandler.setTimestamp(e),this.timestampHandler.addDays(t)}subtractDays(e,t){return this.timestampHandler.setTimestamp(e),this.timestampHandler.subtractDays(t)}addHours(e,t){return this.timestampHandler.setTimestamp(e),this.timestampHandler.addHours(t)}addMinutes(e,t){return this.timestampHandler.setTimestamp(e),this.timestampHandler.addMinutes(t)}addSeconds(e,t){return this.timestampHandler.setTimestamp(e),this.timestampHandler.addSeconds(t)}getDay(e){return this.timestampHandler.setTimestamp(e),this.timestampHandler.getDay()}getMonth(e){return this.timestampHandler.setTimestamp(e),this.timestampHandler.getMonth()}getYear(e){return this.timestampHandler.setTimestamp(e),this.timestampHandler.getYear()}getHour(e){return this.timestampHandler.setTimestamp(e),this.timestampHandler.getHour()}getMinute(e){return this.timestampHandler.setTimestamp(e),this.timestampHandler.getMinute()}getSecond(e){return this.timestampHandler.setTimestamp(e),this.timestampHandler.getSecond()}async setTimeout(e,t,n){this.showLog(`[TimerWorker] request: setTimeout - id: ${e} - ts: ${n}`),this.functionsMap[e]=t;const i=await this.postMessage("setTimeout",{id:e,ts:n});return this.showLog(`[TimerWorker] response: setTimeout - id: ${i.timeoutId}`),i.timeoutId}async clearTimeout(e){if(this.showLog(`[TimerWorker] request: clearTimeout - id: ${e}`),this.functionsMap.hasOwnProperty(e)){const t=await this.postMessage("clearTimeout",{id:e});return this.showLog(`[TimerWorker] response: clearTimeout - id: ${e} - cleared: ${t.cleared}`),delete this.functionsMap[e],t.cleared}return null}async getTimeout(e){return this.showLog(`[TimerWorker] request: getTimeout - id: ${e}`),this.functionsMap.hasOwnProperty(e)?this.functionsMap[e]:null}async setInterval(e,t,n){this.showLog(`[TimerWorker] setInterval - id: ${e} - ts: ${n}`);const i=async()=>{t(),this.functionsMap[e]&&(this.functionsMap[e].timeoutId=await this.setTimeout(`${e}-interval-${this.seq}`,i,n))};return this.functionsMap[e]={fn:t,intervalFunction:i,timeoutId:await this.setTimeout(e,i,n)},!0}async clearInterval(e){return this.showLog(`[TimerWorker] clearInterval - id: ${e}`),this.functionsMap.hasOwnProperty(e)?(clearTimeout(this.functionsMap[e].timeoutId),delete this.functionsMap[e],!0):null}async getInterval(e){return this.showLog(`[TimerWorker] getInterval - id: ${e}`),this.functionsMap.hasOwnProperty(e)?this.functionsMap[e].fn:null}async startTimer(e,t){this.showLog(`[TimerWorker] request startTimer - timer: ${e} - ts: ${t}`);const n=await this.postMessage("startTimer",{_timer:e,_ts:t});return this.showLog(`[TimerWorker] response startTimer - timer: ${JSON.stringify(n.timer)}`),n.timer}async stopTimer(e){this.showLog(`[TimerWorker] request: stopTimer - timer: ${e}`);const t=await this.postMessage("stopTimer",{_timer:e});return t.timer?this.showLog(`[TimerWorker] response: stopTimer - timer: ${JSON.stringify(t.timer)}`):this.showLog(`[TimerWorker] [Error] response: stopTimer - timer: ${e} not stopped!`),t.timer}async removeTimer(e){this.showLog(`[TimerWorker] request: removeTimer - timer: ${e}`);const t=await this.postMessage("removeTimer",{_timer:e});return this.showLog(`[TimerWorker] response: removeTimer - success: ${t.success}`),t.success}async stopTimers(e){this.showLog(`[TimerWorker] request: stopTimers - category: ${e}`);const t=await this.postMessage("stopTimers",{category:e});return this.showLog(`[TimerWorker] response: stopTimers - timers: ${JSON.stringify(t.timers)}`),t.timers}async getTimer(e){this.showLog(`[TimerWorker] request: getTimer - timer: ${e}`);const t=await this.postMessage("getTimer",{_timer:e});return this.showLog(`[TimerWorker] response: getTimer - timer: ${JSON.stringify(t.timer)}`),t.timer}async getTimers(e){this.showLog(`[TimerWorker] request: getTimers - category: ${e}`);const t=await this.postMessage("getTimers",{category:e});return this.showLog(`[TimerWorker] response: getTimers - timers: ${JSON.stringify(t.timers)}`),t.timers}async reset(e){this.showLog(`[TimerWorker] request: reset - category: ${e}`);const t=await this.postMessage("reset",{category:e});return this.showLog(`[TimerWorker] response: reset - success: ${t.success}`),t.success}};const hp=e=>{const t=Nr("persistentConfigs")||{};return window.webcamBitrate=e||t.webcamBitrate||window.config.webcamDefaultBitrate||256,window._engine.setBitrate(1e3*window.webcamBitrate),Or("persistentConfigs",{...t,webcamBitrate:window.webcamBitrate}),window.webcamBitrate},pp=e=>{const t=Nr("persistentConfigs")||{};return window.screenBitrate=e||t.screenBitrate||window.config.screenDefaultBitrate||1024,window._engine.setBitrateScreen(1e3*window.screenBitrate),Or("persistentConfigs",{...t,screenBitrate:window.screenBitrate}),window.screenBitrate};function mp(e,t){const n=document.querySelector("#display-modal");let i;return n?(n.setAttribute("index",t),n.innerHTML=e,n.onclick=e=>{"display-forward"===e.target.className?window.tutorial.next():"display-back"===e.target.className?window.tutorial.back():"display-end"===e.target.className?window.tutorial.stop():"display-checked"===e.target.className?window.tutorial.checked=e.target.checked:e.target.className.includes("display-go")&&window.tutorial.go(e.target.dataset.index)},!1):(i=document.createElement("div"),i.id="display-modal",i.style.display="flex",i.style.alignItems="center",i.style.position="absolute",i.style.zIndex="9999",i.style.width="100%",i.style.height="100%",i.style.color="#fff",i.style.backgroundColor="rgba(100, 100, 100, 0.5)",i.setAttribute("index",t),i.innerHTML=e,i.onclick=e=>{"display-forward"===e.target.className?window.tutorial.next():"display-back"===e.target.className?window.tutorial.back():"display-end"===e.target.className?window.tutorial.stop():"display-checked"===e.target.className?window.tutorial.checked=e.target.checked:e.target.className.includes("display-go")&&window.tutorial.go(e.target.dataset.index)},document.body.appendChild(i),!1)}const wp={eduspRoomTutorial001:"eduspRoomTutorial001"},gp=[],fp="https://assets.ip.tv/webchat/edusp/",vp=e=>`<div id="content" style="position:relative;width:775px;height:540px;background-color:#002d70;margin:auto;border-radius:20px;">${e}</div>`,bp=`\n    <div style="display:flex;justify-content:center;position:absolute;width:100%;top:35px;"><img src="${fp}tutorial001_01.png" /></div>\n    <div style="display:flex;justify-content:center;position:absolute;width:100%;top:350px;text-align:center;font-size:17px;padding:0px 86px 0px 86px;">No chat da turma, os professores/servidores podem ser identificados pelo Ã­cone laranja de "estrela", que aparece ao lado do nome.</div>\n    <div style="display:flex;justify-content:center;position:absolute;height:20px;width:100%;bottom:90px;">\n        <div class="display-go material-icons" data-index="0" style="color:#21affa;font-size:10px;padding:7px;">circle</div>\n        <div class="display-go material-icons" data-index="1" style="font-size:10px;padding:7px;">circle</span></div>\n        <div class="display-go material-icons" data-index="2" style="font-size:10px;padding:7px;">circle</span></div>\n        <div class="display-go material-icons" data-index="3" style="font-size:10px;padding:7px;">circle</span></div>\n    </div>\n    <div style="position:absolute;display:flex;justify-content:space-between;width:100%;height:40px;align-items:end;padding:0px 35px 35px 35px;bottom:0px;">\n        <div></div>\n        <div class="display-go" data-index="1" style="cursor:pointer;display:flex;align-items:center;font-size:19px;">PrÃ³ximo <span class="material-icons display-go" data-index="1" style="padding-left:5px;">arrow_forward_ios</span></div>\n    </div>`,_p=`\n    <div style="display:flex;justify-content:center;position:absolute;width:100%;top:35px;"><img src="${fp}tutorial001_02.png" /></div>\n    <div style="display:flex;justify-content:center;position:absolute;width:100%;top:340px;text-align:center;font-size:17px;padding:0px 86px 0px 86px;">Agora, na aba de tarefas, Ã© possÃ­vel receber tambÃ©m tarefas enviadas pelos professores da escola. Basta clicar no Ã­cone "Mais opÃ§Ãµes" e escolher<br />"Tarefas da escola" ou "Tarefas do estÃºdio".</div>\n    <div style="display:flex;justify-content:center;position:absolute;height:20px;width:100%;bottom:90px;">\n        <div class="display-go material-icons" data-index="0" style="font-size:10px;padding:7px;">circle</div>\n        <div class="display-go material-icons" data-index="1" style="color:#21affa;font-size:10px;padding:7px;">circle</span></div>\n        <div class="display-go material-icons" data-index="2" style="font-size:10px;padding:7px;">circle</span></div>\n        <div class="display-go material-icons" data-index="3" style="font-size:10px;padding:7px;">circle</span></div>\n    </div>\n    <div style="position:absolute;display:flex;justify-content:space-between;width:100%;height:40px;align-items:end;padding:0px 35px 35px 35px;bottom:0px;">\n        <div class="display-go" data-index="0" style="cursor:pointer;display:flex;align-items:center;font-size:19px;"><span class="material-icons display-go" data-index="0" style="padding-right:5px;">arrow_back_ios</span> Voltar</div>\n        <div class="display-go" data-index="2" style="cursor:pointer;display:flex;align-items:center;font-size:19px;">PrÃ³ximo <span class="material-icons display-go" data-index="2" style="padding-left:5px;">arrow_forward_ios</span></div>\n    </div>`,yp=`\n    <div style="display:flex;justify-content:center;position:absolute;width:100%;top:35px;"><img src="${fp}tutorial001_03.png" /></div>\n    <div style="display:flex;justify-content:center;position:absolute;width:100%;top:350px;text-align:center;font-size:17px;padding:0px 86px 0px 86px;">Se estiver em uma turma de expansÃ£o, nessa aba vocÃª poderÃ¡ assistir as aulas gravadas pelos professores da sua turma.</div>\n    <div style="display:flex;justify-content:center;position:absolute;height:20px;width:100%;bottom:90px;">\n        <div class="display-go material-icons" data-index="0" style="font-size:10px;padding:7px;">circle</div>\n        <div class="display-go material-icons" data-index="1" style="font-size:10px;padding:7px;">circle</span></div>\n        <div class="display-go material-icons" data-index="2" style="color:#21affa;font-size:10px;padding:7px;">circle</span></div>\n        <div class="display-go material-icons" data-index="3" style="font-size:10px;padding:7px;">circle</span></div>\n    </div>\n    <div style="position:absolute;display:flex;justify-content:space-between;width:100%;height:40px;align-items:end;padding:0px 35px 35px 35px;bottom:0px;">\n        <div class="display-go" data-index="1" style="cursor:pointer;display:flex;align-items:center;font-size:19px;"><span class="material-icons display-go" data-index="1" style="padding-right:5px;">arrow_back_ios</span> Voltar</div>\n        <div class="display-go" data-index="3" style="cursor:pointer;display:flex;align-items:center;font-size:19px;">PrÃ³ximo <span class="material-icons display-go" data-index="3" style="padding-left:5px;">arrow_forward_ios</span></div>\n    </div>`;gp.push(`<div id="content" style="position:relative;width:775px;height:540px;background-color:#002d70;margin:auto;border-radius:20px;">${bp}</div>`),gp.push(vp(_p)),gp.push(vp(yp)),gp.push('<div id="content" style="position:relative;width:775px;height:540px;background-color:#002d70;margin:auto;border-radius:20px;">\n    <div style="display:flex;justify-content:center;position:absolute;width:100%;top:126px;text-align:center;font-size:17px;padding:0px 86px 0px 86px;">\n        <div style="display:flex;flex-direction:column;width:100%;">\n            <div style="padding:10px;font-weight:bold;">Se quiser saber mais sobre o CMSP e suas funcionalidades, acesse:</div>\n            <div style="padding:10px;color:#21affa;font-weight:bold;"><a href="https://centrodemidiasp.educacao.sp.gov.br/materiais-de-orientacao/" target="_blank" style="text-decoration:none;color:#21affa;">https://centrodemidiasp.educacao.sp.gov.br/materiais-de-orientacao/</a></div>\n            <div style="padding:10px;font-weight:bold;">Em caso de problemas na funcionalidade do app, acesse:</div>\n            <div style="padding:10px;color:#21affa;font-weight:bold;"><a href="https://atendimento.educacao.sp.gov.br/" target="_blank" style="text-decoration:none;color:#21affa;">https://atendimento.educacao.sp.gov.br/</a></div>\n            <div style="padding:40px 0px 0px 0px;"><input type="checkbox" class="display-checked" name="dont-display-tutorial001" /><span style="font-size:13px;padding-left:10px;">NÃ£o exibir novamente</span></div>\n        </div>\n    </div>\n    <div style="display:flex;justify-content:center;position:absolute;height:20px;width:100%;bottom:90px;">\n        <div class="display-go material-icons" data-index="0" style="font-size:10px;padding:7px;">circle</div>\n        <div class="display-go material-icons" data-index="1" style="font-size:10px;padding:7px;">circle</span></div>\n        <div class="display-go material-icons" data-index="2" style="font-size:10px;padding:7px;">circle</span></div>\n        <div class="display-go material-icons" data-index="3" style="color:#21affa;font-size:10px;padding:7px;">circle</span></div>\n    </div>\n    <div style="position:absolute;display:flex;justify-content:space-between;width:100%;height:40px;align-items:end;padding:0px 35px 35px 35px;bottom:0px;">\n    <div class="display-go" data-index="2" style="cursor:pointer;display:flex;align-items:center;font-size:19px;"><span class="material-icons display-go" data-index="2" style="padding-right:5px;">arrow_back_ios</span> Voltar</div>\n        <div class="display-end" style="font-size:19px;cursor:pointer;">Fechar</div>\n    </div></div>');const Cp=gp;class Sp{constructor(e){if(!wp[e])throw new Error(`Tutorial ${e} does not exist!`);this.index=0,this._checked=!0,this.name=e,this.pages="eduspRoomTutorial001"===wp[e]?Cp:[]}start(){0===this.pages.length&&E(`No tutorial pages found for ${this.name}`);const e=window._engine.currentChannel();return"nested"===window.breakoutRoom.getRoomType(e)||(this.index=0,mp(this.pages[this.index],this.index)),!1}next(){return this.index>=this.pages.length-1?(E("Can not access next page tutorial!"),!1):(this.index+=1,mp(this.pages[this.index],this.index),!1)}go(e){return e>=this.pages.length||e<0?(E(`Can not access tutorial page index ${e}`),!1):(this.index=e,mp(this.pages[this.index],this.index),!1)}back(){return 0===this.index?(E("Can not access back page tutorial!"),!1):(this.index-=1,mp(this.pages[this.index],this.index),!1)}set checked(e){return this._checked=e,!1}get checked(){return this._checked}stop(){const e={},t=document.querySelector(".display-checked");return e[this.name]=!t.checked,function(){const e=document.querySelector("#display-modal");e&&e.remove()}(),l().post(`/g/setUserData${window.location.search}`,{data:e},(function(e){E(`[UserData] remove tutorial result: ${JSON.stringify(e)}`)})),!1}}function Ep(){window._channel.callbacks().channelPermissionsCB((function(e){let t=e.user;p.GUEST&&!window.invite?.allowChat&&(t=e.guest),window._channel.isOwner(p.ENGINE_NICK)&&(t=e.owner),window._channel.isOperator(p.ENGINE_NICK)&&(t=e.operator),window._channel.isRoomOperator(p.ENGINE_NICK)&&(t=e.operator),window._channel.isModerator(p.ENGINE_NICK)&&(t=e.moderator),"p"===window._channel.getSuffix()&&l()("#rpchnhi").show();const n=window._engine.currentChannel(),i="nested"===window.breakoutRoom.getRoomType(n),s="room"===window.breakoutRoom.getRoomType(n),o="meeting"===window.breakoutRoom.getRoomType(n);if(window._channel.isOperator(p.ENGINE_NICK)&&!i){const e=window._channel.getType();0===e?l()(".rpchnmoderate").show():l()(".rpchnmoderate").hide(),l()(".rpchnnotification").show(),window.enableCsm||s||o?l()(".rpchnyt").hide():l()(".rpchnyt").show(),l()(".rpchn-silenced").show(),l()(".rpchn-banned").show(),(0===e&&window.config.allowChannelLinkCopy||1===e&&window.config.allowRoomLinkCopy)&&l()("#rpchncl").show();const t=window.engine.configChannel();let n=t.enable_metaverse?t.enable_metaverse:t.enableMetaverse;p.CONFIG.allowDirectScreenSaving&&0===window._channel.getType()?(n?l()("#rpchnscreensaving").show():l()("#rpchnscreensaving").hide(),window.localScreen?.started()?l()("#screen-saving-status").html(window.i18n.get("enabled")):l()("#screen-saving-status").html(window.i18n.get("disabled"))):l()("#rpchnscreensaving").hide(),window.Events.dispatch("breakout-rooms/options-btn-show")}else l()(".rpchnmoderate").hide(),l()(".rpchnnotification").hide(),l()(".rpchnyt").hide(),l()(".rpchn-silenced").hide(),l()(".rpchn-banned").hide(),l()("#rpchncl").hide(),l()("#rpchnscreensaving").hide(),l()("#rpchn-MuteAll").hide();if(t.allowSendChatMessage){let e;e=0===window._channel.getType()&&""===window._channel.getActiveRoom()?"channel_":"room_";let t={};if(""===window._channel.getActiveRoom())if(null!==localStorage.getItem(e+window._channel.getName()))try{t=JSON.parse(localStorage.getItem(e+window._channel.getName())),window._channel.isOperator(p.ENGINE_NICK)&&(t.msg_per_day=-1)}catch(t){localStorage.removeItem(e+window._channel.getName())}else t.msg_per_day=-1;else if(null!==localStorage.getItem(e+window._channel.getActiveRoom()))try{t=JSON.parse(localStorage.getItem(e+window._channel.getActiveRoom())),window._channel.isOperator(p.ENGINE_NICK)&&(t.msg_per_day=-1)}catch(e){t.msg_per_day=-1}else t.msg_per_day=-1;if(window._channel.getModes().N&&!window._channel.getModes().m)l()("#channelMsgCounter").hide(),l()("#channelMsgAlert").hide(),l()("#hp__Channel__").is(":visible")&&(""===window._channel.getActiveRoom()&&0!==t.todayMsgCredit?(l()("#channelInputArea").show(),l()("#channelGroupInputArea").hide()):(l()("#channelGroupInputArea").show(),l()("#channelInputArea").hide()));else if(-1!==parseInt(t.msg_per_day))0===parseInt(t.msg_per_day)?(l()("#channelMsgAlert").show(),l()("#channelNoMoreMsg").hide()):0===t.todayMsgCredit?(l()("#channelMsgCounter btn").removeClass("pt"),l()("#channelMsgCounter btn").removeClass("bgbl"),l()("#channelMsgCounter btn").addClass("bgdg"),l()("#channelMsgCounter").hide(),l()("#channelNoMoreMsg").show(),1===window._channel.getType()&&l()("#channelInputArea").hide()):t.todayMsgCredit&&(l()("#channelMsgCounter btn").addClass("pt"),l()("#channelMsgCounter btn").addClass("bgbl"),l()("#channelMsgCounter btn").removeClass("bgdg"),l()("#channelMsgCounter").show(),l()("#channelMsgAlert").hide(),l()("#channelNoMoreMsg").hide()),l()("#channelMsgCredit").html(parseInt(t.msg_per_day)-parseInt(t.todayMsgCredit)),l()("#channelMsgCounterLimit").html(t.msg_per_day),l()("#channelGroupInputArea").hide(),l()("#channelInputArea").hide();else if(l()("#channelMsgCounter").hide(),l()("#channelMsgAlert").hide(),""===window._channel.getActiveRoom()){const e=p.ENGINE_NICK;!window._channel.getModes().m||window._channel.isModerator(e)||window._channel.isOperator(e)?l()("#hp__Channel__").is(":visible")&&(""===window._channel.getActiveRoom()?(l()("#channelInputArea").show(),l()("#channelGroupInputArea").hide()):(l()("#channelGroupInputArea").show(),l()("#channelInputArea").hide())):l()("#hp__Channel__").is(":visible")&&(l()("#channelInputArea").hide(),l()("#channelMsgAlert").show(),l()("#channelNoMoreMsg").hide())}else l()("#hp__Channel__").is(":visible")&&l()("#channelGroupInputArea").show()}else l()("#hp__Channel__").is(":visible")&&(l()("#channelGroupInputArea").hide(),l()("#channelInputArea").hide(),l()("#channelMsgCounter").hide(),l()("#channelMsgAlert").show());("l"===window._channel.getSuffix()||"m"===window._channel.getSuffix())&l()("#channelAdmChat").hasClass("ic_channel_chat_ON")&&l()("#channelInputArea").show(),t.allowMediaAttachments?1===window._channel.getType()||""!==window._channel.getActiveRoom()?(window.roomsConfig.attachment_disabled?window._channel.isRoomOperator(p.ENGINE_NICK)||window._channel.isOperator(p.ENGINE_NICK)?window.config.denyAllGroupAttachment?l()(".chnat").hide():(l()(".chnat").show(),l()(".rpmaid").show(),l()(".rpmaia").hide(),l()(".rpmaiiv").hide()):l()(".chnat").hide():(l()(".chnat").show(),l()(".rpmaid").show(),window.config.showRoomAllAttachments?(l()(".rpmaia").show(),l()(".rpmaiiv").show()):(l()(".rpmaia").hide(),l()(".rpmaiiv").hide())),"oros"===window.realm&&(l()(".chnat").show(),l()(".rpmaid").show(),l()(".rpmaia").show(),l()(".rpmaiiv").show())):window._channel.isOperator(p.ENGINE_NICK)||window._channel.isModerator(p.ENGINE_NICK)||!window._channel.getModes().T?(l()(".chnat").show(),l()(".rpmaid").show(),l()(".rpmaia").show(),l()(".rpmaiiv").show()):l()(".chnat").hide():window._channel.isOperator(p.ENGINE_NICK)||window._channel.isModerator(p.ENGINE_NICK)?(l()(".chnat").show(),l()(".rpmaia").show(),l()(".rpmaiiv").show()):l()(".chnat").hide()})),window._channel.callbacks().channelCategoriesCB((function(e){if(p.CONFIG.newCategoriesListWithChannels)return l()("#chnCategoriesMenu").hide(),!1;let t;const n=[],i=e;if(0===i.length)return!1;if(1===i.length)return l()("#chnCategoriesMenu").hide(),l()("#channelCategories").hide(),window._channel.getChannelList("channel",i[0].id),window._channel.setLastCategory(i[0].id),!1;if(l()("#channelCategories").html(""),window.config.showChannelCategoryList){l()("#chnCategoriesMenu").show(),l()("#channelCategories").show();let e="channel";i[0].id===window.config.firstCategorySelected&&(e=window.config.firstCategoryType),window._channel.getChannelList(e,i[0].id),""===window._channel.getLastCategory()&&window._channel.setLastCategory(i[0].id),i.length>15&&l()("#lpchcb").removeClass("fcm"),i.forEach((function(e,i){if(e.imgON&&e.primary)if(n[i]=new Image,n[i].src=`${window.assets}/common${e.imgON}`,t=`<div class=" lpchc${e.id} lpchc fc pt" category="${e.id}">`,t+=`<div class="fic ico" style="height:32px;width:32px;margin-bottom:5px;background-image:url(${window.assets}/common${e.imgOFF})"></div>`,t+=`<div class="name sxs fic" style="max-width:65px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;" title="${e.name}">${e.name}</div></div>`,window.config.firstCategorySelected===e.id){const n=window.config.firstCategoryType?window.config.firstCategoryType:"channel";l()("#channelCategories").prepend(t),window._channel.getLastCategory()!==e.id&&(window._channel.getChannelList(n,e.id),window._channel.setLastCategory(e.id))}else l()("#channelCategories").append(t)}))}else l()("#chnCategoriesMenu").hide(),l()("#channelCategories").hide();return!1})),window._channel.callbacks().channelListCB((function(e,t){if(!e)return!1;if(0===e.length)return!1;if(!l()("#chni").hasClass("lpis")&&l()("#chni").is(":visible"))return!1;if(window._engine.currentChannel())return!1;const n=function(e){l()(`#lpch_img_${e}`).unbind(),l()(`#lpch_img_${e}`).on("error",(function(){let e=l()(this).attr("channel");const t=window._channel.getChannel(e).avatar_id||"",n=e;return"c"===l()(this).attr("imgType")?("-p"===e.slice(-2)&&(e=e.slice(0,-2)),l()(`#lpch_${n}`).attr("imgsrc",`${window.files_base_url}avatars/user/${e}/thumb.jpeg?${t}`),l()(this).attr("src",`${window.files_base_url}avatars/user/${e}/thumb.jpeg?${t}`),l()(this).attr("imgType","u"),window._channel.modifyChannel(n,"imgType","u"),!1):"u"===l()(this).attr("imgType")&&(l()(this).attr("src",`${window.assets}/common/img/avatarChannel.png`),l()(this).attr("imgType","d"),window._channel.modifyChannel(n,"imgType","d"),!1)}))};return l()("#lpcht").html(""),l()("#channelList").html(""),l()("#lpchu").html(""),null===window._engine.currentChannel()&&l()("#rpchn").hide(),e.forEach((function(e){const i=(new Date).getTime(),s={};if(null===localStorage.getItem(`channel_${e.name}`))s.todayMsgCredit=p.MSG_PER_DAY,s.msg_per_day=p.MSG_PER_DAY,s.msgTs=i,s.enable_csm=e.enable_csm,s.enable_metaverse=e.enable_metaverse,localStorage.setItem(`channel_${e.name}`,JSON.stringify(s));else try{const t=JSON.parse(localStorage.getItem(`channel_${e.name}`));i-t.msgTs>864e5?(s.todayMsgCredit=p.MSG_PER_DAY,s.msg_per_day=p.MSG_PER_DAY,s.msgTs=i):(s.todayMsgCredit=t.todayMsgCredit,s.msg_per_day=p.MSG_PER_DAY,s.msgTs=t.msgTs),s.enable_csm=t.enable_csm,s.enable_metaverse=t.enable_metaverse,localStorage.setItem(`channel_${e.name}`,JSON.stringify(s))}catch(t){s.todayMsgCredit=window.msg_per_day,s.msg_per_day=window.msg_per_day,s.msgTs=i,localStorage.setItem(`channel_${e.name}`,JSON.stringify(s))}let o,r="",a=e.name;"-p"===a.slice(-2)&&(a=a.slice(0,-2)),window._channel.setChannel(e.name,{channel:e.name,name:e.topic,followers:e.followers,audience:e.audience,category:e.category,avatar_id:e.avatar_id,featured_id:e.featured_id,imgType:"c",enable_csm:e.enable_csm,enable_metaverse:e.enable_metaverse}),"c"===window._channel.getChannel(e.name).imgType?o=`${window.files_base_url}avatars/channel/${e.name}/thumb.jpeg?${e.avatar_id}`:"u"===window._channel.getChannel(e.name).imgType?o=`${window.files_base_url}avatars/user/${a}/thumb.jpeg?${e.avatar_id}`:"d"===window._channel.getChannel(e.name).imgType&&(o=`${window.assets}/common/img/avatarChannel.png`),e.topic||(e.topic=e.name),void 0!==e.featured_id&&"activity"!==t?(r+='<div class="sha bgw" style="width:47%;margin-left:1.7%;margin-bottom:1.7%;">',r+=`<div class="w100"><img src="${window.files_base_url}featured/channel/${e.name}/full.jpeg?${e.featured_id}" class="lpch_${e.name} chn pt w100" channel="${e.name}" name="${e.topic}" users="${e.followers}" imgsrc="${o}" /></div>`,r+=`<div id="lpch_${e.name}" class="lpch_${e.name} chn fr w100 p10 pt" channel="${e.name}" name="${e.topic}" users="${e.followers}" imgsrc="${o}">`,r+=`<img id="lpch_img_${e.name}" src="${o}" class="cp lpchi" channel="${e.name}" imgType="${window._channel.getChannel(e.name).imgType}">`,r+=`<div class="fc fig pl10"><div class="fr w100"><span class="lpcn sn toj">${e.topic}</span><span class="fig"></span>`,0!==e.followers&&(r+=`<span class="lpchua"><span class="p0 pr5 sn tb material-icons">&#xE838;</span><span class="vat sxs tg lpchu">${M(e.followers)}</span></span>`),r+="</div>",r+=`<div class="fr w100"><span class="lpcto ss">#${a}</span><span class="fig"></span></div>`,r+="</div>",l()("#channelList").append(r),l()("#channelList").show(),n(e.name)):0===l()(`#lpch_${e.name}`).length&&(r+='<div class="sha bgw" style="width:47%;margin-left:1.7%;margin-bottom:1.7%;">',r+=`<div id="lpch_${e.name}" class="lpch_${e.name} chn fr w100 p10 pt" channel="${e.name}" name="${e.topic}" users="${e.followers}" imgsrc="${o}">`,r+=`<img id="lpch_img_${e.name}" src="${o}" class="cp lpchi" channel="${e.name}" imgType="${window._channel.getChannel(e.name).imgType}">`,r+=`<div class="fc fig pl10"><div class="fr w100"><span class="lpcn sn toj">${e.topic}</span><span class="fig"></span>`,0!==e.followers&&(r+=`<span class="lpchua"><span class="p0 pr5 sn tb material-icons">&#xE838;</span><span class="vat sxs tg lpchu">${M(e.followers)}</span></span>`),r+="</div>",r+=`<div class="fr w100"><span class="lpcto ss">#${a}</span><span class="fig"></span></div>`,r+="</div>",l()("#channelList").append(r),l()("#channelList").show(),n(e.name))})),!1})),window._channel.callbacks().roomsListCB((function(e){E(`Rooms list callback: ${JSON.stringify(e)}`);const t=document.createElement("div");t.setAttribute("id","listRoomsBtn"),t.style.cursor="pointer",t.style.display="flex",t.style.justifyContent="space-evenly",t.style.alignItems="center",t.style.margin="0 auto",t.style.backgroundColor="#1A3975",t.style.minWidth="250px",t.style.height="56px",t.style.borderRadius="10px",t.style.padding="16px 24px";const n=document.createElement("div");n.innerHTML='\n        <svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <mask id="mask0_1337_336" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="25" height="24">\n                <rect x="0.5" width="24" height="24" fill="#D9D9D9"/>\n            </mask>\n            <g mask="url(#mask0_1337_336)">\n                <path d="M12.5 20C10.2667 20 8.375 19.225 6.825 17.675C5.275 16.125 4.5 14.2333 4.5 12C4.5 9.76667 5.275 7.875 6.825 6.325C8.375 4.775 10.2667 4 12.5 4C13.65 4 14.75 4.2375 15.8 4.7125C16.85 5.1875 17.75 5.86667 18.5 6.75V5C18.5 4.71667 18.5958 4.47917 18.7875 4.2875C18.9792 4.09583 19.2167 4 19.5 4C19.7833 4 20.0208 4.09583 20.2125 4.2875C20.4042 4.47917 20.5 4.71667 20.5 5V10C20.5 10.2833 20.4042 10.5208 20.2125 10.7125C20.0208 10.9042 19.7833 11 19.5 11H14.5C14.2167 11 13.9792 10.9042 13.7875 10.7125C13.5958 10.5208 13.5 10.2833 13.5 10C13.5 9.71667 13.5958 9.47917 13.7875 9.2875C13.9792 9.09583 14.2167 9 14.5 9H17.7C17.1667 8.06667 16.4375 7.33333 15.5125 6.8C14.5875 6.26667 13.5833 6 12.5 6C10.8333 6 9.41667 6.58333 8.25 7.75C7.08333 8.91667 6.5 10.3333 6.5 12C6.5 13.6667 7.08333 15.0833 8.25 16.25C9.41667 17.4167 10.8333 18 12.5 18C13.6333 18 14.6708 17.7125 15.6125 17.1375C16.5542 16.5625 17.2833 15.7917 17.8 14.825C17.9333 14.5917 18.1208 14.4292 18.3625 14.3375C18.6042 14.2458 18.85 14.2417 19.1 14.325C19.3667 14.4083 19.5583 14.5833 19.675 14.85C19.7917 15.1167 19.7833 15.3667 19.65 15.6C18.9667 16.9333 17.9917 18 16.725 18.8C15.4583 19.6 14.05 20 12.5 20Z" fill="#FEFEFE"/>\n            </g>\n        </svg>',n.addEventListener("click",(function(e){e.stopPropagation()}));const i=document.createElement("span");if(i.setAttribute("id","contentListRoomsBtn"),i.style.color="#fff",i.style.fontWeight="600",i.style.letterSpacing="0.5px",i.style.fontFamily="roboto, Sans-serif",i.style.fontSize="16px",e.rooms.length>0?(t.style.position="absolute",t.style.bottom="25px",t.style.right="20px",t.appendChild(n),i.textContent=window.i18n.get("update-room-list")):(t.style.marginTop="15px",i.textContent=window.i18n.get("find-rooms")),t.appendChild(i),t.addEventListener("click",(function(){!1!==p.permissionUpdateRoom&&(localStorage.removeItem("roomsList"),window.Events.dispatch("main/rooms-icon-click"),p.permissionUpdateRoom=!1,setTimeout((()=>{p.permissionUpdateRoom=!0}),6e4))})),!e){const e=`\n            <div class="frm" style="height:100%;width:100%;align-content:center;text-align:center;flex-wrap:wrap">\n                <div class="b sl toj" style="margin-left:auto;margin-right:auto;">\n                    <svg width="139" height="100" viewBox="0 0 139 100" fill="none" xmlns="http://www.w3.org/2000/svg">\n                        <path d="M5.33337 66.0417C5.33337 69.8336 6.08025 73.5884 7.53135 77.0917C8.98246 80.595 11.1094 83.7781 13.7907 86.4594C19.2058 91.8745 26.5502 94.9167 34.2084 94.9167H111.208C116.893 94.927 122.371 92.7809 126.535 88.9113C130.7 85.0418 133.242 79.7369 133.65 74.0665C134.057 68.3962 132.298 62.7824 128.729 58.3577C125.159 53.933 120.045 51.0265 114.417 50.2246C114.479 39.3084 110.564 28.7429 103.404 20.5032C96.2429 12.2636 86.3265 6.9137 75.5081 5.45369C64.6898 3.99369 53.7099 6.52348 44.6211 12.5702C35.5323 18.6169 28.9567 27.7665 26.1234 38.3089C20.1246 40.0607 14.8556 43.7106 11.1071 48.7109C7.35858 53.7113 5.33268 59.7924 5.33337 66.0417Z" stroke="#BEC3C7" stroke-width="9.625" stroke-linejoin="round"/>\n                        <path d="M69.5 72.4584H69.5642V72.5225H69.5V72.4584Z" stroke="#BEC3C7" stroke-width="14.4375" stroke-linejoin="round"/>\n                        <path d="M69.5 50V30.75" stroke="#BEC3C7" stroke-width="9.625" stroke-linecap="round" stroke-linejoin="round"/>\n                    </svg>\n                    <div>${window.i18n.get("error-getting-rooms")}<div />\n                </div>\n            </div>`;return l()("#roomListFilterArea").hide(),l()("#roomListArea").html(e),t.style.position="relative",t.style.bottom="0",t.style.right="0",t.style.marginTop="15px",t.removeChild(n),l()("#roomListArea > :first-child").css("flex-direction","column"),i.textContent=window.i18n.get("update-room-list"),i.textContent=window.i18n.get("find-rooms"),l()("#roomListArea > :first-child").append(t),!1}if((0===e.rooms.length||p.ROOMS_CATEGORIES_FILTER.length<1)&&l()("#roomListFilterArea").hide(),0===e.rooms.length){const e=`\n                <div class="frm" style="height:100%;width:100%;flex-direction:column;">\n                    <div class="b sl toj" style="margin-left:auto;margin-right:auto;text-align:center;">\n                        <svg width="133" height="111" viewBox="0 0 133 111" fill="none" xmlns="http://www.w3.org/2000/svg">\n                            <path d="M66.4282 0.740095C30.0312 0.740095 0.520996 20.3607 0.520996 44.5627C0.520996 58.4083 10.2086 70.7427 25.2909 78.77C23.1446 85.8925 18.8614 93.7705 10.5839 100.744C10.5839 100.744 29.9109 99.4637 43.5592 85.6182C44.3436 85.8107 45.1569 85.955 45.951 86.1283C45.1775 83.8941 44.7759 81.5481 44.7623 79.1838C44.7623 62.855 62.9343 50.0682 86.1498 50.0682C102.815 50.0682 116.844 56.6902 123.447 66.4596C129.068 60.0108 132.335 52.537 132.335 44.5483C132.335 20.351 102.825 0.730469 66.4282 0.730469V0.740095ZM122.71 79.1935C122.71 65.7666 106.348 54.8759 86.1354 54.8759C65.9469 54.8759 49.57 65.7714 49.57 79.1983C49.57 92.6252 65.9469 103.516 86.145 103.516C90.611 103.516 94.8701 102.958 98.8307 101.976C106.401 109.666 117.118 110.374 117.118 110.374C112.532 106.504 110.159 102.13 108.966 98.1788C117.33 93.7272 122.71 86.879 122.71 79.1935Z" fill="#BEC3C7"/>\n                        </svg>\n                    <br />\n                    ${window.i18n.get("your-rooms-will-be-here")}\n                    </div>\n                </div>`;return l()("#roomListArea").html(e),l()("#roomListArea > :first-child").append(t),!1}if(!l()("#chng").hasClass("lpis")&&!l()("#channelAdmGroup").hasClass("ic_group_ON")&&!window.guest&&l()("#chng").is(":visible"))return!1;const s=e.rooms;window.roomsServers=[],e.config||(e.config={attachment_disabled:!1,msg_delay:60,msg_per_day:-1,todayMsgCredit:-1,txCredit:-1,tx_duration:-1,tx_interval:4}),window.roomsConfig=e.config;for(let t=0;t<e.server.length;t+=1){const n=e.server[t].split(":"),i=n[0],s=parseInt(n[1]),o=n[2]?parseInt(n[2]):s;for(let e=s;e<=o;e+=1)window.roomsServers.push(`${i}:${e}`)}const o=p.ROOMS_CATEGORIES_FILTER||[];if(l()("#roomListFilterOptions").html(""),o){if(o.length>0){let e=`<div class="fc"><div class="p10"><input id="room-filter--1" class="room-filter pt" type="radio" value="-1" name="room-filter" ${"-1"!==p.ROOMS_SELECTED_FILTER&&p.ROOMS_SELECTED_FILTER?"":"checked"}><label for="room-filter--1" class="pl10 pt">${window.i18n.get("all")}</label></div>`;for(let t=0;t<o.length;t+=1){const n=`${o[t].id}`,i=o[t].name;e+=`<div class="p10"><input id="room-filter-${n}" class="room-filter pt" type="radio" value="${n}" name="room-filter" ${p.ROOMS_SELECTED_FILTER===n?"checked":""}><label for="room-filter-${n}" class="pl10 pt">${i}</label></div>`}e+="</div>",l()("#roomListFilterOptions").append(e),l()("#roomListFilterArea").show()}}else l()("#roomListFilterArea").hide();if(null===window._engine.currentChannel()){l()("#roomList").show(),l()("#roomListArea").html(""),l()("#rpchngrouplist").html(`<div class="choose-the-chat-you-want-to-access bglg p10" style="width:100%;border-bottom: 1px solid #F0F0F0;"><div class="p5 sl">${window.i18n.get("choose-the-chat-you-want-to-access")}</div></div>`),window.csm={};for(let t=0;t<s.length;t+=1){const n=s[t].category,i=s[t].rooms;let o="";-1===n.id&&(n.name=window.i18n.get("room-no-category")),p.ROOMS_CATEGORIES_LIST&&0!==p.ROOMS_CATEGORIES_LIST.length&&(o=`<div class="fic p0" style="width:70%;margin-left:1.7%;margin-top:1.7%;"><div class="pl10 ss tw" style="background:#979797;width:50%;">${n.name}</div></div>`);for(let t=0;t<i.length;t+=1){const n=i[t].name,s=i[t].topic.replace('"',""),r=i[t].enable_csm,a=i[t].enable_metaverse,c=window.config.roomIcon;o+='<div class="sha bgw fic" style="width:70%;margin-left:1.7%;margin-bottom:1.2%;">',o+=`<div id="lproom_${n}" class="lproom_${n} frm w100 p10 pt " room="${n}" name="${s}" imgSrc="${c}">`,o+=`<div><img id="lproom_img_${n}" src="${c}" class="cp lpchi room" room="${n}" name="${s}"></div>`,o+=`<div class="fc fig pl5 fig "><div class="fr w100 room" room="${n}" name="${s}"><span class="lpcn sn toj fic">${s}</span><span class="fig"></span></div></div>`,p.TMS_SPA&&(o+=`<div class="material-icons room-list-menu-tasks tdg" room="${n}">assignment</div>`),p.CONFIG.showRoomDetailPage||(o+=`<div class="material-icons room-list-detail-menu tdg" room="${n}">more_vert</div>`),o+="</div></div>";const l=parseInt(window.time.now()),d=864e5,u=e.config;if(window.csm[n]=r,null===localStorage.getItem(`room_${n}`))u.todayMsgCredit=e.config.msg_per_day,u.msgTs=l,u.txCredit=e.config.tx_duration,u.txTs=l,u.enableCsm=r,u.enableMetaverse=a,localStorage.setItem(`room_${n}`,JSON.stringify(u));else try{const t=JSON.parse(localStorage.getItem(`room_${n}`));l-t.msgTs>d?(u.todayMsgCredit=e.config.msg_per_day,u.msgTs=l):(u.todayMsgCredit=t.todayMsgCredit,u.msgTs=t.msgTs),l-(t.txTs+d*t.tx_interval)>0?(u.txCredit=e.config.tx_duration,u.txTs=l):(u.txCredit=t.txCredit,u.txTs=t.txTs),u.enableCsm=r,u.enableMetaverse=a,localStorage.setItem(`room_${n}`,JSON.stringify(u))}catch(t){u.todayMsgCredit=e.config.msg_per_day,u.msgTs=l,u.txCredit=e.config.tx_duration,u.txTs=l,u.enableCsm=r,u.enableMetaverse=a,localStorage.setItem(`room_${n}`,JSON.stringify(u))}}if(0!==i.length)l()("#roomListArea").append(o);else if(1===s.length||-1===n.id){const e=`<div class="bgw fic p20 br frm" style="width:70%;margin-left:1.7%;margin-bottom:1.2%;"><div>${window.i18n.get("room-no-room")}</div></div>`;l()("#roomListArea").append(e)}}l()("#roomListArea").append(t)}else{l()("#rpchngrouplist").html(`<div class="choose-the-chat-you-want-to-access bglg p10" style="width:100%;border-bottom: 1px solid #F0F0F0;"><div class="p5 sl">${window.i18n.get("choose-the-chat-you-want-to-access")}</div></div>`);let e="";for(const t of Object.values(p.ROOM)){const n=t.name,i=t.topic;e+='<div class="bgw p10 fr" style="width:100%;border-bottom: 1px solid #F0F0F0;">',e+='<div class="ic_channel_chat_ON" style="margin-left:10px"></div>',e+=`<div id="grouproom_${n}" class="p5 toj grouproom_${n} grouproom pl10 pt5 pb5 pr5 pt" grouproom="${n}" grouptopic="${i}">${i}</div>`,e+="</div>"}l()("#rpchngrouplist").append(e)}})),window._channel.callbacks().sendMsgCB((function(e){const t=p.ENGINE_NICK.replace("-web","");window.session&&window.session.isStarted()&&(/^(image=|document=|audio=|video=).+/.test(e.text)?window.session.statistics(window.session_id).setUserAttachmentCounter(t):window.session.statistics(window.session_id).setUserMessageSendCounter(t));const n=D(parseInt((new Date).getTime()/1e3)),i=l()("#hp__Channel__ > .msg").last().attr("date");let s=window._channel.getName();const o=p.ENGINE_NICK;let r;""===window._channel.getActiveRoom()?r=l()("#hp__Channel__"):(r=l()("#hp__Group__"),s=window._channel.getActiveRoom());const a=m[Math.abs(T(o))%m.length];let c="",d=o;(window._channel.getOperators().includes(o)||window._channel.getOperators().includes(o.replace("-web","")))&&1===window._channel.getType()&&(d=`<span class="material-icons tw sxs" style="background-color:#FF8A30;border-radius:50%;padding:2px;">star</span> ${o}`),i!==n&&(c+=`<div class="dayBanner frm ts ${window.i18n.get("today")}"><span class="msgd sxs pl10 pr10 pt5 pb5 tg">${window.i18n.get("today")}</span></div>`),c+=`<div id="${s}Msg${e.id}" class="${s}Msg${e.id} msg ${window.i18n.get("today")}" d="2" date="${window.i18n.get("today")}"><div class="msgLeft"><div class="tailLeft"></div><div id="msgId${e.id}"class="bor bubble bubbleLeft" style="max-width:100%">`,c+=`<div class="msgText" style="padding-right:0;padding-bottom:15px"><span class="${s}Msg${e.id} chnMsg chnu_op pt" style="color:${a};font-weight:bold;" from="${o}" seq="${e.id}" t="${o}" group="false">${d}</span> : ${A({text:e.text,type:6})}</div>`,c+='<div class="msgMeta"><span class="msgTime">';const u=new Date;let h=u.getMinutes();if(h<10&&(h=`0${h}`),c+=`${u.getHours()}:${h}`,c+="</span></div></div></div></div>",null!==s){if(r.append(c),window._recorderCtrl.isStarted()){let t=e.text;const n=/^document=/,i=/^video=/,s=/^audio=/;/^image=/.test(t)&&(t="[imagem]"),n.test(t)&&(t="[documento]"),i.test(t)&&(t="[video]"),s.test(t)&&(t="[audio]"),window._recorderCtrl.notifyChat({source:p.ENGINE_NICK,message:t})}setTimeout((function(){r.scrollTop(r[0].scrollHeight)}),100)}else E(`Not in channel. Impossible to send data: ${JSON.stringify(e)}`)})),window._channel.callbacks().delMsgCB((function(e){const t=e.channel;let n="";e.seqs.forEach((function(e){n=l()(`#${t}Msg${e}`).attr("date").replace(/\//g,""),l()(`#${t}Msg${e}`).remove(),1===l()(`.${n}`).length&&l()(`.${n}`).remove(),l()(`#undefinedMsg${e}`).remove()}))})),window._channel.callbacks().sendOpenGraphCB((function(e){const t=D(parseInt((new Date).getTime()/1e3)),n=l()("#hp__Channel__ > .msg").last().attr("date"),i=window._channel.getName(),s=p.ENGINE_NICK;let o;""===window._channel.getActiveRoom()?(o=l()("#hp__Channel__"),l()("#og___Channel__").hide()):(o=l()("#hp__Group__"),l()("#og___Group__").hide());const r=m[Math.abs(T(s))%m.length];let a="";const c=new Date;let d=c.getMinutes();d<10&&(d=`0${d}`),n!==t&&(a+=`<div class="dayBanner frm ts ${window.i18n.get("today")}"><span class="msgd sxs pl10 pr10 pt5 pb5 tg">${window.i18n.get("today")}</span></div>`),e.href?(a+=`<div id="${i}Msg${e.id}" class="${i}Msg${e.id} msg ${window.i18n.get("today")}" d="2" date="${window.i18n.get("today")}" seq="${e.id}"><div class="msgLeft"><div class="tailLeft"></div><div id="msgId${e.id}"class="bor bubble bubbleLeft" style="max-width:100%">`,a+=`<div class="msgText" style="padding-right:0;padding-bottom:15px"><span class="chnMsg chnu_op pt" style="color:${r};font-weight:bold;" from="${s}" seq="${e.id}">${s}</span> : `,e.image&&""!==e.image?a+=`<a href="${e.href}" target="_blank"><div style="color:#262626;background-color:#F9F9F9;min-height:120px;width:100%" class="fc p10 br"><div>${e.title}</div><div class="fr fig"><div class="fic"><img src="${e.image}" class="linkImg p5 br" style="max-width:105px;min-width:105px;width:100%;max-height:105px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;" onerror="loadDefaultOG(this);" /></div><div class="fig sxs" style="overflow:hidden;text-overflow:ellipsis;text-align:justify;">${e.description}</div></div><div class="sxs pt5 pb5 tb">${e.name}</div></div><span style="color:#262626;">${e.text}</span></a>`:a+=`<a href="${e.href}" target="_blank"><div style="color:#262626;background-color:#F9F9F9;min-height:120px;width:100%" class="fc p10 br"><div>${e.title}</div><div class="fr fig"><div class="fic"></div><div class="fig sxs" style="overflow:hidden;text-overflow:ellipsis;text-align:justify;">${e.description}</div></div><div class="sxs pt5 pb5 tb">${e.name}</div></div><span style="color:#262626;">${e.text}</span></a>`,a+='</div><div class="msgMeta"><span class="msgTime">',a+=`${c.getHours()}:${d}`,a+="</span></div></div></div></div>"):(a=`<div id="${e.target}Msg${e.id}" class="${i}Msg${e.id} msg" d="2" date="${window.i18n.get("today")}" seq="${e.id}"><div class="msgLeft"><div class="tailLeft"></div><div id="msgId${e.id}"class="bor bubble bubbleLeft" style="max-width:100%">`,a+=`<div class="msgText tr" style="padding-right:0;padding-bottom:15px">${A({text:e.text,type:6})}</div>`,a+='<div class="msgMeta"><span class="msgTime">',a+=`${c.getHours()}:${d}`,a+="</span></div>",a+="</div></div></div>"),null!==i?(o.append(a),setTimeout((function(){o.scrollTop(o[0].scrollHeight)}),100)):E(`Not in channel. Impossible to send data: ${JSON.stringify(e)}`)})),window._channel.callbacks().printMsgCB((function(e){const t=D(parseInt((new Date).getTime()/1e3)),n=l()("#hp__Channel__ > .msg").last().attr("date"),i=window._channel.getName(),s=window._groupEngine.currentChannel()||"";let o;o=""===window._channel.getActiveRoom()||i===e.to?l()("#hp__Channel__"):l()("#hp__Group__");const r=m[Math.abs(T(e.from))%m.length];let a="";if(e.to===i||e.to===s||e.from.toLowerCase()===window.acs_server||"paranawelcome1"===e.from.toLowerCase()){if(""===e.text)return!1;if(n!==t&&(a+=`<div class="dayBanner frm ts ${t.replace(/\//g,"")}"><span class="msgd sxs pl10 pr10 pt5 pb5 tg">${t}</span></div>`),a+=`<div id="${e.to}Msg${e.id}" class="msg ${t}" d="2" date="${t}"><div class="msgLeft"><div class="tailLeft"></div><div id="msgId${e.id}"class="bor bubble bubbleLeft" style="max-width:100%">`,"ACS"!==e.from&&"acs"!==e.from&&"System"!==e.from&&e.from!==window.acs_server){let t=e.from;if((window._channel.getOperators().includes(e.from)||window._channel.getOperators().includes(e.from.replace("-web","")))&&1===window._channel.getType()&&(t=`<span class="material-icons tw sxs" style="background-color:#FF8A30;border-radius:50%;padding:2px;">star</span> ${e.from}`),e.id>window._channel.getMsgSeq()&&window._channel.setMsgSeq(parseInt(e.id)),"Contact"===e.text.split("=")[0]||"contact"===e.text.split("=")[0]){const t=e.text.split("=")[1];a+=`<div class="msgText" style="padding-right:0;padding-bottom:15px"><span style="color:${r};font-weight:bold;" class="chnMsg pt" from="${e.from}" seq="${e.id}">${e.from}</span> : <br /> <div class="frm targetInfo pt" t="${t}" group="false"><div><img src="___${t}" class="fic cp" style="width:40px;height:40px;margin-right:10px;" style="width:0px;height:0px;" onerror=""><img src="${window.files_base_url}avatars/user/${t}/thumb.jpeg" class="cp rphi" onerror="loadDefaultAvatar(this);"></div><div class="p10"><div class="toj contactname_${t}"></div><div>${t}</div></div></div>`,a+='<div class="msgMeta"><span class="msgTime">'}else e.from===p.ENGINE_NICK?(a+=`<div class="msgText" style="padding-right:0;padding-bottom:15px"><span style="color:${r};font-weight:bold;" class="chnMsg" from="${e.from}" seq="${e.id}">${t}</span> : ${A({text:e.text,type:6})}</div>`,a+='<div class="msgMeta"><span class="msgTime">'):(a+=`<div class="msgText" style="padding-right:0;padding-bottom:15px"><span style="color:${r};font-weight:bold;" class="chnMsg chnUser chnu_op targetInfo pt" from="${e.from}" seq="${e.id}" t="${e.from}" group="false">${t}</span> : ${A({text:e.text,type:6})}</div>`,a+='<div class="msgMeta"><span class="msgTime">');const n=new Date;let i=n.getMinutes();i<10&&(i=`0${i}`),a+=`${n.getHours()}:${i}`,a+="</span></div>"}else{if(window.channelAcsMessages.includes(e.text))return!0;window.channelAcsMessages.push(e.text),a+=`<div class="msgText tr" style="padding-right:0;padding-bottom:15px">${A({text:e.text,type:6})}</div>`}a+="</div></div></div>",o.append(a)}else{if(p.GUEST)return!1;let t="";const n=(new Date).getTime(),i=P(n/1e3).split(",")[0];if(0===l()(`#chnprivc_${e.from}`).length){const t={};t.nick=e.from,t.name=e.from,t.avatar_id="",t.group=!1,l()(".chnprivchatsarea").show(),Yr(t)}else l()(".chnprivchatsarea").show(),l()("#chnprivchatslist").hide(),l()("#chnprivchatsarea > .fc").hide(),l()(`#chnprivc_${e.from}`).show();t=`<div id="s${n}" class="fr msg  Hoje" s="${n}" t="${e.from}" d="2" ts="${n/1e3}">`,t+='<div class="msgLeft fig"><div class="tailLeft "></div><div class="bor bubble bubbleLeft" style="max-width:100%">',t+=`<div class="msgText" style="max-width: 238px;padding-right:0;padding-bottom:15px">${e.text}</div>`,t+=`<div class="msgMeta"><span class="msgTime">${i}</span></div></div></div></div>`,setTimeout((function(){const n=l()(`#chnprivh_${e.from}`);l()(`#chnprivh_${e.from}`).append(t),setTimeout((function(){n.scrollTop()>n[0].scrollHeight-n.height()-300?n.scrollTop(n[0].scrollHeight):setTimeout((function(){n.scrollTop()>n[0].scrollHeight-n.height()-300&&n.scrollTop(n[0].scrollHeight)}),5e3)}),2e3)}),500)}return!1})),window._engine.callbacks().connectCB((function(){window.Events.dispatch("myheart/connect-cb");let e="";const t=window._engine.connectionStatus();t.connected||(e=`connecting ${t.reconnAttempts}/${t.reconnAttemptsMax} ...`),E(e)})),window._engine.callbacks().startedCB((function(e,t,n,i,s){E(`app -> startedCB: ${p.NICK} SIGNED IN : srvClientId:${e}, server:${t}, acsNick:${n}, ppcsNick:${i}, requesting channel list...`),window.Events.dispatch("myheart/started-cb"),window.irmServer=t,s&&window._engine.requestEnterChannel(s,""),window.channelEnter=""})),window._engine.callbacks().startFailedCB((function(e){if(E(`app -> startFailedCB: ${p.NICK} could not login. Reason: ${e}`),p.IFRAME)return!1;""!==window._channel.getName()&&Jr("startFailedCB"),window._engine.stop(),window._channelCtrl.reset(),window._app.logout()})),window._engine.callbacks().connClosedCB((function(){return E("app -> connClosedCB: return value: false. Trying to reconnect!"),l()("#session-recording").hide(),window._recorderCtrl.isStarted()&&window._recorderCtrl.stopRecord(!0),window.countdown&&window.countdown.stop(),window.softCountdown&&window.softCountdown.stop(),window.session&&window.session.reset(),Jr("connClosedCB"),l()("#chng").hasClass("lpis")?l()("#chng").click():l()("#chni").hasClass("lpis")&&l()("#chni").click(),l()("#modalDialog").is(":visible")||(l()(".dialog").hide(),l()("#dbcfb-lbl").html(window.i18n.get("error-connection-lost")),l()("#db-connection-failure").show(),l()("#dialog").show()),window._engine.stop(),window._channelCtrl.reset(),!1})),window._engine.callbacks().channelChatMuteListCB((function(e,t){l()("#channelAdmUserList").removeClass("tb"),l()("#channelAdmChat").removeClass("tb"),l()("#hp__Channel__").hide(),l()("#rpchnusermutelist").html(""),l()("#rpchnuserlist").hide();let n="";window.lChannelMutedUsers={},window.aChannelMutedUsers=[],t.forEach((function(e){window.lChannelMutedUsers[e]={},window.aChannelMutedUsers.push(e)})),window.aChannelMutedUsers.sort((function(e,t){return e<t?-1:e>t?1:0})),l()("#rpchnusermutelist").show(),setTimeout((function(){return 0===window.aChannelMutedUsers.length?(l()("#rpchnusermutelist").append(`<div class="chnmu fr w100 pl10 pt10 pr10 nopt sl b toj">${window.i18n.get("no-silenced-users")}</div>`),!1):(l()("#rpchnusermutelist").append(`<div class="chnmu fr w100 pl10 pt10 pr10 nopt sl b toj">${window.i18n.get("silenced-users")}</div>`),window.aChannelMutedUsers.forEach((function(e){const t="-web"===e.slice(-4)?e.substr(0,e.length-4):e;0===l()(`#lpchmu_${t}`).length&&(n=`<div id="lpchmu_${t}" class="chnmu fr w100 pl10 pt10 pr10 nopt">`,n+=`<img src="${window.files_base_url}avatars/user/${t}/thumb.jpeg" class="cp lpci" onerror="loadDefaultAvatar(this);">`,n+=`<span id="lpchu_${t}_key" class="material-icons toj sl vat"></span>`,n+=`<div class="fc fic fig pl5"><div class="fr w100"><span class="sn n toj">${t}</span><span class="fig"></span>`,n+="</div><div>&nbsp;</div>",n+='<div class="li w100"></div></div>',n+=`<div class="fc fic"><span class="material-icons chnmu_del" nick="${t}">&#xE5CD;</span></div>`,l()("#rpchnusermutelist").append(n))})),!1)}),500)})),window._engine.callbacks().channelChatMuteSetCB((function(e,t,n){E(`Channel: ${JSON.stringify(e)}`),E(`Mutted: ${JSON.stringify(t)}`),E(`Users: ${JSON.stringify(n)}`)})),window._engine.callbacks().channelBanListCB((function(e,t){l()("#channelAdmUserList").removeClass("tb"),l()("#hp__Channel__").hide(),l()("#rpchnuserbanlist").html(""),l()("#rpchnuserlist").hide();let n="";window.lChannelBannedUsers={},window.aChannelBannedUsers=[],t.forEach((function(e){window.lChannelBannedUsers[e.replace("!*@*","")]={},window.aChannelBannedUsers.push(e.replace("!*@*",""))})),window.aChannelBannedUsers.sort((function(e,t){return e<t?-1:e>t?1:0})),l()("#rpchnuserbanlist").show(),setTimeout((function(){return 0===window.aChannelBannedUsers.length?(l()("#rpchnuserbanlist").append(`<div class="chnmu fr w100 pl10 pt10 pr10 nopt sl b toj">${window.i18n.get("no-banned-users")}</div>`),!1):(l()("#rpchnuserbanlist").append(`<div class="chnbu fr w100 pl10 pt10 pr10 nopt sl b toj">${window.i18n.get("banned-users")}</div>`),window.aChannelBannedUsers.forEach((function(e){const t="-web"===e.slice(-4)?e.substr(0,e.length-4):e;0===l()(`#lpchbu_${t}`).length&&(n=`<div id="lpchbu_${t}" class="chnbu fr w100 pl10 pt10 pr10 nopt">`,n+=`<img src="${window.files_base_url}avatars/user/${t}/thumb.jpeg" class="cp lpci" onerror="loadDefaultAvatar(this);">`,n+=`<span id="lpchbu_${t}_key" class="material-icons toj sl vat"></span>`,n+=`<div class="fc fic fig pl5"><div class="fr w100"><span class="sn n toj">${t}</span><span class="fig"></span>`,n+="</div><div>&nbsp;</div>",n+='<div class="li w100"></div></div>',n+=`<div class="fc fic"><span class="material-icons chnbu_del" nick="${t}">&#xE5CD;</span></div>`,l()("#rpchnuserbanlist").append(n))})),!1)}),500)})),window._engine.callbacks().publishResponseCB((function(e,t){E(`app -> publishResponseCB: videoEnabled:${e}, timeout:${t}`),window._channelCtrl.setPublishResponse(e,t)})),window._engine.callbacks().screenSharingReadyCB((function(){return E("app -> screenSharingReadyCB"),window._channelCtrl.screenSharingReady()})),window._engine.callbacks().screenSharingPublishedCB((function(){E("app -> screenSharingPublishedCB"),window._channelCtrl.screenSharingPublished()})),window._engine.callbacks().screenSharingUnpublishedCB((function(){E("app -> screenSharingUnpublishedCB"),window._channelCtrl.screenSharingUnpublished()})),window._engine.callbacks().enterChannelCB((async function(e,t){if(E(`app -> enterChannelCB: Entered channel ${e} (code: ${t})`),"m"===window._channel.getSuffix()&&(window.allowDialogReminder=!0),window.Events.dispatch("breakout-rooms/options-btn-show",e),window._channel.unsetScreen(),l()("#record-option-stop").hide(),l()("#record-option-start").show(),l()("#record-option-icon").css("color",""),p.CONFIG.banubaEffect?l()("#banuba-area").show():l()("#banuba-area").hide(),l()("#user-media-cc").hide(),l()("#roomList").hide(),l()("#roomDetailArea").hide(),hp(),pp(),window.muteFlag=!1,window._engine.setBitrateScreen(1e3*window.screenBitrate),window.session&&window.session.startNeeded(!1),l()("#session-email").hide(),l()("#rpchnmetaverselist").hide(),l()(".channelCsmVideosIcon").hide(),window.enableCsm&&(1===window._channel.getType()&&p.CSM_SPA?l()(".channelCsmVideosIcon").show():l()(".channelCsmVideosIcon").hide()),0===window._channel.getType()){const d=window._channel.getName(),u=window._channel.getChannel(d)?.enable_csm;u&&p.CSM_SPA&&l()(".channelCsmVideosIcon").show()}function n(e){var t=document.querySelectorAll(".rd"),n=(document.getElementById("channel_rp").offsetWidth,document.getElementById("channelAdmUserListCount"));n.style.fontSize="60%",n.style.bottom="-20%",n.style.left="100%";var i=e*=100/(.7*t.length)/100;t.forEach((function(e){e.style.fontSize=i>28?28:i,e.style.width=i>28?28:i,e.style.height=i>28?28:i}));var s=document.querySelectorAll(".emoticonMenu"),o=e*=90/(s.length+1)/10;s.forEach((function(e){e.style.fontSize=o>28?28:o}))}window.feed_spa&&1===window._channel.getType()?l()(".channelFeedIcon").show():l()(".channelFeedIcon").hide(),window.config.showChannelMoreSettings?l()("#rpchnad").show():l()("#rpchnad").hide(),window.config.showRoomTutorial&&window.config.roomTutorial.length>0&&1===window._channel.getType()?l()("#rpchntut").show():l()("#rpchntut").hide(),"watch"!==window.clientType&&window.analytics?.getServerFacts().channel_joined&&(window.analytics.setFactDimension("channel_joined","channel",e),window.analytics.startFact("channel_joined")),window._channel.setJustEntered(!0),window.channelEnter="",p.IFRAME||0===window._channel.getType()&&l()("#channel_rp").css("min-width",""),k("auto"),l()(document).ready((function(){var e=l()("#channel_rp");e.length>0&&n(e.width())}));var i=document.getElementById("channel_mp"),s=document.getElementById("channel_mp_handle"),o=document.getElementById("channel_lp");i.addEventListener("mouseover",(()=>s.style.backgroundColor="#43C9FF")),i.addEventListener("mouseleave",(()=>s.style.backgroundColor="transparent")),i.addEventListener("mousedown",(function(e){var t=o.offsetWidth,i=e.clientX;function s(e){var s=t+(e.clientX-i),r=document.getElementById("channel_rp").offsetWidth;s>0&&(o.style.width=s+"px",n(r))}document.addEventListener("mousemove",s),document.addEventListener("mouseup",(function(){document.removeEventListener("mousemove",s)}))}));const r=window._channel.getImgSource();window._channel.setUsername(p.ENGINE_NICK),window._channel.setJustEntered(!0),window.config.showGroupsIcon&&0===window._channel.getType()&&!window.config.hideChannelGroupsIcon?(window._channel.getRoomsList(),l()(".channelAdmGroup").show()):l()(".channelAdmGroup").hide(),""!==p.TMS_SPA&&1===window._channel.getType()?l()(".channelTaskList").show():l()(".channelTaskList").hide(),window._channel.setActiveRoom(""),!0===window.config.showChannelFavoriteIcon&&(l()("#rpchnui").show(),l()("#rpchnu").show()),l()(".channelAdmUserList").show(),l()("#channelAdmUserListCount").html(""),l()("#channelNoMoreMsg").hide(),l()("#boxesArea").show(),l()("#rpchnconfshow").hide(),l()("#rpchnconfhide").hide(),l()("#rpchngrouplist").hide(),l()("#rpchnuserlist").hide(),l()("#rpchnmodlist").hide(),l()("#rpchnusermutelist").hide(),l()("#rpchnuserbanlist").hide(),l()("#channelModList").removeClass("tb"),l()(".rpmap").hide(),l()("#chatArea").hide(),l()("#channelArea").show(),l()("#top_menu").hide(),l()("#chnCategoriesMenu").hide(),l()("#channelBody").show(),l()(".rpme").removeClass("toj"),l()("#rpEmoticon").hide(),""!==r&&l()("#rpchni").attr("src",r),l()("#rpchntx").val(""),l()("#channelList").html(""),l()("#roomListArea").html(""),l()("#lpchm").hide();let a=e;"-p"===a.slice(-2)&&(a=a.slice(0,-2)),l()("#rpchntx").on("input",(function(){let e=l()(this).val();if(e.length>Hr.MAX_MESSAGE_SIZE){l()(this).val(e.substring(0,Hr.MAX_MESSAGE_SIZE));const t='<div class="limite-message" style="background: #FEFEFE; border-radius: 8px; border: solid #80808000 1px; position: absolute; width: 68%; display: flex; padding: 1%; box-shadow: 0 0 10px rgb(0 0 0 / 30%); transform: translate(24%, -50%); align-items: center; justify-content: space-around;"><div><span class="material-icons" style="color:#E25F00;">&#xe88f;</span></div><div><span style="color:#192229;">Limite mÃ¡ximo de caracteres atingido!</span></div>';l()(".limite-message")&&l()("#rpchntx").after(t),setTimeout((function(){l()(".limite-message").remove()}),3e3)}})),window.lChannelVoices={},l()("#featuredImg").hide(),l()("#featuredImg img").attr("src","");const c=await window._channel.getChannelData(e);if("close"===window.Invite.data.type){async function h(e){try{const t=`${p.API_SERVER}/mas/channel/${e}/member/verify`,n=await fetch(t,{method:"GET",headers:{"x-api-key":window.auth_token}});if(!n.ok)throw new Error(`status: ${n.status}`);!1===(await n.json()).is_member&&window.Events.dispatch("channel/close")}catch(e){console.error("Error verifying member:",e),window.Events.dispatch("channel/close")}}h(window.Invite.data.channel)}if(c){if(c.featured){window._channel.setFeatured(!0);const m=c.featured_image;let w;m&&(w=m.name),w&&(window._channel.setFeaturedImg(`${window.files_base_url}featured/channel/${e}/full.jpeg`),l()("#featuredImg img").attr("src",window._channel.getFeaturedImg()),window.metaverse.started||l()("#featuredImg").show())}else window._channel.setFeatured(!1),l()("#featuredImg").hide();c.topic?window._channel.setTopic(c.topic):window._channel.setTopic(c.name)}if(window.config.messenger||(l()(".dbuserinfo_buttons").hide(),l()(".dbuserinfo_sendmsg").show(),l()(".rpmaic").hide()),l()("#channelList").hide(),p.IFRAME?(l()("#channel_lp").css("width","100%"),l()("#channel_rp").hide(),l()("#channel_mp").hide(),l()("#channel_lp").css("max-width",""),l()(".chnmax").hide()):l()("#channel_rp").show(),l()("#hp__Channel__").show(),l()("#rpchnbox").removeClass("pt"),l()("#rpchn").show(),l()(".rpchnh").show(),l()(".rpchnhcount").html(""),l()("#rpchnconf").hide(),l()(".channelAdmChat").show(),l()("#channelAdmChat").addClass("ic_channel_chat_ON"),!window.config.allowPrivMessage||1!==window._channel.getType()&&""===window._channel.getActiveRoom()?l()(".channelModList").hide():l()(".channelModList").show(),l()("#channelAdmUserList").removeClass("tb"),l()("#channelAdmShareScreen").hide(),l()("#control-screensharing-area").hide(),setTimeout((function(){window._channel.getModes().m&&(l()("#rpchnmoderateicon").html("voice_over_off"),l()("#rpchnmoderatelabel").html(window.i18n.get("unblock-chat")))}),1e3),l()("#rpchnusermutelist").html(""),l()("#rpchnuserbanlist").html(""),l()("#chnprivchatsarea").html(""),l()(".chnprivchatsarea").hide(),l()(".chb").remove(),l()(".us").removeClass("uss"),0===t||100===t){!0===window.callStarted&&setTimeout((function(){window._engine.publish()}),5e3),l()("#channelShareScreenIcon").removeClass("tb"),l()("#rpchnbox").hide(),l()("#rpchnboxtext").html(""),l()("#lpchu").html(""),window.lChannelUsers={},window.aChannelUsers=[],window.lChannelOperators={},window.aChannelOperators=[],zd().getOldMessages(e,0),l()("#fit").val(""),l()("#lpfr").html(""),l()("#lpchb").show(),window._engine.requestChannelInfo(e),p.GUEST?l()(".rpmat").hide():l()(".rpmat").show();let g=e,f=window._channel.getTopic();"-p"===g.slice(-2)&&(g=g.slice(0,-2)),"-p"===f.slice(-2)&&(f=f.slice(0,-2)),"-c"===g.slice(-2)?(window.callTime=(new Date).getTime(),window._engine.requestTransmission(window.engineNick,!0,!0),setTimeout((function(){window._captureCtrl.start()}),2e3),l()(".chnu_m").addClass("tb"),l()("#rpchnui").hide(),l()("#rpchnu").hide()):window.config.showChannelFavoriteIcon&&(l()("#rpchnui").show(),l()("#rpchnu").show()),l()("#lpcb").hide(),l()("#rpchn").show();let v=70;l()("#rpchntx").on("input",(function(){v=this.scrollHeight+37,l()("#scrolldownChat").css("bottom",v)})),l()("#hp__Channel__").html(`<div id="scrolldownChat" class="scrolldown" target="__Channel__" style="display:none;position:absolute;bottom:${v}px;right:10px;z-index:9"><span class="material-icons p5 tg bor brr bgw sha">&#xE313;</span></div></div>`),l()("#rpchnc").html(window._channel.getTopic()),0===window._channel.getType()?l()("#rpchnn").html(window._channel.getName()):l()("#rpchnn").html(""),l()("#rpchnui").attr("nick",window._channel.getName()),window.lPeople[g]?l()("#rpchnui").addClass("tb"):l()("#rpchnui").removeClass("tb"),window.lChannel[e]&&(l()("#rpchnu").html(M(window.lChannel[e].users)),l()(`#lpcht_${e} lpchu`).html(window.lChannel[e].users)),l()("#hp__Channel__").attr("channel",e),l()("#rpchnmap").attr("t",e),l()("#rpchntx").attr("t",e),l()(".chnu").removeClass("bgg"),l()("#rpchnto").hide(),l()("#rpchntx").attr("t",e),l()("#rpchnhi").removeClass("tb"),l()("#rpchnhi").removeClass("ic_collaborate_ON"),l()("#channelChatHide").show(),l()("#channelChatShow").hide(),p.IFRAME?(l()("#channel_rp").hide(),l()("#channel_mp").hide(),l()("#channelBannerArea").hide(),l()("#channel_lp").css("width","100%")):(l()("#channel_rp").show(),l()("#channel_mp").show(),l()("#channelBannerArea").show(),l()("#channel_lp").css("width","70%")),""!==l()("#rpchnboxtext").html()&&"1"!==l()("#rpchnbox").attr("hide")||l()("#rpchnbox").hide(),window._channel.getChannelPermissions()}else E(`app -> enterChannelCB: Could not enter channel ${e} (code: ${t})`),l()("#channel_close").click(),l()(`.hash${e}`).removeClass("toj"),l()(`.hash${e}`).removeClass("pt"),"-p"===e.slice(-2)&&(l()(`.hash${e.slice(0,-2)}`).removeClass("toj"),l()(`.hash${e.slice(0,-2)}`).removeClass("pt"),l()(`.hash${e.slice(0,-2)}-`).removeClass("toj"),l()(`.hash${e.slice(0,-2)}-`).removeClass("pt"));if(l()("#rpchninvite").hide(),setTimeout((function(){if(p.PERMISSIONS.invite_invite_create&&window._channel.isOperator(p.ENGINE_NICK)&&1!==window._channel.getType()){if(2===window._channel.getType()&&!p.PERMISSIONS.invite_invite_create_ephemeral)return!1;l()("#rpchninvite").show()}}),3e3),"0"!==window.metaverseFixedId){E(`[METAVERSE FIXED] Id: ${window.metaverseFixedId}`);const b=window.metaverse.url;if(b){if(l()("#channel_rp").hide(),l()("#channel_mp").hide(),window.metaverse.setIdleTimeout((function(){window.Events.dispatch("metaverse/idle-timeout")}),p.METAVERSE_IDLE_TIMEOUT),"p"===window._channel.getSuffix()?l()("#rpchnhi").show():l()("#rpchnhi").hide(),l()("#featuredImg").hide(),l()("#medias").html(""),l()("#medias").hide(),l()("#metaverse-area").html(`<iframe src="${b}&flags=1&auth_token=${p.AUTH_TOKEN}&api_domain=${p.API_SERVER}&nick=${p.ENGINE_NICK.replace("-web","")}" class="w100 h100" allowvr="yes" allow="camera;microphone;display-capture;vr;speaker;"></iframe>`),l()("#rpchnyt").hide(),l()("#rpchnmetaverse").hide(),l()("#rpchnscreensaving").hide(),l()("#metaverse-area").show(),l()("#media-cc").hide(),window._recorderCtrl.isStarted()&&1!==window._channel.getType()&&l()("#record-option-stop").click(),window.metaverse.started=!0,window.metaverse.hideDevices(),l()(".channelAdmChat").hide(),l()(".channelCsmVideosIcon").hide(),0===window._channel.getType()){const _=window._channel.getName(),y=window._channel.getChannel(_)?.enable_csm;y&&p.CSM_SPA&&l()(".channelCsmVideosIcon").show()}l()(".channelAdmGroup").hide(),l()(".channelOtherIcon").hide(),l()("#channel_rp").hide(),l()("#channel_mp").hide(),l()("#channel_lp").css("max-width",""),l()("#channel_lp").css("width","100%"),l()("#channelChatHide").hide(),setTimeout((function(){window._channel.isOperator(window._engine.nick())?l()("#channel_invite_icon").show():l()("#channel_invite_icon").hide()}),3e3)}else console.log("[METAVERSE] Error getting fixed URL!")}else l()("#channel_invite_icon").hide();if(2===window._channel.getType())if("true"===p.GUEST);else{window.metaverse.channel=window._engine.currentChannel(),window.metaverse.channelType="room";const C=await window.metaverse.getActiveMetaverse();if(C.active){const S=C.metaverse.finish_at-parseInt(window.time.now());window.metaverse.url=C.metaverse.metaverse_room_url,window.Events.dispatch("metaverse/start-metaverse-view"),window.metaverse.setTimeout((()=>{window.Events.dispatch("metaverse/finish-metaverse-view")}),S)}}window.internetConnectionAlertShowed=!1,await async function(e){const t=e,n=window.breakoutRoom.getRoomType(t),i=l()("#rpchnpi"),s=l()("#rpchnp");if("nested"!==n)return i.show(),s.show(),!1;E(`[BreakoutRoom] bkrEnterChannelCB: ${t}`),i.hide(),s.hide();const o=l()(".channelTaskList"),r=l()(".channelCsmVideosIcon"),a=l()(".channelFeedIcon"),c=l()(".channelModList"),d=l()(".channelOtherIcon"),u=l()("#rpchnnotification"),h=l()("#rpchnmetaverse"),p=l()("#rpchn-silenced"),m=l()(".rpchnyt"),w=l()("#rpchn-banned"),g=l()("#rpchntut"),f=l()("#rpchn-MuteAll");o.hide(),o.removeClass("tb"),r.hide(),r.removeClass("tb"),a.hide(),a.removeClass("tb"),c.hide(),c.removeClass("tb"),d.hide(),u.hide(),u.removeClass("tb"),h.hide(),p.hide(),m.hide(),w.hide(),g.hide(),f.hide();const v=l()("#rpchntasklist"),b=l()("#rpchnfeedlist"),_=l()("#rpchnmodlist"),y=l()("#rpchncsmlist");return v.hide(),b.hide(),_.hide(),y.hide(),!0}(e),await async function(e){const t=e,n=window._channel.getType(t);E(`[sessionEnterChannelCB] Processing for channel "${t}" (${n})`);const i=window.breakoutRoom.getRoomType(t);return 1===n?window._channel.isOperator(window.engineNick.slice(0,-4))||window._channel.isOperator(window.engineNick)?(window._engine.requestSetChannelMode(window._channel.getName(),"+o",window.engineNick),window.enableCsm&&window.permissions.csm_session_create&&window.permissions.csm_session_edit?setTimeout((()=>{const e=(new Date).getTime(),t=window._channel.getCsmObject();if(t.session_id){const n=new Date(t.finish_at).getTime(),s=t.owner;n>e&&p.NICK!==s&&("nested"!==i&&"p"!==window._channel.getSuffix()?l()("#chn-session-is-active-btn").show():l()("#chn-session-is-active-btn").hide(),l()("#chn-session-start-btn").hide(),"meeting"!==i&&"nested"!==i&&l()("#rpchnhi").show())}else window.metaverse.started||window.Events.dispatch("session/show-session-start-btn"),"p"===window._channel.getSuffix()?l()("#rpchnhi").show():l()("#rpchnhi").hide()}),3e3):(l()("#chn-session-start-btn").hide(),"meeting"!==i&&"nested"!==i&&l()("#rpchnhi").show())):"meeting"!==i&&"nested"!==i&&l()("#rpchnhi").show():(l()("#chn-session-start-btn").hide(),"meeting"!==i&&"nested"!==i&&l()("#rpchnhi").show()),"0"!==window.metaverseFixedId&&l()("#chn-session-start-btn").hide(),!1}(e),"p"===window._channel.getSuffix()&&l()("#rpchnhi").show()})),window._groupEngine.callbacks().enterChannelCB((function(e,t){E(`app -> enterChannelCB: Entered channel ${e} (code: ${t})`),k("auto"),window.muteFlag=!1,window.analytics?.getServerFacts().channel_joined&&(window.analytics.setFactDimension("channel_joined","channel",e),window.analytics.startFact("channel_joined")),window._channel.setJustEntered(!0),l()("#channelMsgAlert").hide(),""!==window._channel.getActiveRoom()&&l()("#channelInputArea").hide(),l()("#channelAdmUserListCount").html(""),l()("#channelNoMoreMsg").hide(),l()("#rpchnconfshow").hide(),l()("#rpchnconfhide").hide(),window._channel.setUsername(p.ENGINE_NICK),window._channel.setActiveRoom(e),zd().getOldGroupMessages(e,0),window._channel.isRoomOperator(window.engineNick.slice(0,-4))&&(window._groupEngine.requestSetChannelMode(window._channel.getActiveRoom(),"+o",window.engineNick),window._channel.setRoomOperator(window.engineNick)),window._groupEngine.requestUserList(window._groupEngine.currentChannel()),window._channel.getChannelPermissions(),(window.config.showChannelUserListIcon||window._channel.getOperators().includes(p.ENGINE_NICK))&&""===window._channel.getActiveRoom()?l()(".channelAdmUserList").show():l()(".channelAdmUserList").hide()})),window._channel.callbacks().voiceRequestCB((function(e){if(!window._channel.getOperators().includes(p.ENGINE_NICK))return!1;if(0===e.length)return E("No requests for transmission"),l()(".user-request").hide(),!1;const t=e;return l()("#user-request").html(""),t.forEach((function(e){let t=e.replace(/\s+/," ");window._channel.getUser(e)&&(t=window._channel.getUser(e).fullname?.trim()||e,t=t.replace(/\s+/," "));let n=Kr(t);const i=m[Math.abs(I(e))%m.length];window._channel.isOperator(e)?l()("#user-request").append(`<div class="fr w100 pl10 pr20 sn" style="min-height:65px;border-bottom:1px solid;border-color:#f0f0f0"><div class="fcm" style="min-height:65px;"><div class="fcm p5" style="position:relative;border-radius:50%;width:44px;height:44px;background-color:${i};"><div class="frm"><div class="tw b">${n}</div></div><div class="material-icons tw ss" style="position:absolute;right:0px;bottom:0px;width:14px;height:14px;border-radius:50%;background-color:#F29423;">star</div></div></div>   <div class="fcm" style="min-height:65px;"><div><div class="toj pl10" style="color: #F29423">${t}</div><div class="pl10 sxs">${e}</div></div></div><div class="fig"></div><div class="requestVoice fcm ic_collaborate pt" style="min-height:65px;background-repeat:no-repeat;background-position-y:center;" t="${e}"></div></div>`):window._channel.getModerators().includes(e)?l()("#user-request").append(`<div class="fr w100 pl10 pr20 sn" style="min-height:65px;border-bottom:1px solid;border-color:#f0f0f0"><div class="fcm" style="min-height:65px;"><div class="fcm p5" style="position:relative;border-radius:50%;width:44px;height:44px;background-color:${i};"><div class="frm"><div class="tw b">${n}</div></div></div></div>   <div class="fcm" style="min-height:65px;"><div><div class="toj pl10" style="color: blue">${t}</div><div class="pl10 sxs">${e}</div></div></div><div class="fig"></div><div class="requestVoice fcm ic_collaborate pt" style="min-height:65px;background-repeat:no-repeat;background-position-y:center;" t="${e}"></div></div>`):l()("#user-request").append(`<div class="fr w100 pl10 pr20 sn" style="min-height:65px;border-bottom:1px solid;border-color:#f0f0f0"><div class="fcm" style="min-height:65px;"><div class="fcm p5" style="position:relative;border-radius:50%;width:44px;height:44px;background-color:${i};"><div class="frm"><div class="tw b">${n}</div></div></div></div>   <div class="fcm" style="min-height:65px;"><div><div class="toj pl10" style="color: green">${t}</div><div class="pl10 sxs">${e}</div></div></div><div class="fig"></div><div class="requestVoice fcm ic_collaborate pt" style="min-height:65px;background-repeat:no-repeat;background-position-y:center;" t="${e}"></div></div>`)})),l()("#remove-all-request").on("click",(()=>(new pr(`<div style=" padding: 8px;"><span class="material-icons" style="color:#FF8C05;font-size: 40px;">info_outline</span></div><div style=" width: 347px;height: 48px;"><span style="font-weight: 400;color: #2E3E4B;font-size: 18px;">${window.i18n.get("remove-collaboration-requests")}</span></div>`,"",(function(){const e=window._channel.getVoiceRequests();for(const t of e)window._channel.unsetVoiceRequests(t),window._engine.requestTransmission(t,!0,!1),window._engine.requestTransmission(t,!1,!1);l()("#channelRequestVoiceMark").hide()}),"",414,208).present(),!1))),l()(".user-request").show(),!1})),window._channel.callbacks().getMediasCB((e=>{const t=window._channel.getYoutube()?1:0,n=[...e.filter((e=>window._channel.getOperators().includes(e))).sort(),...e.filter((e=>window._channel.getModerators().includes(e)&&!window._channel.getOperators().includes(e))).sort(),...e.filter((e=>!window._channel.getOperators().includes(e)&&!window._channel.getModerators().includes(e))).sort()];n.length-t>0?(l()("#user-transmitting").html(""),n.forEach((e=>{let t=e;window._channel.getUser(e)&&window._channel.getUser(e).fullname&&(t=window._channel.getUser(e).fullname?.trim()||e);let n=Kr(t);const i=m[Math.abs(I(e))%m.length];"youtube"!==e&&(window._channel.getOperators().includes(p.ENGINE_NICK)?window._channel.getOperators().includes(e)?l()("#user-transmitting").append(`<div class="fr w100 pl10 pr10 sn" style="min-height:65px;border-bottom:1px solid;border-color:#f0f0f0"><div class="fcm" style="min-height:65px;"><div class="fcm p5" style="position:relative;border-radius:50%;width:44px;height:44px;background-color:${i};"><div class="frm"><div class="tw b">${n}</div></div><div class="material-icons tw ss" style="position:absolute;right:0px;bottom:0px;width:14px;height:14px;border-radius:50%;background-color:#F29423;">star</div></div></div>   <div class="fcm" style="min-height:65px;"><div><div class="toj pl10" style="color:#F29423;" >${t}</div><div class="pl10 sxs">${e}</div></div></div><div class="fig"></div><div class="removeVoice fcm ic_lista_ON pt" style="min-height:65px;background-repeat:no-repeat;background-position-y:center;" t="${e}"></div><div class="fcm material-icons pl10 chnu_op" style="min-height:65px;" nick="${e}">&#xE5D4;</div></div>`):window._channel.getModerators().includes(e)?l()("#user-transmitting").append(`<div class="fr w100 pl10 pr10 sn" style="min-height:65px;border-bottom:1px solid;border-color:#f0f0f0"><div class="fcm" style="min-height:65px;"><div class="fcm p5" style="position:relative;border-radius:50%;width:44px;height:44px;background-color:${i};"><div class="frm"><div class="tw b">${n}</div></div></div></div>   <div class="fcm" style="min-height:65px;"><div><div class="toj pl10" style="color:blue;">${t}</div><div class="pl10 sxs">${e}</div></div></div><div class="fig"></div><div class="removeVoice fcm ic_lista_ON pt" style="min-height:65px;background-repeat:no-repeat;background-position-y:center;" t="${e}"></div><div class="fcm material-icons pl10 chnu_op" style="min-height:65px;" nick="${e}">&#xE5D4;</div></div>`):l()("#user-transmitting").append(`<div class="fr w100 pl10 pr10 sn" style="min-height:65px;border-bottom:1px solid;border-color:#f0f0f0"><div class="fcm" style="min-height:65px;"><div class="fcm p5" style="position:relative;border-radius:50%;width:44px;height:44px;background-color:${i};"><div class="frm"><div class="tw b">${n}</div></div></div></div>   <div class="fcm" style="min-height:65px;"><div><div class="toj pl10" style="color:green;">${t}</div><div class="pl10 sxs">${e}</div></div></div><div class="fig"></div><div class="removeVoice fcm ic_lista_ON pt" style="min-height:65px;background-repeat:no-repeat;background-position-y:center;" t="${e}"></div><div class="fcm material-icons pl10 chnu_op" style="min-height:65px;" nick="${e}">&#xE5D4;</div></div>`):window._channel.getOperators().includes(e)?l()("#user-transmitting").append(`<div class="fr w100 pl10 pr10 sn" style="min-height:65px;border-bottom:1px solid;border-color:#f0f0f0"><div class="fcm" style="min-height:65px;"><div class="fcm p5" style="position:relative;border-radius:50%;width:44px;height:44px;background-color:${i};"><div class="frm"><div class="tw b">${n}</div></div><div class="material-icons tw ss" style="position:absolute;right:0px;bottom:0px;width:14px;height:14px;border-radius:50%;background-color:#F29423;">star</div></div></div>   <div class="fcm" style="min-height:65px;"><div><div class="toj pl10" style="color:#F29423;">${t}</div><div class="pl10 sxs">${e}</div></div></div><div class="fig"></div><div class="fcm ic_lista_ON" style="min-height:65px;background-repeat:no-repeat;background-position-y:center;"></div></div>`):window._channel.getModerators().includes(e)?l()("#user-transmitting").append(`<div class="fr w100 pl10 pr10 sn" style="min-height:65px;border-bottom:1px solid;border-color:#f0f0f0"><div class="fcm" style="min-height:65px;"><div class="fcm p5" style="position:relative;border-radius:50%;width:44px;height:44px;background-color:${i};"><div class="frm"><div class="tw b">${n}</div></div></div></div>   <div class="fcm" style="min-height:65px;"><div><div class="toj pl10" style="color:blue;">${t}</div><div class="pl10 sxs">${e}</div></div></div><div class="fig"></div><div class="fcm ic_lista_ON" style="min-height:65px;background-repeat:no-repeat;background-position-y:center;"></div></div>`):l()("#user-transmitting").append(`<div class="fr w100 pl10 pr10 sn" style="min-height:65px;border-bottom:1px solid;border-color:#f0f0f0"><div class="fcm" style="min-height:65px;"><div class="fcm p5" style="position:relative;border-radius:50%;width:44px;height:44px;background-color:${i};"><div class="frm"><div class="tw b">${n}</div></div></div></div>   <div class="fcm" style="min-height:65px;"><div><div class="toj pl10" style="color:green;">${t}</div><div class="pl10 sxs">${e}</div></div></div><div class="fig"></div><div class="fcm ic_lista_ON" style="min-height:65px;background-repeat:no-repeat;background-position-y:center;"></div></div>`))})),l()("#user-transmitting-label").html(`${window.i18n.get("transmitting")} <span class="sxs" style="vertical-align:middle;">(${e.length-t})</span>`),l()(".user-transmitting").show()):l()(".user-transmitting").hide(),window._channel.getModes().U||(e.length-t!=0?l()("#channelAdmUserListCount").html(""+(e.length-t)):l()("#channelAdmUserListCount").html(""))})),window._engine.callbacks().userListCB((function(e){if(window.channel.setUserList(e),!window._channel.getModes().U)return E("Request for user list not allowed (Channel mode: U)"),l()(".user-list").hide(),!1;if(0===e.length)return E("Userlist return = null!"),console.log("Userlist return = null!"),l()(".channelAdmUserList").hide(),l()("#channelAdmUserListCount").html(""),!1;let t=[];e.forEach((e=>{t.push(e.name)}));const n=t.filter((e=>window._channel.getOperators().includes(e))).sort(),i=t.filter((e=>window._channel.getModerators().includes(e)&&!window._channel.getOperators().includes(e))).sort(),s=t.filter((e=>!window._channel.getOperators().includes(e)&&!window._channel.getModerators().includes(e))).sort();return t=[...n,...i,...s],window._channel.setUsers(e),0!==t.length?l()("#channelAdmUserListCount").html(`${t.length}`):l()("#channelAdmUserListCount").html(""),l()("#user-list-label").html(`${window.i18n.get("list-of-users-in-session")} <span class="sxs" style="vertical-align:middle;">(${t.length})</span>`),l()("#user-list").html(""),t.forEach((function(e){let t,n=e.replace(/\s+/," ");window._channel.getUser(e)&&(n=window._channel.getUser(e).fullname?.trim()||e),n?(n=n.replace(/\s+/," "),t=Kr(n)):(n="",t=Kr(e));const i=m[Math.abs(I(e))%m.length];let s;s=!1===p.CONFIG.allowPrivMessage?"none":"flex",window._channel.isOperator(p.ENGINE_NICK)?window._channel.getOperators().includes(e)?l()("#user-list").append(`<div class="fr w100 pl10 pr10 sn" style="min-height:65px;border-bottom:1px solid;border-color:#f0f0f0"><div class="fcm" style="min-height:65px;"><div class="fcm p5" style="position:relative;border-radius:50%;width:44px;height:44px;background-color:${i};"><div class="frm"><div class="tw b">${t}</div></div><div class="material-icons tw ss" style="position:absolute;right:0px;bottom:0px;width:14px;height:14px;border-radius:50%;background-color:#F29423;">star</div></div></div>   <div class="fcm" style="min-height:65px;"><div><div class="toj pl10" style="color:#F29423;">${n}</div><div class="pl10 sxs">${e}</div></div></div><div class="fig"></div><div class="fcm material-icons pl10 chnu_op" style="min-height:65px;" nick="${e}">&#xE5D4;</div></div>`):window._channel.getModerators().includes(e)?l()("#user-list").append(`<div class="fr w100 pl10 pr10 sn" style="min-height:65px;border-bottom:1px solid;border-color:#f0f0f0"><div class="fcm" style="min-height:65px;"><div class="fcm p5" style="position:relative;border-radius:50%;width:44px;height:44px;background-color:${i};"><div class="frm"><div class="tw b">${t}</div></div></div></div>   <div class="fcm" style="min-height:65px;"><div><div class="toj pl10" style="color:blue;">${n}</div><div class="pl10 sxs">${e}</div></div></div><div class="fig"></div><div class="fcm material-icons pl10 chnu_op" style="min-height:65px;" nick="${e}">&#xE5D4;</div></div>`):l()("#user-list").append(`<div class="fr w100 pl10 pr10 sn" style="min-height:65px;border-bottom:1px solid;border-color:#f0f0f0"><div class="fcm" style="min-height:65px;"><div class="fcm p5" style="position:relative;border-radius:50%;width:44px;height:44px;background-color:${i};"><div class="frm"><div class="tw b">${t}</div></div></div></div>   <div class="fcm" style="min-height:65px;"><div><div class="toj pl10" style="color:green;">${n}</div><div class="pl10 sxs">${e}</div></div></div><div class="fig"></div><div class="fcm material-icons pl10 chnu_op" style="min-height:65px;" nick="${e}">&#xE5D4;</div></div>`):window._channel.getOperators().includes(e)?(l()("#user-list").append(`<div class="fr w100 pl10 pr10 sn" style="min-height:65px;border-bottom:1px solid;border-color:#f0f0f0"> <div class="fcm" style="min-height:65px;"> <div class="fcm p5" style="position:relative;border-radius:50%;width:44px;height:44px;background-color:${i};"> <div class="frm"> <div class="tw b">${t}</div> </div> <div class="material-icons tw ss" style="position:absolute;right:0px;bottom:0px;width:14px;height:14px;border-radius:50%;background-color:#F29423;"> star</div> </div> </div> <div class="fcm" style="min-height:65px;"> <div> <div class="toj pl10" style="color:#F29423;">${n}</div> <div class="pl10 sxs">${e}</div> </div> </div> <div nick=${e} id="iconMsgPrivate-${e}" class="iconMsgPrivateClass" style="cursor:pointer; flex-grow: 1; display: ${s}; justify-content: flex-end; align-items: center; margin-left: auto; min-height:65px;" t="sendMsg"> <?xml version="1.0" encoding="iso-8859-1"?> <svg class="iconMsgPrivateClass" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 356.267 356.267" style="enable-background:new 0 0 356.267 356.267;" xml:space="preserve" width="20px"> <g> <circle style="fill:#231F20;" cx="260.848" cy="151.1" r="26.469" /> <circle style="fill:#231F20;" cx="178.142" cy="151.1" r="26.469" /> <circle style="fill:#231F20;" cx="95.419" cy="151.1" r="26.469" /> </g> <path style="fill:#231F20;" d="M80.173,356.267c-10.658,0-19.34-8.646-19.34-19.287v-46.055 c-35.344-9.917-60.278-42.173-60.278-79.335V82.529C0.556,37.021,37.559,0,83.067,0H273.2c45.508,0,82.511,37.021,82.511,82.529 V211.59c0,45.508-37.021,82.529-82.511,82.529H155.485l-62.378,57.084C89.543,354.467,84.938,356.267,80.173,356.267z M83.067,17.646c-35.768,0-64.866,29.098-64.866,64.883V211.59c0,31.162,22.322,57.931,53.078,63.666l7.199,1.341v60.384 c0,1.57,1.676,1.641,1.676,1.641c0.388,0,0.706-0.141,1.041-0.423l67.442-61.725h124.579c35.768,0,64.866-29.098,64.866-64.883 V82.529c0-35.786-29.098-64.883-64.866-64.883H83.067z" /> </svg> </div> </div> <div class="fig"> </div>\n                        `),l()(`#iconMsgPrivate-${e}`).on("click",(function(e){e.stopPropagation();const t=l()(this);window.Events.dispatch("users/item-click",t)}))):window._channel.getModerators().includes(e)?l()("#user-list").append(`<div class="fr w100 pl10 pr10 sn" style="min-height:65px;border-bottom:1px solid;border-color:#f0f0f0"><div class="fcm" style="min-height:65px;"><div class="fcm p5" style="border-radius:50%;width:44px;height:44px;background-color:${i};"><div class="frm"><div class="tw b">${t}</div></div></div></div>   <div class="fcm" style="min-height:65px;"><div><div class="toj pl10" style="color:blue;">${n}</div><div class="pl10 sxs">${e}</div></div></div></div><div class="fig"></div></div>`):l()("#user-list").append(`<div class="fr w100 pl10 pr10 sn" style="min-height:65px;border-bottom:1px solid;border-color:#f0f0f0"><div class="fcm" style="min-height:65px;"><div class="fcm p5" style="border-radius:50%;width:44px;height:44px;background-color:${i};"><div class="frm"><div class="tw b">${t}</div></div></div></div>   <div class="fcm" style="min-height:65px;"><div><div class="toj pl10" style="color:green;">${n}</div><div class="pl10 sxs">${e}</div></div></div></div><div class="fig"></div></div>`)})),l()(".user-list").show(),!1})),window._groupEngine.callbacks().userListCB((function(e){E(`Group User List: ${JSON.stringify(e)}`),window._channel.setUsers(e)})),window._engine.callbacks().chatMessageCB((function(e,t,n,i,s,o){if(E(`app -> chatMessageCB: ${e} -> ${o} ( userMode: ${t}, chMsg: ${n}, mode: ${i}, seq: ${s} )`),/^\[DEBUG\]/.test(o))console.log(o);else{const r=e.replace("-web","");if(window.session&&window.session.isStarted()&&(/^(image=|document=|audio=|video=).+/.test(o)?window.session.statistics(window.session_id).setUserAttachmentCounter(r):window.session.statistics(window.session_id).setUserMessageSendCounter(r)),zd().populateChatArea(e,o,n?window._engine.currentChannel():null,!0,s),window._recorderCtrl.isStarted()){let r=o;const a=/^document=/,c=/^video=/,l=/^audio=/;/^image=/.test(r)&&(r="[imagem]"),a.test(r)&&(r="[documento]"),c.test(r)&&(r="[video]"),l.test(r)&&(r="[audio]"),window._recorderCtrl.notifyChat({source:e,userMode:t,chMsg:n,mode:i,seq:s,message:r})}}})),window._groupEngine.callbacks().chatMessageCB((function(e,t,n,i,s,o){E(`app -> groupChatMessageCB: ${e} -> ${o} ( userMode: ${t}, chMsg: ${n}, mode: ${i}, seq: ${s} )`),zd().populateChatArea(e,o,n?window._groupEngine.currentChannel():null,!0,s)})),window._engine.callbacks().userModesCB((function(e,t){E(`app -> userModesCB: mode: ${e}, flags: ${t}`)})),window._engine.callbacks().ctcpCB((function(e,t,n,i){const s=n,o=i;if("DEBUG"===s){const[e,t]=o.split(",");return"1"===t?window.debug.start(e):window.debug.stop(),!1}if("PRIVMSGACKREAD"===s)return!1;if(E(`app -> ctcpCB: source:${e}, userMode:${t}, ctcp:${n}, params:${i}`),async function(e,t,n,i){if("nested"!==n)return!1;const s=i;let o,r;try{const e=JSON.parse(s);o=e.action,r=e.value}catch(e){return console.log(`[BreakoutRoom] ctcpCB error: ${e}`),!1}if(!o||!r)return console.log("[BreakoutRoom] ctcpCB error: no action or value received"),!1;if(E(`[BreakoutRoom] ctcpCB: action "${o}" - value "${r}"`),console.log(`[BreakoutRoom] ctcpCB: action "${o}" - value "${r}"`),"move"===o){const e=r;window.breakoutRoom.changeRoom(e)}}(0,0,n,i),"DEVMUTE"===s){const t=window._channel.isOperator(e),n=i.toUpperCase();t?"ALL"===n?(window.devices.isAudioDeviceMuted()||l()("#user-media-mic").click(),window.devices.isVideoDeviceMuted()||l()("#user-media-cam").click()):"MIC"===n?window.devices.isAudioDeviceMuted()||l()("#user-media-mic").click():"CAM"===n&&(window.devices.isVideoDeviceMuted()||l()("#user-media-cam").click()):console.log(`[DEVMUTE] User ${e} is not an operator!`)}if("BANNER"===s){const e=JSON.parse(i);l()("#rpchnboxtext").html(e.body),"link"===e.action.type?(l()("#rpchnboxtext").attr("target","_blank"),l()(".rpchnboxlink").attr("href",e.action.body),l()(".rpchnboxlink").attr("target","_blank"),l()(".rpchnboxlink").attr("t","link"),l()("#rpchnbox").show()):"message"===e.action.type&&(l()("#rpchnboxtext").attr("target",""),l()(".rpchnboxlink").attr("target",""),l()(".rpchnboxlink").attr("href",""),l()(".rpchnboxlink").attr("t","message"),l()(".rpchnboxlink").attr("body",e.action.body),l()(".rpchnboxlink").attr("target",e.action.target),l()("#rpchnbox").show())}if("RECONNECT"===s.toUpperCase()){let e,t;o.match(/-s\s\S+/g)&&(e=`wss://${o.match(/-s\s\S+/g)[0].split(" ")[1]}`),o.match(/-d\s\S+/g)&&(t=parseInt(o.match(/-d\s\S+/g)[0].split(" ")[1]),t>14e3&&(t-=14557),e=`${e}:${t}`);let n=window._engine.currentChannel();if(o.match(/-c\s\S+/g)&&(n=o.match(/-c\s\S+/g)[0].split(" ")[1],n=n.replace("#","")),E(`RECONNECT: { "server": "${e}" , "port": "${t}", "channel": "${n}" }`),window._channel.setJustEntered(!0),window._youtubeCtrl.reset(),e){const t=n||window._engine.currentChannel();(window._engine.stop(),new Promise((e=>{setTimeout((()=>e(!0)),4e3)}))).then((()=>{window._channel.setName(t),window._channel.setUsersCount(0);const i=t,s=window._channel.getChannel(t).avatar_id||"";window._channel.setImgSource(`${window.files_base_url}avatars/channel/${i}/thumb.jpeg?${s}`),window._engine.callbacks().connectCB((function(){setTimeout((function(){window._channel.resetChannelMedias(),window._engine.requestEnterChannel(n,"")}),2e3)})),window._app.startJanus(e)}))}else n&&(window.channelToGo=n,window._engine.requestChannelInfo(n))}if("PING"===s)return window.old_value!==o&&(window._engine.requestSendPrivateMessage(`${String.fromCharCode(1)}PING ${i}${String.fromCharCode(1)}`,e,2),window.old_value=o),!1;if("VERSION"===s)return O(),window._engine.requestSendPrivateMessage(`${String.fromCharCode(1)}VERSION webclient:${window.navigatorData.language}:${window.navigatorData.browser}:v${window.version}${String.fromCharCode(1)}`,e,2),!1;if("CC"===s){let t;try{t=JSON.parse(i)}catch(e){return E(`[Closed Caption] CtcpCB Parsing Error! Params: ${i}`),!1}let n=e;window.user[e]?n=window.user[e]:window._channel.getUser(e)&&(n=window._channel.getUser(e).fullname?.trim()||n),l()("#session-timer").is(":visible")?l()("#user-media-cc").css("right","120px"):l()("#user-media-cc").css("right","20px"),l()("#user-media-cc").show();let s=t.duration<1e3?1e3:t.duration;s=s>1e4?1e4:s,window._channelCtrl.showClosedCaption(n,t.text,s)}if("SENDMSG"===s){const e=window.msgId-1,t=window._channel.getMsgSeq();l()(`#${window._engine.currentChannel()}Msgundefined`).attr("id",`${window._engine.currentChannel()}Msg${i.split(" ")[0]}`),l()(`.${window._engine.currentChannel()}Msg${t}`).attr("seq",`${i.split(" ")[0]}`),l()(`.${window._engine.currentChannel()}Msg${t}`).addClass(`${window._engine.currentChannel()}Msg${i.split(" ")[0]}`),l()(`#${window._engine.currentChannel()}Msg${t}`).attr("id",`${window._engine.currentChannel()}Msg${i.split(" ")[0]}`),0===window._channel.getType()&&""===window._channel.getActiveRoom()?(l()(`.${window._engine.currentChannel()}Msg${e}`).attr("seq",i.split(" ")[0]),l()(`#${window._engine.currentChannel()}Msg${e}`).attr("id",`${window._engine.currentChannel()}Msg${i.split(" ")[0]}`)):(l()(`.${window._groupEngine.currentChannel()}Msg${e}`).attr("seq",i.split(" ")[0]),l()(`#${window._groupEngine.currentChannel()}Msg${e}`).attr("id",`${window._groupEngine.currentChannel()}Msg${i.split(" ")[0]}`))}if("DELMESSAGES"===s){let e;i.split(" ").forEach((function(t){e=l()("#hp__Channel__ .msg").last().attr("date").replace(/\//g,""),""===window._channel.getActiveRoom()?l()(`#${window._engine.currentChannel()}Msg${t}`).remove():l()(`#${window._groupEngine.currentChannel()}Msg${t}`).remove(),1===l()(`.${e}`).length&&l()(`.${e}`).remove()}))}if("CHLIKES"===s){const e=i.split(" ")[3];l()("#rpchnu").html(M(e)),l()(`#lpcht_${window._engine.currentChannel()} .lpchu`).html(M(e))}if("MEDIAVOICEREQUEST"===s){window._channel.setVoiceRequests(`${e}`);const t=e.replace("-web","");window.audioRequestCollaboration.play(),l()("#channelRequestVoiceMark").show(),window.session&&window.session.isStarted()&&window.session.statistics(window.session_id).setUserRaiseHandCounter(t)}if("MEDIAVOICECANCEL"===s&&(window._channel.unsetVoiceRequests(`${e}`),0===window._channel.getVoiceRequests().length&&l()("#channelRequestVoiceMark").hide(),e===p.ENGINE_NICK&&window._channel.getVoiceRequests().includes(e)&&(window._channel.unsetTransmitting(),window._engine.requestTransmission(e,!1,!1))),"POLL"===s||"QUIZ"===s){const e="POLL"===s?"poll":"quiz",t=!!window.config.allowQuiz;if("QUIZ"===e&&!t)return E("QUIZ not allowed in this realm!"),!1;if(l()("#pollEliminatedArea").hide(),window._poll.getLastPoll()!==s&&(window._poll.setSkey(""),window._poll.setLastPoll(s)),i.includes("START")){const e=i.split("START ")[1];let t={};l()(".pollOption").removeClass("tr b"),l()("#pollArea").hide(),l()("#pollTimeArea").hide(),l()("#pollRewardResult").hide(),window._poll.setAnswered(!1),window._poll.setPlaying(!0),window._poll.setPoints(0);try{t=JSON.parse(e)}catch(e){return E(`${s} error: ${e}`),!1}t.lifes_timeout=t.lifes_timeout||5e3,window._poll.start(t).then((e=>{E(`${JSON.stringify(e.data)}`);const t=e.data.lifes||0,n=e.data.used_lifes||!1,i=e.data.playing||!1;return E(`${s} session started: skey = ${e.data.skey}`),""===e.data.skey&&"QUIZ"===s?(E("QUIZ: not playing!"),window._poll.setPlaying(!1),!1):(window._poll.setSkey(e.data.skey),window._poll.setLastPoll(s),"QUIZ"===s&&(E(`${s} lifes: ${t}`),window._poll.setLifes(t),E(`${s} used_lifes: ${n}`),window._poll.setUsedLifes(n),window._poll.setPlaying(i),window._poll.setContinueWatching(!1)),!1)})).catch((e=>{E(`${s} sesion start error: ${e}`)}))}else if(i.includes("SESSION")){const e=i.split("SESSION ")[1];let t={};l()(".pollOption").removeClass("tr b"),l()("#pollArea").hide(),l()("#pollTimeArea").hide(),l()("#pollRewardResult").hide(),window._poll.setAnswered(!1),window._poll.setPlaying(!0),window._poll.setPoints(0);try{t=JSON.parse(e)}catch(e){return E(`${s} error: ${e}`),!1}t.lifes_timeout=t.lifes_timeout||5e3,window._poll.start(t).then((e=>{E(`${JSON.stringify(e.data)}`);const t=e.data.lifes||0,n=e.data.used_lifes||!1,i=e.data.playing||!1;return E(`${s} session started: skey = ${e.data.skey}`),""===e.data.skey&&"QUIZ"===s?(E("QUIZ: not playing!"),window._poll.setPlaying(!1),!1):(window._poll.setSkey(e.data.skey),window._poll.setLastPoll(s),"QUIZ"===s&&(E(`${s} lifes: ${t}`),window._poll.setLifes(t),E(`${s} used_lifes: ${n}`),window._poll.setUsedLifes(n),window._poll.setPlaying(i),window._poll.setContinueWatching(!1)),!1)})).catch((e=>{E(`${s} sesion start error: ${e}`)}))}else if(i.includes("QUESTION")){const e=i.split("QUESTION ")[1];let t={};try{t=JSON.parse(e),t.duration-=1e3}catch(e){return E(`${s} error: ${e}`),!1}if(l()("#pollBackground0").addClass("bgdlg"),l()("#pollBackground1").addClass("bgdlg"),l()("#pollBackground2").addClass("bgdlg"),l()("#pollBackground0").removeClass("bgdgr"),l()("#pollBackground1").removeClass("bgdgr"),l()("#pollBackground2").removeClass("bgdgr"),l()("#pollOptionText0").css("max-width","100%"),l()("#pollOptionText1").css("max-width","100%"),l()("#pollOptionText2").css("max-width","100%"),l()("#pollTimeArea").hide(),l()("#pollRewardResult").hide(),l()("#pollTimeRemaining").attr("stroke-dasharray","283 283"),window._poll.setAnswered(!1),window._poll.setChoice(-1),""!==window._poll.getSkey()&&window._poll.getSkey()){if("QUIZ"===s&&!window._poll.getPlaying()&&!window._poll.getContinueWatching())return E(`QUESTION ${s}: { playing: ${window._poll.getPlaying()} , continue watching: ${window._poll.getContinueWatching()} }`),l()("#pollArea").hide(),!1;l()("#pollArea").show()}else window._poll.start(t).then((e=>""!==e.data.skey&&e.data.skey?(E(`${s} session started: skey = ${e.data.skey}`),window._poll.setSkey(e.data.skey),window._poll.setQuestion(t),window._poll.setPlaying(!0),l()("#pollArea").show(),!1):(E(`${s} session started error: no valid session (skey)!`),window._poll.setPlaying(!1),l()("#pollArea").hide(),!1)));l()("#pollPlayers").hide(),l()("#pollLifes").hide(),l()("#pollSeq").html(t.seq),"QUIZ"===s&&(t.lifes_disallowed?l()("#pollLifes").hide():(l()("#pollLifesValue").html(window._poll.getLifes()),l()("#pollLifes").show()),l()("#pollPlayers").show(),l()("#pollPlayersValue").html(t.players)),window._poll.setQuestion(t).then((e=>{E(`${s} question registered: ${JSON.stringify(e)}`)})),l()(".pollResultLabel").hide(),l()(".pollValue").hide(),l()("#pollTitle").html(t.text),l()(".pollOption").hide(),l()(".pollOptionArea").show(),l()(".pollOption").removeClass("bgdg"),l()("#pollTimeArea").show(),l()("#pollTopBar").show(),l()("#pollTitle").show();for(let e=0;e<t.options.length;e+=1){const n=`#pollOption${e}`,i=`#pollOptionText${e}`,s=`#pollResult${e}`,o=`#pollBackground${e}`;l()(i).html(t.options[e]),l()(i).removeClass("tw"),l()(i).addClass("tk"),l()(o).removeClass("bgdbl2"),l()(s).hide(),l()(n).show()}const n=t.duration/1e3;let o=t.duration/1e3;clearInterval(window.pollMap.get("timer")),window.pollMap.set("timer",setInterval((()=>{const e=parseInt(o/60);let t=o-60*e,i="";const s=`${parseInt(o/n*283)} 283`;l()("#pollTimeRemaining").attr("stroke-dasharray",s),0!==e&&(i+=`${e.toString()}:`),t>9?i+=t.toString():(t<=0&&(t=0),i+=`0${t.toString()}`),l()("#pollTime").html(i),o-=1,o<0&&(l()("#pollTimeRemaining").attr("stroke-dasharray","283 283"),o<-3&&(l()("#pollTimeArea").hide(),l()("#pollArea").hide(),window._poll.setAnswered(!0),clearInterval(window.pollMap.get("timer"))))}),1e3))}else if(i.includes("RESULT")){if("QUIZ"===s&&!window._poll.getPlaying()&&!window._poll.getContinueWatching())return E(`RESULT ${s}: { playing: ${window._poll.getPlaying()} , continue watching: ${window._poll.getContinueWatching()} }`),!1;const e=i.split("RESULT ")[1];let t={};try{t=JSON.parse(e),E(`RESULT ${s}: ${e}`);const n=t.options,i=t.stats,o=n.length,r=i[0]+i[1]+i[2],a=t.correct,c=window._poll.getChoice();if(l()("#pollPlayers").hide(),l()("#pollLifes").hide(),l()("#pollTopBar").show(),l()("#pollSeq").html(t.seq),l()("#pollOptionText0").css("max-width","90%"),l()("#pollOptionText1").css("max-width","90%"),l()("#pollOptionText2").css("max-width","90%"),""!==window._poll.getSkey()&&window._poll.getSkey()||window._poll.start(t).then((e=>{E(`${s} session started: skey = ${e.data.skey}`),window._poll.setSkey(e.data.skey),window._poll.setQuestion(t)})),"QUIZ"===s){if(t.lifes_disallowed||window._poll.getUsedLifes()||0===window._poll.getLifes()?(l()("#pollLifes").hide(),l()(".pollUseLife").hide()):(l()("#pollLifesValue").html(window._poll.getLifes()),l()("#pollLifes").show(),l()(".pollUseLife").show()),l()("#pollPlayers").show(),l()("#pollPlayersValue").html(t.players),a!==c&&!window._poll.getContinueWatching()){let e=window._poll.getLifesTimeout();e-=1e3,l()("#pollTimeArea").show(),l()("#pollTitle").hide(),l()(".pollOptionArea").hide();const t=e/1e3;let n=e/1e3;return clearInterval(window.pollMap.get("timer")),window.pollMap.set("timer",setInterval((()=>{const e=parseInt(n/60);let i=n-60*e,s="";const o=`${parseInt(n/t*283)} 283`;l()("#pollTimeRemaining").attr("stroke-dasharray",o),0!==e&&(s+=`${e.toString()}:`),i>9?s+=i.toString():(i<=0&&(i=0),s+=`0${i.toString()}`),l()("#pollTime").html(s),n-=1,n<0&&(l()("#pollTimeRemaining").attr("stroke-dasharray","283 283"),n<-3&&(l()("#pollTimeArea").hide(),l()("#pollArea").hide(),window._poll.setPlaying(!1),window._poll.setContinueWatching(!1),clearInterval(window.pollMap.get("timer"))))}),1e3)),l()("#pollResultLabel").removeClass("bgdgr"),l()("#pollResultLabel").addClass("bgr"),l()("#pollResultLabel").html(window.i18n.get("quiz-you-are-eliminated")),l()(".pollResultLabel").show(),l()("#pollEliminatedArea").show(),l()("#pollArea").show(),!1}a!==c||window._poll.getContinueWatching()||window._poll.setPoints(window._poll.getPoints()+1)}if(l()(".pollOption").hide(),l()(".pollOptionArea").show(),l()("#pollTimeArea").hide(),l()("#pollTopBar").show(),l()("#pollTitle").show(),l()("#pollRewardResult").hide(),l()("#pollResultLabel").removeClass("bgdgr"),l()("#pollResultLabel").removeClass("bgr"),"POLL"===s?(l()("#pollResultLabel").removeClass("bgr"),l()("#pollResultLabel").addClass("bgdgr"),l()("#pollResultLabel").html(window.i18n.get("quiz-result"))):window._poll.getContinueWatching()?(l()("#pollResultLabel").removeClass("bgr"),l()("#pollResultLabel").addClass("bgdgr"),l()("#pollResultLabel").html(`<span class="sl pr10 material-icons" style="vertical-align:middle;"></span>${window.i18n.get("quiz-result")}`)):a===c?(l()("#pollResultLabel").removeClass("bgr"),l()("#pollResultLabel").addClass("bgdgr"),l()("#pollResultLabel").html(`<span class="sl pr10 material-icons" style="vertical-align:middle;">&#xE876;</span> ${window.i18n.get("quiz-correct")}`)):(l()("#pollResultLabel").removeClass("bgdgr"),l()("#pollResultLabel").addClass("bgr"),l()("#pollResultLabel").html(`<span class="sl pr10 material-icons" style="vertical-align:middle;">&#xE14C;</span> ${window.i18n.get("quiz-incorrect")}`)),l()(".pollResultLabel").show(),l()("#pollTitle").html(t.text),0===r)return l()("#pollValue0").show(),l()("#pollBackground0").removeClass("bgdbl2"),l()("#pollOptionText0").removeClass("tk tw"),l()("#pollOption0").show(),l()("#pollResult0").hide(),l()("#pollValue1").show(),l()("#pollBackground1").removeClass("bgdbl2"),l()("#pollOptionText1").removeClass("tk tw"),l()("#pollOption1").show(),l()("#pollResult1").hide(),3===o&&(l()("#pollValue2").show(),l()("#pollBackground2").removeClass("bgdbl2"),l()("#pollOptionText2").removeClass("tk tw"),l()("#pollOption2").show(),l()("#pollResult2").hide()),l()(".pollValue").html("0 %"),l()(`#pollBackground${a}`).removeClass("bgdlg"),l()(`#pollBackground${a}`).addClass("bgdgr"),l()("#pollArea").show(),E(`${s} result: ${JSON.stringify(t)}`),!1;for(let e=0;e<o;e+=1)l()(`#pollBackground${e}`).removeClass("bgdbl2"),l()(`#pollOptionText${e}`).removeClass("tk"),l()(`#pollOptionText${e}`).addClass("tw"),l()(`#pollOptionText${e}`).html(n[e]),l()(`#pollOption${e}`).show(),l()(`#pollValue${e}`).show(),l()(`#pollValue${e}`).html(`${parseInt(i[e]/r*100)} %`),l()(`#pollResult${e}`).css("width",`${parseInt(i[e]/r*100)}%`),"POLL"===s||a===e?(l()(`#pollResult${e}`).removeClass("bgr"),l()(`#pollResult${e}`).removeClass("bgdg")):c===e?(l()(`#pollResult${e}`).addClass("bgr"),l()(`#pollResult${e}`).removeClass("bgdg")):(l()(`#pollResult${e}`).addClass("bgdg"),l()(`#pollResult${e}`).removeClass("bgr")),0!==parseInt(i[e]/r*100)&&l()(`#pollResult${e}`).show();l()("#pollArea").show(),E(`${s} result: ${JSON.stringify(t)}`)}catch(e){return E(`${s} error: ${e}`),!1}}else if(i.includes("HIDE"))try{E(`Hiding ${s} area...`),l()("#pollArea").hide(),l()(".pollOptionArea").hide(),l()(".pollResultLabel").hide(),l()("#pollRewardResult").hide()}catch(e){return E(`${s} error: ${e}`),!1}else if(i.includes("FINISH")){if("QUIZ"===s&&!window._poll.getPlaying()&&!window._poll.getContinueWatching())return E(`FINISH ${s}: { playing: ${window._poll.getPlaying()} , continue watching: ${window._poll.getContinueWatching()} }`),!1;const t=i.split("FINISH ")[1],n=0===t.poll_id?t.quiz_id:t.poll_id;let o={};try{if(o=JSON.parse(t),"QUIZ"===s){if(""===window._poll.getSkey())return E("Poll result error: skey is empty!"),!1;window._poll.getResult(o).then((t=>{const i=t.data.data.winner,o=t.data.data.reward,r=t.data.data.reward_quantity,a=t.data.data.total_winners;E(`${s} result: ${JSON.stringify(t.data)}`),l()("#pollTopBar").hide(),l()("#pollTimeArea").hide(),l()("#pollResultLabel").hide(),l()("#pollTitle").hide(),l()(".pollOptionArea").hide(),i?(l()("#pollRewardTopLabel").removeClass("bgr"),l()("#pollRewardTopLabel").addClass("bgdgr"),l()("#pollRewardTopLabel").html(window.i18n.get("congratulations-you-won")),l()(".pollTrophyLooser").hide(),l()(".poolTrophyWinnerImg").attr("src",`${p.ASSETS}/common/img/trophy_winner.png`),l()(".pollTrophyWinner").show(),l()("#pollRewardPointsValue").html(`${r>0?r:""} ${o}`),0===a?l()("#pollTrophyMessage").html(window.i18n.get("quiz-there-were-no-winners")):1===a?l()("#pollTrophyMessage").html(window.i18n.get("quiz-you-were-the-winner")):l()("#pollTrophyMessage").html(`${window.i18n.get("quiz-you-and")} ${a} ${window.i18n.get("quiz-other-participants-were-winners")}`),l()("#pollRewardResult").show(),l()("#pollArea").show(),E(`Finish ${e}_id (${n}): ${s} reseted!`),window._poll.reset()):(l()("#pollRewardTopLabel").addClass("bgr"),l()("#pollRewardTopLabel").removeClass("bgdgr"),l()("#pollRewardTopLabel").html(window.i18n.get("quiz-you-lost")),l()(".pollTrophyWinner").hide(),l()(".poolTrophyLooserImg").attr("src",`${p.ASSETS}/common/img/trophy_looser.png`),l()(".pollTrophyLooser").show(),l()("#pollRewardPointsValue").html(`${r>0?r:""} ${o}`),0===a?l()("#pollTrophyMessage").html(window.i18n.get("quiz-there-were-no-winners")):1===a?l()("#pollTrophyMessage").html(`${a} ${window.i18n.get("quiz-participant-won")}`):l()("#pollTrophyMessage").html(`${a} ${window.i18n.get("quiz-participants-won")}`),l()("#pollRewardResult").show(),l()("#pollArea").show(),E(`Finish ${e}_id (${n}): ${s} reseted!`),window._poll.reset())}))}else E(`Finish ${e}_id (${n}): ${s} reseted!`),window._poll.reset(),l()("#pollArea").hide(),l()(".pollResultLabel").hide()}catch(e){return E(`${s} error: ${e}`),!1}}}return!1})),window._groupEngine.callbacks().ctcpCB((function(e,t,n){E(`groupEngine -> ctcpCB: ( ${e} )  ( ${t} )  ( ${n} )`);const i=t,s=n;if("BANNER"===i){const e=JSON.parse(n);l()("#rpchnboxtext").html(e.body),"link"===e.action.type?(l()("#rpchnboxtext").attr("target","_blank"),l()(".rpchnboxlink").attr("href",e.action.body),l()(".rpchnboxlink").attr("target","_blank"),l()(".rpchnboxlink").attr("t","link"),l()("#rpchnbox").show()):"message"===e.action.type&&(l()("#rpchnboxtext").attr("target",""),l()(".rpchnboxlink").attr("target",""),l()(".rpchnboxlink").attr("href",""),l()(".rpchnboxlink").attr("t","message"),l()(".rpchnboxlink").attr("body",e.action.body),l()(".rpchnboxlink").attr("target",e.action.target),l()("#rpchnbox").show())}if("PING"===i)return window.old_value!==s&&(window._engine.requestSendPrivateMessage(`${String.fromCharCode(1)}PING ${n}${String.fromCharCode(1)}`,e,2),window.old_value=s),!1;if("VERSION"===i){const t=O();return window._engine.requestSendPrivateMessage(`${String.fromCharCode(1)}VERSION ${t.name}${t.version}${String.fromCharCode(1)}`,e,2),!1}if("SENDMSG"===i){const e=window.msgId-1;l()(`#${window._engine.currentChannel()}Msgundefined`).attr("id",`${window._engine.currentChannel()}Msg${n.split(" ")[0]}`),0===window._channel.getType()&&""===window._channel.getActiveRoom()?(l()(`.${window._engine.currentChannel()}Msg${e}`).attr("seq",n.split(" ")[0]),l()(`#${window._engine.currentChannel()}Msg${e}`).attr("id",`${window._engine.currentChannel()}Msg${n.split(" ")[0]}`)):(l()(`.${window._groupEngine.currentChannel()}Msg${e}`).attr("seq",n.split(" ")[0]),l()(`#${window._groupEngine.currentChannel()}Msg${e}`).attr("id",`${window._groupEngine.currentChannel()}Msg${n.split(" ")[0]}`))}if("DELMESSAGES"===i&&n.split(" ").forEach((function(e){""===window._channel.getActiveRoom()?l()(`#${window._engine.currentChannel()}Msg${e}`).remove():l()(`#${window._groupEngine.currentChannel()}Msg${e}`).remove()})),"CHLIKES"===i){const e=n.split(" ")[3];l()("#rpchnu").html(M(e)),l()(`#lpcht_${window._engine.currentChannel()} .lpchu`).html(M(e))}if("MEDIAVOICEREQUEST"===i&&(l()(`#lpchu_${e} .chnu_h`).addClass("tb"),window.lChannelVoices[e]=0,N()),"MEDIAVOICECANCEL"===i&&(l()(`#lpchu_${e} .chnu_h`).removeClass("tb"),l()(`#voice_${e}`).remove(),delete window.lChannelVoices[e],e!==window.engineNick?(l()("#rpchnhi").removeClass("tb"),l()("#rpchnhi").removeClass("ic_collaborate_ON")):(1===window.lChannelVoices[e]&&(window._channel.unsetTransmitting(),window._engine.requestTransmission(e,!1,!1)),window.lChannelVoices[e]=99),N()),"POLL"===i||"QUIZ"===i){if("QUIZ"===i)return!1;if(n.includes("START")){const e=n.split("START ")[1];let t={};l()(".pollOption").removeClass("tr b"),l()("#pollTimeArea").hide(),window._poll.setAnswered(!1);try{t=JSON.parse(e)}catch(e){return E(`${i} error: ${e}`),!1}window._poll.start(t).then((e=>{E(`${i} session started: skey = ${e.data.skey}`),window._poll.setSkey(e.data.skey)})).catch((e=>{E(`${i} sesion start error: ${e}`)}))}else if(n.includes("SESSION")){const e=n.split("SESSION ")[1];let t={};l()(".pollOption").removeClass("tr b"),l()("#pollTimeArea").hide(),window._poll.setAnswered(!1);try{t=JSON.parse(e)}catch(e){return E(`${i} error: ${e}`),!1}window._poll.start(t).then((e=>{E(`${i} session started: skey = ${e.data.skey}`),window._poll.setSkey(e.data.skey)})).catch((e=>{E(`${i} sesion start error: ${e}`)}))}else if(n.includes("QUESTION")){l()("#pollTimeArea").hide(),l()("#pollTimeRemaining").attr("stroke-dasharray","283 283"),window._poll.setAnswered(!1),window._poll.setChoice(-1);const e=n.split("QUESTION ")[1];let t={};try{t=JSON.parse(e)}catch(e){return E(`${i} error: ${e}`),!1}""===window._poll.getSkey()&&window._poll.start(t).then((e=>{E(`${i} session started: skey = ${e.data.skey}`),window._poll.setSkey(e.data.skey),window._poll.setQuestion(t)})),window._poll.setQuestion(t).then((e=>{E(`${i} question registered: ${JSON.stringify(e)}`)})),l()(".pollResultLabel").hide(),l()(".pollValue").hide(),l()("#pollArea").show(),l()("#pollTitle").html(t.text),l()(".pollOption").hide(),l()(".pollOption").removeClass("bgdg"),l()("#pollTimeArea").show();for(let e=0;e<t.options.length;e+=1){const n=`#pollOption${e}`,i=`#pollOptionText${e}`,s=`#pollResult${e}`,o=`#pollBackground${e}`;l()(i).html(t.options[e]),l()(i).removeClass("tw"),l()(i).addClass("tk"),l()(o).removeClass("bgdbl2"),l()(s).hide(),l()(n).show()}const s=t.duration/1e3;let o=t.duration/1e3;const r=setInterval((()=>{const e=parseInt(o/60),t=o-60*e;let n="";const i=`${parseInt(o/s*283)} 283`;l()("#pollTimeRemaining").attr("stroke-dasharray",i),0!==e&&(n+=`${e.toString()}:`),n+=t>9?t.toString():`0${t.toString()}`,l()("#pollTime").html(n),o-=1,o<0&&(l()("#pollTimeRemaining").attr("stroke-dasharray","283 283"),l()("#pollTimeArea").hide(),l()("#pollArea").hide(),window._poll.setAnswered(!0),clearInterval(r))}),1e3)}else if(n.includes("RESULT")){l()(".pollOption").hide(),l()("#pollTimeArea").hide();const e=n.split("RESULT ")[1];let t={};try{t=JSON.parse(e);const n=t.options,s=t.stats,o=n.length,r=s[0]+s[1]+s[2],a=t.correct,c=window._poll.getChoice();if(0===r)return l()("#pollValue0").show(),l()("#pollValue1").show(),3===o&&l()("#pollValue2").show(),l()(".pollValue").html("0 %"),!1;l()("#pollResultLabel").removeClass("bgdgr"),l()("#pollResultLabel").removeClass("bgr"),"POLL"===i?(l()("#pollResultLabel").addClass("bgdgr"),l()("#pollResultLabel").html("RESULTADO")):a===c?(l()("#pollResultLabel").addClass("bgdgr"),l()("#pollResultLabel").html("V CORRETA")):(l()("#pollResultLabel").addClass("bgr"),l()("#pollResultLabel").html("X INCORRETA")),l()(".pollResultLabel").show(),l()("#pollTitle").html(t.text);for(let e=0;e<o;e+=1)l()(`#pollBackground${e}`).removeClass("bgdbl2"),l()(`#pollOptionText${e}`).removeClass("tk"),l()(`#pollOptionText${e}`).addClass("tw"),l()(`#pollOptionText${e}`).html(n[e]),l()(`#pollOption${e}`).show(),l()(`#pollValue${e}`).show(),l()(`#pollValue${e}`).html(`${parseInt(s[e]/r*100)} %`),l()(`#pollResult${e}`).css("width",`${parseInt(s[e]/r*100)}%`),0!==parseInt(s[e]/r*100)&&l()(`#pollResult${e}`).show();l()("#pollArea").show(),E(`${i} result: ${JSON.stringify(t)}`)}catch(e){return E(`${i} error: ${e}`),!1}}else if(n.includes("HIDE"))try{E(`Hiding ${i} area...`),l()("#pollArea").hide(),l()(".pollResultLabel").hide()}catch(e){return E(`${i} error: ${e}`),!1}else if(n.includes("FINISH")){const e=n.split("FINISH ")[1];let t={};try{t=JSON.parse(e),E(`Finish poll_id (${t.poll_id}): ${i} reseted!`),window._poll.reset()}catch(e){return E(`${i} error: ${e}`),!1}}}if("POLL_OLD"===i)if(n.includes("START")){const e=n.split("START ")[1];let t={};l()(".pollOption").removeClass("tr b"),l()("#pollTimeArea").hide(),window._poll.setAnswered(!1);try{t=JSON.parse(e)}catch(e){return E(`${i} error: ${e}`),!1}window._poll.start(t).then((e=>{E(`Poll session started: skey = ${e.data.skey}`),window._poll.setSkey(e.data.skey)})).catch((e=>{E(`Poll sesion start error: ${e}`)}))}else if(n.includes("QUESTION")){l()("#pollTimeArea").hide(),l()("#pollTimeRemaining").attr("stroke-dasharray","283 283"),window._poll.setAnswered(!1);const e=n.split("QUESTION ")[1];let t={};try{t=JSON.parse(e)}catch(e){return E(`${i} error: ${e}`),!1}""===window._poll.getSkey()&&window._poll.start(t).then((e=>{E(`Poll session started: skey = ${e.data.skey}`),window._poll.setSkey(e.data.skey),window._poll.setQuestion(t)})),window._poll.setQuestion(t).then((e=>{E(`Poll question registered: ${JSON.stringify(e)}`)})),l()(".pollResultLabel").hide(),l()(".pollValue").hide(),l()("#pollArea").show(),l()("#pollTitle").html(t.text),l()(".pollOption").hide(),l()(".pollOption").removeClass("bgdg"),l()("#pollTimeArea").show();for(let e=0;e<t.options.length;e+=1){const n=`#pollOption${e}`,i=`#pollOptionText${e}`,s=`#pollResult${e}`,o=`#pollBackground${e}`;l()(i).html(t.options[e]),l()(i).removeClass("tw"),l()(i).addClass("tk"),l()(o).removeClass("bgdbl2"),l()(s).hide(),l()(n).show()}const s=t.duration/1e3;let o=t.duration/1e3;const r=setInterval((()=>{const e=parseInt(o/60),t=o-60*e;let n="";const i=`${parseInt(o/s*283)} 283`;l()("#pollTimeRemaining").attr("stroke-dasharray",i),0!==e&&(n+=`${e.toString()}:`),n+=t>9?t.toString():`0${t.toString()}`,l()("#pollTime").html(n),o-=1,o<0&&(l()("#pollTimeRemaining").attr("stroke-dasharray","283 283"),l()("#pollTimeArea").hide(),l()("#pollArea").hide(),window._poll.setAnswered(!0),clearInterval(r))}),1e3)}else if(n.includes("RESULT")){l()(".pollOption").hide(),l()("#pollTimeArea").hide();const e=n.split("RESULT ")[1];let t={};try{t=JSON.parse(e);const n=t.options,i=t.stats,s=n.length,o=i[0]+i[1]+i[2];if(0===o)return l()("#pollValue0").show(),l()("#pollValue1").show(),3===s&&l()("#pollValue2").show(),l()(".pollValue").html("0 %"),!1;l()(".pollResultLabel").show(),l()("#pollTitle").html(t.text);for(let e=0;e<s;e+=1)l()(`#pollBackground${e}`).removeClass("bgdbl2"),l()(`#pollOptionText${e}`).removeClass("tk"),l()(`#pollOptionText${e}`).addClass("tw"),l()(`#pollOptionText${e}`).html(n[e]),l()(`#pollOption${e}`).show(),l()(`#pollValue${e}`).show(),l()(`#pollValue${e}`).html(`${parseInt(i[e]/o*100)} %`),l()(`#pollResult${e}`).css("width",`${parseInt(i[e]/o*100)}%`),0!==parseInt(i[e]/o*100)&&l()(`#pollResult${e}`).show();l()("#pollArea").show(),E(`Poll result: ${JSON.stringify(t)}`)}catch(e){return E(`${i} error: ${e}`),!1}}else if(n.includes("HIDE"))try{E("Hiding poll area..."),l()("#pollArea").hide(),l()(".pollResultLabel").hide()}catch(e){return E(`${i} error: ${e}`),!1}else if(n.includes("FINISH")){const e=n.split("FINISH ")[1];let t={};try{t=JSON.parse(e),E(`Finish poll_id (${t.poll_id}): Poll reseted!`),window._poll.reset()}catch(e){return E(`${i} error: ${e}`),!1}}return!1})),window._engine.callbacks().userJoinCB((function(e,t){const n=D(parseInt((new Date).getTime()/1e3)),i=l()("#hp__Channel__ > .msg").last().attr("date");E(`USER JOINED: ${e} - umode: ${t}`);const s=t;if(window._channel.setUser(e,s),window.channel.setUser({username:e,fullname:s}),window.config.showChannelUserListIcon&&window._channel.getModes().U&&window._engine.requestUserList(window._engine.currentChannel()),1===window._channel.getType()){let t,s=window._channel.getName();""===window._channel.getActiveRoom()?t=l()("#hp__Channel__"):(t=l()("#hp__Group__"),s=window._channel.getActiveRoom());const o=P(parseInt((new Date).getTime()/1e3)).split(",")[0];let r="";i!==n&&(r+=`<div class="dayBanner frm ts ${window.i18n.get("today")}"><span class="msgd sxs pl10 pr10 pt5 pb5 tg">${window.i18n.get("today")}</span></div>`),r+=`<div class="msg" d="2" date="${window.i18n.get("today")}"><div class="msgLeft">`,r+=`<div class="msgText pl10" style="padding-right:0;padding-bottom:15px"><span class="chnMsg" style="font-weight:bold;">${e}</span><span style="font-style:italic;"> ${window.i18n.get("channel-joined")}</span></div><div class="sxs" style="padding:5px;">${o}</div></div></div>`,null!==s&&t.append(r)}if(window._recorderCtrl&&window._recorderCtrl.isStarted()&&window.recordChatInOut&&window._recorderCtrl.notifyJoin(e),window.session.isStarted()){const t=(new Date).getTime()+window.tsDiff,n=e.replace("-web","");window.session.statistics(window.session_id).setUserJoin(n,t)}})),window._engine.callbacks().userLeaveCB((function(e,t){const n=D(parseInt((new Date).getTime()/1e3)),i=l()("#hp__Channel__ > .msg").last().attr("date");if(window._channel.unsetUser(e),window.channel.unsetUser(e),window._channel.unsetVoiceRequests(e),1===window._channel.getType()){let t,s=window._channel.getName();""===window._channel.getActiveRoom()?t=l()("#hp__Channel__"):(t=l()("#hp__Group__"),s=window._channel.getActiveRoom());const o=P(parseInt((new Date).getTime()/1e3)).split(",")[0];let r="";i!==n&&(r+=`<div class="dayBanner frm ts ${window.i18n.get("today")}"><span class="msgd sxs pl10 pr10 pt5 pb5 tg">${window.i18n.get("today")}</span></div>`),r+=`<div class="msg" d="2" date="${window.i18n.get("today")}"><div class="msgLeft">`,r+=`<div class="msgText pl10" style="padding-right:0;padding-bottom:15px"><span class="chnMsg" style="font-weight:bold;">${e}</span><span style="font-style:italic;"> ${window.i18n.get("channel-leaved")}</span></div><div class="sxs" style="padding:5px;">${o}</div></div></div>`,null!==s&&t.append(r)}window._recorderCtrl&&window._recorderCtrl.isStarted()&&window.recordChatInOut&&window._recorderCtrl.notifyPart(e),window._channel.getMediaVoiceUsers().includes(e)&&window._channel.unsetMediaVoiceUser(e),window._channel.getVoiceUsers().includes(e)&&window._channel.unsetVoiceUser(e),0===window._channel.getVoiceRequests().length&&l()("#channelRequestVoiceMark").hide(),E(`app -> userLeaveCB: username: ${e} reason: ${t}`),l()("#rpchnto .sn").html()===e&&(l()(".chnu").removeClass("bgg"),l()("#rpchnto").hide(),l()("#rpchntx").attr("t",window._engine.currentChannel())),null!==window._engine.currentChannel()&&"-c"===window._engine.currentChannel().slice(-2)&&setTimeout((function(){1===parseInt(l()(`#lpcht_${window._engine.currentChannel()} .lpchp`).html())&&(window._captureCtrl.stop(),setTimeout((function(){window._captureCtrl.stop()}),3e3),window._engine.requestLeaveChannel(window._engine.currentChannel(),""),l()("#top_menu").show(),window.config.showChannelCategoryList?(l()("#chnCategoriesMenu").show(),l()("#channelCategories").show()):(l()("#chnCategoriesMenu").hide(),l()("#channelCategories").hide()),l()("#chni").click())}),2e3),E(`USER LEAVED: ${e} - REASON: ${t}`);const s=e;l()(`#lpchu_${s}`).remove(),l()(`#voice_${s}`).remove(),delete window.lChannelVoices[s],delete window.lChannelUsers[s],window.lChannelOperators[s]?window.aChannelUsers.splice(window.aChannelUsers.indexOf(`___${s}`),1):window.aChannelUsers.splice(window.aChannelUsers.indexOf(s),1),window.config.showChannelUserListIcon&&window._channel.getModes().U&&window._engine.requestUserList(window._engine.currentChannel()),l()(".us").removeClass("uss");const o=window._engine.currentChannel(),r=window.breakoutRoom.getRoomType(o);if(window.timerWorker&&"nested"!==r){const t=e.replace("-web","");window.timerWorker.stopTimer(`session-${t}`).then((()=>{window.Events.dispatch("session/timer-control",{event:"stopTimer",user:t})}))}if(window.session.isStarted()){const t=(new Date).getTime()+window.tsDiff,n=e.replace("-web","");window.session.statistics(window.session_id).setUserLeft(n,t)}})),window._engine.callbacks().topicCB((function(e,t,n){E(`app -> topicCB: channel ${e}, ${t} set topic: ${n}`),window._channel.setTopic(n),l()("#rpchnc").html(n)})),window._engine.callbacks().mediaMuteCB((function(e,t,n){console.log(`app -> mediaMuteCB: user ${e} ${n?"muted":"unmuted"} on channel ${t}`),window._channelCtrl.setRemoteMute(n),window.muteFlag=n,n?Zr():Qr()})),window._engine.callbacks().kickedCB((async function(e,t){if(function(e,t){E(`[BreakoutRoom] room "${e}" closed by "${t}"`);const n=window.breakoutRoom.main;return window.breakoutRoom.changeRoom(n),!0}(e,t))return!1;E(`app -> kickedCB: You were kicked from channel ${e} by ${t}`),window._captureCtrl.stop(),setTimeout((function(){window._captureCtrl.stop()}),3e3),window._channelCtrl.reset(),l()("#channelBody").hide(),l()("#top_menu").show(),l()("#channelCategories").show(),l()("#channelList").show(),l()("#channelChatHide").show(),l()("#channelChatShow").hide(),l()("#channelChatTab").hide(),l()("#channelChatTabIcon").removeClass("tb"),l()("#channelBannerArea").show(),l()("#chni").click()})),window._groupEngine.callbacks().kickedCB((function(e,t){E(`groupEngine -> kickedCB: You were kicked from channel ${e} by ${t}`),window._captureCtrl.stop(),setTimeout((function(){window._captureCtrl.stop()}),3e3),l()("#rpchngroupchatback").click()})),window._channel.setOnMediasUpdatedCB((()=>{const e=window._channel.getRecordingDisplay();if("lateral"===e)switch(window._mediaWndsArray.length){case 0:case 1:break;case 2:case 3:case 4:l()("#record_main_sidebar_slots_combo").val("3"),l()("#display-grid").click();break;case 5:l()("#record_main_sidebar_slots_combo").val("4"),l()("#display-grid").click();break;case 6:l()("#record_main_sidebar_slots_combo").val("5"),l()("#display-grid").click();break;case 7:l()("#record_main_sidebar_slots_combo").val("6"),l()("#display-grid").click();break;case 8:l()("#record_main_sidebar_slots_combo").val("7"),l()("#display-grid").click();break;default:l()("#record_main_sidebar_slots_combo").val("8"),l()("#display-grid").click()}else"grid"===e&&l()("#display-grid").click()})),window._engine.callbacks().channelXModeCB((async function(e,t,n){return E(`app -> channelXModeCB: channel: ${e}, mode: ${t}, modeParam: ${n}`),async function(e){const t=e;let n;if("nested"!==t.mode)return!1;if(!t.modeParam)return E("[Breakout Room] XMode: modeParam is undefined"),window.breakoutRoom.xMode=null,window.Events.dispatch("breakout-rooms/options-btn-show"),!1;try{if(n=JSON.parse(t.modeParam),E(`[BreakoutRoom] XModeCB: ${JSON.stringify(n)}`),!n.rooms)return z({errors:[{message:"[BreakoutRooms] XMODE: invalid value!"}]}),!1;window.breakoutRoom.xMode=n,window.breakoutRoom.main=n.main,window.breakoutRoom.allow_change=n.allow_change,window.breakoutRoom.allow_return=n.allow_return,window.breakoutRoom.rooms=n.rooms,window._engine.currentChannel()===n.main&&(window.breakoutRoom.mainTopic=window._channel.getTopic()),await window.Events.dispatch("breakout-rooms/options-btn-show")}catch(e){return console.log(e),!1}const i=window._engine.currentChannel();await async function(e){const t=e;if("nested"!==window.breakoutRoom.getRoomType(t))return!1;const n=window.breakoutRoom.rooms;let i="";for(let e=0;e<n.length;e+=1)t===n[e].c&&(i=n[e].n);return""===i?(console.log(`[BreakoutRoom] bkrUpdateRoom: room "${t}" does not have topic!`),!1):i!==window._channel.getTopic()&&(l()("#rpchnc").html(i),!0)}(i)}({channel:e,mode:t,modeParam:n}),await async function(e,t,n){const i=e,s=t,o=n;let r,a,c,d,u,h,m;const w=p.ENGINE_NICK.replace("-web",""),g=window._channel.isOperator(w),f=window.time.now(),v=window.breakoutRoom.getRoomType(i);if("csm"!==s)return!1;E(`[sessionXModeCB] Processing for channel "${i}"`),window.metaverse.started||l()("#medias").show();try{if(r=JSON.parse(o),d=r.timeout_at,u=r.recording,a=r.session_id,c=r.finish_at,m=c,h=r.owner,!a)return E("XMode (csm): param session_id not defined!"),!1;if(!h)return E("XMode (csm): owner not defined!"),!1}catch(C){return E('Error parsing XMode mode "csm" params!'),!1}l()("#dbint").hide();const b=await session.getActiveSessionInfo(),_=await window.timerWorker.getTimer(`session-${window.session_id}`);if(w===h&&"p"===window._channel.getSuffix()&&p.PERMISSIONS.csm_session_create&&b.active&&!window._recorderCtrl.isStarted()&&!_.started&&!window.session.isReconnecting()){const S=await window.session.getActiveSessionInfo();if(S.session_id){const x=S.session.live_duration?S.session.live_duration:0;await session.finishSession(S.session_id,{live_duration:x}),l()("#record-option-stop").hide(),l()("#record-option-start").show(),l()("#record-option-icon").css("color","")}}u&&window._recorderCtrl.isStarted()?(l()("#session-recording").show(),window.session.showTimer(),l()("#chn-session-start-btn").hide(),window.timeOut&&window.timeOut.stop()):(l()("#session-recording").hide(),window.session.hideTimer(),l()("#user-media-cc").hide(),d<c&&(g&&w!==h||(m=d)));const y=window._channel.getCsmObject();if(y&&y.session_id===a&&y.finish_at<c)return E(`XMode (csm): Ignoring params received: ${JSON.stringify(r)}`),!1;if(window._channel.setCsmObject(r),window.currentSession[a]||(window.currentSession[a]={},window.currentSession[a].start=f),window.currentSession[a].finish=m,window.currentSession[a].finishAt=c,window.session_id=a,w!==h)return!u&&m>f&&(g&&"nested"!==v&&"p"!==window._channel.getSuffix()?(l()("#chn-session-is-active-btn").show(),l()("#rpchnhi").hide()):g&&l()("#chn-session-is-active-btn").hide()),setTimeout((function(){l()("#dbint_counter").html("");const e=window.currentSession[a].start,t=window._channel.getCsmObject().recording;if(!t&&f-e>5e3&&m>f){if(window.softCountdown&&window.softCountdown.stop(),window.session.setRunning(!0),window.session.hideTimer(),g&&"nested"!==v&&"p"!==window._channel.getSuffix()?(l()("#chn-session-is-active-btn").show(),l()("#rpchnhi").hide()):g&&(l()("#chn-session-is-active-btn").hide(),l()("#rpchnhi").hide()),window.currentSession[a].finish-f-window.tsDiff>5e3&&1===window._channel.getType()){const e=window._engine.currentChannel();window.breakoutRoom.getRoomType(e),l()("#dbint").show()}const e=function(e){l()("#dbint_counter").html(e)},t=function(){l()("#dbint").hide(),g&&(l()("#chn-session-is-active-btn").hide(),window.metaverse.started||window.Events.dispatch("session/show-session-start-btn"),l()("#rpchnhi").hide())};let n=window.currentSession[a].finish-f-window.tsDiff-4500;return g&&(n=window.currentSession[a].finishAt-f-window.tsDiff-4500),window.softCountdown=new G(n,e,t),window.softCountdown.start(),!1}if(window.softCountdown&&window.softCountdown.stop(),l()("#dbint").hide(),l()("#chn-session-continue-btn").hide(),l()("#chn-session-stop-btn").hide(),t&&(window.timeOut&&window.timeOut.stop(),l()("#session-recording").show()),g)if(t){if(r.recording){window.session.setRunning(!0),l()("#chn-session-start-btn").hide(),"nested"!==v&&"p"!==window._channel.getSuffix()?l()("#chn-session-is-active-btn").show():l()("#chn-session-is-active-btn").hide(),"meeting"!==v&&"nested"!==v&&l()("#rpchnhi").show(),window.softCountdown&&window.softCountdown.stop();const e=function(e){l()("#session-timer-value").html(e)},t=function(){window.session.hideTimer(),l()("#chn-session-is-active-btn").hide(),window.metaverse.started||window.Events.dispatch("session/show-session-start-btn"),l()("#rpchnhi").hide()};window.softCountdown=new G(m-f-window.tsDiff-4500,e,t),window.softCountdown.start(),window.session.showTimer()}}else window.softCountdown&&window.softCountdown.stop(),window.metaverse.started||window.Events.dispatch("session/show-session-start-btn"),l()("#chn-session-is-active-btn").hide(),window.session.hideTimer();return window.metaverse.started||l()("#medias").show(),!1}),5e3),!1;if(m<=f){const k=await window.session.getSessionInfo(window.session_id);if("finished"!==k.status){await window.session.continueSession(k),await window.session.startUserListUpdate();const M=await window.timerWorker.getTimers("session-"),T=Object.entries(M);for(let R=0;R<T.length;R+=1){const A=T[R][0].replace("session-","");let $=A;window._channel.getUser(A)&&($=window._channel.getUser(A).fullname?.trim()||A);const L=T[R][1];await window.session.statistics(window.session_id).setUserTime($,A,L)}async function I(){return l()("#chn-session-stop-btn").click(),!1}await I()}window.softCountdown&&(window.session.hideTimer(),window.softCountdown.stop(),window.session.setRunning(!1)),l()("#chn-session-is-active-btn").hide(),window.metaverse.started||window.Events.dispatch("session/show-session-start-btn"),l()("#chn-session-continue-btn").hide(),l()("#chn-session-stop-btn").hide(),"p"===window._channel.getSuffix()?l()("#rpchnhi").show():l()("#rpchnhi").hide(),l()("#session-download").is(":visible")||(l()("#rpchnconf").hide(),l()("#rpchnconficon").removeClass("tb"),l()("#rpchnhi").removeClass("ic_collaborate_ON"),"meeting"!==v&&l()(".dialog").hide())}else{if(window.session.isStarted())l()("#chn-session-continue-btn").hide(),setTimeout((function(){if(!l()("#chn-session-start-btn").is(":visible")){const e=window._channel.getSuffix(window._engine.currentChannel());l()("#chn-session-stop-btn").html(window.i18n.get("session-stop")),"p"!==e&&l()("#chn-session-stop-btn").show(),l()("#chn-session-continue-btn").hide()}}),5e3);else{"p"===window._channel.getSuffix()?l()("#chn-session-continue-btn").hide():l()("#chn-session-continue-btn").show();const P=async()=>{const e=await window.session.getSessionInfo(window.session_id);if("finished"!==e.status){await window.session.continueSession(e),await window.session.startUserListUpdate();const t=await window.timerWorker.getTimers("session-"),n=Object.entries(t);for(let s=0;s<n.length;s+=1){const o=n[s][0].replace("session-","");let r=o;window._channel.getUser(o)&&(r=window._channel.getUser(o).fullname?.trim()||o);const a=n[s][1];await window.session.statistics(window.session_id).setUserTime(r,o,a)}async function i(){return l()("#chn-session-stop-btn").click(),!1}await i()}l()("#chn-session-continue-btn").hide(),l()("#chn-session-stop-btn").hide(),window.session.hideTimer(),l()("#chn-session-is-active-btn").hide(),window.metaverse.started||window.Events.dispatch("session/show-session-start-btn"),"p"===window._channel.getSuffix()?l()("#rpchnhi").show():l()("#rpchnhi").hide()},D=null;window.timeOut=new G(m-f-window.tsDiff,D,P),window.timeOut.start()}l()("#chn-session-start-btn").hide(),l()("#chn-session-is-active-btn").hide(),l()("#rpchnhi").hide()}return!1}(e,t,n),"metaverse"===t&&"0"===window.metaverseFixedId&&(window.metaverse.xMode=n,await window.metaverse.processXMode(n),!1)})),window._engine.callbacks().channelModesCB((function(e,t,n,i,s){E(`app -> channelModesCB: channel: ${e}, mode: ${t}, modeParam: ${n}, flags: ${i}, modes: ${JSON.stringify(s)}`);const o=t.split(" "),r=p.ENGINE_NICK;if("+v"===o[0]?(window._engine.isMediaVoice()&&p.ENGINE_NICK===o[1]?window._channel.setMediaVoiceUser({owner:o[1]}):window._channel.setVoiceUser({owner:o[1]}),l()(`#lpchu_${o[1]} .chnu_m`).addClass("tb"),window.lChannelVoices[o[1]]=1,N()):"-v"===o[0]&&(window._channel.unsetMediaVoiceUser(o[1]),window._channel.unsetVoiceUser(o[1]),l()("#rpchnhi").hasClass("tb")&&r===o[1]&&l()("#rpchnhi").removeClass("ic_collaborate_ON tb"),l()(`#lpchu_${o[1]} .chnu_m`).removeClass("tb"),delete window.lChannelVoices[o[1]],N()),"-o"===o[0]){const e=o[1];window._channel.getMediaVoiceUsers().includes(e)&&window._channel.unsetMediaVoiceUser(e),window._channel.getVoiceUsers().includes(e)&&window._channel.unsetVoiceUser(e),window._channel.unsetOperator(o[1]),1===window._channel.getType()&&(window._channel.unsetRoomOperator(o[1]),window.Events.dispatch("channel/user-list-icon-click"))}switch("-g"===o[0]&&window._channel.unsetModerator(o[1]),o[0]){case"+a":window._channel.setMode("a");break;case"-a":window._channel.unsetMode("a");break;case"+A":window._channel.setMode("A");break;case"-A":window._channel.unsetMode("A");break;case"+c":window._channel.setMode("c");break;case"-c":window._channel.unsetMode("c");break;case"+C":l()("#medias").html(""),window._channel.setJustEntered(!0),window._youtubeCtrl.reset(),window._windowCtrl.redrawWindows();break;case"-C":l()("#youtube-area").remove(),window._channel.unsetWindows(),l()("#medias").html(""),window._channel.setJustEntered(!0),window._youtubeCtrl.reset(),window._windowCtrl.redrawWindows();break;case"+d":window._channel.setMode("d");break;case"-d":window._channel.unsetMode("d");break;case"+G":window._channel.setMode("G");break;case"-G":window._channel.unsetMode("G");break;case"+I":window._channel.setMode("I");break;case"-I":window._channel.unsetMode("I");break;case"+m":window._channel.setMode("m"),l()("#rpchnmoderateicon").html("voice_over_off"),l()("#rpchnmoderatelabel").html(window.i18n.get("unblock-chat"));break;case"-m":window._channel.unsetMode("m"),l()("#rpchnmoderateicon").html("&#xE91F;"),l()("#rpchnmoderatelabel").html(window.i18n.get("block-chat"));break;case"+M":window._channel.setMode("M");break;case"-M":window._channel.unsetMode("M");break;case"+N":window._channel.setMode("N");break;case"-N":window._channel.unsetMode("N");break;case"+q":window._channel.setMode("q");break;case"-q":window._channel.unsetMode("q");break;case"+T":window._channel.setMode("T");break;case"-T":window._channel.unsetMode("T");break;case"+U":window._channel.setMode("U"),l()(".channelAdmUserList").show(),window._engine.requestUserList(window._engine.currentChannel());break;case"-U":window._channel.unsetMode("U"),window._engine.requestUserList(window._engine.currentChannel());break;case"+V":window._channel.setMode("V");break;case"-V":window._channel.unsetMode("V")}window.aChannelOperators=[],window.lChannelOperators={},l()(`#lpchu_${window.engineNick}_key`).html(""),l()(`#lpchu_${window.engineNick}_key`).css("margin-left","0px"),l()(".chnu_x").hide(),l()(".chnu_m").hide(),l()(".chnu_h").hide(),l().each(s,(function(t){const n=s[t];if("C"===n.mode)try{const e=JSON.parse(n.modeParam);if(window.youtubeParams=e,E(`ChannelModeCB (+C): ${JSON.stringify(e)}`),e.wf)window._channel.setWindows(e),window._windowCtrl.redrawWindows();else if(window._channel.justEntered()){l()("#youtube-area").remove(),l()("#medias").prepend('<div id="youtube-area" class="mediahover fc w100" style="height:inherit;maxHeight:inherit;position:relative;" ><div id="player" class="h100 w100"></div><div class="w100 bgb fr fic"><div class="p10 tw sx" style="min-height:48px;">Youtube</div><div class="fig"></div><div><div id="mediaexpand-2" class="mediaexpand mediaexpand-2 sxxl p10 tw material-icons" style="display: none;" mediaid="-2" mediaexpandon="0">&#xE56B;</div></div></div>'),window._channel.setYoutube({container:"",metadata:{mediaId:-2,active:1}});const e=n.modeParam&&n.modeParam.length>0?JSON.parse(n.modeParam):null,t=n.add&&e&&e.yt?e.yt:null;t&&(t.timeElapsed=n.timeElapsed),window._youtubeCtrl.init(t),window._channel.setJustEntered(!1)}}catch(e){E(`Mode "${n.mode}" error: ${e}`)}if("o"===n.mode&&(window._channel.setOperator(n.modeParam),window.Events.dispatch("modes/set-operator",{channel:window._engine.currentChannel(),user:n.modeParam}),window.config.showChannelMoreSettings?l()("#rpchnad").show():l()("#rpchnad").hide(),window.aChannelOperators.push(n.modeParam),window.lChannelOperators[n.modeParam]=n.modeParam,n.modeParam!==window.engineNick&&n.modeParam!==p.NICK||(window._channel.getModes().U&&(window.config.showChannelUserListIcon?""===window._channel.getActiveRoom()&&(l()(".channelAdmUserList").show(),window._engine.requestUserList(e)):l()(".channelAdmUserList").hide()),l()(`#lpchu_${window.engineNick}_key`).html("&#xE0DA;"),l()(`#lpchu_${window.engineNick}_key`).css("margin-left","-15px"),l()(`#lpchu_${window.engineNick}_key`).addClass("z9"),l()(".chnu_x").show(),window.config.messenger&&""!==window.engineNick&&(window.config.showChannelUserListIcon?l()(".channelAdmUserList").show():l()(".channelAdmUserList").hide()))),"w"===n.mode&&(window._channel.setOwner(n.modeParam),window.channelOwner=n.modeParam),"b"===n.mode&&window._channel.setBannedUser(n.modeParam),"g"===n.mode&&window._channel.setModerator(n.modeParam),"U"===n.mode&&(l()(".channelAdmUserList").show(),window._channel.getModes().U||(window._channel.setMode("U"),window.config.showChannelUserListIcon&&""===window._channel.getActiveRoom&&window._engine.requestUserList(window._engine.currentChannel())),0===window._channel.getUsers().length&&(""===window._channel.getActiveRoom()?window._engine.requestUserList(window._engine.currentChannel()):window._groupEngine.requestUserList(window._engine.currentChannel()))),"A"===n.mode&&(window._channel.setMode("A"),l()("#rpchnhi").hide()),"x"===n.mode){const e=parseInt(n.modeParam);window.webcamBitrate>e&&(E(`[ChannelModeCB] Webcam bitrate (${window.webcamBitrate}) adjusted to ${n.modeParam}`),window._channel.isOperator(p.NICK)&&e<=128e3||hp(e))}""===n.modeParam&&window._channel.setMode(n.mode),window._channel.getChannelPermissions()}))})),window._groupEngine.callbacks().channelModesCB((function(e,t,n,i){E(`app -> channelModesCB: channel: ${e}, mode: ${t}, modeParam: ${n}, flags: ${i}`);const s=t.split(" ");"-o"===s[0]&&window._channel.unsetRoomOperator(s[1]),window._channel.getChannelPermissions()})),window._engine.callbacks().txStateCB((function(e,t,n,i){E(`app -> txStateCB: txEnabled: ${e}, mediaVoice: ${t}, avconf: ${n}, screen: ${i}`);const s=t;if(null===window._engine.currentChannel())return!1;if(1===e){if(i)return!1;if(!window._channel.isTransmitting()){if(!window.metaverse?.started){if(!window._channel.getModes().A&&!window._channel.isOperator(p.NICK)){const e=window.i18n.get("you-will-start-transmission");return new hr("TransmissÃ£o",`<div style="width:100%;text-align:center;margin-top:10px;margin-bottom:10px;">${e}</div>`,(function(){l()("#input_devices").click()}),(function(){window._engine.requestTransmission(p.ENGINE_NICK,!1,!1)}),"300px").present(),!1}l()("#input_devices").click()}return!1}const t=p.ENGINE_NICK,o=window._channel.getWindows();if(o){if(o.pip!==t&&o.main!==t&&!o.users.includes(t))return!1;new hr(window.i18n.get("do-you-want-to-start-transmission"),"",(function(){window._channelCtrl.setTx(e,s,n,i),window._channel.setInitialTransmission((new Date).getTime()),l()("#rpchnhi").addClass("tb"),l()("#rpchnhi").addClass("ic_collaborate_ON")}),(function(){""===window._channel.getActiveRoom()?window._engine.requestSetChannelMode(window._engine.currentChannel(),"-v",window._engine.nick()):window._engine.requestSetChannelMode(window._groupEngine.currentChannel(),"-v",window._engine.nick()),l()("#rpchnhi").removeClass("tb"),l()("#rpchnhi").removeClass("ic_collaborate_ON")})).present()}else if(1===window._channel.getType()){let t;t=""===window._channel.getActiveRoom()?window._channel.getName():window._channel.getActiveRoom();try{const o=JSON.parse(localStorage.getItem(`room_${t}`)).txCredit;let r=parseInt(o/60/60);"0"===r&&(r="00");let a=parseInt((o-60*parseInt(r)*60)/60)<10?`0${parseInt((o-60*parseInt(r)*60)/60)}`:parseInt((o-60*parseInt(r)*60)/60);"0"===a&&(a="00");let c=o-60*parseInt(r)*60-60*parseInt(a)<10?"0"+(o-60*parseInt(r)*60-60*parseInt(a)):o-60*parseInt(r)*60-60*parseInt(a);"0"===c&&(c="00"),0===parseInt(r)?r="":r+=":",window._channelCtrl.setTx(e,s,n,i),l()("#rpchnhi").addClass("tb"),l()("#rpchnhi").addClass("ic_collaborate_ON")}catch(e){E(`TxStateCB error: ${e}`)}}else i||(l()("#rpchnhi").addClass("tb"),l()("#rpchnhi").addClass("ic_collaborate_ON"),window._channelCtrl.setTx(e,s,n,i))}else window._channel.unsetTransmitting(),window._channelCtrl.setTx(e,s,n,i),window._captureCtrl.stop(),window._channel.stopTransmission(),window._channel.unsetTransmitting(),l()("#rpchnhi").removeClass("tb"),l()("#rpchnhi").removeClass("ic_collaborate_ON"),l()(".dialog").hide();return!1})),window._engine.callbacks().mediaStateCB((function(e,t,n){window._channelCtrl.onMediaState(e,t,n)})),window._engine.callbacks().userModesCB((function(e,t){E(`app -> userModesCB: mode: ${e}, flags: ${t}`)})),window._engine.callbacks().channelInfoCB((function(e,t,n){if(""!==window.channelToGo){window.channelToGo="";const n=window._channel.getChannel(e).avatar_id||"";0!==t&&zr({channel:e,name:e,users:0,imgSrc:`${window.files_base_url}avatars/channel/${e}/thumb.jpeg?${n}`})}l()(`#lpcht_${window._engine.currentChannel()} .lpchp`).html(M(n)),l()("#rpchnp").html(M(n)),window._channel.setUsersCount(n)})),window._engine.callbacks().localStreamCB((function(e,t,n,i){window._channelCtrl.setLocalStream(e,t,n,i)})),window._engine.callbacks().localStreamTrackEndedCB((function(e,t,n,i){window._channelCtrl.setLocalStreamTrackEnded(e,t,n,i)})),window._engine.callbacks().terminatedCB((e=>{if(E(`[MyHeart] TerminatedCB - flags:${e}`),15===e){const e=window.i18n.get("title-session-expired"),t=window.i18n.get("session-expired"),n=window.i18n.get("text-button-session-expired");new ur('<svg width="30" height="31" viewBox="0 0 30 31" fill="none" xmlns="http://www.w3.org/2000/svg"> <mask id="mask0_496_3959" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="30" height="31"> <rect y="0.725159" width="29.5497" height="29.5497" fill="#D9D9D9"/> </mask> <g mask="url(#mask0_496_3959)"> <path d="M3.35506 26.5811C3.12933 26.5811 2.92413 26.5247 2.73944 26.4118C2.55476 26.299 2.41111 26.1502 2.30851 25.9655C2.20591 25.7808 2.14948 25.5808 2.13921 25.3653C2.12895 25.1498 2.18539 24.9395 2.30851 24.7343L13.6974 5.03449C13.8206 4.82929 13.9796 4.67538 14.1746 4.57278C14.3695 4.47018 14.5696 4.41888 14.7748 4.41888C14.98 4.41888 15.1801 4.47018 15.375 4.57278C15.57 4.67538 15.729 4.82929 15.8521 5.03449L27.241 24.7343C27.3642 24.9395 27.4206 25.1498 27.4103 25.3653C27.4001 25.5808 27.3437 25.7808 27.241 25.9655C27.1384 26.1502 26.9948 26.299 26.8101 26.4118C26.6254 26.5247 26.4202 26.5811 26.1945 26.5811H3.35506ZM14.7748 22.8874C15.1236 22.8874 15.416 22.7694 15.652 22.5334C15.888 22.2975 16.006 22.005 16.006 21.6562C16.006 21.3073 15.888 21.0149 15.652 20.7789C15.416 20.5429 15.1236 20.4249 14.7748 20.4249C14.4259 20.4249 14.1335 20.5429 13.8975 20.7789C13.6615 21.0149 13.5435 21.3073 13.5435 21.6562C13.5435 22.005 13.6615 22.2975 13.8975 22.5334C14.1335 22.7694 14.4259 22.8874 14.7748 22.8874ZM14.7748 19.1937C15.1236 19.1937 15.416 19.0757 15.652 18.8397C15.888 18.6037 16.006 18.3113 16.006 17.9625V14.2688C16.006 13.9199 15.888 13.6275 15.652 13.3915C15.416 13.1555 15.1236 13.0375 14.7748 13.0375C14.4259 13.0375 14.1335 13.1555 13.8975 13.3915C13.6615 13.6275 13.5435 13.9199 13.5435 14.2688V17.9625C13.5435 18.3113 13.6615 18.6037 13.8975 18.8397C14.1335 19.0757 14.4259 19.1937 14.7748 19.1937Z" fill="#FF8C05"/> </g> </svg>',e,t,n,(()=>{window._app.logout()}),void 0,500).present(),l()("#block").hide()}if(e===Nl.MYHEART_IRM_DESTROY_CODE_RECONNECTING){l()(".dialog").hide();const e=window.i18n.get("attention"),t=window.i18n.get("irm-nick-conflit");new dr(e,t,(()=>{l()(".dialog").hide(),window._app.logout()}),void 0,500).present()}return!1})),window._engine.callbacks().slowLinkCB((e=>{E(`app -> slowLinkCB : mediaId:${e}`)})),window._engine.callbacks().publisherStateCB((e=>{E(`app -> publisherStateCB : on:${e}`),window._channelCtrl.publisherState(e)})),window._engine.callbacks().publisherConnectingCB((()=>{E("app -> publisherConnectingCB"),window._channelCtrl.publisherConnecting()})),window._engine.callbacks().networkAlertCB((()=>{})),window._engine.callbacks().statsUpdateCB(((e,t)=>{t.inbound.video.active,console.log()}))}const xp=n(1480);function kp(){Ep(),l()("#channelMsgCounter").click((function(){if(window._channel.getMode("m")&&""===window._channel.getActiveRoom())E("Channel Mode = m (moderated)"),window._channel.getChannelPermissions();else{let e,t;e=0===window._channel.getType()&&""===window._channel.getActiveRoom()?"channel_":"room_",t=""===window._channel.getActiveRoom()?JSON.parse(localStorage.getItem(e+window._channel.getName())):JSON.parse(localStorage.getItem(e+window._channel.getActiveRoom())),0!==t.todayMsgCredit&&(l()("#channelMsgAlert").hide(),l()("#channelMsgCounter").hide(),l()("#channelInputArea").hide(),l()("#channelGroupInputArea").hide(),""===window._channel.getActiveRoom()?l()("#channelInputArea").show():l()("#channelGroupInputArea").show(),l()("#rpchntx").focus())}})),l()("#channelArea").on("click",".grouproom",(function(){window.lastDate=void 0,k("wait"),l()("#channelMsgAlert").hide(),l()("#channelInputArea").hide(),function(e){const t=e.channel,n=p.ROOM[t].oper;for(let e=0;e<n.lenght;e+=1)window._channel.setRoomOperator(n[e]);l()("#rpchngrouplist").hide(),l()("#hp__Group__").html(""),l()("#hp__Group__").show(),l()("#rpchngroupchat").show(),l()("#channelGroupInputArea").show(),l()("#rpchngroupchatname").html(e.topic),window._groupEngine.isStarted()&&(window._groupEngine.requestLeaveChannel(),window._groupEngine.stop()),window._groupEngine.callbacks().connectCB((function(){})),window._groupEngine.callbacks().startedCB((function(t,n,i,s,o){E(`app -> startedCB: ${p.NICK} SIGNED IN : srvClientId:${t}, server:${n}, acsNick:${i}, ppcsNick:${s}`),window.Events.dispatch("myheart/started-cb",{srvClientId:t,serverName:n,acsNick:i,ppcsNick:s,prevchannel:o});const r=e.password?e.password:"";window._channel.unmuteVideo(),window.devices.unmuteVideoDevice(),window._channel.unmuteAudio(),window.devices.unmuteAudioDevice(),window._groupEngine.requestEnterChannel(e.channel,r)}));const i="-l"===e.channel.slice(-2)?e.channel.slice(0,-2):e.channel;let s,o,r,a;1===i.length?(s=i.slice(0,1).charCodeAt(0),o=0,r=i.slice(0,1).charCodeAt(0),a=0):(s=i.slice(0,1).charCodeAt(0),o=i.slice(1,2).charCodeAt(0),r=i.slice(-1).charCodeAt(0),a=i.slice(i.length-2,i.length-1).charCodeAt(0));const c=(s+3*o+7*r+11*a)%window.roomsServers.length;let d=parseInt(window.roomsServers[c].split(":")[1]-14557);445===d&&(d=451);const u=`${window.roomsServers[c].split(":")[0]}:${d}`;E(`Group room Server: ${u}`),window._app.startGroupJanus(`wss://${u}`)}({channel:l()(this).attr("grouproom"),name:l()(this).attr("name"),topic:l()(this).attr("grouptopic"),imgSrc:l()(this).attr("imgsrc")}),setTimeout((function(){"wait"===x()&&k("auto")}),1e4)})),l()("#rpchni").on("error",(function(){l()(this).attr("src",`${window.assets}/common/img/avatarPerson.png`)})),l()(".user-request-label").on("click",(()=>{l()("#user-request").is(":visible")?(l()("#user-request").hide(),l()("#user-request-arrow").html("arrow_right")):(l()("#user-request").show(),l()("#user-request-arrow").html("arrow_drop_down"))})),l()(".user-list-label").on("click",(()=>{l()("#user-list").is(":visible")?(l()("#user-list").hide(),l()("#user-list-arrow").html("arrow_right")):(l()("#user-list").show(),l()("#user-list-arrow").html("arrow_drop_down"))})),l()("#channelChatTabIcon").click((function(){l()(this).hasClass("tb")?(l()("#channelChatTab").hide(),l()("#channelChatTabIcon").removeClass("tb")):(l()("#channelChatTab").show(),l()("#channelChatTabIcon").addClass("tb"))})),l()("#chnchhtabtitle").click((function(){l()("#channelChatTabIcon").click()})),l()("#rpchninvite").on("click",(()=>{if("-g"===window._channel.getName().substr(-2))return!1})),l()("#rpchnmoderate").click((function(){window._channel.getModes().m?window._engine.requestSetChannelMode(window._channel.getName(),"-m",""):window._engine.requestSetChannelMode(window._channel.getName(),"+m",""),l()("#rpchnconf").hide(),l()("#rpchnconficon").removeClass("tb")})),l()("#rpchnnotification").click((function(){if(null===window._engine.currentChannel())return!1;const e=0===window._channel.getType()?"channel":"room",t=window.i18n.get("send-notification"),n=`${window.i18n.get("message")}:<br /><textarea name="notificationText" id="notificationText" class="sn bor br p5" rows="4" maxlength="250" style="width:inherit;"></textarea>`;return new hr(t,n,(()=>{const t=window._channel.getTopic(),n=l()("#notificationText").val().substring(0,250),i=window._engine.currentChannel();return l().post(`/g/notify${window.location.search}`,{data:{type:e,title:t,text:n,target:i}},(function(e){E(JSON.stringify(e))})),l()("#rpchnconf").hide(),l()("#rpchnconficon").removeClass("tb"),!1}),(()=>(l()("#rpchnconf").hide(),l()("#rpchnconficon").removeClass("tb"),!1))).present(),!1})),l()("#rpchnscreensaving").click((function(){return null===window._engine.currentChannel()||(window.localScreen?.started()?(window.localScreen.stop(),window._channel.stopDefaultRecording(),l()("#screen-saving-status").html(window.i18n.get("disabled"))):l()("#local_screen_btn").click(),E("screen saving click")),!1})),l()("#rpchngroupchatback").click((function(){window._groupEngine.currentChannel()&&window._groupEngine.requestLeaveChannel(window._groupEngine.currentChannel(),""),window._groupEngine.stop(),l()("#channelMsgCounter").hide(),l()("#channelMsgAlert").hide(),l()("#channelAdmGroup").click(),p.CONFIG.showChannelUserListIcon&&window._channel.getModes().U&&l()(".channelAdmUserList").show()})),l()(".channelShareScreen").click((function(){if(l()("#rpchnconfhide").click(),window._engine.isTxEnabled()){if(window._channel.getScreenSharingWaitingUserStart()){window._channel.setScreenSharingWaitingUserStart(!1);const e=window.screenFramerate||5,t=window.screenBitrate||256e3;return window._engine.publishScreen(t,e,void 0,!0),!1}window._engine.toggleScreen()?(window._channel.setSharingState(!0),l()("#rpchnhi").addClass("tb"),l()("#rpchnhi").addClass("ic_collaborate_ON"),l()("#channelShareScreenIcon").addClass("tb"),l()(".channelShareScreen").addClass("tb"),l()("#channelAdmUsers").removeClass("tb"),l()("#channelAdmRaisedHands").removeClass("tb"),l()("#lpchu").html(""),l()("#channelVoiceUsers").html(""),l()("#lpchu").hide(),l()("#channelVoiceUsers").hide(),l()("#channelShareScreen").show()):(window._windowCtrl.stopMirrorScreen(),l()("#channelShareScreenIcon").removeClass("tb"),l()(".channelShareScreen").removeClass("tb"))}else E("cannot toggle screen state since user tx is off")})),l()("#control-screensharing").click((function(){if(l()("#control-more-area").hide(),l()("#control-display").css("background-color","#707070"),l()("#control-screensharing").attr("clicked"))return!1;if(l()("#control-screensharing").attr("clicked","true"),setTimeout((()=>{l()("#control-screensharing").attr("clicked","")}),700),window._engine.isTxEnabled()){if(window._channel.getScreenSharingWaitingUserStart()){window._channel.setScreenSharingWaitingUserStart(!1);const e=window.screenFramerate||5,t=window.screenBitrate||256e3;return window._engine.publishScreen(t,e,void 0,!0),!1}window._channel.getScreen()?l()("#control-screensharing-stop").is(":visible")?l()("#control-screensharing-stop").hide():l()("#control-screensharing-stop").show():(window._engine.toggleScreen()||setTimeout((function(){window._engine.toggleScreen()}),400),l()("#control-screensharing-stop").hide(),window._channel.setSharingState(!0),l()("#rpchnhi").addClass("tb"),l()("#rpchnhi").addClass("ic_collaborate_ON"),l()("#channelShareScreenIcon").addClass("tb"),l()(".channelShareScreen").addClass("tb"),l()("#channelAdmUsers").removeClass("tb"),l()("#channelAdmRaisedHands").removeClass("tb"),l()("#lpchu").html(""),l()("#channelVoiceUsers").html(""),l()("#lpchu").hide(),l()("#channelVoiceUsers").hide(),l()("#channelShareScreen").show())}else E("cannot toggle screen state since user tx is off");return!1})),l()("#control-screensharing-stop").on("click",(function(){window._engine.toggleScreen(),window._windowCtrl.stopMirrorScreen(),l()("#channelShareScreenIcon").removeClass("tb"),l()(".channelShareScreen").removeClass("tb"),l()("#control-screensharing-stop").hide(),l()("#control-screensharing").css("background-color","#707070")})),l()("#control-display").click((function(){window._channel.getClosedCaption()?l()("#cc-status").html(window.i18n.get("closed-caption-activated")):l()("#cc-status").html(window.i18n.get("closed-caption-deactivated")),l()("#control-screensharing-stop").hide(),l()("#control-more-area").is(":visible")?(l()("#control-more-area").hide(),l()("#control-display").css("background-color","#707070")):(l()("#control-more-area").show(),l()("#control-display").css("background-color","#38B2F1"))})),l()("#record-option").on("click",(function(){const e=p.ENGINE_NICK;if(!window._channel.isOperator(e))return!1;l()("#control-more-area").hide(),l()("#control-display").css("background-color","#707070"),window._recorderCtrl.isStarted()?(window._channel.stopDefaultRecording(),l()("#record-option-stop").hide(),l()("#record-option-start").show(),l()("#record-option-icon").css("color","")):(window._channel.startDefaultRecording(),l()("#record-option-icon").css("color","red"),l()("#record-option-stop").show(),l()("#record-option-start").hide(),setTimeout((()=>{window._engine.publish()}),6e3))})),l()("#display-define-layout").on("click",(()=>{"staging"!==window.realm&&"school"!==window.realm&&l()("#record_cc_checkbox").parent().hide(),l()("#rec-options").show();const e=window._channel.getRecordingDisplay();"main"===e?l()("#display-main").click():""===e||"lateral"===e?l()("#display-lateral").click():"grid"===e&&l()("#display-grid").click(),l()("#control-more-area").hide(),l()("#control-display").css("background-color","#707070"),l()(".dialog").hide(),l()("#dbdisplay-layout").show(),l()(".modal").show(),l()("#dialog").show()})),l()("#display-layout-cancel").on("click",(()=>{l()(".dialog").hide(),l()("#dbdisplay-layout").hide(),l()(".modal").hide(),l()("#dialog").hide()})),l()("#display-layout-apply").on("click",(()=>{const e=l()('input[name="display-layout"]:checked').val();window._channel.setRecordingDisplay(e),""===e||"main"===e?window.Events.dispatch("record/start","main"):"lateral"===e?window.Events.dispatch("record/start","sidebar"):"grid"===e&&window.Events.dispatch("grid"),l()("#record_cc_checkbox").is(":checked")&&(window._channel.getClosedCaption()||(window._channel.setClosedCaption(!0),l()("#cc-status").html(window.i18n.get("closed-caption-activated")),window._channelCtrl.speechRecognitionStart(),l()("#media-cc").show(),window.resizeMedia.update(),l()("#control-more-area").hide(),l()("#control-display").css("background-color","#707070"))),l()("#record_inout_checkbox").is(":checked")?window.recordChatInOut=!0:window.recordChatInOut=!1,l()(".dialog").hide(),l()("#dbdisplay-layout").hide(),l()(".modal").hide(),l()("#dialog").hide()})),l()("#rpchncl").click((function(){if(!window._channel.isOperator(p.ENGINE_NICK))return!1;let e=window.location.origin;p.CONFIG.shortName&&(e=`https://${p.CONFIG.shortName}-app.ip.tv`);const t=1===window._channel.getType()?"room":"channel",n=window._channel.getName();return window.location.search?e+=`/${window.location.search}&${t}=${n}`:e+=`/?${t}=${n}`,E(`[Channel Link Copy] link = ${e}`),l()("#rpchnconficon").click(),navigator.clipboard.writeText(e).then((function(){window._channel.showTemporaryMessage(window.i18n.get("channel-link-copy-message"),2)}),(function(e){window._channel.showTemporaryMessage(window.i18n.get("channel-link-copy-error"),4)})),!1})),l()("#rpchnmi").click((function(){return l()("#input_devices").attr("from","config"),l()("#input_devices").click(),!1})),l()("#rpchnad").click((function(){const e=p.CONFIG.webcamMinBitrate||64,t=p.CONFIG.webcamMaxBitrate||2048,n=p.CONFIG.screenMinBitrate||256,i=p.CONFIG.screenMaxBitrate||6144,s=[64,128,256,512,1024,2048,3072,4096,5120,6144],o=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],r=["64 kbps","128 kbps","256 kbps","512 kbps","1 Mbps","2 Mbps","3 Mbps","4 Mbps","5 Mbps","6 Mbps"];l()("#webcam-bitrate").html(""),l()("#screen-bitrate").html(""),l()("#screen-framerate").html("");for(let o=0;o<s.length;o+=1){if(s[o]>=e&&s[o]<=t){let e=`<option value="${s[o]}">${r[o]}</option>`;s[o]===window.webcamBitrate&&(e=`<option value="${s[o]}" selected>${r[o]}</option>`),l()("#webcam-bitrate").append(e)}if(s[o]>=n&&s[o]<=i){let e=`<option value="${s[o]}">${r[o]}</option>`;s[o]===window.screenBitrate&&(e=`<option value="${s[o]}" selected>${r[o]}</option>`),l()("#screen-bitrate").append(e)}}window.screenFramerate||(window.screenFramerate=5);for(let e=0;e<o.length;e+=1){let t=`<option value="${o[e]}">${o[e]} fps</option>`;o[e]===window.screenFramerate&&(t=`<option value="${o[e]}" selected>${o[e]} fps</option>`),l()("#screen-framerate").append(t)}return l()("#rpchnconficon").removeClass("tb"),l()("#rpchnconf").hide(),l()(".dialog").hide(),l()("#dbadv").show(),l()(".modal").show(),l()("#dialog").show(),!1})),l()("#rpchntut").click((function(){1===window._channel.getType()&&p.CONFIG.showRoomTutorial&&(window.tutorial=new Sp(p.CONFIG.roomTutorial[0]),window.tutorial.start()),l()("#rpchnconficon").removeClass("tb"),l()("#rpchnconf").hide()})),l()("#dbadv_cancel").on("click",(()=>{l()(".dialog").hide(),l()("#dbadv").hide(),l()(".modal").hide()})),l()("#dbadv_confirm").on("click",(()=>{const e=parseInt(l()("#webcam-bitrate").val()),t=parseInt(l()("#screen-bitrate").val());window.screenFramerate=parseInt(l()("#screen-framerate").val()),window.webcamBitrate!==e&&(hp(e),E(`Webcam bitrate changed from ${window.webcamBitrate} to ${e}`)),window.screenBitrate!==t&&(pp(t),E(`Screensharing bitrate changed from ${window.screenBitrate} to ${t}`)),l()(".dialog").hide(),l()("#dbadv").hide(),l()(".modal").hide()})),l()("#rpchnyt").on("click",(()=>{switch(window.youtubePlaylist=window._youtubeCtrl.playlist(),window.youtubePlaylistTemp=JSON.parse(JSON.stringify(window._youtubeCtrl.playlist())),window.youtubeParamsTemp=window.youtubeParams,l()("#yt-new-board").show(),l()("#yt-playlist-body").html(""),l()("#yt-playlist-board").hide(),l()("#yt-config-board").hide(),l()("#yt-new-update").hide(),l()("#yt-new-search").show(),l()("#yt-input").prop("readonly",!1),l()("#yt-input").val(""),l()("#rpchnconfhide").click(),l()("#yt-preview-content").hide(),l()("#yt-preview-no-content").show(),l()(".item").removeClass("item-selected"),l()("#yt-new").addClass("item-selected"),l()(".dialog").hide(),l()("#dbyt").show(),l()(".modal").show(),l()("#dialog").show(),l()("#yt-input").focus(),l()("#yt-load-error").html(""),l()("#yt-load-error").hide(),window.youtubeParams?window.youtubeParams.yt.f:7){case 0:default:l()("#yt-checkbox0").prop("checked",!1),l()("#yt-checkbox1").prop("checked",!1),l()("#yt-checkbox2").prop("checked",!1),l()("#yt-checkbox3").prop("checked",!1);break;case 1:l()("#yt-checkbox0").prop("checked",!0),l()("#yt-checkbox1").prop("checked",!1),l()("#yt-checkbox2").prop("checked",!1),l()("#yt-checkbox3").prop("checked",!1);break;case 2:l()("#yt-checkbox0").prop("checked",!1),l()("#yt-checkbox1").prop("checked",!0),l()("#yt-checkbox2").prop("checked",!1),l()("#yt-checkbox3").prop("checked",!1);break;case 3:l()("#yt-checkbox0").prop("checked",!0),l()("#yt-checkbox1").prop("checked",!0),l()("#yt-checkbox2").prop("checked",!1),l()("#yt-checkbox3").prop("checked",!1);break;case 4:l()("#yt-checkbox0").prop("checked",!1),l()("#yt-checkbox1").prop("checked",!1),l()("#yt-checkbox2").prop("checked",!0),l()("#yt-checkbox3").prop("checked",!1);break;case 5:l()("#yt-checkbox0").prop("checked",!0),l()("#yt-checkbox1").prop("checked",!1),l()("#yt-checkbox2").prop("checked",!0),l()("#yt-checkbox3").prop("checked",!1);break;case 6:l()("#yt-checkbox0").prop("checked",!1),l()("#yt-checkbox1").prop("checked",!0),l()("#yt-checkbox2").prop("checked",!0),l()("#yt-checkbox3").prop("checked",!1);break;case 7:l()("#yt-checkbox0").prop("checked",!0),l()("#yt-checkbox1").prop("checked",!0),l()("#yt-checkbox2").prop("checked",!0),l()("#yt-checkbox3").prop("checked",!1);break;case 8:l()("#yt-checkbox0").prop("checked",!1),l()("#yt-checkbox1").prop("checked",!1),l()("#yt-checkbox2").prop("checked",!1),l()("#yt-checkbox3").prop("checked",!0);break;case 9:l()("#yt-checkbox0").prop("checked",!0),l()("#yt-checkbox1").prop("checked",!1),l()("#yt-checkbox2").prop("checked",!1),l()("#yt-checkbox3").prop("checked",!0);break;case 10:l()("#yt-checkbox0").prop("checked",!1),l()("#yt-checkbox1").prop("checked",!0),l()("#yt-checkbox2").prop("checked",!1),l()("#yt-checkbox3").prop("checked",!0);break;case 11:l()("#yt-checkbox0").prop("checked",!0),l()("#yt-checkbox1").prop("checked",!0),l()("#yt-checkbox2").prop("checked",!1),l()("#yt-checkbox3").prop("checked",!0);break;case 12:l()("#yt-checkbox0").prop("checked",!1),l()("#yt-checkbox1").prop("checked",!1),l()("#yt-checkbox2").prop("checked",!0),l()("#yt-checkbox3").prop("checked",!0);break;case 13:l()("#yt-checkbox0").prop("checked",!0),l()("#yt-checkbox1").prop("checked",!1),l()("#yt-checkbox2").prop("checked",!0),l()("#yt-checkbox3").prop("checked",!0);break;case 14:l()("#yt-checkbox0").prop("checked",!1),l()("#yt-checkbox1").prop("checked",!0),l()("#yt-checkbox2").prop("checked",!0),l()("#yt-checkbox3").prop("checked",!0);break;case 15:l()("#yt-checkbox0").prop("checked",!0),l()("#yt-checkbox1").prop("checked",!0),l()("#yt-checkbox2").prop("checked",!0),l()("#yt-checkbox3").prop("checked",!0)}window.preview&&window.preview.destroy()})),l()("#rpchn-silenced").on("click",(()=>(l()("#rpchnuserbanlist").hide(),l()("#rpchnconfhide").click(),window._engine.requestChannelGetChatMuteUsers(window._channel.getName()),!1))),l()("#btn-MuteAll").on("click",(()=>{"muteMicAll"===l()("#btn-MuteAll").attr("t")&&window._channel.sendRemoteMute("","MIC")})),l()("#rpchn-banned").on("click",(()=>(l()("#rpchnusermutelist").hide(),l()("#rpchnconfhide").click(),window._engine.requestChannelBanList(window._channel.getName()),!1))),l()(".item").click((function(){l()("#yt-preview").html(""),l()("#yt-preview-content").hide(),l()("#yt-preview-no-content").show(),l()("#yt-title-input").val(""),l()("#yt-input").val(""),l()("#yt-new-update").hide(),l()(".item").removeClass("item-selected"),l()("#yt-new-search").show(),l()(this).addClass("item-selected"),l()("#yt-load-error").html(""),l()("#yt-load-error").hide(),window.preview&&window.preview.destroy()})),l()("#yt-new-search").on("click",(function(){switch(window.youtubeInput=l()("#yt-input").val().replace(" ",""),window.youtubeInput.includes("/embed/")&&(window.youtubeInput=window.youtubeInput.split("?")[0].replace("/embed/","/watch?v=")),l()("#yt-input").prop("readonly",!1),window.youtubeId="",window.youtubeTrimUrl="",window.youtubeIsPlaylist=!1,!0){case window.youtubeInput.includes("https://www.youtube.com/watch?v="):window.youtubeTrimUrl="!",window.youtubeInput.includes("?list=")?window.youtubeId=window.youtubeInput.replace("https://www.youtube.com/watch?v=","").split("?")[0]:window.youtubeId=window.youtubeInput.replace("https://www.youtube.com/watch?v=","").split("&")[0];break;case window.youtubeInput.includes("https://m.youtube.com/watch?v="):window.youtubeTrimUrl="!",window.youtubeId=window.youtubeInput.replace("https://m.youtube.com/watch?v=","").split("&")[0];break;case window.youtubeInput.includes("https://www.youtube.com/"):window.youtubeTrimUrl="$",window.youtubeId=window.youtubeInput.replace("https://www.youtube.com/","").split("&")[0],window.youtubeId.includes("playlist?list=")&&(window.youtubeIsPlaylist=!0,window.youtubeId=window.youtubeId.replace("playlist?list=",""));break;case window.youtubeInput.includes("https://youtube.com/"):window.youtubeTrimUrl="$",window.youtubeId=window.youtubeInput.replace("https://youtube.com/","").split("&")[0],window.youtubeId.includes("playlist?list=")&&(window.youtubeIsPlaylist=!0,window.youtubeId=window.youtubeId.replace("playlist?list=",""));break;case window.youtubeInput.includes("http://www.youtube.com/watch?v="):window.youtubeTrimUrl="@",window.youtubeId=window.youtubeInput.replace("http://www.youtube.com/watch?v=","").split("&")[0];break;case window.youtubeInput.includes("https://www.youtube.com/"):window.youtubeTrimUrl="#",window.youtubeId=window.youtubeInput.replace("http://www.youtube.com/","").split("&")[0],window.youtubeId.includes("playlist?list=")&&(window.youtubeIsPlaylist=!0,window.youtubeId=window.youtubeId.replace("playlist?list=",""));break;case window.youtubeInput.includes("https://www.youtu.be/"):window.youtubeTrimUrl="*",window.youtubeId=window.youtubeInput.replace("https://www.youtu.be/","").split("&")[0],window.youtubeId.includes("playlist?list=")&&(window.youtubeIsPlaylist=!0,window.youtubeId=window.youtubeId.replace("playlist?list=","")),window.youtubeId.includes("?list=")&&(window.youtubeIsPlaylist=!0,window.youtubeId=window.youtubeId.replace("?list=","").split("?")[0]);break;case window.youtubeInput.includes("https://youtu.be/"):window.youtubeTrimUrl="*",window.youtubeId=window.youtubeInput.replace("https://youtu.be/","").split("&")[0],window.youtubeId.includes("playlist?list=")&&(window.youtubeIsPlaylist=!0,window.youtubeId=window.youtubeId.replace("playlist?list=","")),window.youtubeId.includes("?list=")&&(window.youtubeInput=window.youtubeInput.split("?")[0],window.youtubeId=window.youtubeId.split("?")[0]);break;default:return l()("#yt-title-input").val(""),l()("#yt-load-error").html(window.i18n.get("youtube-invalid-address")),l()("#yt-load-error").show(),l()("#yt-preview-content").hide(),l()("#yt-preview-no-content").hide(),!1}const e={height:"225",width:"400",events:{onReady:function(e){e.target.seekTo(0,!0),e.target.playVideo(),window.ytPreviewDuration=e.target.getDuration(),window.ytPreviewUrl=window.youtubeInput},onStateChange:function(e){if(1===e.data||3===e.data){let t=e.target.playerInfo.videoData.title;l()("#yt-input").prop("readonly",!0),t.length>70&&(t=t.substr(0,70)),l()("#yt-title-input").val(t),window.youtubeTitle=l()("#yt-title-input").val(),l()("#yt-new-search").hide(),l()("#yt-preview-content").show(),l()("#yt-preview-no-content").hide()}},onError:function(e){l()("#yt-load-error").show(),101===e.data||150===e.data?l()("#yt-load-error").html(window.i18n.get("youtube-the-owner-does-not-allow-embedded")):2===e.data?l()("#yt-load-error").html(window.i18n.get("youtube-invalid-parameter")):5===e.data?l()("#yt-load-error").html(window.i18n.get("youtube-the-requested-content-cannot-be-played")):100===e.data&&l()("#yt-load-error").html(window.i18n.get("youtube-the-requested-video-was-not-found")),l()("#yt-new-search").show(),l()("#yt-title-input").val(""),l()("#yt-preview-content").hide(),l()("#yt-preview-no-content").hide(),l()("#yt-input").prop("readonly",!1),e.target.destroy()}}};return window.youtubeIsPlaylist?(e.playerVars={},e.playerVars.listType="playlist",e.playerVars.list=window.youtubeId):e.videoId=window.youtubeId,window.preview=new YT.Player("yt-preview",e),!1})),l()(".yt-cancel").on("click",(()=>{window.preview&&window.preview.destroy(),l()("#yt-new-search").show(),l()("#yt-input").val(""),l()("#yt-new-update").hide(),l()("#yt-title-input").val(""),l()("#yt-preview-content").hide(),l()("#yt-preview-no-content").show(),l()("#yt-input").prop("readonly",!1)})),l()(".yt-update-cancel").on("click",(()=>{window.preview&&window.preview.destroy(),l()(".dialog").hide()})),l()("#yt-new-save").on("click",(()=>{window.preview&&window.preview.destroy();const e={};e.name=window.youtubeTitle,e.url=window.ytPreviewUrl,e.duration=window.ytPreviewDuration,e.ytInfo={},window.youtubeIsPlaylist?(e.ytInfo.youtubeId=window.youtubeId,e.playlist=!0):(e.ytInfo.youtubeId=window.youtubeId,e.ytInfo.playlist=!1);let t=!1;window.youtubePlaylistTemp?(window.youtubePlaylistTemp.forEach((n=>{e.url===n.url&&(t=!0)})),t||window.youtubePlaylistTemp.unshift(e)):(window.youtubePlaylistTemp=[],window.youtubePlaylistTemp.push(e)),l()("#yt-new-update").show(),l()("#yt-new-board").hide(),l()("#yt-input").prop("readonly",!1),l()("#yt-playlist-publish").click()})),l()("#yt-new").on("click",(()=>{window.preview&&window.preview.destroy(),l()("#yt-new-board").show(),l()("#yt-playlist-board").hide(),l()("#yt-config-board").hide(),l()("#yt-new-update").hide(),l()("#yt-input").prop("readonly",!1),l()("#yt-input").focus()})),l()("#yt-playlist").on("click",(()=>{l()("#yt-new-board").hide(),l()("#yt-new-update").hide(),l()("#yt-playlist-body").html(""),l()("#yt-playlist-board").show(),l()("#yt-config-board").hide(),window.youtubePlaylistTemp.forEach((function(e,t){l()("#yt-playlist-body").append(`<div class="yt-playlist-item fcm w100" draggable="true" style="border-bottom:1px solid #f1f1f1" index="${t}"><div class="fic frm w100"><div class="material-icons sxl p10">&#xE25D;</div><div class="fig ss toj">${window.youtubePlaylistTemp[t].name}</div><div class="pl5 sxs">${U(parseInt(window.youtubePlaylistTemp[t].duration))}</div>\x3c!--div class="yt-edit material-icons sxl pl5 tg" index="${t}">&#xE3C9;</div --\x3e<div class="yt-delete material-icons sxl pl5 tg" index="${t}">&#xE872;</div></div></div>`)}))})),l()("#yt-config").on("click",(()=>{l()("#yt-new-board").hide(),l()("#yt-new-update").hide(),l()("#yt-playlist-board").hide(),l()("#yt-config-board").show()})),l()("#yt-playlist-body").on("click",".yt-edit",(function(){})),l()("#yt-playlist-body").on("click",".yt-delete",(function(){const e=parseInt(l()(this).attr("index"));window.youtubePlaylistTemp.splice(e,1),l()("#yt-playlist").click()})),l()("#yt-new-again").on("click",(()=>{l()("#yt-new").click()})),l()(".yt-playlist-publish").on("click",(()=>{const e={},t=parseInt((new Date).getTime()/1e3),n=(l()("#yt-checkbox0")[0].checked?1:0)+(l()("#yt-checkbox1")[0].checked?2:0)+(l()("#yt-checkbox2")[0].checked?4:0)+(l()("#yt-checkbox3")[0].checked?8:0);e.yt={},e.yt.f=n,e.yt.t=t,e.yt.v=[],window.preview&&window.preview.destroy(),l()(".dialog").hide(),0!==window.youtubePlaylistTemp.length?(window.youtubePlaylistTemp.forEach((t=>{const n=t.name,i=(s=t.url).includes("https://www.youtube.com/watch?v=")?`!${s.replace("https://www.youtube.com/watch?v=","").split("&")[0]}`:s.includes("https://m.youtube.com/watch?v=")?`!${s.replace("https://m.youtube.com/watch?v=","").split("&")[0]}`:s.includes("https://www.youtube.com/")?s.includes("playlist?list=")?`$playlist?list=${s.replace("https://www.youtube.com/playlist?list=","")}`:`$${s.replace("https://www.youtube.com/","").split("&")[0]}`:s.includes("https://youtube.com/")?s.includes("playlist?list=")?`$playlist?list=${s.replace("https://youtube.com/playlist?list=","")}`:`$${s.replace("https://youtube.com/","").split("&")[0]}`:s.includes("http://www.youtube.com/watch?v=")?`@${s.replace("http://www.youtube.com/watch?v=","").split("&")[0]}`:s.includes("http://www.youtube.com/")?s.includes("playlist?list=")?`#playlist?list=${s.replace("http://www.youtube.com/playlist?list=","")}`:`#${s.replace("http://www.youtube.com/","").split("&")[0]}`:s.includes("https://www.youtu.be/")?s.includes("playlist?list=")?`*playlist?list=${s.replace("https://www.youtu.be/playlist?list=","")}`:`*${s.replace("https://www.youtu.be/","").split("&")[0]}`:!!s.includes("https://youtu.be/")&&(s.includes("playlist?list=")?`*playlist?list=${s.replace("https://youtu.be/playlist?list=","")}`:s.includes("?list=")?`*?list=${s.replace("https://youtu.be/","").split("?")[0]}`:`*${s.replace("https://youtu.be/","").split("&")[0]}`);var s;const o=t.duration;e.yt.v.push({n,u:i,d:o})})),window._engine.requestSetChannelMode(window._channel.getName(),"+C",JSON.stringify(e))):window._engine.requestSetChannelMode(window._channel.getName(),"-C","")})),l()("#yt-input").on("input",(()=>{l()("#yt-load-error").html(""),l()("#yt-load-error").hide(),l()("#yt-preview-no-content").show()})),l()("#rpchnuserlist").on("click",".requestVoice",(function(){if(window.session&&window.enableCsm&&!window.session.isStarted()&&1===window._channel.getType())return!1;const e=l()(this).attr("t");""===window._channel.getActiveRoom()&&(window._engine.requestTransmission(e,!0,!1),window._channel.unsetVoiceRequests(e))})),l()("#rpchnuserlist").on("click",".removeVoice",(function(){const e=l()(this).attr("t");if(window.session)if(window.session.isStarted()){if(e===p.ENGINE_NICK)return!1}else if(window.session.isRunning())return!1;const t=window._channel.getUserMedia(e),n=p.ENGINE_NICK;""===window._channel.getActiveRoom()&&(e===n&&l()("#rpchnhi").removeClass("ic_collaborate_ON tb"),window._channel.hasVoice(e)?window._engine.requestTransmission(e,!1,!1):window._engine.requestTransmission(e,!1,!0)),t&&t.forEach((function(e){e.metadata&&window._channel.unsetChannelMedia(e.metadata.mediaId)})),window._windowCtrl.redrawWindows()})),l()("body").on("click",".chnmod",(function(){const e=l()(this).attr("nick");if(window._channel.isInChannel(e))if(0===l()(`#chnprivc_${e}`).length){const t={};t.nick=e,t.name=e,t.avatar_id="",t.group=!1,l()(".chnprivchatsarea").show(),Yr(t)}else l()(".chnprivchatsarea").show(),l()("#chnprivchatslist").hide(),l()("#chnprivchatsarea > .fc").hide(),l()(`#chnprivc_${e}`).show();return!1})),l()("#channelArea").on("click",".chnmu_del",(function(){const e=l()(this).attr("nick"),t="-web"===e.slice(-4)?e.substr(0,e.length-4):e;window._engine.requestChannelSetChatMuteUsers(window._channel.getName(),[t],!1),delete window.lChannelMutedUsers[t],l()("#channelAdmChat").click()})),l()("#channelArea").on("click",".chnbu_del",(function(){const e=l()(this).attr("nick"),t="-web"===e.slice(-4)?e.substr(0,e.length-4):e;window._engine.requestSetChannelMode(window._channel.getName(),"-b",`${t}!*@*`),l()("#channelAdmChat").click()})),l()(".rpchnboxlink").click((function(e){if("message"===l()(this).attr("t")){e.preventDefault();const t=l()(this).attr("target"),n=l()(this).attr("body");window._app.sendMsg(t,n,window.msgId,6,"false"),window.msgId+=1}})),l()("#rpchnshareinfo").click((function(){return new wr("InformaÃ§Ãµes para Compartilhamento",'Para compartilhamento de tela:<br /><span class="b ss">Google Chrome</span>: necessÃ¡ria a extensÃ£o do <a href="https://chrome.google.com/webstore/detail/janus-webrtc-screensharin/ijihchciofaibiobehjplkaofjafcjdk" class="tb" target="_blank">JANUS WebRTC</a><br /><span class="b ss">Firefox</span>: suporte nativo e, portanto, nÃ£o hÃ¡ a necessidade de instalaÃ§Ã£o de nenhuma extensÃ£o.<br /><br /><span class="b ss">ObservaÃ§Ã£o: </span>Compartilhamento de tela disponÃ­vel somente apÃ³s inÃ­cio de transmissÃ£o de cÃ¢mera.',(function(){})).present(),!1})),l()("#user-media-cc").on("click",(()=>{l()("#media-cc").is(":visible")?(l()("#media-cc").hide(),window.resizeMedia.update()):(l()("#media-cc").show(),window.resizeMedia.update())})),l()("#user-media-mic").click((async function(){return!!window.devicesPermissions.audioAllowed&&(window.muteFlag||(window._channel.isAudioMuted()?Qr():Zr()),!1)})),l()("#user-media-cam").click((async function(e){return!!window.devicesPermissions.webcamAllowed&&(window._engine.isPublishPending()?(E("Previous publish is still pending..."),e.stopPropagation(),!1):(window._engine.txInfoAvconf(!0),window.devices.getAudioInputDevice(),window.devices.getVideoInputDevice(),window._channel.isAudioMuted(),window._channel.isVideoMuted()?(window._channel.unmuteVideo(),window.devices.unmuteVideoDevice(),window._channelCtrl.updateCapture(),setTimeout((()=>{window._captureCtrl.updateBanubaEffect(window._captureCtrl.getSelectedEffect())}),3e3),l()("#user-media-cam").css({"background-color":"#707070","border-color":"#707070"}),l()("#user-media-cam").html("&#xE04B;"),l()("#videoOn").show(),l()("#videoOff").hide()):(window._channel.muteVideo(),window.devices.muteVideoDevice(),window._channelCtrl.updateCapture(),l()("#user-media-cam").css({"background-color":"#F95252","border-color":"#F95252"}),l()("#user-media-cam").html("&#xE04C;"),l()("#videoOn").hide(),l()("#videoOff").show()),e.stopPropagation(),!1))})),l()("#medias").on("click",".mediasound",(function(){"0"===l()(this).attr("mediaaudioon")?(window._channel.setMediaState(l()(this).attr("mediaid"),"muted",!1),l()(this).attr("mediaaudioon","1"),l()(this).removeClass("tr"),l()(this).html("&#xE050;"),l()(`#${l()(this).attr("mediaid")}`)[0].muted=!1):(window._channel.setMediaState(l()(this).attr("mediaid"),"muted",!0),l()(this).attr("mediaaudioon","0"),l()(this).addClass("tr"),l()(this).html("&#xE04F;"),l()(`#${l()(this).attr("mediaid")}`)[0].muted=!0)})),l()("#medias").on("mouseover",".mediahover",(function(){l()(".mediaexpand").hide();const e=l()(this).attr("mediaid");return!(1!==window._mediaWndsArray.length&&!window._channel.getWindows()&&(!window._channel.getMediaState(e)||!1!==window._channel.getMediaState(e).videoOn)&&(l()(this).find(".mediaexpand").show(),1))})),l()("#medias").on("mouseout",".mediahover",(function(){l()(this).find(".mediaexpand").hide()})),l()("#medias").on("click",".mediaexpand",(function(){"1"===l()(this).attr("mediaexpandon")?(window._channel.setMediaState(l()(this).attr("mediaid"),"expanded",!1),l()(this).parent().parent().parent().css("position","relative"),l()(this).parent().parent().parent().css("z-index",""),l()(this).attr("mediaexpandon","0"),l()(this).html("&#xE56B;"),window._windowCtrl.redrawWindows()):(window._channel.setMediaState(l()(this).attr("mediaid"),"expanded",!0),l()(this).parent().parent().parent().css("position","absolute"),l()(this).parent().parent().parent().css("width","100%"),l()(this).parent().parent().parent().css("max-height","100%"),l()(this).parent().parent().parent().css("z-index","10"),l()(this).attr("mediaexpandon","1"),l()(this).html("&#xE5D1;"))})),l()("body").on("click",".pollOption",(function(){const e=0===window._poll.getPollId()?"QUIZ":"POLL";if("QUIZ"===e&&!window._poll.getPlaying()&&!window._poll.getContinueWatching())return E(`OPTION CLICK ${e}: { playing: ${window._poll.getPlaying()} , continue watching: ${window._poll.getContinueWatching()} }`),!1;if(window._poll.getContinueWatching())return E(`OPTION CLICK ${e}: just watching, can not play!`),!1;if(0===parseInt(l()("#pollTime").html()))return E("Poll answer: can not answer - Time expired!"),!1;const t=parseInt(l()(this).attr("option"));return window._poll.getQuestion().then((n=>{const i={questionId:n.questionId,option:t};window._poll.answerQuestion(i).then((n=>(E(`${e} answer response: ${JSON.stringify(n.data)}`),"0"===n.data.result?!!n.data.errors&&("not-playing"===n.data.errors.cause?(E(`${e} answer response error: not playing`),window._poll.setPlaying(!1),!1):(E(`${e} answer response error: ${JSON.stringify(n.data.errors)}`),!1)):(window._poll.setChoice(t),l()(`#pollOptionText${t}`).addClass("tw"),l()(`#pollOptionText${t}`).removeClass("tk"),l()(`#pollBackground${t}`).addClass("bgdbl2"),!1)))).catch((e=>{E(`Poll answer error: ${e}`)}))})),!1})),l()("#pollRewardButton").click((function(){l()("#pollArea").hide()})),l()("#pollUseLife").click((function(){const e=window._poll.getLifes();window._poll.setLifes(e-1),window._poll.setUsedLifes(!0),window._poll.useLife().then((e=>"0"===e.data.result?e.data.errors?"not-playing"===e.data.errors.cause?(E("Poll use life response error: not playing"),window._poll.setPlaying(!1),!1):(E(`Poll use life response error: ${JSON.stringify(e.data.errors)}`),window._poll.setPlaying(!1),!1):(E("Poll use life error!"),window._poll.setPlaying(!1),!1):(window._poll.setPlaying(!0),!1))),clearInterval(window.pollMap.get("timer")),l()("#pollArea").hide()})),l()("#pollEliminatedContinue").click((function(){clearInterval(window.pollMap.get("timer")),l()("#pollArea").hide(),window._poll.setContinueWatching(!0)})),l()("#new-session").on("click",(function(){window.session.setType("newrecord"),l()("#session-continue").click()})),l()("#dbsessionrecord-back").on("click",(()=>{l()(".dialog").hide(),l()("#session-start-label-error").hide(),l()("#chn-session-start-btn").click()})),window.session.getRecordTabShow()?(l()("#session-record-session").css({border:"0","border-bottom-width":"2px","border-color":"#325794","border-style":"solid"}),l()("#session-rerecord-session").css("border","0")):window.session.getReRecordTabShow()&&(l()("#session-rerecord-session").css({border:"0","border-bottom-width":"2px","border-color":"#325794","border-style":"solid"}),l()("#session-record-session").css("border","0")),l()("#session-record-session").on("click",(function(){window.session.setType("record"),window.session.setRecordTabShow(!0),window.session.getReRecordTabShow(!1),l()(this).css({border:"0","border-bottom-width":"2px","border-color":"#325794","border-style":"solid"}),l()("#session-rerecord-session").css("border","0"),async function(){const e={channel:window._channel.getName(),owner:p.ENGINE_NICK.replace("-web",""),status:"created"},t=await window.session.getSessionsListInfo(e),n=[];return t.forEach((e=>{const t=e.id,i=new Date(e.reference_date),s=e.reference_date,o=`${i.getDate()<10?`0${i.getDate()}`:i.getDate()}/${i.getMonth()+1<10?`0${i.getMonth()+1}`:`${i.getMonth()+1}`}/${i.getFullYear()} - ${i.getHours()<10?`0${i.getHours()}`:i.getHours()}:${i.getMinutes()<10?`0${i.getMinutes()}`:i.getMinutes()}`;n.push({id:t,reference_date:s,referenceDate:o})})),l()("#sessions-availiable-area").html(""),n.forEach((e=>{l()("#sessions-availiable-area").append(`<div class="w100 fr ss" style="border:0px;border-bottom:1px;border-style: solid;border-color:#EEEEEE;">\n                    <div class="p5" style="width:120px;text-align:center"><input type="radio" id="record-session-${e.id}" name="record-session" value="${e.id},${e.reference_date}" /><label for="record-session-${e.id}">${e.id}</label></div>\n                    <div class="p5 fig" style="text-align:center;"><label for="record-session-${e.id}">${e.referenceDate}</label></div></div>`)})),n}().then((e=>{E(JSON.stringify(e))}))})),l()("#session-rerecord-session").on("click",(function(){l()("#session-start-label-error").hide(),window.session.setType("rerecord"),window.session.setRecordTabShow(!1),window.session.getReRecordTabShow(!0),l()(this).css({border:"0","border-bottom-width":"2px","border-color":"#325794","border-style":"solid"}),l()("#session-record-session").css("border","0"),async function(){const e={channel:window._channel.getName(),owner:p.ENGINE_NICK.replace("-web",""),status:"rerecord"},t=await window.session.getSessionsListInfo(e),n=[];return t.forEach((e=>{const t=e.id,i=new Date(e.reference_date),s=e.reference_date,o=`${i.getDate()<10?`0${i.getDate()}`:i.getDate()}/${i.getMonth()+1<10?`0${i.getMonth()+1}`:`${i.getMonth()+1}`}/${i.getFullYear()} - ${i.getHours()<10?`0${i.getHours()}`:i.getHours()}:${i.getMinutes()<10?`0${i.getMinutes()}`:i.getMinutes()}`;n.push({id:t,reference_date:s,referenceDate:o})})),l()("#sessions-availiable-area").html(""),n.forEach((e=>{l()("#sessions-availiable-area").append(`<div class="w100 fr ss" style="border:0px;border-bottom:1px;border-style: solid;border-color:#EEEEEE;">\n                    <div class="p5" style="width:120px;text-align:center"><input type="radio" id="record-session-${e.id}" name="record-session" value="${e.id},${e.reference_date}" /><label for="record-session-${e.id}">${e.id}</label></div>\n                    <div class="fig">&nbsp;</div>\n                    <div class="p5 fig" style="text-align:center;width:200px;max-width:200px;"><label for="record-session-${e.id}">${e.referenceDate}</label></div></div>`)})),n}().then((e=>{0!==e.length&&E(`Rerecording list result: ${JSON.stringify(e)}`)}))})),l()("#session-record-session").on("click",(function(){l()("#session-start-label-error").hide(),window.session.setRecordTabShow(!1),window.session.setReRecordTabShow(!0)})),l()("#session-spare").on("change",(function(){const e="spare"===l()(this).val(),t=new Date,n=`${t.getFullYear()}-${t.getMonth()<9?`0${t.getMonth()+1}`:`${t.getMonth()+1}`}-${t.getDate()<10?`0${t.getDate()}`:`${t.getDate()}`}`,i=new Date((new Date).getTime()-864e5).toLocaleDateString().split("/"),s=`${i[2]}-${i[1]}-${i[0]}`;e?(l()("#session-date-reference").val(""),l()("#session-date-reference").removeAttr("min"),l()("#session-date-reference").attr("max",s),l()("#session-date-hour").html('<option value="-1">&nbsp;</option><option value="07">07</option><option value="08">08</option><option value="09">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option>'),l()("#session-date-minutes").html('<option value="-1">&nbsp;</option><option value="00">00</option><option value="05">05</option><option value="10">10</option><option value="15">15</option><option value="20">20</option><option value="25">25</option><option value="30">30</option><option value="35">35</option><option value="40">40</option><option value="45">45</option><option value="50">50</option><option value="55">55</option>')):(l()("#session-date-reference").val(n),l()("#session-date-reference").attr("min",n),l()("#session-date-reference").attr("max",n),l()("#session-date-hour").html('<option value="-1">&nbsp;</option>'),l()("#session-date-reference").change()),l()("#session-date-area").show()})),l()("#session-date-hour").on("change",(function(){const e=new Date,t=`${e.getFullYear()}`,n=e.getMonth()<9?`0${e.getMonth()+1}`:`${e.getMonth()+1}`,i=e.getDate()<10?`0${e.getDate()}`:`${e.getDate()}`,s=e.getHours()<10?`0${e.getHours()}`:`${e.getHours()}`;let o=e.getMinutes()<10?`0${e.getMinutes()}`:`${e.getMinutes()}`;if(`${t}-${n}-${i}`===l()("#session-date-reference").val()){const e=parseInt(l()(this).val()),t=parseInt(s);if(e<t)l()("#session-date-minutes").html('<option value="-1">&nbsp;</option><option value="00">00</option><option value="05">05</option><option value="10">10</option><option value="15">15</option><option value="20">20</option><option value="25">25</option><option value="30">30</option><option value="35">35</option><option value="40">40</option><option value="45">45</option><option value="50">50</option><option value="55">55</option>');else{l()("#session-date-minutes").html('<option value="-1">&nbsp;</option>'),t<e?o=1:parseInt(o)+5<59&&(o=parseInt(o)+5);for(let e=0;e<=parseInt(o);e+=5){const t=e<10?`0${e}`:`${e}`;l()("#session-date-minutes").append(`<option value="${t}">${t}</option>`)}}}})),l()("#session-date-reference").on("change",(function(){const e=l()("#session-date-reference").val(),t=new Date(e).getTime(),n=new Date,i=`${n.getFullYear()}`,s=n.getMonth()<9?`0${n.getMonth()+1}`:`${n.getMonth()+1}`,o=n.getDate()<10?`0${n.getDate()}`:`${n.getDate()}`;let r=n.getHours()<10?`0${n.getHours()}`:`${n.getHours()}`;const a=n.getMinutes()<10?`0${n.getMinutes()}`:`${n.getMinutes()}`,c=`${i}-${s}-${o}`;if(t>n.getTime()&&(l()("#session-date-reference").attr("value",c),l()("#session-date-reference").val(c)),l()("#session-date-reference").attr("value")!==e)l()("#session-date-hour").html('<option value="-1">&nbsp;</option><option value="07">07</option><option value="08">08</option><option value="09">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option>'),l()("#session-date-minutes").html('<option value="-1">&nbsp;</option><option value="00">00</option><option value="05">05</option><option value="10">10</option><option value="15">15</option><option value="20">20</option><option value="25">25</option><option value="30">30</option><option value="35">35</option><option value="40">40</option><option value="45">45</option><option value="50">50</option><option value="55">55</option>');else{l()("#session-date-hour").html('<option value="-1">&nbsp;</option>'),parseInt(a)>55&&r<22&&(r=parseInt(r)+1);for(let e=7;e<=parseInt(r);e+=1){const t=e<10?`0${e}`:`${e}`;l()("#session-date-hour").append(`<option value="${t}">${t}</option>`)}l()("#session-date-minutes").html('<option value="-1">&nbsp;</option>');for(let e=0;e<=parseInt(a);e+=5){const t=e<10?`0${e}`:`${e}`;l()("#session-date-minutes").append(`<option value="${t}">${t}</option>`)}}})),l()("#dbsession-categories-area").on("click",".rm-categories",(function(){const e=l()(this).attr("sId");window.session.getSessions()[e]&&window.session.removeSession(e),l()(`#session-id-${e}`).remove(),l()("#dbsession-add-category").show()})),l()("#dbcsm-categories-area").on("click",".rm-categories",(function(){const e=l()(this).attr("sId");window.session.getSessions()[e]&&window.session.removeSession(e),l()(`#dbcsm-session-id-${e}`).remove(),l()("#dbcsm-add-category").show()})),l()("#add-category").on("click",(()=>{l()("#add-category").hide(),l()("#session-label-start-error").hide(),window.session.getRootCategories().then((e=>{let t;window.session.getSessionId().then((n=>{t=n+1,l()("#categories-area").append(`<div id="session-id-${t}" class="w100 bor br"><div class="bor w100 br p5" style="position:relative;"><div class="selected ss"></div><div class="fc selecting w100 p0" name="id"><div class="w100" style="position:relative;"><input type="text" class="insert-category-text bor br p5 w100" style="width:935px;border-color:rgba(0,0,255,0.25);"/><div class="pt rm-categories" style="position:absolute;right:0px;top:2px;" sId="${t}">X</div></div><div class="category-items fc w100 bgw bor sxs" style="position:absolute;top:31px;max-height:200px;width:935px;overflow-y:auto;display:none;"></div></div></div>`),window.categoryItems=[],e.forEach((e=>{const n=e.required?"*":"";l()("#categories-area .category-items").append(`<div class="p5 category-item hovr pt w100" cid="${e.id}" sid="${t}">${e.name} ${n}</div>`);const i={id:e.id,name:`${e.name} ${n}`};window.categoryItems.push(i)}))})),l()("#add-category").hide()}))})),l()("#dbsessionadd-category").on("click",(()=>{l()("#dbsessionadd-category").hide(),l()("#dbsession-label-start-error").hide(),window.session.getRootCategories().then((e=>{let t;window.session.getSessionId().then((n=>{t=n+1,l()("#dbsession-categories-area").append(`<div id="session-id-${t}" class="w100 bor br"><div class="bor w100 br p5" style="position:relative;"><div class="selected ss"></div><div class="fc selecting w100 p0" name="id"><div class="w100" style="position:relative;"><input type="text" class="insert-category-text bor br p5 w100" style="width:480px;border-color:rgba(0,0,255,0.25);"/><div class="pt rm-categories" style="position:absolute;right:0px;top:2px;" sId="${t}">X</div></div><div class="category-items fc w100 bgw bor sxs" style="position:absolute;top:31px;max-height:200px;width:480px;overflow-y:auto;display:none;"></div></div></div>`),window.categoryItems=[],e.forEach((e=>{const n=e.required?"*":"";l()("#dbsession-categories-area .category-items").append(`<div class="p5 category-item hovr pt w100" cid="${e.id}" sid="${t}">${e.name} ${n}</div>`);const i={id:e.id,name:`${e.name} ${n}`};window.categoryItems.push(i)}))})),l()("#dbsessionadd-category").hide()}))})),l()("#dbcsm-dbsessionadd-category").on("click",(()=>{l()("#dbcsm-dbsessionadd-category").hide(),l()("#dbcsm-dbsession-label-start-error").hide(),window.session.getRootCategories().then((e=>{let t;window.session.getSessionId().then((n=>{t=n+1,l()("#dbcsm-dbsession-categories-area").append(`<div id="dbcsm-session-id-${t}" class="w100 bor br"><div class="bor w100 br p5" style="position:relative;"><div class="selected ss"></div><div class="fc selecting w100 p0" name="id"><div class="w100" style="position:relative;"><input type="text" class="insert-category-text bor br p5 w100" style="width:520px;border-color:rgba(0,0,255,0.25);"/><div class="pt rm-categories" style="position:absolute;right:0px;top:2px;" sId="${t}">X</div></div><div class="category-items fc w100 bgw bor sxs" style="position:absolute;top:31px;max-height:200px;width:520px;overflow-y:auto;display:none;"></div></div></div>`),window.categoryItems=[],e.forEach((e=>{const n=e.required?"*":"";l()("#dbcsm-dbsession-categories-area .category-items").append(`<div class="p5 category-item hovr pt w100" cid="${e.id}" sid="${t}">${e.name} ${n}</div>`);const i={id:e.id,name:`${e.name} ${n}`};window.categoryItems.push(i)}))})),l()("#dbcsm-dbsessionadd-category").hide()}))})),l()("#categories-area").on("click",".insert-category-text",(function(){l()(".category-items").show()})),l()("#dbcsm-categories-area").on("click",".insert-category-text",(function(){l()(".category-items").show()})),l()("#dbsession-categories-area").on("click",".insert-category-text",(function(){l()("#dbsession-categories-area .category-items").show()})),l()("#dbcsm-dbsession-categories-area").on("click",".insert-category-text",(function(){l()("#dbcsm-dbsession-categories-area .category-items").show()})),l()("#categories-area").on("keyup",".insert-category-text",(function(){const e=l()(this).val().toLowerCase(),t=[];window.categoryItems.forEach((n=>{n.name.toLowerCase().includes(e)&&t.push(n)})),l()("#categories-area .category-items").html(""),t.forEach((e=>{l()("#categories-area .category-items").append(`<div class="p5 category-item hovr w100 pt" cid="${e.id}">${e.name}</div>`)}))})),l()("#dbcsm-categories-area").on("keyup",".insert-category-text",(function(){const e=l()(this).val().toLowerCase(),t=[];window.categoryItems.forEach((n=>{n.name.toLowerCase().includes(e)&&t.push(n)})),l()("#dbcsm-categories-area .category-items").html(""),t.forEach((e=>{l()("#dbcsm-categories-area .category-items").append(`<div class="p5 category-item hovr w100 pt" cid="${e.id}">${e.name}</div>`)}))})),l()("#dbsession-categories-area").on("keyup",".insert-category-text",(function(){const e=l()(this).val().toLowerCase(),t=[];window.categoryItems.forEach((n=>{n.name.toLowerCase().includes(e)&&t.push(n)})),l()("#dbsession-categories-area .category-items").html(""),t.forEach((e=>{l()("#dbsession-categories-area .category-items").append(`<div class="p5 category-item hovr w100 pt" cid="${e.id}">${e.name}</div>`)}))})),l()("#dbcsm-dbsession-categories-area").on("keyup",".insert-category-text",(function(){const e=l()(this).val().toLowerCase(),t=[];window.categoryItems.forEach((n=>{n.name.toLowerCase().includes(e)&&t.push(n)})),l()("#dbcsm-dbsession-categories-area .category-items").html(""),t.forEach((e=>{l()("#dbcsm-dbsession-categories-area .category-items").append(`<div class="p5 category-item hovr w100 pt" cid="${e.id}">${e.name}</div>`)}))})),l()("#categories-area").on("click",".category-item",(function(){const e=parseInt(l()(this).attr("cid")),t=parseInt(l()(this).attr("sid"));l()("#session-label-start-error").hide(),""===l()("#categories-area .selected").html()?l()("#categories-area .selected").append(`<div class="toj" style="position:relative;width:935px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${window.session.getCategory(e).name}</div><div class="pt rm-categories" style="position:absolute;right:7px;top:4px;" sId="${t}">X</div>`):l()("#categories-area .selected").append(`<div class="sxs" style="position:relative;width:935px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${window.session.getCategory(e).name}</div>`),window.session.insertCategory(window.session.getCategory(e)).then((t=>{t?(l()("#categories-area .selecting").remove(),l()(this).removeClass("selecting"),l()(".selected").removeClass("selected"),l()("#add-category").show()):(window.session.getSessionId().then((t=>{l()(`#session-id-${t} .selecting`).html(""),window.categoryItems=[],window.session.getCategories(e).then((e=>{l()("#categories-area .selecting").append('<div class="w100" style="position:relative;"><div class="w100"><input type="text" class="insert-category-text bor br p5 w100" style="width:935px;border-color:rgba(0,0,255,0.25);"/></div><div class="category-items fc w100 bgw bor sxs" style="position:absolute;top:26px;max-height:200px;width:935px;overflow-y:auto;display:none;"></div>'),e.forEach((e=>{l()("#categories-area .category-items").append(`<div class="p5 category-item hovr pt w100" cid="${e.id}">${e.name}</div>`);const t={id:e.id,name:e.name};window.categoryItems.push(t)}))}))})),l()("#add-category").hide())}))})),l()("#dbcsm-categories-area").on("click",".category-item",(function(){const e=parseInt(l()(this).attr("cid")),t=parseInt(l()(this).attr("sid"));l()("#dbcsm-session-label-start-error").hide(),""===l()("#dbcsm-categories-area .selected").html()?l()("#dbcsm-categories-area .selected").append(`<div class="toj" style="position:relative;width:500px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${window.session.getCategory(e).name}</div><div class="pt rm-categories" style="position:absolute;right:7px;top:4px;" sId="${t}">X</div>`):l()("#dbcsm-categories-area .selected").append(`<div class="sxs" style="position:relative;width:500px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${window.session.getCategory(e).name}</div>`),window.session.insertCategory(window.session.getCategory(e)).then((t=>{t?(l()("#dbcsm-categories-area .selecting").remove(),l()(this).removeClass("selecting"),l()(".selected").removeClass("selected"),l()("#dbcsm-add-category").show()):(window.session.getSessionId().then((t=>{l()(`#dbcsm-session-id-${t} .selecting`).html(""),window.categoryItems=[],window.session.getCategories(e).then((e=>{l()("#dbcsm-categories-area .selecting").append('<div class="w100" style="position:relative;"><div class="w100"><input type="text" class="insert-category-text bor br p5 w100" style="width:520px;border-color:rgba(0,0,255,0.25);"/></div><div class="category-items fc w100 bgw bor sxs" style="position:absolute;top:26px;max-height:200px;width:520px;overflow-y:auto;display:none;"></div>'),e.forEach((e=>{l()("#dbcsm-categories-area .category-items").append(`<div class="p5 category-item hovr pt w100" cid="${e.id}">${e.name}</div>`);const t={id:e.id,name:e.name};window.categoryItems.push(t)}))}))})),l()("#dbcsm-add-category").hide())}))})),l()("#dbsession-categories-area").on("click",".category-item",(function(e){e.preventDefault();const t=parseInt(l()(this).attr("cid")),n=parseInt(l()(this).attr("sid"));l()("#dbsession-label-start-error").hide(),""===l()("#dbsession-categories-area .selected").html()?l()("#dbsession-categories-area .selected").append(`<div class="toj" style="position:relative;width:480px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${window.session.getCategory(t).name}</div><div class="pt rm-categories" style="position:absolute;right:7px;top:4px;" sId="${n}">X</div>`):l()("#dbsession-categories-area .selected").append(`<div class="sxs" style="position:relative;width:480px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${window.session.getCategory(t).name}</div>`),window.session.insertCategory(window.session.getCategory(t)).then((e=>{e?(l()("#dbsession-categories-area .selecting").remove(),l()(this).removeClass("selecting"),l()(".selected").removeClass("selected"),l()("#dbsessionadd-category").show()):(window.session.getSessionId().then((e=>{l()("#dbsession-categories-area .selecting").html(""),window.categoryItems=[],window.session.getCategories(t).then((e=>{l()("#dbsession-categories-area .selecting").append('<div class="w100" style="position:relative;"><div class="w100"><input type="text" class="insert-category-text bor br p5 w100" style="width:480px;border-color:rgba(0,0,255,0.25);"/></div><div class="category-items fc w100 bgw bor sxs" style="position:absolute;top:26px;max-height:200px;width:480px;overflow-y:auto;display:none;"></div>'),e.forEach((e=>{l()("#dbsession-categories-area .category-items").append(`<div class="p5 category-item hovr pt w100" cid="${e.id}">${e.name}</div>`);const t={id:e.id,name:e.name};window.categoryItems.push(t)}))}))})),l()("#dbsessionadd-category").hide())}))})),l()("#dbcsm-dbsession-categories-area").on("click",".category-item",(function(e){e.preventDefault();const t=parseInt(l()(this).attr("cid")),n=parseInt(l()(this).attr("sid"));l()("#dbcsm-dbsession-label-start-error").hide(),""===l()("#dbcsm-dbsession-categories-area .selected").html()?l()("#dbcsm-dbsession-categories-area .selected").append(`<div class="toj" style="position:relative;width:935px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${window.session.getCategory(t).name}</div><div class="pt rm-categories" style="position:absolute;right:7px;top:4px;" sId="${n}">X</div>`):l()("#dbcsm-dbsession-categories-area .selected").append(`<div class="sxs" style="position:relative;width:935px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${window.session.getCategory(t).name}</div>`),window.session.insertCategory(window.session.getCategory(t)).then((e=>{e?(l()("#dbcsm-dbsession-categories-area .selecting").remove(),l()(this).removeClass("selecting"),l()(".selected").removeClass("selected"),l()("#dbcsm-dbsessionadd-category").show()):(window.session.getSessionId().then((e=>{l()("#dbcsm-dbsession-categories-area .selecting").html(""),window.categoryItems=[],window.session.getCategories(t).then((e=>{l()("#dbcsm-dbsession-categories-area .selecting").append('<div class="w100" style="position:relative;"><div class="w100"><input type="text" class="insert-category-text bor br p5 w100" style="width:520px;border-color:rgba(0,0,255,0.25);"/></div><div class="category-items fc w100 bgw bor sxs" style="position:absolute;top:26px;max-height:200px;width:520px;overflow-y:auto;display:none;"></div>'),e.forEach((e=>{l()("#dbcsm-dbsession-categories-area .category-items").append(`<div class="p5 category-item hovr pt w100" cid="${e.id}">${e.name}</div>`);const t={id:e.id,name:e.name};window.categoryItems.push(t)}))}))})),l()("#dbcsm-dbsessionadd-category").hide())}))})),l()(".session-cancel").on("click",(()=>{l()("#dbcsm-session-date-area-select").hide(),l()("#session-input-title").val(""),l()(".dialog").hide()})),l()("#session-start").on("click",(async()=>{const e=await window.session.getActiveSessionInfo(window._engine.currentChannel());if(e.active){E(`[Session] Start Error: active session info: ${JSON.stringify(e)}`);const t=window.i18n.get("error-session-start");return window._channel.showTemporaryMessage(t,"alert"),l()(".dialog").hide(),l()(".modal").hide(),l()("#dialog").hide(),!1}const t=window.session.getRootRequiredCategories(),n=window.session.getSelectedCategories();let i,s=!0,o=!1;t.forEach((e=>{n.includes(e)||o||(s=!1,i=e,o=!0)}));const r=l()("#session-input-title").val().trim();if(""===r)return l()("#session-label-start-error").html(window.i18n.get("session-error-insert-title")),l()("#session-label-start-error").show(),!1;if(null===l()("#session-spare").val())return l()("#session-label-start-error").html(window.i18n.get("session-error-select-class-type")),l()("#session-label-start-error").show(),!1;if(""===l()("#session-date-reference").val().trim())return l()("#session-label-start-error").html(window.i18n.get("session-error-select-date")),l()("#session-label-start-error").show(),!1;if("-1"===l()("#session-date-hour").val()||"-1"===l()("#session-date-minutes").val())return l()("#session-label-start-error").html(window.i18n.get("session-error-insert-time")),l()("#session-label-start-error").show(),!1;if(l()(".selecting").is(":visible"))return l()("#session-label-start-error").html(window.i18n.get("session-error-finish-selecting")),l()("#session-label-start-error").show(),!1;if(!s){const e=window.session.getCategory(i).name;return l()("#session-label-start-error").html(`${window.i18n.get("session-error-required-category")} "${e}" ${window.i18n.get("session-error-required-notselected")}`),l()("#session-label-start-error").show(),!1}l()("#session-label-start-error").hide(),l()(".dialog").hide(),async function(){const e=`${l()("#session-date-reference").val()}T${l()("#session-date-hour").val()}:${l()("#session-date-minutes").val()}`;return await window.session.setTitle(r),await window.session.setReferenceDate(e),await window.session.setExtras({}),window.session.startNeeded(!0),!0}().then((()=>{l()("#chn-session-start-btn").hide(),l()("#chn-session-continue-btn").hide(),window.session.setStarted(!0),window._engine.requestTransmission(p.ENGINE_NICK,!0,!1)}))})),l()("#dbsession-start").on("click",(()=>{const e=window.session.getRootRequiredCategories(),t=window.session.getSelectedCategories();let n,i=!0,s=!1;e.forEach((e=>{t.includes(e)||s||(i=!1,n=e,s=!0)}));const o=l()("#dbsession-input-title").val().trim();if(""===o)return l()("#dbsession-label-start-error").html(window.i18n.get("session-error-insert-title")),l()("#dbsession-label-start-error").show(),!1;if(l()(".selecting").is(":visible"))return l()("#session-label-start-error").html(window.i18n.get("session-error-finish-selecting")),l()("#session-label-start-error").show(),!1;if(!i){const e=window.session.getCategory(n).name;return l()("#dbsession-label-start-error").html(`${window.i18n.get("session-error-required-category")} "${e}" ${window.i18n.get("session-error-required-notselected")}`),l()("#dbsession-label-start-error").show(),!1}l()("#dbsession-label-start-error").hide(),l()(".dialog").hide(),async function(){return await window.session.setTitle(o),await window.session.setExtras({}),window.session.startNeeded(!0),!0}().then((()=>{l()("#chn-session-start-btn").hide(),l()("#chn-session-continue-btn").hide(),window.session.setStarted(!0),window._engine.requestTransmission(p.ENGINE_NICK,!0,!1)}))})),l()("#session-ok").on("click",(()=>{l()(".dialog").hide(),l()("#session-recording").hide(),window._channel.isOperator(p.ENGINE_NICK)&&1===window._channel.getType()&&window.enableCsm&&(l()("#chn-session-stop-btn").hide(),window.Events.dispatch("session/show-session-start-btn"),localStorage.removeItem("session-username"))})),l()("#session-email").on("click",(()=>{!async function(){const e=await window.session.getUserListReport(),t=window.session_id,n=e.length,i=window.live_duration;let s="Nome Completo,Apelido,Tempo\n";e.forEach((([e,t])=>{const n=localStorage.getItem("session-username");let i="";try{i=JSON.parse(n)[e]}catch(e){E("Error parsing session-username")}s+=`${i},${e},${U(parseInt(t/1e3))}\n`}));const o=await window.session.getSessionUserJoinLeaveReportCSV(t),r={session_id:t,users:n,live_duration:i,attachments:[{filename:`user-list-report-${t}.csv`,content:s},{filename:`user-join-part-report-${t}.csv`,content:o}]};E(await wi(r))}()})),l()("#dbcfb-ok").on("click",(()=>{l()(".dialog").hide(),l()("#db-connection-failure").hide(),l()("#chng").hasClass("lpis")?l()("#chng").click():l()("#chni").hasClass("lpis")&&l()("#chni").click()})),l()("#roomListArea").on("click",".rooms-refresh",(function(){l()("#roomListArea").html(""),setTimeout((function(){l()("#chng").click()}),1e3)})),l()("#dbdev-audio-input-toggle").on("click",(async function(){if(!window.devicesPermissions.audioAllowed)return!1;l()(this).hasClass("tb")?(l()(this).removeClass("tb").addClass("tg"),l()(this).html("toggle_off"),l()("#audio_input_select").hide()):(l()(this).removeClass("tg").addClass("tb"),l()(this).html("toggle_on"),l()("#audio_input_select").show())})),l()("#dbdev-audio-output-toggle").on("click",(function(){l()(this).hasClass("tb")?(l()(this).removeClass("tb").addClass("tg"),l()(this).html("toggle_off"),l()("#audio_output_select").hide(),window.devices.muteAudioOutputDevice()):(l()(this).removeClass("tg").addClass("tb"),l()(this).html("toggle_on"),l()("#audio_output_select").show(),window.devices.unmuteAudioOutputDevice())})),l()("#audio_input_select").on("change",(function(){const e=l()(this).val();window.devices.setAudioInputDevice(e).then((()=>{E(`Audio device changed: ${l()(this).val()}`),br()}))})),l()("#audio_output_select").on("change",(function(){const e=l()(this).val();window.devices.setAudioOutputDevice(e).then((()=>{E(`Audio output device changed: ${l()(this).val()}`),window.devices.setAudioOutputDevice(l()(this).val())}))})),window.toggleTimeout=!1,l()("#dbdev-video-toggle").on("click",(async function(){return!!window.devicesPermissions.webcamAllowed&&(window.toggleTimeout||(window.toggleTimeout=!0,setTimeout((()=>{window.toggleTimeout=!1}),2e3),l()(this).hasClass("tb")?(l()(this).removeClass("tb").addClass("tg"),l()(this).html("toggle_off"),l()("#video_select").hide(),window._channel.muteVideo(),window.devices.muteVideoDevice(),l()("#webcam_preview").hide(),l()("#banuba-area").hide(),l()("#banuba-area").is(":visible")&&l()("#banuba-area").hide(),l()("#user-media-cam").css({"background-color":"#F95252","border-color":"#F95252"}),l()("#user-media-cam").html("&#xE04C;"),l()("#videoOn").hide(),l()("#videoOff").show()):(l()(this).removeClass("tg").addClass("tb"),l()(this).html("toggle_on"),l()("#video_select").show(),window._channel.unmuteVideo(),window.devices.unmuteVideoDevice(),p.CONFIG.banubaEffect&&l()("#banuba-area").show(),l()("#webcam_preview").show(),l()("#user-media-cam").css({"background-color":"#707070","border-color":"#707070"}),l()("#user-media-cam").html("&#xE04B;"),l()("#videoOn").show(),l()("#videoOff").hide())),!1)})),l()("#video_select").on("change",(function(){const e=l()(this).val();window.devices.setVideoInputDevice(e),E(`Video device changed: ${l()(this).val()}`),br()})),l()("#dbdev_quit").on("click",(function(){l()(".dialog").hide(),window._channel.close()})),l()("#dbdev_cancel").on("click",(function(){window.devicesStream&&window.devicesStream.getTracks().forEach((e=>{e.stop()})),l()("#rpchnconf").hide(),l()("#rpchnconficon").removeClass("tb"),l()("#rpchnhi").removeClass("ic_collaborate_ON"),l()(".dialog").hide(),window._channel.getModes().A&&(window.devices.muteVideoDevice(),window.devices.muteAudioDevice(),l()("#dbdev-audio-input-toggle").removeClass("tb"),window.devicesStream&&window.devicesStream.getTracks().forEach((e=>{e.stop()})),l()("#video_select").hide(),window._channel.muteVideo(),window._channelCtrl.updateCapture(),l()("#user-media-cam").css({"background-color":"#F95252","border-color":"#F95252"}),l()("#user-media-cam").html("&#xE04C;"),l()("#videoOn").hide(),l()("#videoOff").show(),l()("#dbdev_confirm").click())})),l()("#dbdev_confirm").on("click",(async function(){const e=l()("#dbdev_confirm").attr("target"),t="1"===l()("#dbdev_confirm").attr("tx");let n,i;if(E(`[Devices] Confirm button clicked! Target: "${e}" - enableTx: "${t}" - mediaVoice: "${"1"===l()("#dbdev_confirm").attr("mediavoice")}"`),window.devicesStream&&window.devicesStream.getTracks().forEach((e=>{e.stop()})),window.timeoutShowed=!1,window.sessionTimerShowed=!1,l()("#rpchnconf").hide(),l()("#rpchnconficon").removeClass("tb"),!window.devicesPermissions)return!1;if(window.devicesPermissions.audioAllowed)n=window._captureCtrl.audioSource();else if(window.devices.muteAudioDevice(),window.devices.isVideoDeviceMuted()&&window._channel.isTransmitting())return window._channel.muteVideo(),window.devices.muteVideoDevice(),window._channelCtrl.updateCapture(),l()(".dialog").hide(),!1;window.devicesPermissions.webcamAllowed?i=window._captureCtrl.videoSource():window.devices.muteVideoDevice(),(window.devices.isVideoDeviceMuted()||window.camNotReadable)&&(i=void 0),window.devices.isVideoDeviceMuted()&&(window._channel.muteVideo(),window.devices.muteVideoDevice(),window._captureCtrl.setSelectedEffect("none"),window._channelCtrl.updateCapture()),l()("#control-screensharing-stop").hide(),window._engine.callbacks().publishResponseCB((async function(e,t,n){if(E(`PublishResponseCB: videoEnabled: ${e} timeout: ${t} error: ${JSON.stringify(n)}`),!n&&t){if("m"!==window._channel.getSuffix()&&(window._engine.unpublish(),window.session.isReconnecting()&&"p"===window._channel.getSuffix())){const e=await window.session.getActiveSessionInfo();if(e.session_id){const t=e.session.live_duration?e.session.live_duration:0;await session.finishSession(e.session_id,{live_duration:t}),l()("#record-option-stop").hide(),l()("#record-option-start").show(),l()("#record-option-icon").css("color","")}return!1}return window.metaverse?.started||window._channel.getMedias().includes(p.ENGINE_NICK)||function(){const e=window.i18n.get("error-publish"),t=`${window.i18n.get("error-publish-timeout")}. ${window.i18n.get("try-again")}?`;new hr(e,t,(()=>(yr(window.engineNick,!0,!1),!1)),(()=>!1)).present()}(),!1}l()("#rpchnhi").addClass("ic_collaborate_ON"),l()("#rpchnhi").addClass("tb"),window._channel.hideTemporaryMessage(),window._channel.getClosedCaption()?window._channelCtrl.speechRecognitionStart():window._channelCtrl.speechRecognitionStop();const i=window._engine.currentChannel();if("meeting"!==window.breakoutRoom.getRoomType(i)&&l()("#chn-session-continue-btn").hide(),void 0===window._channel.getMyMedia()[0])return!1;const s=window._engine.txInfoAvconf(!0)?.mediaId;window.devices.isVideoDeviceMuted()?(window._channel.muteVideo(),window.devices.muteVideoDevice(),window._channel.getMyMedia()[0].metadata.screen||l()(`#${s}`).hide(),l()("#user-media-cam").css({"background-color":"#F95252","border-color":"#F95252"}),l()("#user-media-cam").html("&#xE04C;"),l()("#videoOn").hide(),l()("#videoOff").show()):(window._channel.unmuteVideo(),window.devices.unmuteVideoDevice(),l()(`#${s}`).show(),l()("#user-media-cam").css({"background-color":"#707070","border-color":"#707070"}),l()("#user-media-cam").html("&#xE04B;"),l()("#videoOn").show(),l()("#videoOff").hide());const o=window._engine.txInfoAvconf(!0)?.mediaId;window.devices.isAudioDeviceMuted()?(window._engine.muteAudio(o),window._channel.muteAudio(),l()("#user-media-mic").css({"background-color":"#F95252","border-color":"#F95252"}),l()("#user-media-mic").html("&#xE02B;"),l()("#audioOn").hide(),l()("#audioOff").show()):(window._engine.unmuteAudio(o),window._channel.unmuteAudio(),l()("#user-media-mic").css({"background-color":"#707070","border-color":"#707070"}),l()("#user-media-mic").html("&#xE029;"),l()("#audioOn").show(),l()("#audioOff").hide()),window.config.allowClosedCaption?(l()("#display-define-layout").hide(),l()("#control-more-area").css("top","-65px"),l()("#control-display").html("more_vert"),l()("#control-display").show(),l()("#display-grid-area").show(),l()("#cc-select").show()):(l()("#display-define-layout").hide(),l()("#control-more-area").css("top","-65px"));let r=!1;if(0===window._channel.getType()&&window._channel.getChannel(window._engine.currentChannel())&&(r=window._channel.getChannel(window._engine.currentChannel()).enable_csm),0===window._channel.getType()&&window._channel.isOperator(p.ENGINE_NICK)&&r&&window.permissions.csm_session_create?(l()("#control-display").show(),l()("#record-option").show(),window.config.allowClosedCaption?l()("#control-more-area").css("top","-111px"):l()("#control-more-area").css("top","-60px")):l()("#record-option").hide(),window.session){window.countdown&&window.countdown.stop();const e=async function(){if(window.session.isStartNeeded()){const e=window.session.getExtras();let t,n;if("school"===window.realm||"staging"===window.realm||"edusp"===window.realm)if("rerecord"===window.session.getType()||"record"===window.session.getType())n=window.session.getId(),t=await window.session.start(e,n);else{if(!((new Date).getTime()-window.lastPublish>6e4)){window.session.finishSession(),window.Events.dispatch("session/show-session-start-btn"),l()("#dbcsm-session-date-area-select").hide();const e=window._engine.currentChannel();"meeting"!==window.breakoutRoom.getRoomType(e)&&(window._engine.txInfoAvconf(!0)&&window._engine.requestTransmission(p.ENGINE_NICK,!1,!0),window._channel.stopAllTransmissions());const t={};return t.errors=[{message:window.i18n.get("error-csm-wait")}],z(t),!1}window.lastPublish=(new Date).getTime(),t=await window.session.create(e),n=t.id,window.session_id=t.id,t=await window.session.start(e,n)}else{if(!((new Date).getTime()-window.lastPublish>6e4))return E("Error creating session: Too many requests!"),!1;window.lastPublish=(new Date).getTime(),t=await window.session.create(e),n=t.id,window.session_id=t.id,t=await window.session.start(e,n)}return!1===t?(window.session.reset(),1===window._channel.getType()&&"m"!==window._channel.getSuffix()&&window._channel.stopAllTransmissions(),E("Error creating session!"),!1):(window.session_id=t.id,window.createdAt=t.created_at,window.sessionFinishedAt=(new Date).getTime()+1e3*t.max_duration,localStorage.setItem("session_category_ids",JSON.stringify(t.category_ids)),E(`Session started: ${JSON.stringify(t)}`),l()("#chn-session-start-btn").hide(),l()("#chn-session-continue-btn").hide(),window.session.startNeeded(!1),!0)}return!0},t=async function(){const e=window.i18n.get("session-initiating-recording");if(window.session.isStarted()&&window._channel.isOperator(p.ENGINE_NICK)){window._recorderCtrl.isStarted()||window._channel.showTemporaryMessage(e,"loading",4900),window.session.isRunning()||(window.streamTimer.reset(),window.session.startUserListUpdate()),window.countdown&&(window.countdown.isStarted()?window.countdown.stop():(window.session.hideTimer(),window.sessionTimerShowed=!1)),window._channel.setRecordingDisplay(""),window.session.setRunning(!0),l()("#session-timer-icon").removeClass("tr");const t=window.sessionFinishedAt-(new Date).getTime()-window.tsDiff;window.sessionTimerShowed=!1,window.countdown=new G(t,((e,t)=>{window.sessionTimerShowed||window._recorderCtrl.isStarted()&&(window.session.showTimer(),l()("#session-recording").show(),window.sessionTimerShowed=!0),t<=12e4&&t>108e3?(l()("#session-timer-icon").hasClass("tr")||l()("#session-timer-icon").addClass("tr"),l()("#session-timer-value").html(`<span class="tr">${e}</span>`),window.timeoutShowed||(window.timeoutShowed=!0,window.audioTimeIsRunningOut.play(),l()("#alert-time-remaining").show(),setTimeout((()=>{l()("#alert-time-remaining").hide()}),1e4))):(l()("#session-timer-icon").removeClass("tr"),l()("#session-timer-value").html(e))}),(()=>{window._channel.isDefaultRecord()?(window._channel.stopDefaultRecording(),l()("#record-option-stop").hide(),l()("#record-option-start").show(),l()("#record-option-icon").css("color","")):l()("#chn-session-stop-btn").click()})),window.countdown.start(),l()("#chn-session-start-btn").hide(),setTimeout((function(){1===window._channel.getType()&&(l()("#chn-session-stop-btn").show(),l()("#chn-session-continue-btn").hide()),window._windowCtrl.redrawWindows()}),6e3),setTimeout((function(){window._recorderCtrl.isStarted()||window.Events.dispatch("record/start","main")}),5e3),l()("#control-display").show(),1===window._channel.getType()?l()("#display-define-layout").show():l()("#display-define-layout").hide(),l()("#display-grid-area").show(),window.config.allowClosedCaption?l()("#cc-select").show():(l()("#control-display").html("dashboard"),l()("#cc-select").hide(),l()("#control-more-area").css("top","-60px"))}else window.session.isRunning()&&window._channel.isOperator(p.ENGINE_NICK)?l()("#control-display").show():window.config.allowClosedCaption||window._channel.isOperator(p.ENGINE_NICK)||(l()("#control-display").hide(),l()("#control-more-area").hide());return!0};!async function(){await e()&&await t()}()}else"school"!==window.realm&&"staging"!==window.realm&&(l()("#control-display").hide(),l()("#control-more-area").hide());const a=window._channel.getCsmObject();let c=!1;a&&(c=a.recording);const d="m"===window._channel.getSuffix();let u=!1,h=!1;if(d){const e=p.ROOM[window._engine.currentChannel()];e&&(u=e.enable_csm,h=e.oper.includes(p.NICK))}let m=!1;if(p.PERMISSIONS&&(m=p.PERMISSIONS.csm_session_create),l()("#chn-session-continue-btn").is(":visible")&&(window.allowDialogReminder=!1),window.allowDialogReminder&&d&&u&&h&&m&&!c){l()(".dialog").hide(),l()("#dbdisplay_confirm").css("background-color","rgb(97, 196, 40)"),l()("#dbdisplay_confirm").html(window.i18n.get("record-start")),l()("#dbdisplay_confirm").css("margin-left","10px");const e="AtenÃ§Ã£o",t=window.i18n.get("record-reminder");new mr(e,t,(()=>{l()("#dbdisplay_confirm").css("background-color",""),l()("#dbdisplay_confirm").css("margin-left",""),l()("#dbdisplay_confirm").html(window.i18n.get("confirm")),l()("#chn-session-start-btn").click(),l()(".dialog").hide(),window.allowDialogReminder=!1}),(()=>{l()("#dbdisplay_confirm").css("margin-left",""),l()("#dbdisplay_confirm").css("background-color",""),l()("#dbdisplay_confirm").html(window.i18n.get("confirm")),l()(".dialog").hide(),window.allowDialogReminder=!1}),"350px","170px").present()}}));const s=window.devicesPermissions.webcamAllowed,o=window.devicesPermissions.audioAllowed;if(!(n||i||s||o)){l()(".dialog").hide();const e=window.i18n.get("error-publish"),t=window.i18n.get("devices-blocked");return new dr(e,t,(()=>{l()(".dialog").hide()})).present(),!1}{const e=window._engine.txInfoAvconf(!0)?.mediaId;l()("#dbdev-audio-input-toggle").hasClass("tb")?(window.devices.unmuteAudioDevice(),window._engine.unmuteAudio(e),window._channel.unmuteAudio(),l()("#user-media-mic").css({"background-color":"#707070","border-color":"#707070"}),l()("#user-media-mic").html("&#xE029;"),l()("#audioOn").show(),l()("#audioOff").hide()):(window.devices.muteAudioDevice(),window._engine.muteAudio(e),window._channel.muteAudio(),l()("#user-media-mic").css({"background-color":"#F95252","border-color":"#F95252"}),l()("#user-media-mic").html("&#xE02B;"),l()("#audioOn").hide(),l()("#audioOff").show())}if(t?(window._engine.isTxEnabled()&&(E("Tx is enabled!"),setTimeout((()=>{window._engine.isCapturingAudioCam()||window._engine.isTxEnabled()&&window._engine.publish()}),3e3)),window._channel.setTransmitting()):E("Tx is not enabled!"),window.Invite&&window.Invite.data.channel===window._channel.getName()&&p.NICK===window.Invite.data.host)return window.Events.dispatch("invite/ephemeral-show-share-link-dialog"),!1;l()(".dialog").hide()})),window.devices.setDeviceChangeCB((()=>{E("Some device(s) changed! Updating devices list!"),async function(e){const t=await window.devices.getAudioInputDevices();let n;""===window.devices.getAudioInputDevice()?(n=t[0],n&&window.devices.setAudioInputDevice(n.deviceId)):n=window.devices.getAudioInputDevice(),l()(`#${e}`).html(""),t.forEach((t=>{const i=t.label;t.deviceId===n?l()(`#${e}`).append(`<option value="${t.deviceId}" selected>${i}</option>`):l()(`#${e}`).append(`<option value="${t.deviceId}">${i}</option>`)}))}("audio_input_select"),gr("audio_output_select"),async function(e){const t=await window.devices.getVideoInputDevices();let n;""===window.devices.getVideoInputDevice()?(n=t[0],n?window.devices.setVideoInputDevice(n.deviceId):(l()("#dbdev-video-toggle").removeClass("tb").addClass("tg"),l()("#dbdev-video-toggle").html("toggle_off"),l()("#video_select").hide())):n=window.devices.getVideoInputDevice(),l()(`#${e}`).html(""),t.forEach((t=>{const i=t.label;t.deviceId===n?l()(`#${e}`).append(`<option value="${t.deviceId}" selected>${i}</option>`):l()(`#${e}`).append(`<option value="${t.deviceId}">${i}</option>`)}))}("video_select")})),window.webSpeech.setStartCB((()=>{})),window.webSpeech.setStopCB((()=>{})),window.webSpeech.setInterimResultCB((e=>{l()("#media-cc-interim").css("color","#AAAAAA"),l()("#media-cc-interim").html(e)})),window.webSpeech.setResultCB((e=>{E(`CC: "${e}"`),l()("#media-cc-interim").css("color","#FFFFFF"),l()("#media-cc-interim").html(e)})),window.webSpeech.setNotSupportedCB((()=>{l()("#media-cc").removeClass("fr"),l()("#media-cc").addClass("frm"),l()("#media-cc-interim").html("Close Caption nÃ£o suportado por este navegador.<br />Utilize a versÃ£o 25 do Chrome ou superior!")}))}function Mp(){_app.callbacks().sendMsgCB((function(e,t,n){if(E(`Sendmsgcb: ${JSON.stringify(e)}`),""==e.text)return!1;const i=e.target.replace(/#/g,"__hash__");if($(`.statusTick${i}`)&&$(`.statusTick${i}`).remove(),window.pushSeq!=window.lastPushSeq&&0==$(`#msgId${e.sequence}`).length){let t="";if(6==e.type){const n={};n.text=e.text,n.type=6;const s=$(`#hp${i}`),o=$(`#chnprivh_${i}`);let r,a;!function(e,t,n,i){let s=""===e?"&nbsp":e;1===t&&(s='<span class="material-icons lpbi">&#xE310;</span>&nbsp;Ãudio'),2===t&&(s='<span class="material-icons lpbi">&#xE853;</span>&nbsp;Contato'),3===t&&(s='<span class="material-icons lpbi">&#xE40B;</span>&nbsp;Imagem'),4===t&&(s='<span class="material-icons lpbi">&#xE55F;</span>&nbsp;LocalizaÃ§Ã£o'),5===t&&(s='<span class="material-icons lpbi">&#xE06F;</span>&nbsp;Documento'),6===t&&e.length>20&&(s=`${e.substring(0,20)}...`),7===t&&(s='<span class="material-icons lpbi">&#xE63A;</span>&nbsp;VÃ­deo'),8===t&&(s="[Aplication]"),9===t&&(s="[Proposal]"),10===t&&(s="[Game]"),11===t&&(s='<span class="material-icons lpbi">&#xE157;</span>&nbsp;Link'),12===t&&(s="[Banner]"),13===t&&(s='<span class="material-icons lpbi">&#xE8FD;</span>&nbsp;Pergunta'),14===t&&(s="[Answer]"),15===t&&(s="[GIF]"),function(e){r=e,a=e.replace('class="ss','class="sxs')}(`<span class="ss l lpcm pl5" sequence="${n}">${s}</span><span class="fig"></span>`)}(n.text,n.type,e.sequence),t=1!=s.find(".msg").last().attr("d")?"":"noTail";let c=`<div class="fr msg ${t}" d="1" tp="6"><div class="fic pl5"><input type="checkbox" class="chkb" msgId="${e.sequence}" mode="msg"></div><div class="msgRight fig"><div id="msgId${e.sequence}"class="bubble bubbleRight ${t}">`;c+=`<div class="msgText" style="max-width: 238px;padding-right:0;padding-bottom:15px">${A(n)}</div>`,c+='<div class="msgMeta"><span class="msgTime">';const l=new Date;let d=l.getMinutes();d<10&&(d=`0${d}`),c+=`${l.getHours()}:${d}`,window.config.messenger&&(c+='<span class="material-icons tg sn p0 pl5">&#xE8B5;</span>'),c+=`</span></div><div class="material-icons more moreRight" t="${e.target}">&#xE065;</div></div><div class="tailRight ${t}"></div>`,c+="</div></div>",""!=e.source&&null!=e.source?($(`#lpc${i}`).find(".lpcm").html(r),$(`#chatTab${i}`).find(".lpcm").html(a)):($(`#lpc${i}`).find(".lpcm").html(`<span class="statusTick${e.sequence} material-icons tg sn p0">&#xE8B5;</span>${r}`),$(`#chatTab${i}`).find(".lpcm").html(`<span class="statusTick${e.sequence} material-icons tg sn p0">&#xE8B5;</span>${a}`)),0!=s.length&&(s.append(c),setTimeout((function(){s.scrollTop(s[0].scrollHeight)}),100)),0!=o.length&&(o.append(c),setTimeout((function(){o.scrollTop(o[0].scrollHeight)}),100)),window.config.messenger||null!=_engine.currentChannel()&&(1==window._channel.getType()||""==window._channel.getActiveRoom()?window._engine.requestSendPrivateMessage(e.text,e.target,1):window._groupEngine.requestSendPrivateMessage(e.text,e.target,1)),window.lastIdlePushSeq=window.pushSeq}}})),_chat.callbacks().panelUserCB((function(e){})),_app.callbacks().resetCB((function(e,t){})),_app.callbacks().logoutCB((function(){const e=localStorage.getItem("selectedRealm"),t=localStorage.getItem("persistentConfigs");let n=localStorage.getItem("roomsList");n&&(n=JSON.parse(n),n.rooms.forEach((function(e){localStorage.removeItem(`room_${e.name}`)})),localStorage.removeItem("roomsList")),window.login.removeDeviceData(),window._captureCtrl&&window._captureCtrl.stop(),null!=window._engine.currentChannel()&&window._engine.requestLeaveChannel(window._engine.currentChannel(),""),window._engine.stop(),document.cookie="session=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; SameSite=None; Secure",document.cookie="session=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=./; SameSite=None; Secure",document.cookie="session=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=./w/; SameSite=None; Secure",document.cookie="tabId=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=./; SameSite=None; Secure",window.location.href=`/login${window.location.search}`,localStorage.clear(),e&&localStorage.setItem("selectedRealm",e),t&&localStorage.setItem("persistentConfigs",t)})),_app.callbacks().notifyMsgStatusCB((function(e,t,n){})),l()("body").click((function(e){const t=l()(e.target);l()("#popup").is(":visible")&&!t.is(".more")&&0==t.parents("#popup").length&&l()("#popup").hide(),l()("#lpctx").is(":visible")&&l()("#lpctx").hide()})),l()("body").on("click","a",(function(e){e.preventDefault();const t=l()(this).attr("href");if("3"==l()(this).attr("type"))return/\.(jpeg|jpg|gif|png)/.test(t)?(window.open(t),!1):(window.open(`/g/openImg/${n=t,n.replace(/[\/\.]/g,(e=>({"/":"%2F",".":"%2E"}[e]||e)))}`),!1);var n;t&&window.open(t)})),l()("body").on("keydown",(function(e){if((e.metaKey||e.ctrlKey)&&"m"===String.fromCharCode(e.which).toLowerCase()){const e="AlteraÃ§Ã£o de servidor webRTC";let t="";"string"==typeof window.config.janusServer?t=window.config.janusServer:window.testJanusServer=window.config.janusServer,new wr(e,`Servidor: <input type="text" name="webRTCServer" id="webRTCServer" class="sxs bor br p5" size="50" value="${t}">`,(async()=>{let e=l()("#webRTCServer").val().trim();e=e.replace("wss://","");const t=e.split(":")[0];let n=443;if(e.split(":")[1]&&(n=parseInt(e.split(":")[1])),""===e)return await Fr(),E("Tx: WebRTC Server changed to default parameters"),!1;p.IRM_SERVERS=null,p.JANUS_SERVER=[`wss://${t}:${n}`],window.roomsServers=[`${t}:${n+14557}`],E(`Tx: WebRTC Server changed to ${t}:${n}`),console.log(`Tx: WebRTC Server changed to ${t}:${n}`)})).present()}})),l()("#chi").click((function(){l()(".ic_group").removeClass("ic_group_ON"),l()("#fit").val(""),l()(".lpfr").hide(),l()("#lpfro").hide(),l()("#lpfro").html(""),l()(".lpfro").hide(),l()("#lpfb").attr("t","c"),l()(".lpi").removeClass("lpis"),l()(this).addClass("lpis"),l()("#chnCategoriesMenu").hide(),l()("#channelCategories").hide(),l()("#channelArea").hide(),l()("#chatArea").show(),l()("#otherArea").hide(),l()("#chnprivchatsarea").html(""),l()(".us").removeClass("uss"),l()("#lpfr").html(""),null==_engine.currentChannel()&&l()("#rpchn").hide(),null!=_engine.currentChannel()&&("-c"==_engine.currentChannel().slice(-2)?(window._captureCtrl.stop(),_engine.requestLeaveChannel(_engine.currentChannel(),""),_engine.stop()):(window._captureCtrl.stop(),_engine.requestLeaveChannel(_engine.currentChannel(),""))),l()(`#lpc${lastTarget}`).addClass("uss"),l()("#lpchb").hide(),l()("#lpchm").hide(),l()("#lpfb").attr("t","c"),l()("#lpfb").show(),l()("#lpcb").show(),l()("#lppb").hide(),l()("#fi").removeClass("tb"),l()(".rpme").removeClass("toj"),l()("#rpEmoticon").hide()})),l()("#pei").click((function(){l()(".ic_group").removeClass("ic_group_ON"),l()("#fit").val(""),l()(".lpfr").show(),l()("#lpfro").show(),l()("#lpfro").html(""),l()(".lpfro").hide(),l()("#lpfb").attr("t","p"),l()(".lpi").removeClass("lpis"),l()(this).addClass("lpis"),l()("#chnCategoriesMenu").hide(),l()("#channelCategories").hide(),l()("#channelBody").hide(),l()("#channelArea").hide(),l()("#chatArea").show(),l()("#otherArea").hide(),l()("#lpfr").html(""),null==_engine.currentChannel()&&l()("#rpchn").hide(),l()("#lpchm").hide(),l()("#lpfb").attr("t","p"),l()("#lpfb").show(),l()(".rpme").removeClass("toj"),l()("#rpEmoticon").hide(),null!=_engine.currentChannel()&&("-c"==_engine.currentChannel().slice(-2)?(window._captureCtrl.stop(),_engine.requestLeaveChannel(_engine.currentChannel(),""),_engine.stop()):(window._captureCtrl.stop(),_engine.requestLeaveChannel(_engine.currentChannel(),""))),l()("#lppb").html(""),window.aPeople.forEach((function(e){if(null!=window.lPeople[e.nick]&&!1!==window.lPeople[e.nick].friend&&"false"!=window.lPeople[e.nick].friend){let t="";t=`<div id="lpp${e.nick}" class="fr w100 pl10 pt10 pr10 us pt" nick="${e.nick}" name="${e.name}" group="false" avatar_id="${e.avatar_id}">`,"undefined"==e.avatar_id||null==e.avatar_id?t+=`<img src="${window.assets}/common/img/avatarPerson.png" class="cp">`:t+=`<img src="${window.files_base_url}avatars/user/${e.nick}/thumb.jpeg" class="cp">`,t+='<div class="fc fig pl5"><div class="fr w100">',t+=`<span class="sn toj">${e.name}</span><span class="fig"></span></div>`,t+=`<div class="fr w100"><span class="ss">${e.nick}</span>`,t+='<span class="fig"></span><span class="ci sxs"></span></div>',t+='<span class="li w100"></span></div></div>',l()("#lppb").append(t)}})),l()("#lpchb").hide(),l()("#lpcb").hide(),l()("#lppb").show()})),l()("#lms").click((function(){l()(".lpi").removeClass("lpis"),l()(".ic_group").removeClass("ic_group_ON"),l()(".ic_group").removeAttr("selected"),l()(this).addClass("lpis"),window.open(window.config.lmsLink,"_blank")})),l()("#channelLmsIcon").click((function(){window.open(window.config.lmsLink,"_blank")})),l()("#gci").click((function(){window.open(window.config.googleClassroomLink,"_blank")})),l()(".ic_group").removeClass("ic_group_ON"),l()("#coi").click((function(){confAlertNewMessageSound?l()("#dbconfnm").prop("checked",!0):l()("#dbconfnm").prop("checked",!1),l()(".lpfr").hide(),l()("#lpfro").html(""),l()(".lpfro").hide(),l()(".dialog").hide(),l()("#dbconf").show(),l()("#dialog").show()})),l()("#channelChatTabList").on("click",".us",(function(e){!function(e){l()(".us").removeClass("uss");const t=e.nick.replace(/#/g,"__hash__");if(l()(`#lpc${t}`).addClass("uss"),l()(`#chatTab${t}`).addClass("uss"),lastTarget=e.nick,null!=window.lMsg[e.nick]&&window.lMsg[e.nick].length>0&&_app.sendMsgStatus(e.nick,window.lMsg[e.nick].filter((function(e,t,n){return n.indexOf(e)==t})),5),l()(`#lpc${t}`).find(".ci").html(""),l()(`#lpc${t}`).find(".lpcu").removeClass("lpcut"),l()(`#chatTab${t}`).find(".ci").html(""),l()(`#chatTab${t}`).find(".lpcu").removeClass("lpcut"),0==l()(`#chnprivc_${t}`).length){const t={};t.nick=e.nick,t.name=e.name,t.avatar_id=e.avatar_id,t.group=e.group,l()(".chnprivchatsarea").show(),function(e){const t=e;let n,i="";const s=t.nick.replace(/#/g,"__hash__");if(n="true"==t.group?"&nbsp;":t.nick,i=`<div id="chnprivc_${s}" class="fc bgw bor brtl brtr sha " style="width:384px;text-align:center;margin-right:10px;display:none;" t="${s}" name="${t.name}">`,i+=`<div class="bglg brtl brtr fr w100 pl5 pr5 chnprivmaxmin pt" style="border:0px;height:60px;border-bottom:1px;border-style:solid;border-color:#F0F0F0;" t="${s}"><div class="fic pt" style="width:50px">`,""!=t.avatar_id&&null!=t.avatar_id&&"undefined"!=t.avatar_id?"true"==t.group?i+=`<img src="${window.files_base_url}avatars/group/${t.nick}/thumb.jpeg" class="cp rphi">`:i+=`<img src="${window.files_base_url}avatars/user/${t.nick}/thumb.jpeg" class="cp rphi" onerror="loadDefaultAvatar(this);">`:"true"==t.group?i+=`<img src="${window.assets}/common/img/avatarGroup.png" class="cp rphi">`:i+=`<img src="${window.assets}/common/img/avatarPerson.png" class="cp rphi">`,i+=`</div><div class="fc fig fic pt"><div class="sn pt toj pl5">${t.name}</div>`,"true"!=t.group&&(i+=`<div class="sxs pl5">${t.nick}</div>`),i+=`</div><div class="fic pt chnprivclose" style="width:15px" t="${t.nick}">X</div></div>`,i+=`<div id="chnprivb_${s}" class="fc w100 fig" style="height:300px;">`,i+=`<div id="chnprivh_${s}" class="rpb fig w100 chnprivc_${s}" style="overflow-y:auto;" target="${t.nick}"><div class="rpbw frm pt5"><span class="" target="${t.nick}"></span></div>`,i+=`<div class="scrolldown" t="${t.nick}" style="position:absolute;bottom:70px;right:10px;z-index:9;display:none;"><span class="material-icons p5 tg bor brr bgw sha">&#xE313;</span></div></div>`,i+=`<div class="w100 bglg fcm" style="height:60px;min-height:60px;" t="${t.nick}">`,i+=`<div class="fr w100"><div class="rpm bglg fr pr10"><span class="rpmap tdg bor sha" t="${t.nick}" group="${t.group}" style="text-align:left;"><div class="rpmaiiv"><span class="material-icons material-icons tb rpma">&#xE3F4;</span><span class="tl">Fotos e VÃ­deos</span></div><div class="rpmaid"><span class="material-icons material-icons tb rpma">&#xE24D;</span><span class="tl">Compartilhar Documento</span></div><div class="rpmaia"><span class="material-icons material-icons tb rpma">&#xE050;</span><span class="tl">Compartilhar Ãudio</span></div><div class="rpmaic"><span class="material-icons material-icons tb rpma">&#xE0BA;</span><span class="tl">Compartilhar Contato</span></div></span><div class="fic"><span class="material-icons material-icons tg rpme" t="${t.nick}" privChat="privChat">&#xE24E;</span></div>`,"iptv"!=_user.getRealm()&&(i+=`<div class="fic"><span class="material-icons material-icons tb rpma rpmat" t="${t.nick}" privChat="privChat">&#xE226;</span></div>`),i+=`<div class="fic fig rmc"><textarea id="privChat${s}" class="w100 br sn rm" style="position:absolute;left:0px;border-color:#CCC;height:30px;resize:none;" t="${t.nick}" type="privChat" onkeydown="inputKeyDown(event,this);" onkeyup="inputKeyUp(event, this);" oninput="inputChange(event, this);"></textarea></div></div></div>`,l()("#chnprivchatsarea").append(i),l()("#chnprivchatsarea").is(":visible")||(l()("#chnprivchatsarea > .fc").hide(),l()(`#chnprivc_${s}`).show()),setTimeout((function(){l()(`#privChat${s}`).focus()}),500),null!=l()(`#chnprivh_${s}`)&&L(`chnprivh_${s}`),"iptv"!=_user.getRealm()){l()(".rpb").unbind("scroll"),l()(".rpb").on("scroll",(function(){const e=l()(this).attr("target");null!=window.lMsg[e]&&tabSelected&&l()(".uss").attr("nick")==e&&window.lMsg[e].length>0&&(l()(`#lpc${s}`).find(".ci").html(""),l()(`#lpc${s}`).find(".lpcu").removeClass("lpcut"),l()(`#chatTab${s}`).find(".ci").html(""),l()(`#chatTab${s}`).find(".lpcu").removeClass("lpcut"),_app.sendMsgStatus(e,window.lMsg[e].filter((function(e,t,n){return n.indexOf(e)==t})),5));let t=30;0==l()(this).scrollTop()&&"1"!=l()(this).find(".msg").attr("c")&&(l()(".rpb").outerHeight()>900&&(t=parseInt(l()(".rpb").outerHeight()/40)+5),l()(`#hp${s} > .rpbw`).find("span").addClass("loader"),l()(`#chnprivh_${s} > .rpbw`).find("span").addClass("loader"),l()(this).find(".msg").attr("c","1"),l()(`#chnprivh_${s} > .rpbw`).find("span").addClass("loader"),_app.loadMsgs(l()(this).find(".msg").attr("t"),l()(this).find(".msg").attr("s"),t)),l()(this).scrollTop()<l()(this)[0].scrollHeight-l()(this).height()-70?l()(this).find(".scrolldown").show():l()(this).find(".scrolldown").hide()}));let e=30;l()(".rpb").outerHeight()>900&&(e=parseInt(l()(".rpb").outerHeight()/40)+5),l()(`#chnprivh_${s} > .rpbw`).find("span").addClass("loader"),_app.loadMsgs(t.nick,void 0,e)}}(t)}else l()(".chnprivchatsarea").show(),l()("#chnprivchatslist").hide(),l()("#chnprivchatsarea > .fc").hide(),l()(`#chnprivc_${t}`).show()}({nick:l()(this).attr("nick"),name:l()(this).attr("name"),avatar_id:l()(this).attr("avatar_id"),group:l()(this).attr("group")})})),l()("#rp").on("click",".scrolldown",(function(){const e=l()(this).attr("t");l()(`#hp${e}`).scrollTop(l()(`#hp${e}`)[0].scrollHeight),l()(`#hp${e}`).find(".scrolldown").hide()})),l()("#channel_rp").on("click",".scrolldown",(function(){l()("#hp__Channel__").scrollTop(l()("#hp__Channel__")[0].scrollHeight),l()("#hp__Channel__").find(".scrolldown").hide()})),l()("#chnprivchatsarea").on("click",".scrolldown",(function(){const e=l()(this).attr("t");l()(`#chnprivh_${e}`).scrollTop(l()(`#chnprivh_${e}`)[0].scrollHeight),l()(`#chnprivh_${e}`).find(".scrolldown").hide()})),l()("#app").on("click",".mention",(function(){const e=l()(this).attr("t"),t=l()(this).attr("nick"),n=t.length,i=l()(`#mention_${e}`).attr("selectionStart"),s=l()(`#mention_${e}`).attr("search");let o=l()(`#textArea${e}`)[0].value;o=o.replace(/\@\w*$/,`@${t} `),l()(`#textArea${e}`)[0].value=o,l()(`#textArea${e}`).focus(),o.length!=i&&l()(`#textArea${e}`).prop("selectionEnd",i-s.length+n+2),l()(`#mention_${e}`).hide(),l()(`#mentionList_${e}`).html("")}))}function Tp(){let e=!1,t="";return{start:function(n){return!!n&&(e=!0,t=n,E(`Debug started for target ${n}!`),!0)},stop:function(){e=!1,t="",E("Debug stoped!")},sendText:function(n){const i=n.substr(0,300);e&&window._engine.requestSendPrivateMessage(i,t,1)},isActive:function(){return e},request:function(e,t){const n=String.fromCharCode(1),i=p.ENGINE_NICK,s=e;let o;return o=t?"1":"0",s?(window._engine.requestSendPrivateMessage(`${n}DEBUG ${i},${o}${n}`,s,1),console.log(`Debug requested to target ${s}`),!0):(E("Debug request error: need target parameter!"),!1)}}}window.gzip=new function(){let e="";function t(e){return xp.inflate(e,{to:"string"})}return{setData:function(t){return e=t,!0},getData:function(){return e},compress:function(e){return xp.deflate(e)},uncompress:t,b64Compress:function(e){const t=xp.deflate(e);return btoa(String.fromCharCode.apply(null,t))},b64Uncompress:function(e){const n=atob(e).split("").map((function(e){return e.charCodeAt(0)}));return t(n)}}},window.ldjson=new function(){let e=[];const t={};return{push:function(t){let n=t;if("string"==typeof t)try{n=JSON.parse(t)}catch{return console.log(`Error trying to parse: ${t}`),!1}return e.push(JSON.stringify(n)),!0},set:function(e,n){t[e]?t[e][n]?t[e][n]+=1:t[e][n]=0:(t[e]={},t[e][n]=0)},get:function(){let e="";return Object.entries(t).forEach((t=>{e+=`${t}\n`})),e},clear:function(){e=[]}}},l()("#rpchni").on("click",(()=>{})),window.webSpeech=new function(){let e=null,t=!1,n=null,i=null,s=null,o=null,r=null;return{start:function(){if(window.SpeechRecognition=window.webkitSpeechRecognition||window.SpeechRecognition,void 0===window.SpeechRecognition){const e={error:"This browser does not support Web Speech API!"};return r&&r(),E(e),!1}return e=new window.SpeechRecognition,e.continuous=!0,e.interimResults=!0,e.maxAlternatives=1,e.lang="en-US",t=!0,e.onresult=e=>{let t="";for(let n=e.resultIndex;n<e.results.length;n+=1)if(e.results[n].isFinal){if(t=e.results[n][0].transcript,o)return o(t.trim()),!0}else t+=e.results[n][0].transcript;return s&&s(t.trim()),!0},e.onaudiostart=()=>{},e.onstart=()=>{n&&n()},e.onaudioend=()=>{},e.onend=()=>{i&&i(),t=!1,setTimeout((()=>{e&&e.start()}),500)},e.onerror=()=>{},e.start(),!0},setStartCB:function(e){n=e},stop:function(){return!!e&&(e.stop(),e=null,!0)},setStopCB:function(e){i=e},setInterimResultCB:function(e){s=e},setResultCB:function(e){o=e},setNotSupportedCB:function(e){r=e},isActive:function(){return t}}};var Ip=n(4596),Rp=n.n(Ip),Ap=n(6520),$p=n.n(Ap),Lp=n(6176),Pp=n.n(Lp),Dp=n(5120),Np=n.n(Dp),Op=n(6808),Bp=n.n(Op),Fp=n(1936),Up=n.n(Fp),jp=n(5764),Vp={};let Gp;Vp.styleTagTransform=Up(),Vp.setAttributes=Np(),Vp.insert=Pp().bind(null,"head"),Vp.domAPI=$p(),Vp.insertStyleElement=Bp(),Rp()(jp.c,Vp),jp.c&&jp.c.locals&&jp.c.locals,window.$=l(),window.startedTime=(new Date).getTime(),l()((async function(){if(window.login=new Ii,window.login.load(),function(){window.gtimer=function(e,t="/js/timer-worker-script.js"){const n=new cl(10,t);return{addListener:(e,t)=>{n.addListener(e,t)},removeListener:e=>{n.removeListener(e)},terminate:()=>{n.terminate()}}}(),window.setInitial=Fr,window.showLog=!1,window.Events=$a,window.files_base_url="",window.acs_server="",window.ppcs_server="",window.room_server="",window.msg_drop_rate=0,window.playing=0,window.mutationObserver={},window.lPeople={},window.aPeople=[],window.lastPushSeq=0,window.lastIdlePushSeq=0,window.sentPushSeq={},window.idleTimerCounter=0,window.engineUrl="",window.engineNick="",window.enginePassword="",window.engineDeviceId="",window.msgId=1,window.lChat={},window.aChat=[],window.lastTarget="",window.tabSelected=!0,window.lMsg={},window.old_value=0,window.confAlertNewMessageSound=!0,window.lChannelVoice={},window.lChannelVoices={},window.lChannelMediaVoice={},window.callStarted=!1,window.lChannelUsers={},window.aChannelUsers=[],window.lChannelMutedUsers={},window.aChannelMutedUsers=[],window.lChannelBannedUsers={},window.aChannelBannedUsers=[],window.lChannelOperators={},window.aChannelOperators=[],window.mobile=!1,window.lChannel={},window.aChannel=[],window.channelOwner="",window.wsHost="",window.receivingCall=!1,window.receivingCallTs=0,window.lastMsgTxt="",window.ogSeq=0,window.chkb=[],window.chkbForward=[],window.aForwardTargets=[],window.lForwardTargets={},window.aForwardMessages=[],window.aMoreCategories=[],window.roomsServers=[],window.room={},window.roomsConfig={},window.lastMsgTs=0,window.videocall_channel="",window.videocall_channelPassword="",window.watch_channel="",window.channelToGo="",window.pollMap=new Map,window.lastJanusServerIndex=-1,window.channelEnter="",window.channelEnterTry=0,window.brokenUrls=[],window.channelAcsMessages=[],window.lastPublish=0,window.memoryStorage={},window._poll=new eh,window.timeout=new Xu,window.C=p,window.addEventListener("error",(e=>{E(e)})),window.devices=new th,window.webAudio=new nh,window.cc=new ep,window.Invite=new np,window.i18n=new Hd,window.session=new gh,window.metaverse=new Sh,window._medias=new op,window.rooms=new Eh,window.currentSession={},window.time=new xh,window.timer=new Ur,window.timeOut=null,window.streamTimer=new Ur,window._app=new Ul,window._channel=new Dd,window._channelType={DEFAULT:0,CHATROOM:1},window.channel=new Ra,window.resizeMedia=new kh(((e,t,n)=>{const i=e?.target.id;if("rpchn"===i){let e=n-60;l()("#media-cc").is(":visible")&&(e-=100),l()("#user-media-control").is(":visible")&&(e-=64),l()("#boxesArea").height(`${e}`)}})),window.resizeMedia.insert("rpchn"),window.storage=uh,window.BanubaToken="y3gu0VC04SzEImLums/vBzRKfEC8pkAjGbiOTzWJ83PEkmmPuRAuPGvUFLGBAPM/+NZcHVvjeYFCAiriShPvG+o/kZvQLqSbFMwbbKOHhSJeif9iOny7hC/u0HmC2fKhAEXuI9wLjcgaxxDYTiMNQAb00hALX+kYz4m7xN3O5wQ1NS0zVXT7OxrGOUjeWLYuC6dtb65i8YaAJJ69xmbBf0QrJRysReuvGBqZmiWdvEj+HPF32YP1LsYQuIJR73XpwG8pr/BKjb3SheRx/93yubQq5BRIl0UDzrO8p8dChQQAcW+3p5opSaBM+Dm72LEpAjPSSqL68no395GebT38JvFXmZTK01xUVHNKjVzNnj4sUVkR3GGkh0xDiIUVKgZsVu0PoxKoqmPhvNyVZwoaK/Frv5SrDt+ICR1qv6RtYcQ9iVJQh0jR+ajUbGpvAc+OcRqF4LZsG8zmEbtmxxVBnpXhkFRw9smh1WwJd4VKjlu55mhcbiWYPQ0EsIBu1yR0JxVoMKZN0WOLQvKJ7A2wW8fySytQQDwmR+ZrN3n7SXv3HtnkuRr0pjfR5Ez5zktUGIpV8jjW2wrEc8e6DipflyUFAtlrfuGvazVBarIrjrznRTU7xLR4R/BS6wCxLVgNHynK+bIaXCzKw88Wym8p85WQhJJq1lpXcaUSj/JO5oUMMkooaWsxVANAa2a5ZCTXUPPAFaal7vlVGv9Bee9sN7ZxALSwGcElohx7cL48dE048N7BVtTLbD5Yh0BF3VpJUYNhcpBg5wDXVGnCrsuUYDslidxSjTaNn5aYW/hW0LFW/oaMiyTf8JyXCTiijdQbLtmMPM0zF4TMckWhOp8+ow2X8R9Q8REmFXp2Fp1dk3h6fE00eg==",window.url=new URL(window.location),"true"===window.url.searchParams.get("showLog")&&(window.showLog=!0),Di.g.setLogCallback((e=>{E(e)}));const e={checkTimeout:9e5,initialTs:(new Date).getTime(),validateSession:!1,logout:window._app.logout};function t(e,t){window._channel.setMsgSeq(t),window._channel.sendMsg(e,t)}function n(e,t,n){window._app.sendMsg(t,e,window.msgId,6,n)}window.activity=new Mh(e),window.log=new Th,window._engine=Fl(window.gtimer),window.engine=new up(window._engine),window.breakoutRoom=new Ah,window._windowCtrl=su(),window._channelCtrl=Ku(window._engine,window._captureCtrl),window._myMediaId=-1,window._myMediaIdScreen=-1,window._mediaIdYouTube=-2,window._txTypeAvconf="pub",window._txTypeScreen="screen",window._groupEngine=Fl(window.gtimer),window._chat=new Nd,window.inputChange=function(e,t){if(e.preventDefault(),t.value.length<12)return!1;const n=e.target.value.match(w);let i=t.getAttribute("t").replace(/#/g,"__hash__");if("channel"===t.getAttribute("type")?i="__Channel__":"groupinchannel"===t.getAttribute("type")&&(i="__Group__"),null==n&&""!==l()(`#og_${i}`).attr("og_href"))return window.ogUrl="",l()(`#og_${i}`).attr("display","hidden"),l()(`#og_${i}`).hide(),l()(`#og_${i}`).attr("og_href",""),l()(`#og_${i}`).attr("og_image",""),l()(`#og_${i}`).attr("og_text",""),l()(`#og_${i} .og_Image`).html(""),l()(`#og_${i} .og_Title`).html(""),l()(`#og_${i} .og_Description`).html(""),!1;if(null!=n&&window.ogUrl!==n[0]&&n[0].length>9&&!n[0].match(g)){E(n[0]);const s=e.target.value;window.ogUrl=n[0],window.ogSeq+=1,l().post(`/g/getOpenGraph${window.location.search}`,{data:{action:"getOpenGraph",url:n[0],seq:window.ogSeq}},(function(e){let o;if(E(JSON.stringify(e)),"0"!==e.result&&e.seq>=window.ogSeq){if(t.value.length<12)return l()(`#og_${i}`).hide(),!1;if(l()(`#og_${i}`).show(),l()(`#og_${i}`).attr("display","show"),e.data.ogUrl)l()(`#og_${i}`).attr("og_href",e.data.ogUrl),o=e.data.ogUrl.split("/")[2],l()(`#og_${i} .og_Name`).html(o);else{const e=n[0].split("/");"http:"===e[0]||"https:"===e[0]?(l()(`#og_${i}`).attr("og_href",n[0]),o=e[2]):(l()(`#og_${i}`).attr("og_href",`http://${n[0]}`),o=e[0]),l()(`#og_${i} .og_Name`).html(o)}e.data.ogImage?Array.isArray(e.data.ogImage)?e.data.ogImage[0]&&e.data.ogImage[0].url?("http"!==e.data.ogImage[0].url.substring(0,4)?"//"===e.data.ogImage[0].url.substring(0,2)?(l()(`#og_${i} .og_Image`).html(`<img src="http:${e.data.ogImage[0].url}" style="height:100%;width:100%" class="brtl brbl" onerror="loadDefaultOG(this);" />`),l()(`#og_${i}`).attr("og_image",`http:${e.data.ogImage[0].url}`)):"/"===e.data.ogImage[0].url.substring(0,1)?(l()(`#og_${i} .og_Image`).html(`<img src="http://${o}${e.data.ogImage[0].url}" style="height:100%;width:100%" class="brtl brbl" onerror="loadDefaultOG(this);" />`),l()(`#og_${i}`).attr("og_image",`http://${o}${e.data.ogImage[0].url}`)):(l()(`#og_${i} .og_Image`).html(`<img src="http://${o}/${e.data.ogImage[0].url}" style="height:100%;width:100%" class="brtl brbl" onerror="loadDefaultOG(this);" />`),l()(`#og_${i}`).attr("og_image",`http://${o}/${e.data.ogImage[0].url}`)):(l()(`#og_${i} .og_Image`).html(`<img src="${e.data.ogImage[0].url}" style="height:100%;width:100%" class="brtl brbl" onerror="loadDefaultOG(this);" />`),l()(`#og_${i}`).attr("og_image",e.data.ogImage[0].url)),l()(`#og_${i} .og_Image`).show()):l()(`#og_${i} .og_Image`).hide():e.data.ogImage.url?(l()(`#og_${i} .og_Image`).html(`<img src="${e.data.ogImage.url}" style="height:100%;width:100%" class="brtl brbl" onerror="loadDefaultOG(this);" />`),l()(`#og_${i}`).attr("og_image",e.data.ogImage.url),l()(`#og_${i} .og_Image`).show()):l()(`#og_${i} .og_Image`).hide():l()(`#og_${i} .og_Image`).hide(),l()(`#og_${i} .og_Title`).html(e.data.ogTitle),e.data.ogDescription?l()(`#og_${i} .og_Description`).html(e.data.ogDescription):l()(`#og_${i} .og_Description`).html(""),l()(`#og_${i}`).attr("og_text",s)}else e.seq>=window.ogSeq&&(l()(`#og_${i}`).hide(),l()(`#og_${i}`).attr("display","hidden"),l()(`#og_${i}`).attr("og_href",""),l()(`#og_${i}`).attr("og_image",""),l()(`#og_${i}`).attr("og_text",""),l()(`#og_${i} .og_Name`).html(""),l()(`#og_${i} .og_Image`).html(""),l()(`#og_${i} .og_Title`).html(""),l()(`#og_${i} .og_Description`).html(""));return!1}))}return!1},window.inputKeyDown=function(e,t){const n=t.getAttribute("type"),i=t.value,s=t.getAttribute("t"),o=s.replace(/#/g,"__hash__");let r;if(r="channel"===n?document.getElementById("rpchntx"):"groupinchannel"===n?document.getElementById("rpchngrouptx"):"privChat"===n?document.getElementById(`privChat${o}`):document.getElementById(`textArea${s}`),13===e.keyCode&&l()(`#mention_${s}`).is(":visible"))return e.preventDefault(),!1;if(27===e.keyCode)return e.preventDefault(),l()(`#mentionList_${o}`).html(""),l()(`#mention_${o}`).hide(),!1;if(38===e.keyCode&&/\@\w*/.test(i.substring(0,r.selectionStart))){e.preventDefault();const t=l()(`#mention_${o}`).attr("tab");return 0===parseInt(t)?l()(`#mentionList_${o} .mention:nth-child(${t})`).addClass("bgg"):(l()(`#mentionList_${o} .mention`).removeClass("bgg"),l()(`#mention_${o}`).attr("tab",parseInt(t)-1),l()(`#mentionList_${o} .mention:nth-child(${t})`).addClass("bgg"),l()(`#mentionList_${o} .mention:nth-child(${t})`)[0].scrollIntoView()),!1}if(40===e.keyCode&&/\@\w*/.test(i.substring(0,r.selectionStart))){e.preventDefault();const t=l()(`#mention_${o}`).attr("tab"),n=l()(`#mentionList_${o} .mention`).length;return parseInt(t)===n-1||(l()(`#mentionList_${o} .mention`).removeClass("bgg"),l()(`#mention_${o}`).attr("tab",parseInt(t)+1),l()(`#mentionList_${o} .mention:nth-child(${parseInt(t)+2})`).addClass("bgg"),l()(`#mentionList_${o} .mention:nth-child(${parseInt(t)+2})`)[0].scrollIntoView()),!1}return!1},window.inputKeyUp=function(e,i){const s=i.getAttribute("type"),o=i.getAttribute("group");let r=i.value;const a=i.getAttribute("t");let c,d=a.replace(/#/g,"__hash__");if(""===r&&(l()("#og___Channel__").hide(),l()("#og___Group__").hide()),27===e.keyCode)return e.preventDefault(),!1;if(13===e.keyCode){if(l()(`#mention_${a}`).is(":visible")){const e=l()(`#mentionList_${a} .bgg`).attr("nick");return r=r.replace(/\@\w*$/,`@${e} `),l()(`#textArea${a}`)[0].value=r,l()(`#mentionList_${d}`).html(""),l()(`#mention_${d}`).hide(),!1}if(""!==window._channel.getName()&&window._channel.getMode("m")&&"privChat"!==s&&""===window._channel.getActiveRoom()&&!window._channel.isModerator(p.ENGINE_NICK)&&!window._channel.isOperator(p.ENGINE_NICK))return i.style.height="30px",i.value="",!1;if("oros"!==window.realm&&p.GUEST&&!window.invite.allowChat)return i.style.height="30px",i.value="",!1;let c,u;if(c="channel"===s?document.getElementById("rpchntx"):"groupinchannel"===s?document.getElementById("rpchngrouptx"):"privChat"===s?document.getElementById(`privChat${d}`):document.getElementById(`textArea${a}`),!e.shiftKey){u=c.selectionStart!==c.selectionEnd||c.selectionStart!==c.value.length?r.substring(0,c.selectionStart-1)+r.substring(c.selectionStart):r;let h=u;if(u=u.replace(/^\s+|\s+$/gm,""),u=u.replace(/^\n+|\n+$/gm,""),u=u.replace(/^\r+|\r+$/gm,""),u=u.replace(/^\t+|\t+$/gm,""),h=h.replace(/\s+$/g,""),h=h.replace(/\n+$/g,""),h=h.replace(/\r+$/g,""),h=h.replace(/\t+$/g,""),h=h.replace(/^(video=|audio=|image=|document=)/,""),l()(".rpme").removeClass("toj"),l()("#rpEmoticon").hide(),l()("#channelEmoticon").hide(),0!==u.length){if(i.style.height="30px",o||"privChat"===s){d=a.replace(/#/g,"__hash__");const e=window._channel.getMsgSeq()+1;if("show"===l()(`#og_${d}`).attr("display")){const t=l()(`#og_${d}`).attr("og_href"),n=l()(`#og_${d} .og_Title`).html(),i=l()(`#og_${d} .og_Name`).html(),s=l()(`#og_${d} .og_Description`).html(),r=l()(`#og_${d}`).attr("og_image"),c=l()(`#og_${d}`).attr("og_text");l()(`#og_${d}`).attr("display","hidden"),l()(`#og_${d}`).hide(),window._app.sendOpenGraph(a,i,r,t,n,s,c,e,"11",o)}else l()(`#og_${d}`).attr("display","hidden"),l()(`#og_${d}`).hide(),l()(`#${a} .commentBar`).is(":visible")?(n(`[@${l()(`#${a} .commentBar`).attr("ds")}: ${l()(`#${a} .commentedText`).html()}]\n\n${h}`,a,o),l()(".commentBar").hide()):n(h,a,o)}else if(d="groupinchannel"===s?"__Group__":"__Channel__","show"===l()(`#og_${d}`).attr("display")&&h.includes(l()(`#og_${d} .og_Name`).html())){const e=window._channel.getMsgSeq()+1,t=l()(`#og_${d}`).attr("og_href"),n=l()(`#og_${d} .og_Title`).html(),i=l()(`#og_${d} .og_Name`).html(),s=l()(`#og_${d} .og_Description`).html(),o=l()(`#og_${d}`).attr("og_image");l()(`#og_${d}`).attr("display","hidden"),l()(`#og_${d}`).hide(),window._channel.sendOpenGraph(h,t,n,o,s,i,e)}else{let n,i;l()(`#og_${d}`).attr("display","hidden"),l()(`#og_${d}`).hide(),n=1!==window._channel.getType()&&""===window._channel.getActiveRoom()?`channel_${window._channel.getName()}`:""===window._channel.getActiveRoom()?`room_${window._channel.getName()}`:`room_${window._channel.getActiveRoom()}`;try{i=JSON.parse(localStorage.getItem(n))}catch(e){i=null}const s=window._channel.getMsgSeq()+1;null!=i&&-1!==i.msg_per_day?(0!==i.todayMsgCredit||window._channel.getModes().N)&&(window._channel.getModes().N||(i.todayMsgCredit-=1,localStorage.setItem(n,JSON.stringify(i))),t(h,s),window._channel.getChannelPermissions()):t(h,s)}window.msgId+=1,i.value=""}else i.style.height="30px",i.value=""}}if(l()("#rpchntx").on("input",(function(){if(i.value.length<10)i.style.height="30px",l()("#channelInputArea").css("height","60px"),l()("#channelEmoticon").css("bottom","47px");else{let e=i.scrollHeight+20;e>220&&(e=220),i.style.height=`${i.scrollHeight}px`,l()("#channelInputArea").css("height",`${e}px`),l()("#channelEmoticon").css("bottom",e-8+"px")}})),40===e.keyCode||38===e.keyCode)return!1;if(c="channel"===s?document.getElementById("rpchntx"):"groupinchannel"===s?document.getElementById("rpchngrouptx"):"privChat"===s?document.getElementById(`privChat${d}`):document.getElementById(`textArea${a}`),32===e.keyCode)return l()(`#mentionList_${d}`).html(""),l()(`#mention_${d}`).hide(),!1;const u=r.substring(0,c.selectionStart).match(/\@\w*$/);if(null==u)return l()(`#mentionList_${d}`).html(""),l()(`#mention_${d}`).hide(),!1;l()(`#mentionList_${d}`).html(""),l()(`#mention_${d}`).show(),l()(`#mention_${d}`).attr("selectionStart",c.selectionStart),l()(`#mention_${d}`).attr("search",u[0]);const h=u[0].replace("@","");if(l()(`#mention_${d}`).attr("tab","0"),0===h.length)window.aPeople.forEach((function(e,t){let n;n=0===t?`<div class="fr w100 mention pt bgg" style="height:60px" nick="${e.nick}" t="${d}"><div class="fic fr w100"><div class="fic"><img src="https://s3.amazonaws.com/iptv.redline/avatars/user/${e.nick}/thumb.jpeg" class="cp pt" t="${e.nick}" group="false" onerror="loadDefaultAvatar(this);"></div><div class="pl10 fic"><div class="toj">${e.name}</div><div class="sxs">${e.nick}</div></div></div></div>`:`<div class="fr w100 mention pt" style="height:60px" nick="${e.nick}" t="${d}"><div class="fic fr w100"><div class="fic"><img src="https://s3.amazonaws.com/iptv.redline/avatars/user/${e.nick}/thumb.jpeg" class="cp pt" t="${e.nick}" group="false" onerror="loadDefaultAvatar(this);"></div><div class="pl10 fic"><div class="toj">${e.name}</div><div class="sxs">${e.nick}</div></div></div></div>`,l()(`#mentionList_${d}`).append(n)}));else{const e=new RegExp(`\\w*${h}\\w*`,"i");let t=0;window.aPeople.forEach((function(n){if(e.test(n.nick+n.name)){let e;0===t?(e=`<div class="fr w100 mention pt bgg" style="height:60px" nick="${n.nick}" t="${d}"><div class="fic fr w100"><div class="fic"><img src="https://s3.amazonaws.com/iptv.redline/avatars/user/${n.nick}/thumb.jpeg" class="cp pt" t="${n.nick}" group="false" onerror="loadDefaultAvatar(this);"></div><div class="pl10 fic"><div class="toj">${n.name}</div><div class="sxs">${n.nick}</div></div></div></div>`,t+=1):(e=`<div class="fr w100 mention pt" style="height:60px" nick="${n.nick}" t="${d}"><div class="fic fr w100"><div class="fic"><img src="https://s3.amazonaws.com/iptv.redline/avatars/user/${n.nick}/thumb.jpeg" class="cp pt" t="${n.nick}" group="false" onerror="loadDefaultAvatar(this);"></div><div class="pl10 fic"><div class="toj">${n.name}</div><div class="sxs">${n.nick}</div></div></div></div>`,t+=1),l()(`#mentionList_${d}`).append(e)}}))}return!1},window.loadDefaultAvatar=function(e){return window.brokenUrls.includes(e.src)||window.brokenUrls.push(e.src),e.onerror="",e.src=`${window.assets}/common/img/avatarPerson.png`,!0},window.loadDefaultOG=function(e){return e.onerror="",e.src=`${window.assets}/common/img/pixel.gif`,e.style.display="none",!0},window.messageImageError=function(e){return window.brokenUrls.includes(e.src)||window.brokenUrls.push(e.src),e.onerror="",e.src=`${window.assets}/common/img/pixel.gif`,e.style.display="none",!0},window.channelImageOnError=function(e){l()(`#lpch_img_${e}`).on("error",(function(){let e=l()(this).attr("channel");const t=e;if("c"===l()(this).attr("imgType")){"-p"===e.slice(-2)&&(e=e.slice(0,-2)),l()(`#lpch_${t}`).attr("imgsrc",`${window.files_base_url}avatars/user/${e}/thumb.jpeg`),l()(this).attr("src",`${window.files_base_url}avatars/user/${e}/thumb.jpeg`),l()(this).attr("imgType","u"),window.lChannel[t].imgType="u";for(let e=0;e<window.aChannel.length;e+=1)if(window.aChannel[e].channel===t){window.aChannel[e].imgType="u";break}return!1}if("u"===l()(this).attr("imgType")){l()(this).attr("src",`${window.assets}/common/img/avatarChannel.png`),l()(this).attr("imgType","d"),window.lChannel[t].imgType="d";for(let e=0;e<window.aChannel.length;e+=1)if(window.aChannel[e].channel===t){window.aChannel[e].imgType="d";break}return!1}return!1}))}}(),!window.login.realmConfig.realm){const e=localStorage.getItem("persistentConfigs");localStorage.clear(),e&&localStorage.setItem("persistentConfigs",e)}if(document.getElementById("login-panel")||document.getElementById("login-select")||document.getElementById("login")){window.config=window.login.realmConfig.config;const e=await window.login.getRealmLogin();if(e){l()("#realm-panel").hide(),await window.login.clearRealmLogin(),l()("#btnBackRealm").hide(),l()("#realm").val(e);const t=new URL(window.location.href),n=t.pathname.split("/");"r"===n[1]&&n[2]===e&&(n.splice(1,2),t.pathname=n.join("/")),window.history.pushState({},null,t.toString()),localStorage.setItem("selectedRealm",e),l()("#btnRealm").click()}return Ci(),!0}kp(),Mp(),setInterval((function(){if(!navigator.onLine||l()("#db-connection-failure").is(":visible"),p.CONFIG&&window.analytics){const e=window._engine.txInfoAvconf(!0)?.mediaId;if(e)if(window._mediaWndsMap.get(e)){const e=window._engine.currentChannel();e&&!window.analytics.isFactStarted("media_transmitted")&&window.analytics.getServerFacts().media_transmitted&&(window.analytics.setFactDimension("media_transmitted","channel",e),window.analytics.startFact("media_transmitted"))}else window.analytics?.isFactStarted("media_transmitted")&&window.analytics?.stopFact("media_transmitted")}window._mediaWndsArray.length>0?(l()("#featuredImg").hide(),0!==l()("#medias video").length&&l()("#medias").show(),window.devices.updateAudioOutput()):!window._channel.isFeatured()||l()("#youtube-area").is(":visible")||window.metaverse.started?l()("#featuredImg").hide():l()("#featuredImg").show()}),1e3),setInterval((function(){let e=0,t=0;l()("#lpcb .lpcu").each((function(){""!=l()(this).html()?(e+=parseInt(l()(this).html()),t+=1):t+=1,l()("#lpcb .lpcu").length==t&&(e>0?(l()("#chinotread").html()!=e&&(l()("#chinotread").show(),l()("#chinotread").html(e)),l()("#channelchatnotread").html()!=e&&(l()("#channelchatnotread").show(),l()("#channelchatnotread").html(e))):(l()("#chinotread").hide(),l()("#channelchatnotread").hide()))})),l()("#chnprivchatsarea > .fc").length>1?(l()("#chnprivchats").show(),l()("#chnopenprivchats").show(),0==l()("#chnprivchatsarea .fc").is(":visible")?l()("#chnopenprivchats").html(l()("#chnprivchatsarea > .fc").length):l()("#chnopenprivchats").html(l()("#chnprivchatsarea > .fc").length-1),l()("#chnprivchatslist").html(""),l()("#chnprivchatsarea > .fc").each((function(){0==l()(this).is(":visible")&&l()("#chnprivchatslist").append(`<div class="w100 chnprivchatitem pt" style="text-align:left;" t="${l()(this).attr("t")}">${l()(this).attr("name")}</div>`)}))):1==l()("#chnprivchatsarea > .fc").length?(l()("#chnprivchats").hide(),l()("#chnopenprivchats").hide(),l()("#chnprivchatsarea > .fc").show()):(l()("#chnprivchats").hide(),l()("#chnopenprivchats").hide()),null!=window._engine.currentChannel()&&(l()("#rpchn").is(":visible")||l()("#rpchn").show(),l()("#rpchnhvoicebadge").is(":visible")&&parseInt(l()("#rpchnhvoicebadge").html())!=Object.keys(lChannelVoices).length&&(l()("#rpchnhvoicebadge").html(Object.keys(lChannelVoices).length),N())),window._channel.getMediaVoices().length<2?l()(".channelShareScreen").hasClass("tb")&&l()(".channelShareScreen").removeClass("tb"):l()(".channelShareScreen").hasClass("tb")||l()(".channelShareScreen").addClass("tb")}),2e3),setInterval((function(){if(window._engine.currentChannel()&&0!=window._channel.getChannelMediasArray().length){const e=window._channel.getChannelMediasObject();window._channel.getChannelMediasArray().forEach((t=>{if(window._mediaWndsArray.includes(t))window._channel.setChannelMedia(t,0);else{const n=e[t].ts,i=e[t].owner,s=(new Date).getTime();s-n>0&&0!==n||i===p.ENGINE_NICK?(E(`Removing channel media window: ${t}`),window._channel.unsetChannelMedia(t),window._windowCtrl.redrawWindows()):0===n&&(E(`Updating channel media window: ${t} (timestamp: ${s})`),window._channel.setChannelMedia(t,s))}}))}}),2e3),setInterval((function(){null!=window._engine.currentChannel()&&window._engine.requestChannelInfo(window._engine.currentChannel())}),6e4),setInterval((function(){if(null==window._engine.currentChannel())l()("#hp__Channel__ > .msg").remove();else if(l()("#hp__Channel__ > .msg").length>150){const e=l()("#hp__Channel__ > .msg").length-150;l()(`#hp__Channel__ > .msg:lt(${e})`).remove()}}),3e5),setInterval((function(){window.activity&&window.activity.check();const e=l()("#rp > .cu").length;for(let t=0;t<e;t++)l()(`#rp > .cu:nth(${t})`).hasClass("z9")||l()(`#rp > .cu:nth(${t})`).remove()}),18e5),Gp=function(e,t){const n=e.action,i=e.data;if("forwardDialogClose"===n&&(window.preview&&window.preview.destroy(),window.devicesStream&&window.devicesStream.getTracks().forEach((e=>{e.stop()})),window._channel.getUserMedia(window.engineNick)||l()("#rpchnhi").removeClass("ic_collaborate_ON"),l()("#dbm").hide(),l()("#rpchnconf").hide(),setTimeout((function(){l()(".chkb").hide(),l()(".chkb").prop("checked",!1),l()(".msg").css("background-color",""),window.aForwardMessages=[],window.lForwardTargets={},window.aForwardTargets=[],l()(".dialog").hide(),l()(".msgBar").hide()}),300)),"messageAttachFileSend"===n){window.lastFile=t.name,l()(".rpmap").hide();let e="";if("imagevideo"==i.type)if(i.filename.match(/\.(png|jpg|jpeg)$/))e=`<a href="${i.objFile}" target="_blank"><img width="220" height="auto" src="${i.objFile}" s="" /></a>`;else{if(!i.filename.match(/\.(mp4|mpg|mpeg|mov|qt|flv|avi)$/))return E("File send: not allowed image/video extension!"),!1;e=`<span><video width="220" height="auto" controls><source src="${i.objFile}" type="video/mp4" s=""></video></span>`}else if("document"==i.type){if(!i.filename.match(/\.pdf$/))return E("File send: not allowed document extension!"),!1;e=`<a href="${i.objFile}" target="_blank" class="tb"><span class="material-icons pdf">&#xE873;</span><span class="sn"> PDF</span></a>`}else if("audio"==i.type){if(!i.filename.match(/\.(mp3|m4a|m4p|opus|wav)$/))return E("File send: not allowed audio extension!"),!1;e=`<audio controls><source src="${i.objFile}" type="audio/ogg" s=""><source src="${i.objFile}" type="audio/mpeg"></audio>`}else"image"==i.type?e=`<a href="${i.objFile}" target="_blank"><img width="220" height="auto" src="${i.objFile}" s="" /></a>`:"video"==i.type?e=`<span><video width="220" height="auto" controls><source src="${i.objFile}" type="video/mp4" s=""></video></span>`:E("File send: undefined type!");if("__Channel__"!=i.target&&"__Group__"!=i.target){let n="";n=1!=(o=0!=l()(`#hp${i.target}`).length?l()(`#hp${i.target}`):l()(`#chnprivh_${i.target}`)).find(".msg").last().attr("d")?"":"noTail",result=`<div class="msg ${n}" d="1"><div class="msgRight"><div id="msgId${window.msgId}"class="bubble bubbleRight ${n}">`,result+=`<div class="msgText" style="padding-right:0;padding-bottom:15px">${e}</div>`,result+='<div class="msgMeta"><span class="msgTime">';const r=new Date;let a=r.getMinutes();a<10&&(a=`0${a}`),result+=`${r.getHours()}:${a}`,result+=`</span></div><div class="material-icons more moreRight">&#xE065;</div></div><div class="tailRight ${n}"></div>`,result+=`<div class="fic"><input type="checkbox" class="chkb" msgId="${window.msgId}" mode="channelMsg"></div></div></div>`,""!=e?(o.append(result),setTimeout((function(){null!=o[0]?o.scrollTop(o[0].scrollHeight):setTimeout((function(){null!=o[0]&&o.scrollTop(o[0].scrollHeight)}),2e3)}),2e3),(s=new FormData).append("nick",void 0),s.append("t",i.target),s.append("id",msgId),s.append("file",t),l().ajax({type:"POST",enctype:"multipart/form-data",timeout:6e5,url:`/g/f/f${window.location.search}`,data:s,processData:!1,contentType:!1,cache:!1,success:e=>(E(JSON.stringify(e)),!1)})):l()(".rpmap").hide()}else{var s,o;(s=new FormData).append("nick",p.NICK),s.append("t",i.target),s.append("id",msgId),s.append("file",t),l().ajax({type:"POST",enctype:"multipart/form-data",timeout:6e5,url:`/g/f/f${window.location.search}`,data:s,processData:!1,contentType:!1,cache:!1,success(e){E(JSON.stringify(e));const t={};return 1==e.type?t.text=`audio= ${e.link} ${e.duration}`:3==e.type?t.text=`image= ${e.link}`:5==e.type?t.text=`document= ${e.link}`:7==e.type&&(t.text=`video= ${e.link} ${e.duration}`),t.type=6,t.to="",window._channel.setMsgSeq(window._channel.getMsgSeq()+1),window._channel.sendMsg(t.text,window._channel.getMsgSeq()),!1}})}}"rightPanelBodyClick"==n&&(l()(".rpme").removeClass("toj"),l()("#rpEmoticon").hide(),l()(".rpmap").hide()),"mobileRightPanelBackIconClick"==n&&(l()("#rp").hide(),l()("#lp").show())},window.addEventListener("beforeunload",(function(e){delete e.returnValue})),l()(document).on("contextmenu","#lpb",(function(e){return e.preventDefault(),!1})),L("hp__Channel__"),L("hp__Group__"),window.addEventListener("focus",(function(){window.tabSelected=!0})),window.addEventListener("blur",(function(){window.tabSelected=!1})),l()("#chnprivchatsarea").on("click",".chnprivmaxmin",(function(){l()(`#chnprivb_${l()(this).attr("t")}`).toggle()})),l()("#chnprivchatsarea").on("click",".chnprivclose",(function(){l()(`#chnprivc_${l()(this).attr("t")}`).remove(),l()(`#chatTab${l()(this).attr("t")}`).removeClass("uss"),l()("#chnprivchatsarea > .fc").length>0&&l()("#chnprivchatsarea > .fc").first().show()})),l()(".chnprivchats").click((function(){l()("#chnprivchatslist").toggle()})),l()("#chnprivchatslist").on("click",".chnprivchatitem",(function(){l()("#chnprivchatslist").hide(),l()("#chnprivchatsarea > .fc").hide(),l()(`#chnprivc_${l()(this).attr("t")}`).show(),l()("#channelChatTabList .us").removeClass("uss"),l()(`#chatTab${l()(this).attr("t")}`).addClass("uss"),l()(`#privChat${l()(this).attr("t")}`).focus()}));const e=document.getElementById("lpchcb");let t,n=0,i=0,s=!1,o=!1;if(e.onmousedown=function(e){n=(new Date).getTime(),t=e.pageX,s&&(clearInterval(s),s=!1),o&&(clearInterval(o),o=!1)},e.onmouseup=function(e){i=(new Date).getTime()},e.onmousemove=function(r){if(i<n&&!s&&!o)if(i=n,t>r.pageX){s||(s=setInterval(c,5));const a=e.scrollWidth-e.offsetWidth;function c(){o&&(clearInterval(o),o=!1),e.scrollLeft>=a?(clearInterval(s),s=!1):e.scrollLeft+=1}}else{function l(){s&&(clearInterval(s),s=!1),0!=e.scrollLeft?e.scrollLeft-=1:(clearInterval(o),o=!1)}o||(o=setInterval(l,5))}},l()("#channel_lp").on("click",".chnprivclose",(function(){const e=l()(this).attr("t");l()(`#chnprivc_${e}`).remove()})),l()("#rpchnrequestvoicelist").on("click",".userVoiceIcon",(function(){l()(this).hasClass("tb")?(window.lChannelVoices[l()(this).attr("t")]=99,delete window.lChannelVoice[l()(this).attr("t")],delete window.lChannelMediaVoice[l()(this).attr("t")],window._engine.requestTransmission(l()(this).attr("t"),!1,!1),delete window.lChannelVoices[l()(this).attr("t")],l()(this).attr("t")==window.engineNick?(window._engine.requestTransmission(l()(this).attr("t"),!1,!0),l()("#rpchnhi").removeClass("ic_collaborate_ON")):null!=lChannelMediaVoice[l()(this).attr("t")]&&window._engine.requestTransmission(l()(this).attr("t"),!1,!0),N()):(window._engine.requestTransmission(l()(this).attr("t"),!0,!1),N())})),l()("#channel_max_icon").click((function(){l()(".chnmax").hide(),l()("#rpchn").attr("position","absolute"),l()("#channel_lp").css("width","100%"),l()(this).attr("zoom","1"),l()("#boxesArea").css("max-height",""),l()("#boxesArea").css("min-height","")})),l()("#boxesArea").click((function(){"1"==l()("#channel_max_icon").attr("zoom")&&(l()("#boxesArea").css("max-height","70%"),l()("#rpchn").attr("position","relative"),l()("#channel_lp").css("width","70%"),l()("#channel_max_icon").attr("zoom","0"),l()(".chnmax").show(),l()("#channelAdm").hasClass("tb")?l()("#channelBannerArea").hide():l()("#channelAdmArea").hide(),""!=l()("#rpchnboxtext").html()&&"1"!=l()("#rpchnbox").attr("hide")||l()("#rpchnbox").hide())})),l()("#hp__Channel__").on("scroll",(async function(){if(l()("#channelUserPopup").hide(),0==l()(this).scrollTop()&&l()(this).find(".msg").attr("seq")){const e=l()(this).attr("channel"),t=l()(this).find(".msg").attr("seq"),n=await window._channel.getChannelMessages2(e,50,t);let i=[];if(n&&(i=n.msgs||[]),i.length>0){const t=i.reverseSortBy("seq"),n=l()("#hp__Channel__ > .msg").attr("seq");let s=0,o=50;l()("#hp__Channel__ > .msg").length<5&&(o=0),t.forEach((function(i,r){zd().printMessage(e,i.user,i.text,i.ts/1e3,i.seq),s+=1;const a=l()("#hp__Channel__");if(0==o&&setTimeout((function(){a.scrollTop(a[0].scrollHeight)}),3e3),s==t.length)if(0==o)a.scrollTop(a[0].scrollHeight);else if(null!=n){const t=document.getElementById(`${e}Msg${n}`).offsetTop,i=a[0].offsetTop;l()("#hp__Channel__").scrollTop(t-i-o)}}))}}l()(this).scrollTop()<l()(this)[0].scrollHeight-l()(this).height()-70?l()(this).find(".scrolldown").show():l()(this).find(".scrolldown").hide()})),l()("#rpchnuserlist").on("click",".chnu_x",(function(){setTimeout((function(){l()(".chnu").removeClass("bgg"),l()("#rpchnto").hide(),l()("#rpchntx").attr("t",_engine.currentChannel())}),100),l()(this).attr("t")!=window.engineNick&&window._engine.requestKickUser(l()(this).attr("t"),"")})),l()("#rpchnuserlist").on("click",".chnu_m",(function(){if(setTimeout((function(){l()(".chnu").removeClass("bgg"),l()("#rpchnto").hide(),l()("#rpchntx").attr("t",_engine.currentChannel())}),100),l()(this).hasClass("tb")){if(l()(this).removeClass("tb"),window._engine.requestTransmission(l()(this).attr("t"),!1,!1),l()(this).attr("t")==window.engineNick){const e=window._captureCtrl.stream();window._captureCtrl.stopStream(e),window._captureCtrl.stop()}}else l()(this).addClass("tb"),l()(this).attr("t")==window.engineNick?window._engine.requestTransmission(l()(this).attr("t"),!0,!0):window._engine.requestTransmission(l()(this).attr("t"),!0,!1)})),l()("#rpchnuserlist").on("click",".chnu_h",(function(){setTimeout((function(){l()(".chnu").removeClass("bgg"),l()("#rpchnto").hide(),l()("#rpchntx").attr("t",_engine.currentChannel())}),100),l()(this).hasClass("tb")&&(l()(this).removeClass("tb"),window._engine.requestTransmission(l()(this).attr("t"),!0,!1))})),l()("#rpchnboxclose").click((function(){l()("#rpchnbox").attr("hide","1"),l()("#rpchnbox").hide()})),l()("#lpchb").on("click",".chnu",(function(){l()(this).hasClass("bgg")?(l()(".chnu").removeClass("bgg"),l()("#rpchnto").hide(),l()("#rpchntx").attr("t",_engine.currentChannel())):(l()(".chnu").removeClass("bgg"),l()(this).addClass("bgg"),l()("#rpchntx").attr("t",l()(this).find(".sn").html()),l()("#rpchnto .sn").html(l()(this).find(".sn").html()),l()("#rpchnto").show())})),l()("#rpchnto").click((function(){l()(".chnu").removeClass("bgg"),l()("#rpchnto").hide(),l()("#rpchntx").attr("t",_engine.currentChannel())})),l()("#dbconfnm").on("change",(function(){this.checked?confAlertNewMessageSound=!0:confAlertNewMessageSound=!1})),l()("#app").on("click",".channelHashTag",(function(){if("edu"===window.config.realm.slice(0,3))return!1;let e=l()(this).attr("channel").split("#")[1];"-p"!=e.slice(-2)&&("-"==e.slice(-1)?e=e.slice(0,-1):e+="-p"),window._engine.currentChannel()?(window._channel.setJustEntered(!0),window._youtubeCtrl.reset(),window.channelToGo=e,window._engine.requestChannelInfo(e)):zr({channel:e,name:e,users:0,imgSrc:`${window.files_base_url}avatars/channel/${e}/thumb.jpeg`})})),l()("#popup").on("click",".popupItem",(function(){const e=l()("#popup").attr("s"),t=l()("#popup").attr("t").replace(/#/g,"__hash__");if(l()("#dbf").hide(),"comment"==l()(this).attr("t")){const n=l()(`#s${e}`).attr("ds");let i;const s=l()(`#s${e} .comment`).html();null!=s?i=s:(E("no comment"),i=l()(`#s${e} .msgText`).html()),l()(`#${t} .commentBar`).attr("s",e),l()(`#${t} .commentBar`).attr("ds",n),l()(`#${t} .commentedTextArea`).html(`<div class="fic fc bgg bor br" style="min-width:220px;min-height:80px;max-height:80px"><div class="pt5 pl5 pr5 bor tr bgg w100" style="min-width:220px;">${n}</div><div class="commentedText bgg bor w100 p5">${i}</div></div>`),l()("#popup").hide(),l()(".commentBar").show(),l()(`#${t} .rm`).focus()}else"forward"==l()(this).attr("t")?(l()(`#${t} .chkb`).show(),l()(`#s${e} input`).click(),l()(".forward").show(),l()(`#${t} .msgBar`).show(),l()(`#${t} .rpm`).hide()):"delete"==l()(this).attr("t")&&new hr("Apagar Mensagem?","",(()=>{const e=[],t=l()(this).attr("target"),n=l()(this).attr("s");e.push(n),_app.deleteMsg(t,e)})).present()})),l()(".dx").click((function(){Gp({action:"forwardDialogClose",data:{}})})),l()("#app").on("change",".file",(function(e){null!=this.files[0]&&(Gp({action:"messageAttachFileSend",data:{target:l()(this).attr("t"),type:l()(this).attr("m"),filename:this.files[0].name.toLowerCase(),objFile:window.URL.createObjectURL(this.files[0])}},this.files[0]),this.value="")})),l()("#app").on("drag dragstart dragend dragover dragenter dragleave drop",(function(e){e.preventDefault(),e.stopPropagation()})),l()("#app").on("drop",".rpb",(function(e){if(p.CONFIG.allowDropFiles){const t=e.originalEvent.dataTransfer.items[0].getAsFile();let n="";t.type.match(/image.*/)?n="image":t.type.match(/video.*/)?n="video":t.type.match(/.*pdf/)?n="document":t.type.match(/audio.*/)&&(n="audio"),""!==n&&Gp({action:"messageAttachFileSend",data:{target:l()(this).attr("target"),filename:t.name.toLowerCase(),type:n,objFile:window.URL.createObjectURL(t)}},t)}})),l()("#app").on("paste",".rm",(function(e){const t=p.ENGINE_NICK;if(window._channel.getModes().T&&!window._channel.isOperator(t)&&!window._channel.isRoomOperator(t)&&!window._channel.isModerator(t)){const t=e.originalEvent.clipboardData.getData("Text");return t&&l()(this).val(t),!1}const n=e.originalEvent.clipboardData.items;for(let e=0;e<n.length;e++)if(n[e].type.match(/image.*/)){const t=n[e].getAsFile();"channel"==l()(this).attr("type")?Gp({action:"messageAttachFileSend",data:{target:"__Channel__",filename:t.name.toLowerCase(),type:"image",objFile:window.URL.createObjectURL(t)}},t):"groupinchannel"==l()(this).attr("type")?Gp({action:"messageAttachFileSend",data:{target:"__Group__",filename:t.name.toLowerCase(),type:"image",objFile:window.URL.createObjectURL(t)}},t):Gp({action:"messageAttachFileSend",data:{target:l()(this).attr("t"),filename:t.name.toLowerCase(),type:"image",objFile:window.URL.createObjectURL(t)}},t)}})),l()("#lpcb_disc").click((function(){Gp({action:"leftPanelDisconnectionWindowClick",data:{}})})),await Fr(),await window.Events.dispatch("main/set-initial-localstorage"),await window.Events.dispatch("main/show-initial-main-panel"),window.debug=new Tp,await window.i18n.start(),window.i18n.setLanguage(navigator.language),localStorage.getItem("iframe")||window.location.href.includes("/iframe")){const e=new URL(window.location.href).pathname.split("/")[2],t=localStorage.getItem("iframe")||e;localStorage.removeItem("iframe");const n=window.login.getRealmConfig2(),i=window.login.realmConfig.realm||n.realm;p.REALM=i,localStorage.setItem("realm",i),localStorage.removeItem("selectedRealm"),p.IFRAME=!0;const s=(new Date).getTime();return p.NAME=`iframe ${s}`,p.ENGINE_NICK=p.ENGINE_NICK.replaceAll("-web",""),l()("body").prepend('<div class="iframeplay frm h100 w100 bgb tw" style="position:absolute;z-index:9999;"><div class="fic sxxl">â¶</div></div>'),l()("body").on("click",".iframeplay",(async function(){const e={channel:t,name:t,users:0,imgSrc:`${p.FILES_BASE_URL}avatars/user/${t}/thumb.jpeg`};return await window.Events.dispatch("main/channel-click",e),l()(".iframeplay").hide(),l()("#channel_rp").hide(),l()("#channelArea").css("background-image",""),l()("#channelArea").css("background-color","#000000"),!1})),!1}if("watch"===p.CLIENT_TYPE){if(window.invite=p.INVITE?JSON.parse(p.INVITE):void 0,window.invite){const e=3,t=window.invite.cf.toString(2).padStart(e,"0");window.invite.anonymous="1"===t.substr(-3,1),window.invite.allowChat="1"===t.substr(-2,1),window.invite.allowMedia="1"===t.substr(-1,1)}else window.invite={},window.invite.anonymous=!0,window.invite.allowChat=!0,window.invite.allowMedia=!0;const e=new URL(document.location).searchParams.get("realm"),t=e?`/?realm=${e}`:"";window.history.pushState("watch",window.document.title,`${window.location.origin}${t}`);let n=p.CHANNEL;if("-p"===n.slice(-2)&&(n=n.slice(0,-2)),p.CONFIG.showChannelCategoryList&&"-l"!==n.slice(-2)?(l()("#chnCategoriesMenu").show(),l()("#channelCategories").show()):(l()("#chnCategoriesMenu").hide(),l()("#channelCategories").hide()),l()("#channelChatTabIcon").hide(),l()(".channelChatTabIcon").hide(),"true"===p.GUEST||!0===p.GUEST)"-l"===n.slice(-2)&&window._channel.getRoomsList(),l()("#top_menu").hide(),l()("#lpchcb").hide(),l()("#chnCategoriesMenu").hide(),l()(".dbuserinfo_buttons").hide(),l()(".dbuserinfo_sendmsg").hide(),l()(".rpma").hide(),l()("#nchi").hide(),l()("#chi").hide(),l()("#pei").hide(),window.invite?.allowChat||l()("#channelInputArea").hide(),l()("#channelChatTabIcon").hide(),l()(".channelChatTabIcon").hide(),l()("#chnCategoriesMenu").hide(),l()("#channelCategories").hide(),l()("#channelArea").hide(),l()("#top_menu").hide(),window.invite?.anonymous||!window.invite?(l()("#db_invite").hide(),l()("#db_inv_button").click()):(l()("#db_inv_msg").html(`${window.i18n.get("you-were-invited-to-watch-channel")} <br><span class="sxl b">${n}</span>`),l()("#db_invite").show(),l()("#lpchcb").show(),l()("#db_invite_name").focus());else{const e=p.CHANNEL;if(l()("#top_menu").hide(),l()("#chnCategoriesMenu").hide(),l()("#channelList").hide(),p.CHANNEL)if("-l"===e.slice(-2)){window._channel.getRoomsList();let t,n=e;setTimeout((function(){try{t=JSON.parse(localStorage.getItem("roomsList")),t.rooms.forEach((e=>{e.name===n&&(n=e.topic)}))}catch(e){console.log(e)}Wr({channel:e,name:n,imgSrc:`${window.config.roomIcon}`})}),5e3)}else zr({channel:e,name:e,users:0,imgSrc:`${window.files_base_url}avatars/user/${e}/thumb.jpeg`})}return!1}if(await window.Events.dispatch("analytics/start"),"invite"===p.CLIENT_TYPE){const e=await window.Invite.getInvite(p.TOKEN);window.Invite.data=e;const t=new URL(window.location.href);t.searchParams.delete("api"),t.searchParams.delete("token");const n=t.toString();window.history.replaceState({Page:"",Url:n},"",n)}if(!window.Invite.data)return await window.Invite.showTimeExpired(),!1;const r=window.time.now();if(window.Invite.data.end_at<r)return await window.Invite.showTimeExpired(),!1;if(window.Invite.data.start_at>r)return await window.Invite.showNotStarted(),!1;if("close"===window.Invite.type&&!await window._channel.isChannelMember(window.Invite.data.channel))return await window.Invite.showCloseDenied(),!1;if(p.GUEST&&"invite"===p.CLIENT_TYPE)return await window.Invite.showGuestLogin(),!1;if("invite"===p.CLIENT_TYPE)return await window.Events.dispatch("main/enter-ephemeral-conference-room",window.Invite.data);if(!p.CONFIG.showChannelCategoryList&&"watch"!==p.CLIENT_TYPE&&!p.CONFIG.newCategoriesListWithChannels){const e=p.CONFIGfirstCategoryType?p.CONFIG.firstCategoryType:"channel";window._channel.getChannelList(e,p.CONFIG.firstCategorySelected,void 0,!0),window._channel.setLastCategory(p.CONFIG.firstCategorySelected)}p.CONFIG.newCategoriesListWithChannels&&window._channel.showNewCategoriesWithChannels()})),Array.prototype.sortBy=function(e){return this.slice(0).sort((function(t,n){return t[e]>n[e]?1:t[e]<n[e]?-1:0}))},Array.prototype.reverseSortBy=function(e){return this.slice(0).sort((function(t,n){return t[e]>n[e]?-1:t[e]<n[e]?1:0}))}})()})();